<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Java,编程,源代码,Java实践," />










<meta name="description" content="地址：https:&#x2F;&#x2F;how2j.cn?p&#x3D;154642">
<meta property="og:type" content="article">
<meta property="og:title" content="J2EE【HOW2J】">
<meta property="og:url" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/index.html">
<meta property="og:site_name" content="伶仃浩瀚">
<meta property="og:description" content="地址：https:&#x2F;&#x2F;how2j.cn?p&#x3D;154642">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1554.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1555.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1556.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1557.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1560.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1561.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1562.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4480.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4481.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4482.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4484.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4485.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4486.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4605.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4621.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4627.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1563.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1564.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1565.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4521.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4522.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4526.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4523.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4524.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4525.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4527.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1570.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1571.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1572.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1573.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1574.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1576.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1577.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1584.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1586.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1589.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/7461.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3029.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1603.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1604.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1593.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1594.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1595.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1597.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1601.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1568.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1567.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1602.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1605.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1606.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1608.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1609.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1611.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1612.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1613.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1746.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3875.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1749.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1750.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5129.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5130.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5131.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5132.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5133.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5134.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5135.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5136.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5137.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5138.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5143.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5139.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5681.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5682.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5683.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5684.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5685.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5839.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5840.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5841.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5559.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5560.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5871.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5872.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3921.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1618.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1621.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1622.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1623.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3036.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1626.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3037.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1628.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1629.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5537.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5538.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5539.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5544.png">
<meta property="og:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5551.png">
<meta property="article:published_time" content="2020-08-21T01:34:31.000Z">
<meta property="article:modified_time" content="2020-08-24T09:27:54.440Z">
<meta property="article:author" content="潇 卟 甸">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="源代码">
<meta property="article:tag" content="Java实践">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1554.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/08/21/J2EE【HOW2J】/"/>







<script>
    (function(){
        if('224694'){
            if (prompt('请输入文章密码') !== '224694'){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

  <title>J2EE【HOW2J】 | 伶仃浩瀚</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://xbd224694.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">伶仃浩瀚</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="潇 卟 甸">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/picture.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="伶仃浩瀚">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">J2EE【HOW2J】</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建时间" itemprop="dateCreated datePublished" datetime="2020-08-21T09:34:31+08:00">
                2020-08-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/How2j/" itemprop="url" rel="index">
                    <span itemprop="name">How2j</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/" class="leancloud_visitors" data-flag-title="J2EE【HOW2J】">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度 </span>
               
                 <span class="leancloud-visitors-count"></span>
	 <span> ℃ </span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  26.9k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  120 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>地址：<strong><a href="https://how2j.cn/?p=154642" target="_blank" rel="noopener">https://how2j.cn?p=154642</a></strong></p>
<a id="more"></a>
<h1 id="壹、Tomcat"><a class="header-anchor" href="#壹、Tomcat">¶</a>壹、Tomcat</h1>
<p>Tomcat是常见的免费的web服务器.<br>
Tomcat 这个名字的来历，Tomcat是一种野外的猫科动物，不依赖人类，独立生活。 Tomcat的作者，取这个名字的初衷是希望，这一款服务器可以自力更生，自给自足，像Tomcat这样一种野生动物一般，不依赖其他插件，而可以独立达到提供web 服务的效果。</p>
<h2 id="一、基础"><a class="header-anchor" href="#一、基础">¶</a>一、基础</h2>
<h3 id="1、Hello-Tomcat"><a class="header-anchor" href="#1、Hello-Tomcat">¶</a>1、Hello Tomcat</h3>
<h4 id="步骤-1-不使用tomcat访问html"><a class="header-anchor" href="#步骤-1-不使用tomcat访问html">¶</a>步骤 1 : 不使用tomcat访问html</h4>
<p>不使用tomcat也可以打开html页面，但是可以在浏览器的地址里看到 <strong>file:d:/test.html</strong> 这样的格式，是通过打开本地文件的形式打开的</p>
<p>但是我们平时上网看到的html网址一般都是:<br>
<a href="http://12306.com/index.html" target="_blank" rel="noopener">http://12306.com/index.html</a> 这样的形式<br>
这是因为有web服务器的存在</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1554.png" alt></p>
<h4 id="步骤-2-使用tomcat后，访问html"><a class="header-anchor" href="#步骤-2-使用tomcat后，访问html">¶</a>步骤 2 : 使用tomcat后，访问html</h4>
<p>使用tomcat后，可以这样 <strong>127.0.0.1:8080/test.html</strong> 像访问一个网站似的，访问一个html文件了。</p>
<p>这是因为tomcat本身是一个web 服务器，test.html部署在了这个web服务器上，所以就可以这样访问了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1555.png" alt></p>
<h4 id="步骤-3-如何启动tomcat"><a class="header-anchor" href="#步骤-3-如何启动tomcat">¶</a>步骤 3 : 如何启动tomcat</h4>
<p>首先右边下载 tomcat.rar</p>
<p>解压在d:盘，随便你解压在哪里，一般解压在一个好找的地方，因为后续的学习需要频繁的启动它</p>
<p>然后运行批处理文件： <strong>D:/tomcat/bin/startup.bat</strong></p>
<p>最后如果你看到Server startup in xxx ms，就表明启动成功了。</p>
<p><strong>注</strong> Tomcat启动之后，不要关闭。。。。 关闭了就不能访问了。。。。</p>
<p>为了正常运行，请务必确认当前java环境是JDK1.8.<br>
在命令行中输入<strong>java -version</strong>进行校验<br>
参考JDK下载以及配置办法： [JDK1.8以及更高版本下载和环境变量配置]<br>
JDK9 不够稳定，特别是Tomcat7 <strong>无法在JDK9 中运行</strong>，请勿使用JDK9运行本Tomcat7，请切换至JDK8，谢谢</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1556.png" alt></p>
<h4 id="步骤-4-如何部署网页"><a class="header-anchor" href="#步骤-4-如何部署网页">¶</a>步骤 4 : 如何部署网页</h4>
<p>部署一个功能完备的web应用 有很多种方式，但是如果只是部署一个test.html，很简单</p>
<p>把test.html 复制到 D:\tomcat\webapps\ROOT 目录下</p>
<p>就可以通过 <a href="http://127.0.0.1:8080/test.html" target="_blank" rel="noopener">http://127.0.0.1:8080/test.html</a> 访问了</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1557.png" alt></p>
<h4 id="步骤-5-8080是什么鬼？"><a class="header-anchor" href="#步骤-5-8080是什么鬼？">¶</a>步骤 5 : 8080是什么鬼？</h4>
<p>8080是tomcat默认使用的端口号</p>
<p>平时上网的网址，比如 <a href="http://12306.com/index.html" target="_blank" rel="noopener">http://12306.com/index.html</a> 是没有端口号的</p>
<p>如何让tomcat也做成这样呢？ 请继续下一个章节，[给tomcat改端口]</p>
<h3 id="2、改端口"><a class="header-anchor" href="#2、改端口">¶</a>2、改端口</h3>
<p>tomcat默认的端口号是8080，可以通过配置把端口号修改成80</p>
<h4 id="步骤-1-server-xml"><a class="header-anchor" href="#步骤-1-server-xml">¶</a>步骤 1 : server.xml</h4>
<p>tomcat的端口配置相关信息在 server.xml中</p>
<p>server.xml 记录了非常多的tomcat配置信息，其中就包括端口</p>
<p>用记事本打开 D:\tomcat\conf\server.xml</p>
<p>查询 ctrl+f，输入8080</p>
<p>可以找到两个8080，一个在注释中，不用理会。 另一个是</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span>             <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span> <span class="attr">redirectPort</span>=<span class="string">"8543"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>这就表明使用的是8080端口，把它修改为80，保存。</p>
<p>接着，必须<strong>重启tomcat</strong></p>
<p>重启tomcat…就是先关掉(点击黑屏幕右上角的xx)，再运行startup.bat…</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1560.png" alt></p>
<h4 id="步骤-2-80端口"><a class="header-anchor" href="#步骤-2-80端口">¶</a>步骤 2 : 80端口</h4>
<p>接着就可以直接通过 <a href="http://127.0.0.1/test.html%E8%AE%BF%E9%97%AE%E7%BD%91%E9%A1%B5%E4%BA%86%E3%80%82" target="_blank" rel="noopener">http://127.0.0.1/test.html访问网页了。</a></p>
<p>80端口就是web服务默认的端口号，所以就不需要显式写这个端口号了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1561.png" alt></p>
<h4 id="步骤-3-80端口被占用"><a class="header-anchor" href="#步骤-3-80端口被占用">¶</a>步骤 3 : 80端口被占用</h4>
<p>有时候80端口被占用了，无法使用该端口。</p>
<p>解决这个问题，请查看 [端口被占用怎么办]</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1562.png" alt></p>
<h3 id="3、问题排查"><a class="header-anchor" href="#3、问题排查">¶</a>3、问题排查</h3>
<p>列罗出了Tomcat常见的问题，如不能启动，屏幕一闪而过，启动之后，访问总是出现404等等常见问题。</p>
<p>以下排查手段都是针对通过startup.bat 独立方式启动的Tomcat，集成开发环境IDE(IDEA,ECLIPSE,MYECLIPSE等) 下的Tomcat启动不在此知识点讨论范围之内。</p>
<h4 id="步骤-1-JAVA-HOME"><a class="header-anchor" href="#步骤-1-JAVA-HOME">¶</a>步骤 1 : JAVA_HOME</h4>
<p>现象：点击startup.bat之后，屏幕一闪而过<br>
检验：如图所示, 首先通过cmd命令进入控制台，然后切换到对应的目录执行startup命令，得到JRE_HOME environment … 这么个提示，就表示JAVA_HOME环境变量没有设置。<br>
分析：Tomcat本身是JAVA程序，必须要有JDK才可以执行，所以必须配置JAVA_HOME。<br>
解决：进入[配置JAVA_HOME教程]，跟着下载，配置，验证三个步骤学习如何进行JDK环境变量配置。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4480.png" alt></p>
<h4 id="步骤-2-CATALINA-HOME未设置"><a class="header-anchor" href="#步骤-2-CATALINA-HOME未设置">¶</a>步骤 2 : CATALINA_HOME未设置</h4>
<p>现象：点击startup.bat之后，屏幕一闪而过<br>
检验：如图所示, 首先通过cmd命令进入控制台，然后切换到对应的目录执行startup命令，得到CATALINA_HOME environment … 这么个提示，就表示CATALINA_HOME环境变量设置错误。<br>
分析：Tomcat执行必须依赖CATALINA_HOME或者CATALINA_BASE这两个环境变量。 如果没有在环境变量里配置过，那么会自动采用bin目录的父目录作为CATALINA_HOME和CATALINA_BASE。 如果配置了，而所配置的地方又不是正确的TOMCAT目录，那么就会出现这个错误。<br>
解决：</p>
<ol>
<li>
<p>在环境变量中删除CATALINA_HOME,CATALINA_BASE的配置，记得不仅要检查环境变量，还要检查用户变量。</p>
</li>
<li>
<p>或者把CATALINA_HOME设置为正确的TOMCAT目录。</p>
</li>
</ol>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4481.png" alt></p>
<h4 id="步骤-3-CATALINA-HOME错误设置"><a class="header-anchor" href="#步骤-3-CATALINA-HOME错误设置">¶</a>步骤 3 : CATALINA_HOME错误设置</h4>
<p>现象：Tomcat可以成功启动，但是就是不能访问自己配置的web应用，老是提示404错误<br>
检验：如图所示, 在环境变量里，CATALINA_HOME设置在了另一个合法的tomcat目录上，所以无论运行哪个startup.bat，都会导致这个d:/tomcatxxxx目录下的程序被启动，而不是你期望的那个。<br>
分析：默认的Tomcat会优先根据环境变量中的CATALINA_HOME来定位目录，并运行。<br>
解决：</p>
<ol>
<li>
<p>在环境变量中删除CATALINA_HOME,CATALINA_BASE的配置，记得不仅要检查环境变量，还要检查用户变量。</p>
</li>
<li>
<p>或者使用本站的[纯净版 Tomcat]，已经取消了对环境变量CATALINA_HOME和CATALINA_BASE的依赖。</p>
</li>
</ol>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4482.png" alt></p>
<h4 id="步骤-4-端口冲突"><a class="header-anchor" href="#步骤-4-端口冲突">¶</a>步骤 4 : 端口冲突</h4>
<p>现象：屏幕一闪而过，或者不会关闭，但是提示大量错误，其中会看到如图所示的Address already in use: JVM_Bind &lt;null&gt;:80，即表示端口被占用了。</p>
<p>检验：如果是这个错误，在TOMCAT目录下的logs目录里，会有一个日志文件：catalina.yyyy-mm-dd.log（当天时间），在这个日志文件里会记载一样的错误:Address already in use: JVM_Bind &lt;null&gt;:80。即表明80端口被占用了。</p>
<p>分析：端口是独占式的，一旦一个程序占用了这个端口，其他程序就不能够再去占用它了。而80端口，有可能是被已经存在的Tomcat占用了，也有可能是被其他不知名的软件占用了，比如Apache,IIS,Oracle等等。<br>
解决：请按照[Tomcat 端口被占用了怎么办？] 步骤进行操作，定位占用端口的程序，并关闭，即可。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4484.png" alt></p>
<h4 id="步骤-5-localhost-yyyy-mm-dd-log"><a class="header-anchor" href="#步骤-5-localhost-yyyy-mm-dd-log">¶</a>步骤 5 : localhost.yyyy-mm-dd.log</h4>
<p>现象：404错误<br>
检验：打开tomcat/logs目录里的localhost.yyyy-mm-dd.log文件，发现大量的报错信息。<br>
分析：当server.xml， web.xml配置错误的时候，当前web应用就会部署失败，并且会将错误信息输出到localhost.yyyy-mm-dd.log文件中。<br>
解决： 要在localhost.yyyy-mm-dd.log文件中看提示什么错误，有可能是配置的context目录不存在，有可能是多了一个&gt;符号，具体问题，具体分析了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4485.png" alt></p>
<h4 id="步骤-6-Error-FilterStart"><a class="header-anchor" href="#步骤-6-Error-FilterStart">¶</a>步骤 6 : Error FilterStart</h4>
<p>现象：404错误，明明有文件，但是就是不能访问。<br>
检验：这个严格地说，也是配置失败，但是tomcat不会大量报错，只会偷偷地来这么一句： startup failed due to previous errors。<br>
分析：过滤器启动失败就会报这个错。<br>
解决：同样的，过滤器启动失败原因也是多种多样，好在它都会把具体错误信息输出到localhost.yyyy-mm-dd.log，这样打开localhost.yyyy-mm-dd.log根据实际情况分析，就可以较快定位问题所在了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4486.png" alt></p>
<h4 id="步骤-7-JDK版本"><a class="header-anchor" href="#步骤-7-JDK版本">¶</a>步骤 7 : JDK版本</h4>
<p>现象：404错误，明明有文件，但是就是不能访问。<br>
检验：在命令行中运行java -version 检查一下当前java的版本<br>
分析：当部署的web应用中的类是由高版本JDK编译生成，而当前tomcat运行所使用的JDK又是低版本的话，就会报出如图所示的错误：UnsupportedClassVersionError，进而导致web应用启动失败。<br>
解决：请使用JDK8或者更高版本，请参考 [检测JDK版本，以及下载与配置]</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4605.png" alt></p>
<h3 id="4、-404问题排查"><a class="header-anchor" href="#4、-404问题排查">¶</a>4、 404问题排查</h3>
<h4 id="步骤-1-404问题"><a class="header-anchor" href="#步骤-1-404问题">¶</a>步骤 1 : 404问题</h4>
<p>404表示File Not Found， 文件不存在错误。<br>
通过学员反映，出现比较多的问题是页面报404错误，因此除了前面的 [Tomcat 问题排查] 之外，又专门做了这么一个404问题排查的文章，提供问题分析的思路和对策。</p>
<h4 id="步骤-2-正确的端口号"><a class="header-anchor" href="#步骤-2-正确的端口号">¶</a>步骤 2 : 正确的端口号</h4>
<p>出现404错误证明，TOMCAT是启动成功了的。 但是在一台计算机上，可以启动多个端口号不一样的TOMCAT, 所以请确保自己访问的是正确的那个端口号，别自己启动的是8080端口号的TOMCAT,但是访问的地址却用的是80端口（默认），这样肯定会出现404错误的。</p>
<h4 id="步骤-3-环境变量"><a class="header-anchor" href="#步骤-3-环境变量">¶</a>步骤 3 : 环境变量</h4>
<p>假设有两个Tomcat A和 B，自己分明运行的是B 下的startup.bat, 但是启动的却是A，为什么会这样呢？ 这就是环境变量在作祟了。<br>
在环境变量中有两个属性：分别是CATALINA_HOME和CATALNIA_BASE，如果这个值指向的是A，那么即便运行的是B下的startup.bat, 真正启动的还会是A。</p>
<p>解决办法： 删除掉这个环境变量，或者使用移除了环境变量影响的[纯净版 Tomcat]</p>
<h4 id="步骤-4-确定Web应用是否成功启动"><a class="header-anchor" href="#步骤-4-确定Web应用是否成功启动">¶</a>步骤 4 : 确定Web应用是否成功启动</h4>
<p>虽然Tomcat启动成功了，但是对应的Web应用启动失败，依然会导致404错误。<br>
怎么判断Web应用成功与失败呢？ 倘若Web引用启动失败，那么就一定会在Tomcat的logs目录下的 <strong>localhost.当前日期.log</strong> 里留下错误信息。<br>
打开这个文件，检查对应的Web应用是否启动过程中报错了。 也许是web.xml多写了一个标签结束，也许是对应的servlet类找不到。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4621.png" alt></p>
<h4 id="步骤-5-webapps下的ROOT目录"><a class="header-anchor" href="#步骤-5-webapps下的ROOT目录">¶</a>步骤 5 : webapps下的ROOT目录</h4>
<p>有的时候，在server.xml 中配置的&lt;context 是以**“/&quot;<strong>为开始路径的，与此同时，在webapps目录下还存在一个ROOT目录，这个ROOT目录其实也是告诉tomcat，以</strong>“/”** 为开始路径，那么这样就发生冲突了，Tomcat只能二选一，通常情况下都会选择ROOT目录，那么在server.xml中配置的&lt;context 就无法启动了，导致访问对应的资源提示404错误。<br>
解决办法就是删除掉ROOT目录，或者把ROOT目录重命名</p>
<h4 id="步骤-6-访问地址的时候是否加了web应用的名称"><a class="header-anchor" href="#步骤-6-访问地址的时候是否加了web应用的名称">¶</a>步骤 6 : 访问地址的时候是否加了web应用的名称</h4>
<p>这个也是常犯的错误，加入部署的时候，指定了路径，比如：<br>
&lt;Context path=&quot;/j2ee&quot; docBase=“e:\project\j2ee\web” debug=“0” reloadable=“false” /&gt;</p>
<p>那么访问的时候，要记得加上j2ee，像这样：<br>
<a href="http://127.0.0.1:8080/" target="_blank" rel="noopener">http://127.0.0.1:8080/</a><strong>j2ee</strong>/hello</p>
<h4 id="步骤-7-是否访问对资源了"><a class="header-anchor" href="#步骤-7-是否访问对资源了">¶</a>步骤 7 : 是否访问对资源了</h4>
<p>。。。 这种错误也常见，你写的文件是 hello.html， 但是访问的是 holle.html，自然会提示404啦</p>
<h4 id="步骤-8-不能访问WEB-INF目录下的资源"><a class="header-anchor" href="#步骤-8-不能访问WEB-INF目录下的资源">¶</a>步骤 8 : 不能访问WEB-INF目录下的资源</h4>
<p>从安全角度出发，TOMCAT不允许访问WEB-INF目录下的HTML,JSP文件。 所以如果你的资源文件放在WEB-INF下，也会提示404错误</p>
<h4 id="步骤-9-访问地址后面多加了一个斜杠"><a class="header-anchor" href="#步骤-9-访问地址后面多加了一个斜杠">¶</a>步骤 9 : 访问地址后面多加了一个斜杠</h4>
<p>访问地址后面多加了一个<strong>斜杠</strong><br>
如图，本来应该访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/j2ee/login.html</span></span><br></pre></td></tr></table></figure>
<p>但是却访问了地址：<br>
<a href="http://127.0.0.1:8080/j2ee/login.html/" target="_blank" rel="noopener">http://127.0.0.1:8080/j2ee/login.html/</a></p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4627.png" alt></p>
<h3 id="5、端口被占用"><a class="header-anchor" href="#5、端口被占用">¶</a>5、端口被占用</h3>
<p>端口被占用就无法启动tomcat</p>
<p>所以要找到端口被占用的程序是哪一个</p>
<p>然后再关闭对应的程序即可</p>
<h4 id="步骤-1-查看80端口被哪些程序占用了"><a class="header-anchor" href="#步骤-1-查看80端口被哪些程序占用了">¶</a>步骤 1 : 查看80端口被哪些程序占用了</h4>
<p>使用命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano|findstr &quot;80&quot;</span><br></pre></td></tr></table></figure>
<p>查看 端口号包含&quot;80&quot;的占用情况</p>
<p>查询结果找到 80，8009，8005 （这三个都包含80）。</p>
<p>对应的pid(process id) 进程id 是1828</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1563.png" alt></p>
<h4 id="步骤-2-根据pid（进程id）-查询对应的应用程序"><a class="header-anchor" href="#步骤-2-根据pid（进程id）-查询对应的应用程序">¶</a>步骤 2 : 根据pid（进程id） 查询对应的应用程序</h4>
<p>使用命令:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist|findstr &quot;1828&quot;</span><br></pre></td></tr></table></figure>
<p>1828根据上一步找到的对应的pid</p>
<p>发现是一个java.exe程序占用了80端口</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1564.png" alt></p>
<h4 id="步骤-3-根据名称-结束该程序"><a class="header-anchor" href="#步骤-3-根据名称-结束该程序">¶</a>步骤 3 : 根据名称 结束该程序</h4>
<p>最后使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill &#x2F;f &#x2F;t &#x2F;im java.exe</span><br></pre></td></tr></table></figure>
<p>结束java.exe</p>
<p>结束成功会提示：<br>
成功： 已终止 。。。</p>
<p>或者通过pid终止：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill &#x2F;f &#x2F;pid 1828</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1565.png" alt></p>
<h3 id="6、持久化异常"><a class="header-anchor" href="#6、持久化异常">¶</a>6、持久化异常</h3>
<p>Tomcat启动的时候会报一个Exception loading sessions from persistent storage异常，但是又不影响正常的业务。</p>
<h4 id="步骤-1-启动报错"><a class="header-anchor" href="#步骤-1-启动报错">¶</a>步骤 1 : 启动报错</h4>
<p>Tomcat启动的时候会报一个<strong>Exception loading sessions from persistent storage</strong>异常</p>
<p>该问题的原因是tomcat的session持久化机制引起的，tomcat这个功能本身的用意在于重启tomcat后保存之前的session，Tomcat会把session持久化在%TOMCAT%/work/Catalina/localhost/session.ser 这个文件里。 但是因为tomcat非正常关闭，所以这个文件没有正确地结束(无EOF标记)</p>
<p><strong>解决办法治标：</strong> 只需要删除 session.ser文件即可。</p>
<p>**解决办法治本：**关闭tomcat的持久化功能，就能一劳永逸的解决这个问题。具体为修改conf下的server.xml文件。在项目的context间加入一句代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">"org.apache.catalina.session.PersistentManager"</span> <span class="attr">saveOnRestart</span>=<span class="string">"false"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>重启tomcat以后再也不会报这个错误了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/"</span> <span class="attr">docBase</span>=<span class="string">"D:\\project\\j2ee\\web"</span> <span class="attr">debug</span>=<span class="string">"0"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">"org.apache.catalina.session.PersistentManager"</span> <span class="attr">saveOnRestart</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="7、纯净版-TOMCAT"><a class="header-anchor" href="#7、纯净版-TOMCAT">¶</a>7、纯净版 TOMCAT</h3>
<p>学员常常碰到启动Tomcat失败的问题，这里对Tomcat做了些调整.</p>
<ol>
<li>
<p>移除了对换变量中配置的CATALINA_HOME和CATALINE_BASE的依赖，运行startup.bat就一定是启动当前的tomcat。</p>
</li>
<li>
<p>删除了webapps里的所有文件夹，避免未删除的ROOT目录与server.xml中的context配置发生冲突可能导致的错误，详见：[webapps下的ROOT目录]</p>
</li>
</ol>
<p>右侧准备了两个一个是80端口的，一个是8080端口的，下载解压之后运行bin目录下的startup.bat即可。</p>
<h4 id="步骤-1-80端口的，纯净版tomcat"><a class="header-anchor" href="#步骤-1-80端口的，纯净版tomcat">¶</a>步骤 1 : 80端口的，纯净版tomcat</h4>
<p>下载右上角80端口的纯净版tomcat： tomcat_80.rar</p>
<h4 id="步骤-2-8080端口的，纯净版tomcat"><a class="header-anchor" href="#步骤-2-8080端口的，纯净版tomcat">¶</a>步骤 2 : 8080端口的，纯净版tomcat</h4>
<p>下载右上角8080端口的纯净版tomcat： tomcat_8080.rar</p>
<h4 id="步骤-3-注意"><a class="header-anchor" href="#步骤-3-注意">¶</a>步骤 3 : 注意</h4>
<p>以上两个版本单独运行不会有问题，但是不要在[创建]中使用。 在动态web project中应该使用 [tomcat7-8080-eclipse.rar]</p>
<h3 id="8、部署"><a class="header-anchor" href="#8、部署">¶</a>8、部署</h3>
<h4 id="步骤-1-本知识点目的"><a class="header-anchor" href="#步骤-1-本知识点目的">¶</a>步骤 1 : 本知识点目的</h4>
<p>在接下来的课程中有大量的J2EE应用，比如servlet, struts, springmvc，这些 J2EE应用都需要部署在Tomcat里才可以运行。而初学者又特别容易在这一步犯错，所以本文专门示例如何从0开始，正确地部署一个可运行的J2EE应用，包括在过程中会碰到的问题以及对应的解决办法。</p>
<h4 id="步骤-2-下载"><a class="header-anchor" href="#步骤-2-下载">¶</a>步骤 2 : 下载</h4>
<p>下载[纯净版 Tomcat]，这是我调整过之后的tomcat, 移除了对换变量中配置的CATALINA_HOME和CATALINE_BASE的依赖。</p>
<p>推荐使用8080端口那个。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4521.png" alt></p>
<h4 id="步骤-3-测试端口"><a class="header-anchor" href="#步骤-3-测试端口">¶</a>步骤 3 : 测试端口</h4>
<p>下载好之后，解压，并运行其bin目录下的startup.bat。<br>
如果启动失败，多半是8080端口被占用了(假设上一步下载的是8080端口的那个)。 那么就通过 [端口排查]手段，找到是哪个程序占用了8080，并关闭之，然后再启动。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4522.png" alt></p>
<h4 id="步骤-4-成功启动截图"><a class="header-anchor" href="#步骤-4-成功启动截图">¶</a>步骤 4 : 成功启动截图</h4>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4526.png" alt></p>
<h4 id="步骤-5-下载一个J2EE应用"><a class="header-anchor" href="#步骤-5-下载一个J2EE应用">¶</a>步骤 5 : 下载一个J2EE应用</h4>
<p>接下来下载一个J2EE应用来进行测试，本站有很多可以运行的J2EE应用项目可供下载，尽量使用一个简单点的，不用连接数据库的来测试。<br>
如[第一个servlet]知识点右上角有一个j2ee.rar 可供下载。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4523.png" alt></p>
<h4 id="步骤-6-部署"><a class="header-anchor" href="#步骤-6-部署">¶</a>步骤 6 : 部署</h4>
<p>下载好j2ee.rar后，解压出来，假设解压到如下目录：<br>
E:\download\j2ee</p>
<p>接着用记事本把 前面下载的 tomcat8080 对应的 conf 目录下的 server.xml文件打开，复制本来被注释掉的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	&lt;Context path="/" docBase="E:\\project\\j2ee\\web" debug="0" reloadable="false" /&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>
<p>如图所示，把e:\<strong>project</strong>\j2ee\web 修改为 e:\<strong>download</strong>\j2ee\web。<br>
如果没有把握就下载右上角的server.xml,并覆盖server.xml。</p>
<p><strong>注：</strong> 文件路径是<strong>双斜杠</strong>哦，不是单斜杠</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4524.png" alt></p>
<h4 id="步骤-7-重启tomcat-并测试"><a class="header-anchor" href="#步骤-7-重启tomcat-并测试">¶</a>步骤 7 : 重启tomcat,并测试</h4>
<p>关闭tomcat, 并重新运行startup.bat。 然后输入如下网址，看到如图所示的截图，即表示部署成功了。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/hello</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4525.png" alt></p>
<h1 id="贰、Servlet"><a class="header-anchor" href="#贰、Servlet">¶</a>贰、Servlet</h1>
<h2 id="一、基础-v2"><a class="header-anchor" href="#一、基础-v2">¶</a>一、基础</h2>
<h3 id="1、开发第一个SERVLET"><a class="header-anchor" href="#1、开发第一个SERVLET">¶</a>1、开发第一个SERVLET</h3>
<p>Servlet 本身不能独立运行，需要在一个web应用中运行的<br>
而一个web应用是部署在tomcat中的</p>
<p>所以开发一个servlet需要如下几个步骤<br>
创建web应用项目<br>
编写servlet代码<br>
部署到tomcat中</p>
<p>开发的IDE也有各种选择，有的使用MyEclipse，有的使用eclipse 的EE版本,有的使用IDEA开发。</p>
<p>本例使用<strong>Eclipse EE版</strong> 结合<strong>独立的 tomcat</strong>进行一次<strong>java普通项目</strong>的创建。</p>
<p>这样做的好处是，通过最原始的方式创建一个web应用，可以掌握最基本的知识。</p>
<p>以后再碰到相关问题出错的时候，更加利于解决。</p>
<p><strong>注：</strong> 动态WEB项目的风格在[如何在Eclipse中创建动态Web项目]中也有讲解</p>
<p><strong>必读：</strong> 基于Tomcat的程序要成功运行，对于配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致运行失败。 如果你是第一次学习本教程，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-先运行，看到效果，再学习"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>先运行，再学习</p>
<p>本知识点是一个JAVA WEB项目，需要做不少步骤，任何一步部做漏了，做错了，都有可能失败，这样会影响学习的信心，并且误以为本教程是走不通的。</p>
<p>所以先下载右上角的可运行项目:j2ee.rar，解压后部署在tomcat中，观察是否正常运行。确定可以运行，确定教程是可以跑得起来的，再学习下面的内容。</p>
<p>部署tomcat的办法请参考：[在tomcat中部署JAVA WEB应用]</p>
<p>部署成功之后，测试地址</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/hello</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 本教程用的是80端口</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/4527.png" alt></p>
<h4 id="步骤-2-模仿和排错"><a class="header-anchor" href="#步骤-2-模仿和排错">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-创建一个java项目j2ee"><a class="header-anchor" href="#步骤-3-创建一个java项目j2ee">¶</a>步骤 3 : 创建一个java项目j2ee</h4>
<p>File-&gt;New-&gt;Other-&gt;Java-&gt;Java Project<br>
输入名称j2ee<br>
这样就创建一个单纯的基于java的项目<br>
注意： 必须 放在 <strong>e:\project\j2ee</strong>目录下，后续配置是基于这个目录进行<br>
注意：<strong>不要使用如下方式</strong><br>
File-&gt;New-&gt;Other-Web-&gt;Dynamic Web Project<br>
这是eclipse ee创建项目的方式，它会把各种tomcat,相关配置文件的生成都自动做掉了。 而这些细节，恰恰就是你需要学习和掌握的。 所以对于初学者不建议使用这种方式。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1570.png" alt></p>
<h4 id="步骤-4-导入必须的servlet-api-jar包"><a class="header-anchor" href="#步骤-4-导入必须的servlet-api-jar包">¶</a>步骤 4 : 导入必须的servlet-api.jar包</h4>
<p>因为是开发Servlet所以需要用到 servlet-api.jar 这个包里的相关类。</p>
<p>servlet-api.jar 包位于 D:\tomcat\lib\servlet-api.jar</p>
<p>或者从本网页的右侧下载</p>
<p>导入办法:</p>
<p>右键点击项目 -&gt; properties -&gt; Java Build Path -&gt;Libraries -&gt; Add External JARs</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1571.png" alt></p>
<h4 id="步骤-5-编写HelloServlet"><a class="header-anchor" href="#步骤-5-编写HelloServlet">¶</a>步骤 5 : 编写HelloServlet</h4>
<p>创建 HelloServlet(在Eclipse中创建一个普通类的方式：菜单-&gt;File-&gt;New-&gt;Class)<br>
<strong>注意：<strong>eclipse创建的时候会自带一个</strong>包名j2ee</strong>，**不要使用这个包名，让包名置空<br>
**<br>
HelloServlet继承了 HttpServlet<br>
并且提供了一个doGet方法</p>
<p>后续测试该类的时候，会直接在浏览器输入地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.01&#x2F;hello</span><br></pre></td></tr></table></figure>
<p>在浏览器中输入地址提交数据的方式是GET ([参考GET和POST的区别])<br>
所以该Servlet需要提供一个对应的doGet方法</p>
<p>在doGet中，输出html<br>
分别是 标题元素h1 和 当前时间的字符串</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1572.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.getWriter().println(<span class="string">"&lt;h1&gt;Hello Servlet!&lt;/h1&gt;"</span>);</span><br><span class="line">            response.getWriter().println(<span class="keyword">new</span> Date().toLocaleString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-配置web-xml"><a class="header-anchor" href="#步骤-6-配置web-xml">¶</a>步骤 6 : 配置web.xml</h4>
<p>首先在j2ee下创建目录web<br>
接着再创建目录web/WEB-INF<br>
然后在WEB-INF目录中创建 <strong>web.xml</strong></p>
<p>web.xml提供路径与servlet的映射关系<br>
把/hello这个路径，映射到 HelloServlet这个类上</p>
<p>&lt;servlet&gt; 标签下的 &lt;servlet-name&gt;<br>
与 &lt;servlet-mapping&gt; 标签下的 &lt;servlet-name&gt; 必须一样</p>
<p>&lt;servlet-name&gt;与&lt;servlet-class&gt;可以不一样，但是为了便于理解与维护，一般都会写的一样。 一目了然</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1573.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-指定项目输出到classes目录"><a class="header-anchor" href="#步骤-7-指定项目输出到classes目录">¶</a>步骤 7 : 指定项目输出到classes目录</h4>
<p>首先在WEB-INF下创建classes目录</p>
<p>把项目的class文件输出由原来的 j2ee/bin 设置到 j2ee/web/WEB-INF/classes下</p>
<p>步骤:<br>
项目右键-&gt;properties-&gt;Java Build Path-&gt;Source-&gt;右下角的 Brower-&gt; 指定位置是 j2ee/web/WEB-INF/classes。</p>
<p><strong>为什么要有这一步？</strong> 在ecilpse中默认输出的class是在bin目录下，但是tomcat启动之后，在默认情况下，不会去bin目录找这些class文件，而是到WEB-INF/classes这个目录下去寻找。 所以通过这一步的配置，使得eclipse的class文件输出到WEB-INF/classes目录下，那么这样就和tomcat兼容了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1574.png" alt></p>
<h4 id="步骤-8-配置tomcat的server-xml-中的-context"><a class="header-anchor" href="#步骤-8-配置tomcat的server-xml-中的-context">¶</a>步骤 8 : 配置tomcat的server.xml 中的&lt;context&gt;</h4>
<p>Tomcat 请使用 [80端口的，纯净版tomcat]</p>
<p>为了把 j2ee/web 这个目录部署到tomcat中，进行如下操作：</p>
<p>打开tomcat/conf/sever.xml</p>
<p>在 &lt;Host name=“localhost” 。。。 下面加一句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/"</span> <span class="attr">docBase</span>=<span class="string">"e:\\project\\j2ee\\web"</span> <span class="attr">debug</span>=<span class="string">"0"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>path=&quot;/&quot; 就表示直接通过 <a href="http://127.0.0.1/hello" target="_blank" rel="noopener">http://127.0.0.1/hello</a> 就可以访问网页了。</p>
<p>如果设置为</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/j2ee"</span> <span class="attr">docBase</span>=<span class="string">"e:\\project\\j2ee\\web"</span> <span class="attr">debug</span>=<span class="string">"0"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>那么表示需要通过 <a href="http://127.0.0.1/" target="_blank" rel="noopener">http://127.0.0.1/</a><strong>j2ee</strong>/hello才能访问呢</p>
<p>如果这一步老是失败，请直接在右侧下载修改好的server.xml</p>
<h4 id="步骤-9-删除tomcat-webapps下的ROOT目录"><a class="header-anchor" href="#步骤-9-删除tomcat-webapps下的ROOT目录">¶</a>步骤 9 : 删除tomcat webapps下的ROOT目录</h4>
<p>在上一步部署web的时候server.xml中的path 配置为 “/” 与 webapps下的ROOT目录冲突了</p>
<p>所以要<strong>删除ROOT目录</strong>，如果没有就不用删除了</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1576.png" alt></p>
<h4 id="步骤-10-重启tomcat，访问http-127-0-0-1-hello"><a class="header-anchor" href="#步骤-10-重启tomcat，访问http-127-0-0-1-hello">¶</a>步骤 10 : 重启tomcat，访问http://127.0.0.1/hello</h4>
<p>关闭tomcat后，重新启动startup.bat 访问下面地址就可以看到servlet的输出</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1/hello</span></span><br></pre></td></tr></table></figure>
<p>并且每一次刷新，都能看到输出新的时间</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1577.png" alt></p>
<h4 id="步骤-11-完整项目"><a class="header-anchor" href="#步骤-11-完整项目">¶</a>步骤 11 : 完整项目</h4>
<p>最后，在右侧提供本项目的完整压缩包。</p>
<p>实在搞不出来，可以先解压出来，完全照着里面的复制一遍，总归能搞得出来的</p>
<h3 id="2、获取参数"><a class="header-anchor" href="#2、获取参数">¶</a>2、获取参数</h3>
<p>本例通过登录行为，演示servlet如何获取从浏览器提交的账号密码</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v2"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v2">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v2"><a class="header-anchor" href="#步骤-2-模仿和排错-v2">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-创建-login-html"><a class="header-anchor" href="#步骤-3-创建-login-html">¶</a>步骤 3 : 创建 login.html</h4>
<p>在web上右键 -&gt; New -&gt;File<br>
创建一个 login.html文件<br>
然后添加一个form元素<br>
action=“login” 标题会提交到login路径，login路径在后续步骤会映射到LoginServlet<br>
method=“post” post方式表示提交的密码信息在浏览器地址栏看不到</p>
<p>接着准备账号和密码的input元素<br>
因为要提交两个数据，在servlet端为了区分哪个是账号，哪个是密码，要给这两个input元素的name属性分别叫做name和password。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1584.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>登录页面<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">账号: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">密码: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-创建-LoginServlet"><a class="header-anchor" href="#步骤-4-创建-LoginServlet">¶</a>步骤 4 : 创建 LoginServlet</h4>
<p>创建一个LoginServlet</p>
<p>因为浏览器中的<strong>form的method是post</strong>,所以LoginServlet需要提供一个<strong>doPost</strong>方法</p>
<p>在doPost方法中，通过<strong>request.getParameter</strong> 根据name取出对应的账号和密码</p>
<p>然后用System.out.println() 打印在控制台</p>
<p><strong>注</strong> 这里是打印在控制台，并没有在网页上输出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">"name:"</span> + name);</span><br><span class="line">        System.out.println(<span class="string">"password:"</span> + password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-映射LoginServlet到路径login"><a class="header-anchor" href="#步骤-5-映射LoginServlet到路径login">¶</a>步骤 5 : 映射LoginServlet到路径login</h4>
<p>在web.xml中新增映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-在页面提交数据"><a class="header-anchor" href="#步骤-6-在页面提交数据">¶</a>步骤 6 : 在页面提交数据</h4>
<p><strong>首先重启tomcat</strong><br>
然后访问页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/login.html</span><br></pre></td></tr></table></figure>
<p>输入账号密码，提交<br>
然后<strong>在tomcat的窗口</strong>，就可以看到提交的账号和密码了。</p>
<p><strong>注</strong> 不是在浏览器上看到这个提交的数据，浏览器上要看到tomcat的反馈数据，需要通过[响应]来实现。将在下一个章节讲解。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1586.png" alt></p>
<h3 id="3、返回响应"><a class="header-anchor" href="#3、返回响应">¶</a>3、返回响应</h3>
<p>根据浏览器提交的账号密码返回登录成功或者失败</p>
<p>这一步本来应该通过访问数据库来实现，这里简化一下，直接在内存中进行校验</p>
<p>如果账号是 admin,密码是123, 就返回登录成功，否则返回登录失败</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v3"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v3">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v3"><a class="header-anchor" href="#步骤-2-模仿和排错-v3">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-LoginServlet"><a class="header-anchor" href="#步骤-3-LoginServlet">¶</a>步骤 3 : LoginServlet</h4>
<p>判断账号密码是否为 admin 123，如果是就打印<br>
success 否则就打印 fail</p>
<p>根据账号密码，创建对应的html字符串。</p>
<p>然后通过response.getWriter().println() 发送到浏览器。</p>
<p><strong>注:</strong> 比较的时候把常量字符串&quot;admin&quot; &quot;123&quot;放前面，因为用户可能没有输入账号密码就提交，servlet会获取到null。 这样就规避了空指针异常的问题。</p>
<p><strong>注:</strong> 这里输出的响应是success和fail，不是中文。 如果使用中文浏览器有可能看到乱码。</p>
<p>关于中文乱码问题，统一在[中文问题]章节解决，咱们一个知识点一个知识点的掌握</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">  </span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">  </span><br><span class="line">        String html = <span class="keyword">null</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password))</span><br><span class="line">            html = <span class="string">"&lt;div style='color:green'&gt;success&lt;/div&gt;"</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            html = <span class="string">"&lt;div style='color:red'&gt;fail&lt;/div&gt;"</span>;</span><br><span class="line">  </span><br><span class="line">        PrintWriter pw = response.getWriter();</span><br><span class="line">        pw.println(html);</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-重启tomcat，提交数据"><a class="header-anchor" href="#步骤-4-重启tomcat，提交数据">¶</a>步骤 4 : 重启tomcat，提交数据</h4>
<p>访问页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/login.html</span><br></pre></td></tr></table></figure>
<p>账号输入admin<br>
密码输入123<br>
提交可以看到success</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1589.png" alt></p>
<h3 id="4、调用流程"><a class="header-anchor" href="#4、调用流程">¶</a>4、调用流程</h3>
<p>做到目前为止，已经可以使用简单的Servlet完成一些功能了。 接下来，把Servlet的调用流程整理一遍，让大家的思路更清晰一些。</p>
<h4 id="步骤-1-流程图"><a class="header-anchor" href="#步骤-1-流程图">¶</a>步骤 1 : 流程图</h4>
<p>大体思路图就是这样，接下来对思路图里的每个环节具体讲解</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/7461.png" alt></p>
<h4 id="步骤-2-login-html"><a class="header-anchor" href="#步骤-2-login-html">¶</a>步骤 2 : login.html</h4>
<p>首先访问</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/login.html</span><br></pre></td></tr></table></figure>
<p>打开一个静态的html页面，在这个页面中可以通过form，以post的形式提交数据</p>
<h4 id="步骤-3-login路径"><a class="header-anchor" href="#步骤-3-login路径">¶</a>步骤 3 : /login路径</h4>
<p>在上一步的login.html中，用form，把账号和密码，提交到/login这个路径，并且附带method=“post”</p>
<h4 id="步骤-4-找到对应的Servlet"><a class="header-anchor" href="#步骤-4-找到对应的Servlet">¶</a>步骤 4 : 找到对应的Servlet</h4>
<p>tomcat接受到一个新的请求：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/login</span><br></pre></td></tr></table></figure>
<p>其路径是/login，接着就到[配置文件web.xml]进行匹配，发现/login，对应的Servlet类是 LoginServlet。<br>
接下来的工作，就会基于这个LoginServlet进行。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3029.png" alt></p>
<h4 id="步骤-5-实例化Servlet对象"><a class="header-anchor" href="#步骤-5-实例化Servlet对象">¶</a>步骤 5 : 实例化Servlet对象</h4>
<p>Tomcat 定位到了LoginServlet后，发现并没有LoginServlet的实例存在，于是就调用LoginServlet的public无参的构造方法LoginServlet()实例化一个LoginServlet对象以备后续使用</p>
<h4 id="步骤-6-调用doGet或者doPost"><a class="header-anchor" href="#步骤-6-调用doGet或者doPost">¶</a>步骤 6 : 调用doGet或者doPost</h4>
<p>Tomcat从上一步拿到了LoginServlet的实例之后，根据页面login.html提交信息的时候带的method=“post”，去调用对应的doPost方法。</p>
<h4 id="步骤-7-request获取参数"><a class="header-anchor" href="#步骤-7-request获取参数">¶</a>步骤 7 : request获取参数</h4>
<p>接着流程进入了doPost方法中，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这个方法中，通过参数request，把页面上传递来的账号和密码信息取出来</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">String password = request.getParameter(<span class="string">"password"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-response设置响应"><a class="header-anchor" href="#步骤-8-response设置响应">¶</a>步骤 8 : response设置响应</h4>
<p>接着，根据账号和密码是否正确(判断是否是admin和123)， 创建不同的html字符串。</p>
<p>然后把html字符串通过如下方式，设置在了response对象上。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PrintWriter pw = response.getWriter();</span><br><span class="line">pw.println(html);</span><br></pre></td></tr></table></figure>
<p>到这里，Servlet的工作就做完了。</p>
<h4 id="步骤-9-tomcat把html传递给浏览器"><a class="header-anchor" href="#步骤-9-tomcat把html传递给浏览器">¶</a>步骤 9 : tomcat把html传递给浏览器</h4>
<p>在Servlet完成工作之后，tomcat拿到被Servlet修改过的response，根据这个response生成html 字符串，然后再通过[HTTP协议]，这个html字符串，回发给浏览器，浏览器再根据HTTP协议获取这个html字符串，并<strong>渲染</strong>在界面上。</p>
<p>这样在效果上，浏览器就可以看到Servlet中生成的字符串了。</p>
<p>关于HTTP协议，有专门的章节讲解 ： [HTTP协议教程]</p>
<h3 id="5、service"><a class="header-anchor" href="#5、service">¶</a>5、service()</h3>
<p>Servlet 需要提供对应的doGet() 与 doPost()方法</p>
<h4 id="步骤-1-doGet"><a class="header-anchor" href="#步骤-1-doGet">¶</a>步骤 1 : doGet()</h4>
<p>当浏览器使用get方式提交数据的时候，servlet需要提供doGet()方法</p>
<p>哪些是get方式呢？</p>
<p>form默认的提交方式<br>
如果通过一个超链访问某个地址<br>
如果在地址栏直接输入某个地址<br>
ajax指定使用get方式的时候</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-doPost"><a class="header-anchor" href="#步骤-2-doPost">¶</a>步骤 2 : doPost()</h4>
<p>当浏览器使用post方式提交数据的时候，servlet需要提供doPost()方法</p>
<p>哪些是post方式呢？<br>
在form上显示设置 method=&quot;post&quot;的时候<br>
ajax指定post方式的时候</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-service"><a class="header-anchor" href="#步骤-3-service">¶</a>步骤 3 : service()</h4>
<p>LoginServlet继承了HttpServlet,同时也继承了一个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service(HttpServletRequest , HttpServletResponse )</span><br></pre></td></tr></table></figure>
<p>实际上，在执行doGet()或者doPost()之前，都会先执行service()</p>
<p>由service()方法进行判断，到底该调用doGet()还是doPost()</p>
<p>可以发现，service(), doGet(), doPost() 三种方式的参数列表都是一样的。</p>
<p>所以，有时候也会**直接重写service()**方法，在其中提供相应的服务，就不用区分到底是get还是post了。</p>
<p>比如把前面的登录的LoginServlet，改为提供service方法，也可以达到相同的效果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"> </span><br><span class="line">        String html = <span class="keyword">null</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password))</span><br><span class="line">            html = <span class="string">"&lt;div style='color:green'&gt;success&lt;/div&gt;"</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            html = <span class="string">"&lt;div style='color:red'&gt;fail&lt;/div&gt;"</span>;</span><br><span class="line"> </span><br><span class="line">        PrintWriter pw = response.getWriter();</span><br><span class="line">        pw.println(html);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6、中文问题"><a class="header-anchor" href="#6、中文问题">¶</a>6、中文问题</h3>
<h4 id="示例-1-获取中文的参数"><a class="header-anchor" href="#示例-1-获取中文的参数">¶</a>示例 1 : 获取中文的参数</h4>
<p>为了成功获取中文参数，需要做如下操作</p>
<ol>
<li>login.html中加上</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这句话的目的是告诉浏览器，等下发消息给服务器的时候，使用UTF-8编码</p>
<ol start="2">
<li>
<p>login.html<br>
form的method修改为post</p>
</li>
<li>
<p>在servlet进行解码和编码</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] bytes=  name.getBytes(<span class="string">"ISO-8859-1"</span>);</span><br><span class="line">name = <span class="keyword">new</span> String(bytes,<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<p>先根据ISO-8859-1解码，然后用UTF-8编码<br>
这样就可以得到正确的中文参数了</p>
<p>这样需要对每一个提交的数据都进行编码和解码处理，如果觉得麻烦，也可以使用一句话代替：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<p>并且把这句话放在request.getParameter()之前</p>
<p>以上是使用UTF-8的方式获取中文呢。 也可以使用GBK。把所有的UTF-8替换为GBK即可。 GB2312同理。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1603.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//login.html</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    账号 ： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span> 密码: <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//LoginServlet.java</span></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// byte[] bytes = name.getBytes("ISO-8859-1");</span></span><br><span class="line">        <span class="comment">// name = new String(bytes, "UTF-8");</span></span><br><span class="line"> </span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"name:"</span> + name);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例-2-返回中文的响应"><a class="header-anchor" href="#示例-2-返回中文的响应">¶</a>示例 2 : 返回中文的响应</h4>
<p>在Servlet中，加上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1604.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"> </span><br><span class="line">        String html = <span class="keyword">null</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password))</span><br><span class="line">            html = <span class="string">"&lt;div style='color:green'&gt;登录成功&lt;/div&gt;"</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            html = <span class="string">"&lt;div style='color:red'&gt;登录失败&lt;/div&gt;"</span>;</span><br><span class="line"> </span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">        PrintWriter pw = response.getWriter();</span><br><span class="line">        pw.println(html);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7、生命周期"><a class="header-anchor" href="#7、生命周期">¶</a>7、生命周期</h3>
<h4 id="步骤-1-生命周期"><a class="header-anchor" href="#步骤-1-生命周期">¶</a>步骤 1 : 生命周期</h4>
<p>一个Servlet的生命周期由 [实例化]，[初始化]，[提供服务]，[销毁]，[被回收] 几个步骤组成</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1593.png" alt></p>
<h4 id="步骤-2-实例化"><a class="header-anchor" href="#步骤-2-实例化">¶</a>步骤 2 : 实例化</h4>
<p>当用户通过浏览器输入一个路径，这个路径对应的servlet被调用的时候，该Servlet就会被实例化</p>
<p>为LoginServlet显式提供一个构造方法 LoginServlet()</p>
<p>然后通过浏览器访问，就可以观察到<br>
“LoginServlet 构造方法 被调用”</p>
<p>无论访问了多少次LoginServlet<br>
LoginServlet构造方法 <strong>只会执行一次</strong>，所以Servlet是<strong>单实例的</strong></p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1594.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginServlet</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"LoginServlet 构造方法 被调用"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//略</span></span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-初始化"><a class="header-anchor" href="#步骤-3-初始化">¶</a>步骤 3 : 初始化</h4>
<p>LoginServlet 继承了HttpServlet，同时也继承了init(ServletConfig) 方法</p>
<p>init 方法是一个实例方法，所以会在构造方法执行后执行。</p>
<p>无论访问了多少次LoginSerlvet<br>
init初始化 <strong>只会执行一次</strong></p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1595.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"LoginServlet 构造方法 被调用"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"init(ServletConfig)"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 略</span></span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-提供服务"><a class="header-anchor" href="#步骤-4-提供服务">¶</a>步骤 4 : 提供服务</h4>
<p>接下来就是执行service()方法，然后通过浏览器传递过来的信息进行判断，是调用doGet()还是doPost()方法</p>
<p>在service()中就会编写我们的<strong>业务代码</strong>，在本例中就是判断用户输入的账号和密码是否正确</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"LoginServlet 构造方法 被调用"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"init(ServletConfig)"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">  </span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line">  </span><br><span class="line">        String html = <span class="keyword">null</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password))</span><br><span class="line">            html = <span class="string">"&lt;div style='color:green'&gt;success&lt;/div&gt;"</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            html = <span class="string">"&lt;div style='color:red'&gt;fail&lt;/div&gt;"</span>;</span><br><span class="line">  </span><br><span class="line">        PrintWriter pw = response.getWriter();</span><br><span class="line">        pw.println(html);</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-销毁"><a class="header-anchor" href="#步骤-5-销毁">¶</a>步骤 5 : 销毁</h4>
<p>接着是销毁destroy()<br>
在如下几种情况下，会调用destroy()</p>
<ol>
<li>该Servlet所在的web应用重新启动<br>
在server.xml中配置该web应用的时候用到了</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/"</span> <span class="attr">docBase</span>=<span class="string">"e:\\project\\j2ee\\web"</span> <span class="attr">debug</span>=<span class="string">"0"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果把 reloadable=“<strong>false</strong>” 改为reloadable=“<strong>true</strong>” 就表示有任何类发生的更新，web应用会<strong>自动重启</strong><br>
当web应用自动重启的时候，destroy()方法就会被调用</p>
<ol start="2">
<li>关闭tomcat的时候 destroy()方法会被调用，但是这个一般都发生的很快，不易被发现。</li>
</ol>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1597.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"destroy()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 略</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-被回收"><a class="header-anchor" href="#步骤-6-被回收">¶</a>步骤 6 : 被回收</h4>
<p>当该Servlet被销毁后，就满足垃圾回收的条件了。 当下一次垃圾回收GC来临的时候，就有可能被回收。</p>
<p>这个。。。也是不容易被观察到的现象。</p>
<h3 id="8、跳转"><a class="header-anchor" href="#8、跳转">¶</a>8、跳转</h3>
<p>页面跳转是开发一个web应用经常会发生的事情。</p>
<p>比如登录成功或是失败后，分别会跳转到不同的页面。</p>
<p>跳转的方式有两种，<strong>服务端跳转</strong>和客户端跳转</p>
<h4 id="步骤-1-首先准备两个页面-success-html-fail-html"><a class="header-anchor" href="#步骤-1-首先准备两个页面-success-html-fail-html">¶</a>步骤 1 : 首先准备两个页面 success.html fail.html</h4>
<p>首先在web目录下准备两个页面 success.html,fail.html<br>
分别用于显示登录成功 或者登录失败</p>
<p>如果登录成功了，就<strong>服务端跳转</strong>到success.html</p>
<p>如果登录失败了，就<strong>客户端跳转</strong>到fail.html</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1601.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//success.html</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"color:green"</span>&gt;</span>login success<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//fail.html</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"color:red"</span>&gt;</span>login fail<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-服务端跳转"><a class="header-anchor" href="#步骤-2-服务端跳转">¶</a>步骤 2 : 服务端跳转</h4>
<p>在Servlet中进行服务端跳转的方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.getRequestDispatcher(<span class="string">"success.html"</span>).forward(request, response);</span><br></pre></td></tr></table></figure>
<p>服务端跳转可以看到浏览器的地址依然是/login 路径，并不会变成success.html</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1568.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password)) &#123;</span><br><span class="line">            request.getRequestDispatcher(<span class="string">"success.html"</span>).forward(request, response);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-客户端跳转"><a class="header-anchor" href="#步骤-3-客户端跳转">¶</a>步骤 3 : 客户端跳转</h4>
<p>在Servlet中进行客户端跳转的方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(<span class="string">"fail.html"</span>);</span><br></pre></td></tr></table></figure>
<p>可以观察到，浏览器地址发生了变化</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1567.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password)) &#123;</span><br><span class="line">            request.getRequestDispatcher(<span class="string">"success.html"</span>).forward(request, response);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            response.sendRedirect(<span class="string">"fail.html"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-服务端跳转与客户端跳转图示"><a class="header-anchor" href="#步骤-4-服务端跳转与客户端跳转图示">¶</a>步骤 4 : 服务端跳转与客户端跳转图示</h4>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1602.png" alt></p>
<h3 id="9、自启动"><a class="header-anchor" href="#9、自启动">¶</a>9、自启动</h3>
<p>有的时候会有这样的业务需求：<br>
tomcat一启动，就需要执行一些初始化的代码，比如校验数据库的完整性等。</p>
<p>但是Servlet的生命周期是在用户访问浏览器对应的路径开始的。如果没有用户的第一次访问，就无法执行相关代码。</p>
<p>这个时候，就需要Servlet实现<strong>自启动</strong> 即，伴随着tomcat的启动，自动启动初始化，在初始化方法init()中，就可以进行一些业务代码的工作了。</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v4"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v4">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v4"><a class="header-anchor" href="#步骤-2-模仿和排错-v4">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-load-on-startup"><a class="header-anchor" href="#步骤-3-load-on-startup">¶</a>步骤 3 : load-on-startup</h4>
<p>在web.xml中，配置Hello Servlet的地方，增加一句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>取值范围是1-99</p>
<p>即表明该Servlet会随着Tomcat的启动而初始化。</p>
<p>同时，为HelloServlet提供一个init(ServletConfig) 方法，验证自启动</p>
<p>如图所示，在tomcat完全启动之前，就打印了<strong>init of HelloServlet</strong><br>
&lt;load-on-startup&gt;<strong>10</strong>&lt;/load-on-startup&gt; 中的<strong>10</strong>表示启动顺序<br>
如果有多个Servlet都配置了自动启动，数字越小，启动的优先级越高</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1605.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">//web.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//HelloServlet</span></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"init of Hello Servlet"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.getWriter().println(<span class="string">"&lt;h1&gt;Hello Servlet!&lt;/h1&gt;"</span>);</span><br><span class="line">            response.getWriter().println(<span class="keyword">new</span> Date().toLocaleString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="10、request常见用法"><a class="header-anchor" href="#10、request常见用法">¶</a>10、request常见用法</h3>
<p>request对象的类是HttpServletRequest，提供了很多有实用价值的方法</p>
<h4 id="示例-1-先运行，看到效果，再学习"><a class="header-anchor" href="#示例-1-先运行，看到效果，再学习">¶</a>示例 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="示例-2-模仿和排错"><a class="header-anchor" href="#示例-2-模仿和排错">¶</a>示例 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="示例-3-request的常见方法"><a class="header-anchor" href="#示例-3-request的常见方法">¶</a>示例 3 : request的常见方法</h4>
<p><strong>request.getRequestURL():</strong> 浏览器发出请求时的完整URL，包括协议 主机名 端口(如果有)&quot;<br>
<strong>request.getRequestURI():</strong> 浏览器发出请求的资源名部分，去掉了协议和主机名&quot;<br>
<strong>request.getQueryString():</strong> 请求行中的参数部分，只能显示以get方式发出的参数，post方式的看不到<br>
<strong>request.getRemoteAddr():</strong> 浏览器所处于的客户机的IP地址<br>
<strong>request.getRemoteHost():</strong> 浏览器所处于的客户机的主机名<br>
<strong>request.getRemotePort():</strong> 浏览器所处于的客户机使用的网络端口<br>
<strong>request.getLocalAddr():</strong> 服务器的IP地址<br>
<strong>request.getLocalName():</strong> 服务器的主机名<br>
<strong>request.getMethod():</strong> 得到客户机请求方式一般是GET或者POST</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1606.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"浏览器发出请求时的完整URL，包括协议 主机名 端口(如果有): "</span> + request.getRequestURL());</span><br><span class="line">        System.out.println(<span class="string">"浏览器发出请求的资源名部分，去掉了协议和主机名: "</span> + request.getRequestURI());</span><br><span class="line">        System.out.println(<span class="string">"请求行中的参数部分: "</span> + request.getQueryString());</span><br><span class="line">        System.out.println(<span class="string">"浏览器所处于的客户机的IP地址: "</span> + request.getRemoteAddr());</span><br><span class="line">        System.out.println(<span class="string">"浏览器所处于的客户机的主机名: "</span> + request.getRemoteHost());</span><br><span class="line">        System.out.println(<span class="string">"浏览器所处于的客户机使用的网络端口: "</span> + request.getRemotePort());</span><br><span class="line">        System.out.println(<span class="string">"服务器的IP地址: "</span> + request.getLocalAddr());</span><br><span class="line">        System.out.println(<span class="string">"服务器的主机名: "</span> + request.getLocalName());</span><br><span class="line">        System.out.println(<span class="string">"得到客户机请求方式: "</span> + request.getMethod());</span><br><span class="line"> </span><br><span class="line">        String html = <span class="keyword">null</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password))</span><br><span class="line">            html = <span class="string">"&lt;div style='color:green'&gt;登录成功&lt;/div&gt;"</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            html = <span class="string">"&lt;div style='color:red'&gt;登录失败&lt;/div&gt;"</span>;</span><br><span class="line"> </span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">        PrintWriter pw = response.getWriter();</span><br><span class="line">        pw.println(html);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例-4-获取参数"><a class="header-anchor" href="#示例-4-获取参数">¶</a>示例 4 : 获取参数</h4>
<p><strong>request.getParameter()</strong>: 是常见的方法，用于获取单值的参数<br>
<strong>request.getParameterValues():</strong> 用于获取具有多值的参数，比如注册时候提交的 “hobits”，可以是多选的。<br>
<strong>request.getParameterMap():</strong> 用于遍历所有的参数，并返回Map类型。</p>
<p>本例准备了一个注册的例子<br>
包括一个注册页面 register.html<br>
服务端的 RegisterServlet</p>
<p>分别演示了获取单值参数，多值参数以及遍历所有的参数</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1608.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//register.html</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"register"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">    账号 ： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    爱好 ： LOL<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobits"</span> <span class="attr">value</span>=<span class="string">"lol"</span>&gt;</span></span><br><span class="line">        DOTA<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"hobits"</span> <span class="attr">value</span>=<span class="string">"dota"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"注册"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//RegisterServlet.java</span></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RegisterServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"获取单值参数name:"</span> + request.getParameter(<span class="string">"name"</span>));</span><br><span class="line"> </span><br><span class="line">        String[] hobits = request.getParameterValues(<span class="string">"hobits"</span>);</span><br><span class="line">        System.out.println(<span class="string">"获取具有多值的参数hobits: "</span> + Arrays.asList(hobits));</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"通过 getParameterMap 遍历所有的参数： "</span>);</span><br><span class="line">        Map&lt;String, String[]&gt; parameters = request.getParameterMap();</span><br><span class="line"> </span><br><span class="line">        Set&lt;String&gt; paramNames = parameters.keySet();</span><br><span class="line">        <span class="keyword">for</span> (String param : paramNames) &#123;</span><br><span class="line">            String[] value = parameters.get(param);</span><br><span class="line">            System.out.println(param + <span class="string">":"</span> + Arrays.asList(value));</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">//web.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/register<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="示例-5-获取头信息"><a class="header-anchor" href="#示例-5-获取头信息">¶</a>示例 5 : 获取头信息</h4>
<p><strong>request.getHeader()</strong> 获取浏览器传递过来的头信息。<br>
比如getHeader(“user-agent”) 可以获取浏览器的基本资料，这样就能判断是firefox、IE、chrome、或者是safari浏览器<br>
<strong>request.getHeaderNames()</strong> 获取浏览器所有的<strong>头信息名称</strong>，根据头信息名称就能遍历出所有的头信息</p>
<p>在本例，修改HelloServlet,使其获取头信息<br>
访问HelloServlet获取如下头信息:<br>
host: 主机地址<br>
user-agent: 浏览器基本资料<br>
accept: 表示浏览器接受的数据类型<br>
accept-language: 表示浏览器接受的语言<br>
accept-encoding: 表示浏览器接受的<strong>压缩方式</strong>，是压缩方式，并非编码<br>
connection: 是否保持连接<br>
cache-control: 缓存时限</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1609.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"init of Hello Servlet"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">        Enumeration&lt;String&gt; headerNames= request.getHeaderNames();</span><br><span class="line">        <span class="keyword">while</span>(headerNames.hasMoreElements())&#123;</span><br><span class="line">            String header = headerNames.nextElement();</span><br><span class="line">            String value = request.getHeader(header);</span><br><span class="line">            System.out.printf(<span class="string">"%s\t%s%n"</span>,header,value);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.getWriter().println(<span class="string">"&lt;h1&gt;Hello Servlet!&lt;/h1&gt;"</span>);</span><br><span class="line">            response.getWriter().println(<span class="keyword">new</span> Date().toLocaleString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例-6-服务端传参"><a class="header-anchor" href="#示例-6-服务端传参">¶</a>示例 6 : 服务端传参</h4>
<p>setAttribute和getAttribute可以用来在进行服务端跳转的时候，在不同的Servlet之间进行数据共享</p>
<p>在[MVC]章节会提供更好实例帮助大家理解这两个方法的用途</p>
<h3 id="11、response-用法"><a class="header-anchor" href="#11、response-用法">¶</a>11、response 用法</h3>
<p>response是HttpServletResponse的实例，用于提供给浏览器的响应信息</p>
<h4 id="示例-1-设置响应内容"><a class="header-anchor" href="#示例-1-设置响应内容">¶</a>示例 1 : 设置响应内容</h4>
<p>通过response设置响应已经用得比较多了，在前面的Servlet学习中都是用到<br>
PrintWriter pw= <strong>response.getWriter();</strong><br>
通过response.getWriter(); 获取一个PrintWriter 对象<br>
可以使用println(),append(),write(),format()等等方法设置返回给浏览器的html内容。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            PrintWriter pw= response.getWriter();</span><br><span class="line">            pw.println(<span class="string">"&lt;h1&gt;Hello Servlet&lt;/h1&gt;"</span>);</span><br><span class="line">             </span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例-2-设置响应格式"><a class="header-anchor" href="#示例-2-设置响应格式">¶</a>示例 2 : 设置响应格式</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">"text/html"</span>);</span><br></pre></td></tr></table></figure>
<p>“text/html” 是即格式 ，在[request获取头信息] 中对应的request.getHeader(“accept”).<br>
“text/html” 是存在的，表示浏览器可以识别这种格式，如果换一个其他的格式， 比如 “text/lol” ，浏览器不能识别，那么打开此servlet就会弹出一个下载的对话框。</p>
<p>这样的手段也就常常用于实现下载功能</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1611.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            PrintWriter pw = response.getWriter();</span><br><span class="line">            pw.println(<span class="string">"&lt;h1&gt;Hello Servlet&lt;/h1&gt;"</span>);</span><br><span class="line"> </span><br><span class="line">            response.setContentType(<span class="string">"text/lol"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例-3-设置响应编码"><a class="header-anchor" href="#示例-3-设置响应编码">¶</a>示例 3 : 设置响应编码</h4>
<p>设置响应编码有两种方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line"><span class="number">2</span>. response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<p>这两种方式都需要在response.getWriter调用之前执行才能生效。</p>
<p>他们的区别在于</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<p>不仅发送到浏览器的内容会使用UTF-8编码，而且还通知浏览器使用UTF-8编码方式进行显示。所以总能正常显示中文</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>. response.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<p>仅仅是发送的浏览器的内容是UTF-8编码的，至于浏览器是用哪种编码方式显示不管。 所以当浏览器的显示编码方式不是UTF-8的时候，就会看到乱码，需要手动再进行一次设置。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1612.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line"><span class="comment">//          response.setCharacterEncoding("UTF-8");</span></span><br><span class="line"> </span><br><span class="line">            PrintWriter pw = response.getWriter();</span><br><span class="line">            pw.println(<span class="string">"&lt;h1&gt;第一次 使用 Servlet&lt;/h1&gt;"</span>);</span><br><span class="line"> </span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例-4-301或者302客户端跳转"><a class="header-anchor" href="#示例-4-301或者302客户端跳转">¶</a>示例 4 : 301或者302客户端跳转</h4>
<p>客户端有两种跳转<br>
302 表示临时跳转<br>
301 表示永久性跳转</p>
<p>302就是前面在[客户端跳转]章节用到过的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(<span class="string">"fail.html"</span>);</span><br></pre></td></tr></table></figure>
<p>301要使用另外的手段：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.setStatus(<span class="number">301</span>);</span><br><span class="line">response.setHeader(<span class="string">"Location"</span>, <span class="string">"fail.html"</span>);</span><br></pre></td></tr></table></figure>
<p>用户感受不出这两种跳转的区别，但是可以借助[火狐的调试工具]看到响应的头信息是:<br>
301 Moved Permanently。<br>
301和302的区别主要在搜索引擎对页面排名的时候有影响，这是属于SEO范畴的概念，在此就不展开了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1613.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        String name = request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String password = request.getParameter(<span class="string">"password"</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"admin"</span>.equals(name) &amp;&amp; <span class="string">"123"</span>.equals(password)) &#123;</span><br><span class="line">            request.getRequestDispatcher(<span class="string">"success.html"</span>).forward(request, response);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            response.setStatus(<span class="number">301</span>);</span><br><span class="line">            response.setHeader(<span class="string">"Location"</span>, <span class="string">"fail.html"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="示例-5-设置不使用缓存"><a class="header-anchor" href="#示例-5-设置不使用缓存">¶</a>示例 5 : 设置不使用缓存</h4>
<p>使用缓存可以加快页面的加载，降低服务端的负担。但是也可能看到过时的信息，可以通过如下手段通知浏览器不要使用缓存</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.setDateHeader(<span class="string">"Expires"</span>,<span class="number">0</span> );</span><br><span class="line">response.setHeader(<span class="string">"Cache-Control"</span>,<span class="string">"no-cache"</span>);</span><br><span class="line">response.setHeader(<span class="string">"pragma"</span>,<span class="string">"no-cache"</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.setDateHeader(<span class="string">"Expires"</span>, <span class="number">0</span>);</span><br><span class="line">            response.setHeader(<span class="string">"Cache-Control"</span>, <span class="string">"no-cache"</span>);</span><br><span class="line">            response.setHeader(<span class="string">"pragma"</span>, <span class="string">"no-cache"</span>);</span><br><span class="line">            response.getWriter().println(<span class="string">"&lt;h1&gt;Hello Servlet!&lt;/h1&gt;"</span>);</span><br><span class="line">            response.getWriter().println(<span class="keyword">new</span> Date().toLocaleString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="12、上传文件"><a class="header-anchor" href="#12、上传文件">¶</a>12、上传文件</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v5"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v5">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v5"><a class="header-anchor" href="#步骤-2-模仿和排错-v5">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-首先准备上传页面-upload-html"><a class="header-anchor" href="#步骤-3-首先准备上传页面-upload-html">¶</a>步骤 3 : 首先准备上传页面 upload.html</h4>
<p>上传页面有两点需要注意</p>
<ol>
<li>form 的<strong>method必须是post</strong>的，get不能上传文件。 还需要加上<strong>enctype=“multipart/form-data”</strong> 表示提交的数据是二进制文件</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"uploadPhoto"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>需要提供<strong>type=“file”</strong> 的字段进行上传</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"uploadPhoto"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">  英雄名称:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"heroName"</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  上传头像 : <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"filepath"</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"上传"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-接着准备-UploadPhotoServlet"><a class="header-anchor" href="#步骤-4-接着准备-UploadPhotoServlet">¶</a>步骤 4 : 接着准备 UploadPhotoServlet</h4>
<p>在UploadPhotoServlet进行上传的功能开发。</p>
<ol>
<li>
<p>需要用到两个第三方的jar包，<strong>commons-io-1.4.jar</strong>和<strong>commons-fileupload-1.2.2.jar</strong>。 在右侧下载，并放在WEB-INF/lib下</p>
</li>
<li>
<p>前部分代码是固定写法，用来做一些准备工作。 直到遍历出Item,一个Item就是对应一个浏览器提交的数据，通过item.getInputStream可以打开浏览器上传的文件的输入流。</p>
</li>
<li>
<p>客户提交的文件名有可能是一样的，所以在服务端保存文件的时候，不能使用客户提交的文件名。这里使用的是一种粗糙的解决文件名重复的办法，即使用时间戳。</p>
</li>
<li>
<p>读取输入流中的数据，保存在服务端的目录下 e:/project/j2ee/web/uploaded，这个目录是通过getRealPath获取到的。 如果项目部署在其他地方，那么会自动做相应的变化。<br>
<strong>注：</strong> 为什么要放这里？ 因为后续网页上显示的时候是通过http://127.0.0.1/uploaded/xxx.jpg 路径来获取图片。</p>
</li>
<li>
<p>根据临时生成的文件名，创建一个html img元素，然后通过response返回浏览器</p>
</li>
</ol>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1746.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.FileItem;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.FileUploadException;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.disk.DiskFileItemFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.servlet.ServletFileUpload;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadPhotoServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        String filename = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            DiskFileItemFactory factory = <span class="keyword">new</span> DiskFileItemFactory();</span><br><span class="line">            ServletFileUpload upload = <span class="keyword">new</span> ServletFileUpload(factory);</span><br><span class="line">            <span class="comment">// 设置上传文件的大小限制为1M</span></span><br><span class="line">            factory.setSizeThreshold(<span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">             </span><br><span class="line">            List items = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                items = upload.parseRequest(request);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (FileUploadException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            Iterator iter = items.iterator();</span><br><span class="line">            <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                FileItem item = (FileItem) iter.next();</span><br><span class="line">                <span class="keyword">if</span> (!item.isFormField()) &#123;</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">// 根据时间戳创建头像文件</span></span><br><span class="line">                    filename = System.currentTimeMillis() + <span class="string">".jpg"</span>;</span><br><span class="line">                     </span><br><span class="line">                    <span class="comment">//通过getRealPath获取上传文件夹，如果项目在e:/project/j2ee/web,那么就会自动获取到 e:/project/j2ee/web/uploaded</span></span><br><span class="line">                    String photoFolder =request.getServletContext().getRealPath(<span class="string">"uploaded"</span>);</span><br><span class="line">                     </span><br><span class="line">                    File f = <span class="keyword">new</span> File(photoFolder, filename);</span><br><span class="line">                    f.getParentFile().mkdirs();</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">// 通过item.getInputStream()获取浏览器上传的文件的输入流</span></span><br><span class="line">                    InputStream is = item.getInputStream();</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">// 复制文件</span></span><br><span class="line">                    FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(f);</span><br><span class="line">                    <span class="keyword">byte</span> b[] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line">                    <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">while</span> (-<span class="number">1</span> != (length = is.read(b))) &#123;</span><br><span class="line">                        fos.write(b, <span class="number">0</span>, length);</span><br><span class="line">                    &#125;</span><br><span class="line">                    fos.close();</span><br><span class="line">  </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(item.getFieldName());</span><br><span class="line">                    String value = item.getString();</span><br><span class="line">                    value = <span class="keyword">new</span> String(value.getBytes(<span class="string">"ISO-8859-1"</span>), <span class="string">"UTF-8"</span>);</span><br><span class="line">                    System.out.println(value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">             </span><br><span class="line">            String html = <span class="string">"&lt;img width='200' height='150' src='uploaded/%s' /&gt;"</span>;</span><br><span class="line">            response.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">            PrintWriter pw= response.getWriter();</span><br><span class="line">             </span><br><span class="line">            pw.format(html, filename);</span><br><span class="line">             </span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-配置web-xml"><a class="header-anchor" href="#步骤-5-配置web-xml">¶</a>步骤 5 : 配置web.xml</h4>
<p>配置UploadPhotoServlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UploadPhotoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>UploadPhotoServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UploadPhotoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/uploadPhoto<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-复制jar包"><a class="header-anchor" href="#步骤-6-复制jar包">¶</a>步骤 6 : 复制jar包</h4>
<p><strong>再强调一遍</strong>：把右侧的两个jar包commons-io-1.4.jar，commons-fileupload-1.2.2.jar 复制到WEB-INF/lib 目录下</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3875.png" alt></p>
<h4 id="步骤-7-在项目中导入jar包"><a class="header-anchor" href="#步骤-7-在项目中导入jar包">¶</a>步骤 7 : 在项目中导入jar包</h4>
<p>把jar包导入到项目中，导包办法：右键 project-&gt;properties-&gt;java build path-&gt;libaries-&gt;add external jars</p>
<h4 id="步骤-8-上传测试"><a class="header-anchor" href="#步骤-8-上传测试">¶</a>步骤 8 : 上传测试</h4>
<p>重启tomcat, 打开页面进行上传</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/upload.html</span><br></pre></td></tr></table></figure>
<p>选中某个图片点击上传，就可以看到上传的图片了</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1749.png" alt></p>
<h4 id="步骤-9-如何处理其他非File字段"><a class="header-anchor" href="#步骤-9-如何处理其他非File字段">¶</a>步骤 9 : 如何处理其他非File字段</h4>
<p>因为浏览器指定了以二进制的形式提交数据，那么就不能通过常规的手段获取非File字段：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.getParameter(<span class="string">"heroName"</span>)</span><br></pre></td></tr></table></figure>
<p>在遍历Item时(Item即对应浏览器提交的字段)，可以通过</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">item.isFormField</span><br></pre></td></tr></table></figure>
<p>来判断是否是常规字段还是提交的文件。 当item.isFormField返回true的时候，就表示是常规字段。</p>
<p>然后通过item.getFieldName()和item.getString()就知道分别是哪个字段，以及字段的值了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1750.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.FileItem;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.FileUploadException;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.disk.DiskFileItemFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.fileupload.servlet.ServletFileUpload;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadPhotoServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        String filename = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            DiskFileItemFactory factory = <span class="keyword">new</span> DiskFileItemFactory();</span><br><span class="line">            ServletFileUpload upload = <span class="keyword">new</span> ServletFileUpload(factory);</span><br><span class="line">            <span class="comment">// 设置上传文件的大小限制为1M</span></span><br><span class="line">            factory.setSizeThreshold(<span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">             </span><br><span class="line">            List items = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                items = upload.parseRequest(request);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (FileUploadException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            Iterator iter = items.iterator();</span><br><span class="line">            <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                FileItem item = (FileItem) iter.next();</span><br><span class="line">                <span class="keyword">if</span> (!item.isFormField()) &#123;</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">// 根据时间戳创建头像文件</span></span><br><span class="line">                    filename = System.currentTimeMillis() + <span class="string">".jpg"</span>;</span><br><span class="line">                    String photoFolder = <span class="string">"e:\\project\\j2ee\\web\\uploaded"</span>;</span><br><span class="line">                    File f = <span class="keyword">new</span> File(photoFolder, filename);</span><br><span class="line">                    f.getParentFile().mkdirs();</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">// 通过item.getInputStream()获取浏览器上传的文件的输入流</span></span><br><span class="line">                    InputStream is = item.getInputStream();</span><br><span class="line">  </span><br><span class="line">                    <span class="comment">// 复制文件</span></span><br><span class="line">                    FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(f);</span><br><span class="line">                    <span class="keyword">byte</span> b[] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line">                    <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">while</span> (-<span class="number">1</span> != (length = is.read(b))) &#123;</span><br><span class="line">                        fos.write(b, <span class="number">0</span>, length);</span><br><span class="line">                    &#125;</span><br><span class="line">                    fos.close();</span><br><span class="line">  </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    System.out.println(item.getFieldName());</span><br><span class="line">                    String value = item.getString();</span><br><span class="line">                    value = <span class="keyword">new</span> String(value.getBytes(<span class="string">"ISO-8859-1"</span>), <span class="string">"UTF-8"</span>);</span><br><span class="line">                    System.out.println(value);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">             </span><br><span class="line">            String html = <span class="string">"&lt;img width='200' height='150' src='uploaded/%s' /&gt;"</span>;</span><br><span class="line">            PrintWriter pw= response.getWriter();</span><br><span class="line">            pw.format(html, filename);</span><br><span class="line">             </span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、动态Web项目"><a class="header-anchor" href="#二、动态Web项目">¶</a>二、动态Web项目</h2>
<h3 id="1、创建"><a class="header-anchor" href="#1、创建">¶</a>1、创建</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v6"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v6">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目 j2ee.rar，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v6"><a class="header-anchor" href="#步骤-2-模仿和排错-v6">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-说明"><a class="header-anchor" href="#步骤-3-说明">¶</a>步骤 3 : 说明</h4>
<p>本知识点采用动态Web项目-Dynamic Web Project的方式把 [Java project+独立Tomcat的Hello Servlet] 重新做一遍。</p>
<h4 id="步骤-4-新建Dynamic-Web-Project"><a class="header-anchor" href="#步骤-4-新建Dynamic-Web-Project">¶</a>步骤 4 : 新建Dynamic Web Project</h4>
<p>新建Dynamic Web Project<br>
File-&gt;New-&gt;Other-&gt;Web-&gt;Dynamic Web Project</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5129.png" alt></p>
<h4 id="步骤-5-Servlet类"><a class="header-anchor" href="#步骤-5-Servlet类">¶</a>步骤 5 : Servlet类</h4>
<p>创建 HelloServlet<br>
**注意：**eclipse创建的时候会自带一个包名j2ee，不要使用这个包名，让包名置空</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5130.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span>&#123;</span><br><span class="line">          </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.getWriter().println(<span class="string">"&lt;h1&gt;Hello Servlet!&lt;/h1&gt;"</span>);</span><br><span class="line">            response.getWriter().println(<span class="keyword">new</span> Date().toLocaleString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-解决HttpServlet找不到问题"><a class="header-anchor" href="#步骤-6-解决HttpServlet找不到问题">¶</a>步骤 6 : 解决HttpServlet找不到问题</h4>
<p>默认的Dynamic Web Project并不会导入servlet-api.jar，所以Servlet会出现编译错误。<br>
在右上角下载servlet-api.jar,并复制到e:/project/j2ee/WebContent/WEB-INF/lib 目录下</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5131.png" alt></p>
<h4 id="步骤-7-刷新项目"><a class="header-anchor" href="#步骤-7-刷新项目">¶</a>步骤 7 : 刷新项目</h4>
<p>复制好之后，右键点击项目，刷新即可。 这个动作，会导致当前项目的build path-&gt;Libraries里的 Web App Libraries 自动加上这个servlet-api.jar包，这样HelloServlet就编译通过了。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5132.png" alt></p>
<h4 id="步骤-8-web-xml"><a class="header-anchor" href="#步骤-8-web-xml">¶</a>步骤 8 : web.xml</h4>
<p>在WEB-INF目录中创建 web.xml</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5133.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-通过Eclipse启动Tomcat-Run-On-Server"><a class="header-anchor" href="#步骤-9-通过Eclipse启动Tomcat-Run-On-Server">¶</a>步骤 9 : 通过Eclipse启动Tomcat-Run On Server</h4>
<p>接下来就是在eclipse中配置Tomcat并启动，这个需要好几个步骤完成。<br>
首先右键项目 -&gt; Run As -&gt; Run on Server</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5134.png" alt></p>
<h4 id="步骤-10-通过Eclipse启动Tomcat-服务器选择Tomcat-v7-0-Server"><a class="header-anchor" href="#步骤-10-通过Eclipse启动Tomcat-服务器选择Tomcat-v7-0-Server">¶</a>步骤 10 : 通过Eclipse启动Tomcat-服务器选择Tomcat v7.0 Server</h4>
<p>这里选中Tomcat v7.0 Server, 如果你使用的是更高版本的eclipse,这里还可以看到Tomcat v9.0 Server.<br>
本知识点使用Tomcat 为例进行讲解，其他版本的Tomcat使用类似的操作。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5135.png" alt></p>
<h4 id="步骤-11-通过Eclipse启动Tomcat-指定Tomcat服务器地址"><a class="header-anchor" href="#步骤-11-通过Eclipse启动Tomcat-指定Tomcat服务器地址">¶</a>步骤 11 : 通过Eclipse启动Tomcat-指定Tomcat服务器地址</h4>
<p>然后指定Tomcat目录所在位置，这里使用的位置是：<br>
<strong>D:\tomcat7-8080-eclipse</strong>，这个位置的Tomcat 在右上角可以下载。<br>
表示版本是7的tomcat,端口号是8080.</p>
<p><strong>注意：</strong> 右上角的tomcat7-8080-eclipse.rar是可以确保能够在eclipse中配置的，有时候tomcat被人为自定义修改之后，就不再能够在Eclipse中使用，请使用右上角确保可以运行的tomcat7，绕开不必要的麻烦。</p>
<p><strong>注意：</strong> 不要使用[纯净版 Tomcat]，因为我对其进行了修改，有可能会导致在eclipse中启动失败。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5136.png" alt></p>
<h4 id="步骤-12-通过Eclipse启动Tomcat-部署"><a class="header-anchor" href="#步骤-12-通过Eclipse启动Tomcat-部署">¶</a>步骤 12 : 通过Eclipse启动Tomcat-部署</h4>
<p>然后就是下一步，把当前项目作为 “j2ee” 部署在tomcat中。</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5137.png" alt></p>
<h4 id="步骤-13-测试"><a class="header-anchor" href="#步骤-13-测试">¶</a>步骤 13 : 测试</h4>
<p>部署成功之后，访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/j2ee/hello</span></span><br></pre></td></tr></table></figure>
<p>需要注意的是，因为在上一步部署的时候，使用的是<strong>j2ee</strong>这个配置，所以这里访问的时候有路径名称<strong>j2ee</strong>,与 [前面的独立Tomcat部署方式]不一样，那个没有j2ee这个路径</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1/hello</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5138.png" alt></p>
<h4 id="步骤-14-关闭Eclipse中的Tomcat"><a class="header-anchor" href="#步骤-14-关闭Eclipse中的Tomcat">¶</a>步骤 14 : 关闭Eclipse中的Tomcat</h4>
<p>以Eclipse的方式启动Tomcat,其实就是一个普通的Java 进程，只需要在Console 面板关闭即可</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5143.png" alt></p>
<h4 id="步骤-15-Eclipse中启动Tomcat问题-端口"><a class="header-anchor" href="#步骤-15-Eclipse中启动Tomcat问题-端口">¶</a>步骤 15 : Eclipse中启动Tomcat问题-端口</h4>
<p>启动的时候，如果出现这个错误窗口，就表示端口8080和8089被占用了。 请使用端口排查教程找出端口被哪个程序占用了：<br>
[端口被占用]</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5139.png" alt></p>
<h4 id="步骤-16-需要注意的几点"><a class="header-anchor" href="#步骤-16-需要注意的几点">¶</a>步骤 16 : 需要注意的几点</h4>
<ol>
<li>
<p>类文件会被输出到build里，而不是WEB-INF/classes目录下</p>
</li>
<li>
<p>当有类或者配置文件变化时，会自动重启，无需手动重启Tomcat. 但是不稳定，当很许多类改动，新加了jar包，新增加了配置文件等等，都有可能导致自动重启失效，所以最好还是手动重启，确保重启成功。</p>
</li>
<li>
<p>WebContent会被整个复制到 <strong>E:\project.metadata.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps\j2ee</strong> 这个位置下面去，Eclipse中启动的tomcat其实是访问的这个位置。所以当WebContent里的内容比较多的时候，就会花较长时间复制。</p>
</li>
<li>
<p>因为第3条的原因，第1条在build里生成的类和配置文件，也会被复制到第3条所说的位置</p>
</li>
</ol>
<h4 id="步骤-17-右上角可运行项目"><a class="header-anchor" href="#步骤-17-右上角可运行项目">¶</a>步骤 17 : 右上角可运行项目</h4>
<p>如果自己实在搞不出来，可以试试右上角的可运行项目j2ee.rar</p>
<h3 id="2、切换"><a class="header-anchor" href="#2、切换">¶</a>2、切换</h3>
<h4 id="步骤-1-切换到动态Web项目"><a class="header-anchor" href="#步骤-1-切换到动态Web项目">¶</a>步骤 1 : 切换到动态Web项目</h4>
<p>前一个教程[创建]讲了如何从头创建一个Web动态项目，这个教程讲解如何把一个现成的Java Project项目，切换成Web 动态项目格式</p>
<h4 id="步骤-2-准备java-project"><a class="header-anchor" href="#步骤-2-准备java-project">¶</a>步骤 2 : 准备java project</h4>
<p>在[开发servlet]的右上角，下载j2ee.rar, 并解压后，作为java project项目创建在eclipse中</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5681.png" alt></p>
<h4 id="步骤-3-项目转换"><a class="header-anchor" href="#步骤-3-项目转换">¶</a>步骤 3 : 项目转换</h4>
<p>右键项目j2ee-&gt;properties-&gt;Project Facets-&gt;Convert to faceted form…</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5682.png" alt></p>
<h4 id="步骤-4-设置content-directory"><a class="header-anchor" href="#步骤-4-设置content-directory">¶</a>步骤 4 : 设置content directory</h4>
<ol>
<li>勾选Dynamic Web Module</li>
<li>勾选之后，会出现 Furthe configuration available …, 点击</li>
<li>动态web项目的默认内容目录是WebContent,而 j2ee这个项目的对应目录是 web, 所以这里要输入web</li>
<li>点击ok</li>
</ol>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5683.png" alt></p>
<h4 id="步骤-5-点击确认"><a class="header-anchor" href="#步骤-5-点击确认">¶</a>步骤 5 : 点击确认</h4>
<p>点击Ok就行了， 不用管Revert和Apply按钮</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5684.png" alt></p>
<h4 id="步骤-6-转换成功"><a class="header-anchor" href="#步骤-6-转换成功">¶</a>步骤 6 : 转换成功</h4>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5685.png" alt></p>
<h3 id="3、导入"><a class="header-anchor" href="#3、导入">¶</a>3、导入</h3>
<h4 id="步骤-1-导入动态Web"><a class="header-anchor" href="#步骤-1-导入动态Web">¶</a>步骤 1 : 导入动态Web</h4>
<p>在前面讲解了如何从零开始[创建动态Web项目], 有时候会拿到一个完整项目，而其类型本来就是动态Web项目，那么这里就会讲解如何导入到Eclipse中，并用Tomcat启动部署起来。</p>
<h4 id="步骤-2-下载动态Web项目"><a class="header-anchor" href="#步骤-2-下载动态Web项目">¶</a>步骤 2 : 下载动态Web项目</h4>
<p>首先下载右上角的j2ee.rar，他就是一个动态Web项目</p>
<h4 id="步骤-3-导入到Eclipse中1"><a class="header-anchor" href="#步骤-3-导入到Eclipse中1">¶</a>步骤 3 : 导入到Eclipse中1</h4>
<p>菜单-&gt;File-&gt;Import-&gt;General-&gt;Existing Projects Into Workspace</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5839.png" alt></p>
<h4 id="步骤-4-导入到Eclipse中2"><a class="header-anchor" href="#步骤-4-导入到Eclipse中2">¶</a>步骤 4 : 导入到Eclipse中2</h4>
<p>在Select root directory中输入[下载动态Web项目]步骤中解压出来的目录。</p>
<p>**注：**如图所示，会发现无法点击Finish,此时只需要点一下 Brower 就可以点击Finish了。 如果怎么也点不出来，是因为Eclipse里面已经管理着一个同名项目，把那个同名项目从Eclipse删除掉就好了</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5840.png" alt></p>
<h4 id="步骤-5-动态Web项目J2EE"><a class="header-anchor" href="#步骤-5-动态Web项目J2EE">¶</a>步骤 5 : 动态Web项目J2EE</h4>
<p>这样就可以看到是动态Web项目格式的视图</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5841.png" alt></p>
<h4 id="步骤-6-启动Tomcat"><a class="header-anchor" href="#步骤-6-启动Tomcat">¶</a>步骤 6 : 启动Tomcat</h4>
<p>接下来，就可以跟着[创建新的动态Web项目]中的[通过Eclipse启动Tomcat-Run On Server] 步骤进行下去啦。</p>
<h3 id="4、无法配置Tomcat"><a class="header-anchor" href="#4、无法配置Tomcat">¶</a>4、无法配置Tomcat</h3>
<h4 id="步骤-1-现象"><a class="header-anchor" href="#步骤-1-现象">¶</a>步骤 1 : 现象</h4>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5559.png" alt></p>
<h4 id="步骤-2-解决办法"><a class="header-anchor" href="#步骤-2-解决办法">¶</a>步骤 2 : 解决办法</h4>
<p>定位到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\project\.metadata\.plugins\org.eclipse.core.runtime\.settings</span><br></pre></td></tr></table></figure>
<p>删除：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.eclipse.wst.server.core.prefs</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.eclipse.jst.server.tomcat.core.prefs</span><br></pre></td></tr></table></figure>
<p>接着重启eclipse即可</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5560.png" alt></p>
<h3 id="5、无法启动Tomcat"><a class="header-anchor" href="#5、无法启动Tomcat">¶</a>5、无法启动Tomcat</h3>
<h4 id="步骤-1-现象-v2"><a class="header-anchor" href="#步骤-1-现象-v2">¶</a>步骤 1 : 现象</h4>
<p>有时候点击Eclipse中的Tomcat启动，会弹出这么个对话框，表示启动失败</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5871.png" alt></p>
<h4 id="步骤-2-解决办法-v2"><a class="header-anchor" href="#步骤-2-解决办法-v2">¶</a>步骤 2 : 解决办法</h4>
<p>解决办法粗暴一点：菜单-Window-&gt;Show View-&gt;Other-&gt;Server-&gt;Servers 此时会出现如图所示的Tomcat v7.0 Server…</p>
<p>右键点击，选择Delete</p>
<p>然后再重新配置 [通过Eclipse启动Tomcat-Run On Server]即可~</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5872.png" alt></p>
<h3 id="6、idea"><a class="header-anchor" href="#6、idea">¶</a>6、idea</h3>
<p>前几个教程使用Eclipse下的Web Dynamic Web Project风格创建，可是有部分同学更倾向于使用idea来启动web项目，不过在idea导入eclipse的Dynamic Web Project风格项目的时候由常常走不通，为此专门制作了：[如何使用IDEA导入并启动Eclipse下的的 Dynamic Web Project]，协助学习曲线更平滑些。</p>
<h2 id="三、CRUD"><a class="header-anchor" href="#三、CRUD">¶</a>三、CRUD</h2>
<h3 id="1、查询"><a class="header-anchor" href="#1、查询">¶</a>1、查询</h3>
<p>CRUD是常见的页面功能，即我们常说的增删改查<br>
C - Creation 增加<br>
R - Retrieve 查询<br>
U - Update 修改<br>
D - DELETE 删除</p>
<p>本章节将介绍如何与JDBC结合，通过servlet查询数据库，根据查询结果，得到一个html页面，显示数据库中的内容。</p>
<p>本例借助JDBC章节的Hero类和[HeroDAO类]进行数据库查询</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v7"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v7">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v7"><a class="header-anchor" href="#步骤-2-模仿和排错-v7">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果"><a class="header-anchor" href="#步骤-3-效果">¶</a>步骤 3 : 效果</h4>
<p>这样就把表Hero里的数据都查出来了</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3921.png" alt></p>
<h4 id="步骤-4-准备实体类Hero"><a class="header-anchor" href="#步骤-4-准备实体类Hero">¶</a>步骤 4 : 准备实体类Hero</h4>
<p>Hero类有id,name,hp,damage等属性。</p>
<p>并且为每一个属性提供public的getter和setter。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bean;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hero</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> hp;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> damage;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getHp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHp</span><span class="params">(<span class="keyword">float</span> hp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hp = hp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDamage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> damage;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDamage</span><span class="params">(<span class="keyword">int</span> damage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.damage = damage;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-准备DAO-类-HeroDAO"><a class="header-anchor" href="#步骤-5-准备DAO-类-HeroDAO">¶</a>步骤 5 : 准备DAO 类 HeroDAO</h4>
<p>准备一个HeroDAO，提供增加，删除，修改，查询等常规数据库操作方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dao;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> bean.Hero;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroDAO</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HeroDAO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(<span class="string">"jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8"</span>, <span class="string">"root"</span>,</span><br><span class="line">                <span class="string">"admin"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> (Connection c = getConnection(); Statement s = c.createStatement();) &#123;</span><br><span class="line">  </span><br><span class="line">            String sql = <span class="string">"select count(*) from hero"</span>;</span><br><span class="line">  </span><br><span class="line">            ResultSet rs = s.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                total = rs.getInt(<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            System.out.println(<span class="string">"total:"</span> + total);</span><br><span class="line">  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">  </span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Hero hero)</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        String sql = <span class="string">"insert into hero values(null,?,?,?)"</span>;</span><br><span class="line">        <span class="keyword">try</span> (Connection c = getConnection(); PreparedStatement ps = c.prepareStatement(sql);) &#123;</span><br><span class="line">  </span><br><span class="line">            ps.setString(<span class="number">1</span>, hero.name);</span><br><span class="line">            ps.setFloat(<span class="number">2</span>, hero.hp);</span><br><span class="line">            ps.setInt(<span class="number">3</span>, hero.damage);</span><br><span class="line">  </span><br><span class="line">            ps.execute();</span><br><span class="line">  </span><br><span class="line">            ResultSet rs = ps.getGeneratedKeys();</span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                <span class="keyword">int</span> id = rs.getInt(<span class="number">1</span>);</span><br><span class="line">                hero.id = id;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">  </span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Hero hero)</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        String sql = <span class="string">"update hero set name= ?, hp = ? , damage = ? where id = ?"</span>;</span><br><span class="line">        <span class="keyword">try</span> (Connection c = getConnection(); PreparedStatement ps = c.prepareStatement(sql);) &#123;</span><br><span class="line">  </span><br><span class="line">            ps.setString(<span class="number">1</span>, hero.name);</span><br><span class="line">            ps.setFloat(<span class="number">2</span>, hero.hp);</span><br><span class="line">            ps.setInt(<span class="number">3</span>, hero.damage);</span><br><span class="line">            ps.setInt(<span class="number">4</span>, hero.id);</span><br><span class="line">  </span><br><span class="line">            ps.execute();</span><br><span class="line">  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">  </span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">try</span> (Connection c = getConnection(); Statement s = c.createStatement();) &#123;</span><br><span class="line">  </span><br><span class="line">            String sql = <span class="string">"delete from hero where id = "</span> + id;</span><br><span class="line">  </span><br><span class="line">            s.execute(sql);</span><br><span class="line">  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">  </span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Hero <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        Hero hero = <span class="keyword">null</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">try</span> (Connection c = getConnection(); Statement s = c.createStatement();) &#123;</span><br><span class="line">  </span><br><span class="line">            String sql = <span class="string">"select * from hero where id = "</span> + id;</span><br><span class="line">  </span><br><span class="line">            ResultSet rs = s.executeQuery(sql);</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                hero = <span class="keyword">new</span> Hero();</span><br><span class="line">                String name = rs.getString(<span class="number">2</span>);</span><br><span class="line">                <span class="keyword">float</span> hp = rs.getFloat(<span class="string">"hp"</span>);</span><br><span class="line">                <span class="keyword">int</span> damage = rs.getInt(<span class="number">4</span>);</span><br><span class="line">                hero.name = name;</span><br><span class="line">                hero.hp = hp;</span><br><span class="line">                hero.damage = damage;</span><br><span class="line">                hero.id = id;</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">  </span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hero;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Hero&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> list(<span class="number">0</span>, Short.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Hero&gt; <span class="title">list</span><span class="params">(<span class="keyword">int</span> start, <span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">        List&lt;Hero&gt; heros = <span class="keyword">new</span> ArrayList&lt;Hero&gt;();</span><br><span class="line">  </span><br><span class="line">        String sql = <span class="string">"select * from hero order by id desc limit ?,? "</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">try</span> (Connection c = getConnection(); PreparedStatement ps = c.prepareStatement(sql);) &#123;</span><br><span class="line">  </span><br><span class="line">            ps.setInt(<span class="number">1</span>, start);</span><br><span class="line">            ps.setInt(<span class="number">2</span>, count);</span><br><span class="line">  </span><br><span class="line">            ResultSet rs = ps.executeQuery();</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                Hero hero = <span class="keyword">new</span> Hero();</span><br><span class="line">                <span class="keyword">int</span> id = rs.getInt(<span class="number">1</span>);</span><br><span class="line">                String name = rs.getString(<span class="number">2</span>);</span><br><span class="line">                <span class="keyword">float</span> hp = rs.getFloat(<span class="string">"hp"</span>);</span><br><span class="line">                <span class="keyword">int</span> damage = rs.getInt(<span class="number">4</span>);</span><br><span class="line">                hero.id = id;</span><br><span class="line">                hero.name = name;</span><br><span class="line">                hero.hp = hp;</span><br><span class="line">                hero.damage = damage;</span><br><span class="line">                heros.add(hero);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">  </span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> heros;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-创建表Hero的SQL"><a class="header-anchor" href="#步骤-6-创建表Hero的SQL">¶</a>步骤 6 : 创建表Hero的SQL</h4>
<p>用于创建表Hero的SQL语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS &#96;hero&#96;;</span><br><span class="line"> </span><br><span class="line">CREATE TABLE &#96;hero&#96; (</span><br><span class="line">  &#96;id&#96; int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  &#96;name&#96; varchar(30) DEFAULT NULL,</span><br><span class="line">  &#96;hp&#96; float DEFAULT NULL,</span><br><span class="line">  &#96;damage&#96; int(11) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;id&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-为web应用导入mysql-jdbc的jar包"><a class="header-anchor" href="#步骤-7-为web应用导入mysql-jdbc的jar包">¶</a>步骤 7 : 为web应用导入mysql-jdbc的jar包</h4>
<p>为web应用导入mysql-jdbc的jar包与[为项目导入mysql-jdbc的jar包]不同，其作用的web应用在tomcat中运行起来后，能够找到jar包中的类。<br>
所以需要把 mysql 的jar包放在WEB-INF/lib 目录下。</p>
<p><strong>注：</strong> mysql-connector-java-5.0.8-bin.jar 可以在右侧下载<br>
<strong>注： 放在WEB-INF/lib 下指的是能够web应用中找到对应的class，如果要在eclipse中做调试，还是需要为项目添加该jar才可以。</strong></p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1618.png" alt></p>
<h4 id="步骤-8-编写-HeroListServlet"><a class="header-anchor" href="#步骤-8-编写-HeroListServlet">¶</a>步骤 8 : 编写 HeroListServlet</h4>
<p>做一个Hero的维护页面需要一些通用的操作，比如增加，删除，编辑，修改，查询等。</p>
<p>每个不同的操作，都需要一个对应的Servlet，除了做Hero之外，还会做到其他的一些表的相关操作，所以好的规范会对将来的维护更有好处。</p>
<p>一般会这样命名,以查询为例 HeroListServlet ： [表][行为]Servlet 这样一种命名规则。</p>
<p>所以对于Hero而言就会如此命名：<br>
增加 HeroAddServlet<br>
删除 HeroDeleteServlet<br>
编辑 HeroEditServlet<br>
修改 HeroUpdateServlet<br>
查询 HeroListServlet</p>
<p>在HeroListServlet中，会使用HeroDAO把数据查询出来，然后拼接成一个table用于显示其内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> bean.Hero;</span><br><span class="line"><span class="keyword">import</span> dao.HeroDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroListServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">         </span><br><span class="line">        List&lt;Hero&gt; heros = <span class="keyword">new</span> HeroDAO().list();</span><br><span class="line"> </span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        sb.append(<span class="string">"&lt;table align='center' border='1' cellspacing='0'&gt;\r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;name&lt;/td&gt;&lt;td&gt;hp&lt;/td&gt;&lt;td&gt;damage&lt;/td&gt;&lt;/tr&gt;\r\n"</span>);</span><br><span class="line"> </span><br><span class="line">        String trFormat = <span class="string">"&lt;tr&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%f&lt;/td&gt;&lt;td&gt;%d&lt;/td&gt;&lt;/tr&gt;\r\n"</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (Hero hero : heros) &#123;</span><br><span class="line">            String tr = String.format(trFormat, hero.getId(), hero.getName(), hero.getHp(), hero.getDamage());</span><br><span class="line">            sb.append(tr);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        sb.append(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line"> </span><br><span class="line">        response.getWriter().write(sb.toString());</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-配置web-xml"><a class="header-anchor" href="#步骤-9-配置web-xml">¶</a>步骤 9 : 配置web.xml</h4>
<p>在web.xml中把路径 listHero映射到HeroListServlet上。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/register<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroListServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/listHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-重启tomcat，访问http-127-0-0-1-listHero"><a class="header-anchor" href="#步骤-10-重启tomcat，访问http-127-0-0-1-listHero">¶</a>步骤 10 : 重启tomcat，访问http://127.0.0.1/listHero</h4>
<p>重启tomcat，访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1/listHero</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1621.png" alt></p>
<h3 id="2、增加"><a class="header-anchor" href="#2、增加">¶</a>2、增加</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v8"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v8">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v8"><a class="header-anchor" href="#步骤-2-模仿和排错-v8">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-准备增加的页面-addHero-html"><a class="header-anchor" href="#步骤-3-准备增加的页面-addHero-html">¶</a>步骤 3 : 准备增加的页面 addHero.html</h4>
<p>在web目录下增加addHero.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>表示用UTF-8显示中文，同时浏览器也会使用UTF-8编码提交中文</p>
<p>form:<br>
action设置为addHero路径<br>
method设置为post 也是为了提交中文</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1622.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"addHero"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">     名字 ： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">血量 ： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"hp"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">伤害： <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"damage"</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"增加 "</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-编写-HeroAddServlet"><a class="header-anchor" href="#步骤-4-编写-HeroAddServlet">¶</a>步骤 4 : 编写 HeroAddServlet</h4>
<p>HeroAddServlet 中根据浏览器传过来的参数，创建一个Hero对象。 接着通过HeroDAO把该对象保存到数据库中。<br>
最后使用客户端跳转到listHero查看所有的Hero，就能看到新加入的Hero对象了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br></pre></td></tr></table></figure>
<p>表示使用UTF-8的方式获取浏览器传过来的中文</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1623.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> bean.Hero;</span><br><span class="line"><span class="keyword">import</span> dao.HeroDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroAddServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line"> </span><br><span class="line">        Hero hero = <span class="keyword">new</span> Hero();</span><br><span class="line">        hero.setName(request.getParameter(<span class="string">"name"</span>));</span><br><span class="line">        hero.setHp(Float.parseFloat(request.getParameter(<span class="string">"hp"</span>)));</span><br><span class="line">        hero.setDamage(Integer.parseInt(request.getParameter(<span class="string">"damage"</span>)));</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">new</span> HeroDAO().add(hero);</span><br><span class="line"> </span><br><span class="line">        response.sendRedirect(<span class="string">"/listHero"</span>);</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-配置web-xml-v2"><a class="header-anchor" href="#步骤-5-配置web-xml-v2">¶</a>步骤 5 : 配置web.xml</h4>
<p>在web.xml中设置路径addHero对应HeroAddServlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/register<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroListServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/listHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/addHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试"><a class="header-anchor" href="#步骤-6-测试">¶</a>步骤 6 : 测试</h4>
<p>重启tomcat,访问增加页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1/addHero.html</span></span><br></pre></td></tr></table></figure>
<p>提交数据，接着客户端跳转到/listHero，就可以显示新增加的这条数据了</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3036.png" alt></p>
<h3 id="3、删除"><a class="header-anchor" href="#3、删除">¶</a>3、删除</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v9"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v9">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v9"><a class="header-anchor" href="#步骤-2-模仿和排错-v9">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-提供delete超链"><a class="header-anchor" href="#步骤-3-提供delete超链">¶</a>步骤 3 : 提供delete超链</h4>
<p>修改HeroLIstServlet，多一个单元格，是一个超链</p>
<p>超链的href属性指向地址 /deleteHero?id=217(每条不同的记录id不一样)</p>
<p>可以在左下角的浏览器状态栏里看到</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1626.png" alt></p>
<h4 id="步骤-4-修改HeroListServlet"><a class="header-anchor" href="#步骤-4-修改HeroListServlet">¶</a>步骤 4 : 修改HeroListServlet</h4>
<p>为table新增加一列delete,对于每条hero数据，增加一个delete超链</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> bean.Hero;</span><br><span class="line"><span class="keyword">import</span> dao.HeroDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroListServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">         </span><br><span class="line">        List&lt;Hero&gt; heros = <span class="keyword">new</span> HeroDAO().list();</span><br><span class="line"> </span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        sb.append(<span class="string">"&lt;table align='center' border='1' cellspacing='0'&gt;\r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;name&lt;/td&gt;&lt;td&gt;hp&lt;/td&gt;&lt;td&gt;damage&lt;/td&gt;&lt;td&gt;delete&lt;/td&gt;&lt;/tr&gt;\r\n"</span>);</span><br><span class="line"> </span><br><span class="line">        String trFormat = <span class="string">"&lt;tr&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%f&lt;/td&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;&lt;a href='deleteHero?id=%d'&gt;delete&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\r\n"</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (Hero hero : heros) &#123;</span><br><span class="line">            String tr = String.format(trFormat, hero.getId(), hero.getName(), hero.getHp(), hero.getDamage(),hero.getId());</span><br><span class="line">            sb.append(tr);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        sb.append(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line"> </span><br><span class="line">        response.getWriter().write(sb.toString());</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-配置web-xml-v3"><a class="header-anchor" href="#步骤-5-配置web-xml-v3">¶</a>步骤 5 : 配置web.xml</h4>
<p>配置web.xml 把/deleteHero指向 HeroDeleteServlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/register<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroListServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/listHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/addHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/deleteHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-编写HeroDeleteServlet"><a class="header-anchor" href="#步骤-6-编写HeroDeleteServlet">¶</a>步骤 6 : 编写HeroDeleteServlet</h4>
<p>首先获取参数id<br>
然后通过HeroDAO根据id，删除该对象<br>
然后客户端跳转到 /listHero</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> dao.HeroDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroDeleteServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">new</span> HeroDAO().delete(id);</span><br><span class="line"> </span><br><span class="line">        response.sendRedirect(<span class="string">"/listHero"</span>);</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试"><a class="header-anchor" href="#步骤-7-测试">¶</a>步骤 7 : 测试</h4>
<p>重启tomcat,首先访问查询页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1/listHero</span></span><br></pre></td></tr></table></figure>
<p>然后点击删除，可以观察到某条数据被删除了</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/3037.png" alt></p>
<h3 id="4、编辑"><a class="header-anchor" href="#4、编辑">¶</a>4、编辑</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v10"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v10">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v10"><a class="header-anchor" href="#步骤-2-模仿和排错-v10">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-修改HeroListServlet"><a class="header-anchor" href="#步骤-3-修改HeroListServlet">¶</a>步骤 3 : 修改HeroListServlet</h4>
<p>新增加一列 edit，里面放上指向 /editHero的超链</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1628.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> bean.Hero;</span><br><span class="line"><span class="keyword">import</span> dao.HeroDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroListServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">         </span><br><span class="line">        List&lt;Hero&gt; heros = <span class="keyword">new</span> HeroDAO().list();</span><br><span class="line"> </span><br><span class="line">        StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        sb.append(<span class="string">"&lt;table align='center' border='1' cellspacing='0'&gt;\r\n"</span>);</span><br><span class="line">        sb.append(<span class="string">"&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;name&lt;/td&gt;&lt;td&gt;hp&lt;/td&gt;&lt;td&gt;damage&lt;/td&gt;&lt;td&gt;edit&lt;/td&gt;&lt;td&gt;delete&lt;/td&gt;&lt;/tr&gt;\r\n"</span>);</span><br><span class="line"> </span><br><span class="line">        String trFormat = <span class="string">"&lt;tr&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%f&lt;/td&gt;&lt;td&gt;%d&lt;/td&gt;&lt;td&gt;&lt;a href='editHero?id=%d'&gt;edit&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&lt;a href='deleteHero?id=%d'&gt;delete&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\r\n"</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (Hero hero : heros) &#123;</span><br><span class="line">            String tr = String.format(trFormat, hero.getId(), hero.getName(), hero.getHp(), hero.getDamage(),hero.getId(),hero.getId());</span><br><span class="line">             </span><br><span class="line">            sb.append(tr);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        sb.append(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line"> </span><br><span class="line">        response.getWriter().write(sb.toString());</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-配置web-xml"><a class="header-anchor" href="#步骤-4-配置web-xml">¶</a>步骤 4 : 配置web.xml</h4>
<p>在web.xml中把 /editHero路径映射到 HeroEditServlet类上</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/register<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroListServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/listHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/addHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/deleteHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroEditServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroEditServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroEditServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/editHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-准备HeroEditServlet"><a class="header-anchor" href="#步骤-5-准备HeroEditServlet">¶</a>步骤 5 : 准备HeroEditServlet</h4>
<p>HeroEditServlet 根据浏览器传过来的id获取一个hero对象</p>
<p>然后根据这个hero对象，准备一个类似add.html的页面，不同之处在于每个输入框都是有值的。</p>
<p>最后还会提供一个type=&quot;hidden&quot;的input,用于提交id到路径/updateHero</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/1629.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> bean.Hero;</span><br><span class="line"><span class="keyword">import</span> dao.HeroDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroEditServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line"> </span><br><span class="line">        Hero hero = <span class="keyword">new</span> HeroDAO().get(id);</span><br><span class="line"> </span><br><span class="line">        StringBuffer format = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line"> </span><br><span class="line">        format.append(<span class="string">"&lt;!DOCTYPE html&gt;"</span>);</span><br><span class="line"> </span><br><span class="line">        format.append(<span class="string">"&lt;form action='updateHero' method='post'&gt;"</span>);</span><br><span class="line">        format.append(<span class="string">"名字 ： &lt;input type='text' name='name' value='%s' &gt; &lt;br&gt;"</span>);</span><br><span class="line">        format.append(<span class="string">"血量 ： &lt;input type='text' name='hp'  value='%f' &gt; &lt;br&gt;"</span>);</span><br><span class="line">        format.append(<span class="string">"伤害： &lt;input type='text' name='damage'  value='%d' &gt; &lt;br&gt;"</span>);</span><br><span class="line">        format.append(<span class="string">"&lt;input type='hidden' name='id' value='%d'&gt;"</span>);</span><br><span class="line">        format.append(<span class="string">"&lt;input type='submit' value='更新'&gt;"</span>);</span><br><span class="line">        format.append(<span class="string">"&lt;/form&gt;"</span>);</span><br><span class="line"> </span><br><span class="line">        String html = String.format(format.toString(), hero.getName(), hero.getHp(), hero.getDamage(), hero.getId());</span><br><span class="line"> </span><br><span class="line">        response.getWriter().write(html);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、更新"><a class="header-anchor" href="#5、更新">¶</a>5、更新</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v11"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v11">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v11"><a class="header-anchor" href="#步骤-2-模仿和排错-v11">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-编写-HeroUpdateServlet"><a class="header-anchor" href="#步骤-3-编写-HeroUpdateServlet">¶</a>步骤 3 : 编写 HeroUpdateServlet</h4>
<p>HeroUpdateServlet<br>
根据浏览器提交的id name hp damage创建一个Hero对象<br>
然后调用HeroDAO的update，进行更新</p>
<p>更新结束后，客户端跳转到 /listHero</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> bean.Hero;</span><br><span class="line"><span class="keyword">import</span> dao.HeroDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroUpdateServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line"> </span><br><span class="line">        Hero hero = <span class="keyword">new</span> Hero();</span><br><span class="line">        hero.setId(Integer.parseInt(request.getParameter(<span class="string">"id"</span>)));</span><br><span class="line">        hero.setName(request.getParameter(<span class="string">"name"</span>));</span><br><span class="line">        hero.setHp(Float.parseFloat(request.getParameter(<span class="string">"hp"</span>)));</span><br><span class="line">        hero.setDamage(Integer.parseInt(request.getParameter(<span class="string">"damage"</span>)));</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">new</span> HeroDAO().update(hero);</span><br><span class="line"> </span><br><span class="line">        response.sendRedirect(<span class="string">"/listHero"</span>);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-配置web-xml-v2"><a class="header-anchor" href="#步骤-4-配置web-xml-v2">¶</a>步骤 4 : 配置web.xml</h4>
<p>新增对路径 /updateHero的映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>10<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>LoginServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>RegisterServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/register<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroListServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/listHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroAddServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/addHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroDeleteServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/deleteHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroEditServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroEditServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroEditServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/editHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroUpdateServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>servlet.HeroUpdateServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HeroUpdateServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/updateHero<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="6、弊端"><a class="header-anchor" href="#6、弊端">¶</a>6、弊端</h3>
<h4 id="步骤-1-使用Servlet进行CRUD开发的弊端"><a class="header-anchor" href="#步骤-1-使用Servlet进行CRUD开发的弊端">¶</a>步骤 1 : 使用Servlet进行CRUD开发的弊端</h4>
<p>用到这里，大家对使用Servlet进行CRUD开发就有比较全面感性认识了。 其中一个比较明显的弊端就是在Servlet编写html代码很痛苦，效率不高，可读性差，难以维护。</p>
<p>最好可以在html文件里面写html代码，同时又能在里面调用java的变量，那么这样就需要学习[JSP]了。</p>
<h2 id="四、JSON"><a class="header-anchor" href="#四、JSON">¶</a>四、JSON</h2>
<h3 id="1、提交数据"><a class="header-anchor" href="#1、提交数据">¶</a>1、提交数据</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v12"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v12">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v12"><a class="header-anchor" href="#步骤-2-模仿和排错-v12">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v2"><a class="header-anchor" href="#步骤-3-效果-v2">¶</a>步骤 3 : 效果</h4>
<p>访问地址，提交数据</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/submit.html</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5537.png" alt></p>
<h4 id="步骤-4-资源"><a class="header-anchor" href="#步骤-4-资源">¶</a>步骤 4 : 资源</h4>
<p>要运行起来需要jquery.min.js，各种jar包，都在右上角的j2ee.rar中提供，请自行下载解压获取。</p>
<h4 id="步骤-5-submit-html"><a class="header-anchor" href="#步骤-5-submit-html">¶</a>步骤 5 : submit.html</h4>
<p>点击提交之后，把form中的数据取出来，组织成json的格式，用ajax发送出去。<br>
这里用的ajax方式是 jquery的post函数, 请参考：[使用post方式提交ajax]</p>
<p>JSON.stringify函数的作用是将一个javascript对象，转换为JSON格式的字符串。</p>
<p>提交之后，将会看到如图所示的对话框</p>
<p>这里还用到了jquery.min.js，请在右上角下载</p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5538.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式提交数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> &gt;</span> </span><br><span class="line">       名称：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span> </span><br><span class="line">        血量：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"hp"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> name=<span class="built_in">document</span>.getElementById(<span class="string">'name'</span>).value; </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> hp=<span class="built_in">document</span>.getElementById(<span class="string">'hp'</span>).value; </span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> hero=&#123;<span class="string">"name"</span>:name,<span class="string">"hp"</span>:hp&#125;; </span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> url=<span class="string">"submitServlet"</span>; </span></span><br><span class="line">           </span><br><span class="line"><span class="javascript">        $.post(</span></span><br><span class="line">                url,</span><br><span class="line"><span class="javascript">                &#123;<span class="string">"data"</span>:<span class="built_in">JSON</span>.stringify(hero)&#125;,</span></span><br><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>&#123; </span></span><br><span class="line"><span class="actionscript">                     alert(<span class="string">"提交成功，请在Tomcat控制台查看服务端接收到的数据"</span>);</span></span><br><span class="line">         &#125;);  </span><br><span class="line"> </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-SubmitServlet"><a class="header-anchor" href="#步骤-6-SubmitServlet">¶</a>步骤 6 : SubmitServlet</h4>
<ol>
<li>获取浏览器提交的字符串</li>
<li>把字符串转换为JSON对象</li>
<li>把JSON对象转换为Hero对象</li>
</ol>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5539.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Hero.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hero</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> hp;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHp</span><span class="params">(<span class="keyword">int</span> hp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hp = hp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hero [name="</span> + name + <span class="string">", hp="</span> + hp + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubmitServlet.java</span></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> net.sf.json.JSONObject; </span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubmitServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String data =request.getParameter(<span class="string">"data"</span>);</span><br><span class="line">         </span><br><span class="line">        System.out.println(<span class="string">"服务端接收到的数据是："</span> +data);</span><br><span class="line">  </span><br><span class="line">        JSONObject json=JSONObject.fromObject(data); </span><br><span class="line">          </span><br><span class="line">        System.out.println(<span class="string">"转换为JSON对象之后是："</span>+ json);</span><br><span class="line">           </span><br><span class="line">        Hero hero = (Hero)JSONObject.toBean(json,Hero<span class="class">.<span class="keyword">class</span>)</span>; </span><br><span class="line">        System.out.println(<span class="string">"转换为Hero对象之后是："</span>+hero);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-web-xml"><a class="header-anchor" href="#步骤-7-web-xml">¶</a>步骤 7 : web.xml</h4>
<p>配置映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/submitServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试"><a class="header-anchor" href="#步骤-8-测试">¶</a>步骤 8 : 测试</h4>
<p>重启tomcat，访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/submit.html</span></span><br></pre></td></tr></table></figure>
<h3 id="2、获取一个对象"><a class="header-anchor" href="#2、获取一个对象">¶</a>2、获取一个对象</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v13"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v13">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v13"><a class="header-anchor" href="#步骤-2-模仿和排错-v13">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v3"><a class="header-anchor" href="#步骤-3-效果-v3">¶</a>步骤 3 : 效果</h4>
<p>访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/getOne.html</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5544.png" alt></p>
<h4 id="步骤-4-资源-v2"><a class="header-anchor" href="#步骤-4-资源-v2">¶</a>步骤 4 : 资源</h4>
<p>要运行起来需要jquery.min.js，各种jar包，都在右上角的j2ee.rar中提供，请自行下载解压获取。</p>
<h4 id="步骤-5-GetOneServlet"><a class="header-anchor" href="#步骤-5-GetOneServlet">¶</a>步骤 5 : GetOneServlet</h4>
<ol>
<li>创建一个Hero对象</li>
<li>创建一个JSONObject 对象</li>
<li>把Hero对象转换为JSONObject 对象，并放在上一个JSONObject对象上，key是&quot;hero&quot;</li>
<li>设置编码方式为UTF-8</li>
<li>通过response返回</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.Writer;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> net.sf.json.JSONObject; </span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetOneServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">          </span><br><span class="line">        Hero hero = <span class="keyword">new</span> Hero();</span><br><span class="line">        hero.setName(<span class="string">"盖伦"</span>);</span><br><span class="line">        hero.setHp(<span class="number">353</span>);</span><br><span class="line">         </span><br><span class="line">        JSONObject json= <span class="keyword">new</span> JSONObject();</span><br><span class="line">   </span><br><span class="line">        json.put(<span class="string">"hero"</span>, JSONObject.fromObject(hero));</span><br><span class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>); </span><br><span class="line">        response.getWriter().print(json);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-web-xml"><a class="header-anchor" href="#步骤-6-web-xml">¶</a>步骤 6 : web.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/submitServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetOneServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>GetOneServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetOneServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/getOneServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-getOne-html"><a class="header-anchor" href="#步骤-7-getOne-html">¶</a>步骤 7 : getOne.html</h4>
<ol>
<li>点击按钮之后，通过ajax访问getOneServlet</li>
<li>获取都数据后，通过JSON.parse 转换为json对象</li>
<li>获取name和hp</li>
<li>显示在div里</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式获取数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"通过AJAX获取一个Hero对象"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span>  </span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> url=<span class="string">"getOneServlet"</span>; </span></span><br><span class="line"><span class="javascript">        $.post(</span></span><br><span class="line">                url,</span><br><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                     <span class="keyword">var</span> json=<span class="built_in">JSON</span>.parse(data); </span></span><br><span class="line"><span class="actionscript">                     <span class="keyword">var</span> name =json.hero.name; </span></span><br><span class="line"><span class="actionscript">                     <span class="keyword">var</span> hp = json.hero.hp;</span></span><br><span class="line"><span class="javascript">                     $(<span class="string">"#messageDiv"</span>).html(<span class="string">"英雄名称："</span>+name + <span class="string">"&lt;br&gt;英雄血量:"</span> +hp );</span></span><br><span class="line">                      </span><br><span class="line">         &#125;);  </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试-v2"><a class="header-anchor" href="#步骤-8-测试-v2">¶</a>步骤 8 : 测试</h4>
<p>重启Tomcat,访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/getOne.html</span></span><br></pre></td></tr></table></figure>
<h3 id="3、获取多个对象"><a class="header-anchor" href="#3、获取多个对象">¶</a>3、获取多个对象</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v14"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v14">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v14"><a class="header-anchor" href="#步骤-2-模仿和排错-v14">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v4"><a class="header-anchor" href="#步骤-3-效果-v4">¶</a>步骤 3 : 效果</h4>
<p>访问地址：<br>
<a href="http://127.0.0.1:8080/getMany.html" target="_blank" rel="noopener">http://127.0.0.1:8080/getMany.html</a></p>
<p><img src="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/5551.png" alt></p>
<h4 id="步骤-4-资源-v3"><a class="header-anchor" href="#步骤-4-资源-v3">¶</a>步骤 4 : 资源</h4>
<p>要运行起来需要jquery.min.js，各种jar包，都在右上角的j2ee.rar中提供，请自行下载解压获取。</p>
<h4 id="步骤-5-GetManyServlet"><a class="header-anchor" href="#步骤-5-GetManyServlet">¶</a>步骤 5 : GetManyServlet</h4>
<ol>
<li>准备一个集合</li>
<li>向集合中放入 10个Hero对象</li>
<li>通过JSONSerializer.toJSON(heros)把集合转换为JSON字符串</li>
<li>返回给浏览器</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> net.sf.json.JSONSerializer; </span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetManyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        List&lt;Hero&gt; heros = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            Hero hero = <span class="keyword">new</span> Hero();</span><br><span class="line">            hero.setName(<span class="string">"name"</span>+i);</span><br><span class="line">            hero.setHp(<span class="number">500</span>+i);</span><br><span class="line">            heros.add(hero);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        String result =JSONSerializer.toJSON(heros).toString();</span><br><span class="line"> </span><br><span class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>); </span><br><span class="line">        response.getWriter().print(result);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;Hero&gt; heros = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            Hero hero = <span class="keyword">new</span> Hero();</span><br><span class="line">            hero.setName(<span class="string">"name"</span>+i);</span><br><span class="line">            hero.setHp(<span class="number">500</span>+i);</span><br><span class="line">            heros.add(hero);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        System.out.println(JSONSerializer.toJSON(heros).toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-web-xml-v2"><a class="header-anchor" href="#步骤-6-web-xml-v2">¶</a>步骤 6 : web.xml</h4>
<p>配置映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SubmitServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/submitServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetOneServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>GetOneServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetOneServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/getOneServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetManyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>GetManyServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetManyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/getManyServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-getMany-html"><a class="header-anchor" href="#步骤-7-getMany-html">¶</a>步骤 7 : getMany.html</h4>
<ol>
<li>通过ajax访问getManyServlet</li>
<li>把返回的数据，通过 $.parseJSON 转换为json数组</li>
<li>遍历数组，显示在div中</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式获取数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"通过AJAX获取多个Hero对象"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span>  </span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> url=<span class="string">"getManyServlet"</span>; </span></span><br><span class="line"><span class="javascript">        $.post(</span></span><br><span class="line">                url,</span><br><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">var</span> heros = $.parseJSON(data);</span></span><br><span class="line">                     for(i in heros)&#123;</span><br><span class="line"><span class="javascript">                         <span class="keyword">var</span> old = $(<span class="string">"#messageDiv"</span>).html();</span></span><br><span class="line"><span class="actionscript">                         <span class="keyword">var</span> hero = heros[i];</span></span><br><span class="line"><span class="javascript">                         $(<span class="string">"#messageDiv"</span>).html(old + <span class="string">"&lt;br&gt;"</span>+hero.name+<span class="string">"   -----   "</span>+hero.hp); </span></span><br><span class="line">                     &#125;</span><br><span class="line">         &#125;);  </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试-v3"><a class="header-anchor" href="#步骤-8-测试-v3">¶</a>步骤 8 : 测试</h4>
<p>重启tomcat，并测试</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/getMany.html</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    <div>
     
         <div>
 
  <div style="text-align:center;color:#bfbfbf;font-size:16px;">
   <span>-------- 本文结束 </span>
   <i class="fa fa-paw"></i>
   <span> 感谢阅读 --------</span>
  </div>
 
</div>
     
    </div>

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="潇 卟 甸 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="潇 卟 甸 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <!-- JS库 clipboard 拷贝内容到粘贴板-->
<script src="https://cdn.bootcss.com/clipboard.js/2.0.1/clipboard.min.js"></script>

<!-- JS库 sweetalert 显示提示信息-->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<ul class="post-copyright">
<!-- 本文标题 -->
<li>
  <strong>本文标题： </strong>
  J2EE【HOW2J】
</li>

<!-- 本文作者 -->
<li class="post-copyright-author">
  <strong>本文作者： </strong>
  
</li>

<!-- 创建时间 -->
<li>
  <strong>创建时间： </strong>
  2020年08月21日 - 09时08分
</li>

<!-- 修改时间 -->
<li>
  <strong>修改时间： </strong>
  2020年08月24日 - 17时08分
</li>

<!-- 引用链接 -->
<li class="post-copyright-link">
  <strong>本文链接：</strong>
  <a href="http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/" title="J2EE【HOW2J】"
    >http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/</a
  >
  <span class="copy-path" title="点击复制引用链接"
    ><i
      style="cursor: pointer"
      class="fa fa-clipboard"
      data-clipboard-text="['s Blog | J2EE【HOW2J】](http://yoursite.com/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/)"
      aria-label="复制成功"
    ></i
  ></span>
</li>

<!-- 版权声明 -->
<li class="post-copyright-license">
  <strong
    >版权声明：
  </strong>
  本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
</li>
</ul>

<script>
var clipboard = new ClipboardJS(".fa-clipboard");
clipboard.on("success", function(target) {
  var message = document.createElement("div");
  message.innerHTML =
    '<i class="fa fa-check-circle message-icon"></i><span class="message-content">' +
    target.trigger.getAttribute("aria-label") +
    "</span>";
  swal({
    content: message,
    className: "copy-success-message",
    timer: 1000,
    button: false
  });
});
</script>
      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
          
            <a href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag"><i class="fa fa-tag"></i> 编程</a>
          
            <a href="/tags/%E6%BA%90%E4%BB%A3%E7%A0%81/" rel="tag"><i class="fa fa-tag"></i> 源代码</a>
          
            <a href="/tags/Java%E5%AE%9E%E8%B7%B5/" rel="tag"><i class="fa fa-tag"></i> Java实践</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/07/27/%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86%E3%80%90HOW2J%E3%80%91/" rel="next" title="前端部分【HOW2J】">
                <i class="fa fa-chevron-left"></i> 前端部分【HOW2J】
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <a href="/">
              <img class="site-author-image" itemprop="image"
                src="/uploads/picture.jpg"
                alt="潇 卟 甸" />
              </a>
            
              <p class="site-author-name" itemprop="name">潇 卟 甸</p>
              <p class="site-description motion-element" itemprop="description">总结自己一些知识，一些事</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">44</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

			
				<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
				<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
				<div class="widget-wrap">
					<div id="myCanvasContainer" class="widget tagcloud">
						<canvas width="250" height="250" id="resCanvas" style="width=100%">
							<ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%AE%9E%E8%B7%B5/" rel="tag">Java实践</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/b%E7%AB%99%E8%A7%86%E9%A2%91/" rel="tag">b站视频</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E7%BA%A7/" rel="tag">中级</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%96%9C%E9%A9%AC%E6%8B%89%E9%9B%85/" rel="tag">喜马拉雅</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80/" rel="tag">基础</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E8%AF%AD/" rel="tag">日语</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E4%BB%A3%E7%A0%81/" rel="tag">源代码</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%B5%E5%AD%90%E4%B9%A6/" rel="tag">电子书</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a><span class="tag-list-count">32</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BE%8E%E5%8C%96/" rel="tag">美化</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%B1%E8%AF%AD/" rel="tag">英语</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" rel="tag">计算机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E6%8E%A8%E8%8D%90/" rel="tag">读书推荐</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E9%98%B6/" rel="tag">进阶</a><span class="tag-list-count">3</span></li></ul>
						</canvas>
					</div>
				</div>
			

          </nav>

          

          
		  
		  <!-- 添加近期文章 -->
			
				<div class="links-of-blogroll motion-element links-of-blogroll-block">
				<div class="links-of-blogroll-title">
				<!-- modify icon to fire by szw -->
				<i class="fa fa-history fa-" aria-hidden="true"></i>
				近期文章
				</div>
				<ul class="links-of-blogroll-list">
				
				
					<li>
					<a href="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/" title="J2EE【HOW2J】" target="_blank">J2EE【HOW2J】</a>
					</li>
				
					<li>
					<a href="/2020/07/27/%E5%89%8D%E7%AB%AF%E9%83%A8%E5%88%86%E3%80%90HOW2J%E3%80%91/" title="前端部分【HOW2J】" target="_blank">前端部分【HOW2J】</a>
					</li>
				
					<li>
					<a href="/2020/07/25/%E5%96%9C%E9%A9%AC%E7%B2%BE%E8%AF%BB%E4%B8%96%E7%95%8C%E5%90%8D%E8%91%97%E7%AC%94%E8%AE%B0%E3%80%90%E9%99%84%E7%94%B5%E5%AD%90%E4%B9%A6%E3%80%91%EF%BC%88%E4%BA%8C%EF%BC%89/" title="喜马精读世界名著笔记【附电子书】（二）" target="_blank">喜马精读世界名著笔记【附电子书】（二）</a>
					</li>
				
					<li>
					<a href="/2020/07/24/10%E5%88%86%E9%92%9F%E9%80%9F%E6%88%90%E8%AF%BE%EF%BC%9A%E5%93%B2%E5%AD%A6/" title="10分钟速成课：哲学" target="_blank">10分钟速成课：哲学</a>
					</li>
				
					<li>
					<a href="/2020/07/23/%E5%96%9C%E9%A9%AC%E7%B2%BE%E8%AF%BB%E4%B8%96%E7%95%8C%E5%90%8D%E8%91%97%E7%AC%94%E8%AE%B0%E3%80%90%E9%99%84%E7%94%B5%E5%AD%90%E4%B9%A6%E3%80%91%EF%BC%88%E4%B8%80%EF%BC%89/" title="喜马精读世界名著笔记【附电子书】（一）" target="_blank">喜马精读世界名著笔记【附电子书】（一）</a>
					</li>
				
				</ul>
			</div>
			

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐阅读
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://sushan102.top/posts/1410804403/" title="博客搭建" target="_blank">博客搭建</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://how2j.cn?p=154642" title="HOW2J" target="_blank">HOW2J</a>
                  </li>
                
              </ul>
            </div>
          
		  
		  
			
		  
		  <div style="">
  <canvas id="canvas" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();
</script>


        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#壹、Tomcat"><span class="nav-text">壹、Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、基础"><span class="nav-text">一、基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、Hello-Tomcat"><span class="nav-text">1、Hello Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-不使用tomcat访问html"><span class="nav-text">步骤 1 : 不使用tomcat访问html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-使用tomcat后，访问html"><span class="nav-text">步骤 2 : 使用tomcat后，访问html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-如何启动tomcat"><span class="nav-text">步骤 3 : 如何启动tomcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-如何部署网页"><span class="nav-text">步骤 4 : 如何部署网页</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-8080是什么鬼？"><span class="nav-text">步骤 5 : 8080是什么鬼？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、改端口"><span class="nav-text">2、改端口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-server-xml"><span class="nav-text">步骤 1 : server.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-80端口"><span class="nav-text">步骤 2 : 80端口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-80端口被占用"><span class="nav-text">步骤 3 : 80端口被占用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、问题排查"><span class="nav-text">3、问题排查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-JAVA-HOME"><span class="nav-text">步骤 1 : JAVA_HOME</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-CATALINA-HOME未设置"><span class="nav-text">步骤 2 : CATALINA_HOME未设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-CATALINA-HOME错误设置"><span class="nav-text">步骤 3 : CATALINA_HOME错误设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-端口冲突"><span class="nav-text">步骤 4 : 端口冲突</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-localhost-yyyy-mm-dd-log"><span class="nav-text">步骤 5 : localhost.yyyy-mm-dd.log</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-Error-FilterStart"><span class="nav-text">步骤 6 : Error FilterStart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-JDK版本"><span class="nav-text">步骤 7 : JDK版本</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、-404问题排查"><span class="nav-text">4、 404问题排查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-404问题"><span class="nav-text">步骤 1 : 404问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-正确的端口号"><span class="nav-text">步骤 2 : 正确的端口号</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-环境变量"><span class="nav-text">步骤 3 : 环境变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-确定Web应用是否成功启动"><span class="nav-text">步骤 4 : 确定Web应用是否成功启动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-webapps下的ROOT目录"><span class="nav-text">步骤 5 : webapps下的ROOT目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-访问地址的时候是否加了web应用的名称"><span class="nav-text">步骤 6 : 访问地址的时候是否加了web应用的名称</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-是否访问对资源了"><span class="nav-text">步骤 7 : 是否访问对资源了</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-不能访问WEB-INF目录下的资源"><span class="nav-text">步骤 8 : 不能访问WEB-INF目录下的资源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-访问地址后面多加了一个斜杠"><span class="nav-text">步骤 9 : 访问地址后面多加了一个斜杠</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、端口被占用"><span class="nav-text">5、端口被占用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-查看80端口被哪些程序占用了"><span class="nav-text">步骤 1 : 查看80端口被哪些程序占用了</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-根据pid（进程id）-查询对应的应用程序"><span class="nav-text">步骤 2 : 根据pid（进程id） 查询对应的应用程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-根据名称-结束该程序"><span class="nav-text">步骤 3 : 根据名称 结束该程序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、持久化异常"><span class="nav-text">6、持久化异常</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-启动报错"><span class="nav-text">步骤 1 : 启动报错</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、纯净版-TOMCAT"><span class="nav-text">7、纯净版 TOMCAT</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-80端口的，纯净版tomcat"><span class="nav-text">步骤 1 : 80端口的，纯净版tomcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-8080端口的，纯净版tomcat"><span class="nav-text">步骤 2 : 8080端口的，纯净版tomcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-注意"><span class="nav-text">步骤 3 : 注意</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、部署"><span class="nav-text">8、部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-本知识点目的"><span class="nav-text">步骤 1 : 本知识点目的</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-下载"><span class="nav-text">步骤 2 : 下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-测试端口"><span class="nav-text">步骤 3 : 测试端口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-成功启动截图"><span class="nav-text">步骤 4 : 成功启动截图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-下载一个J2EE应用"><span class="nav-text">步骤 5 : 下载一个J2EE应用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-部署"><span class="nav-text">步骤 6 : 部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-重启tomcat-并测试"><span class="nav-text">步骤 7 : 重启tomcat,并测试</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#贰、Servlet"><span class="nav-text">贰、Servlet</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、基础-v2"><span class="nav-text">一、基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、开发第一个SERVLET"><span class="nav-text">1、开发第一个SERVLET</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建一个java项目j2ee"><span class="nav-text">步骤 3 : 创建一个java项目j2ee</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-导入必须的servlet-api-jar包"><span class="nav-text">步骤 4 : 导入必须的servlet-api.jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-编写HelloServlet"><span class="nav-text">步骤 5 : 编写HelloServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-配置web-xml"><span class="nav-text">步骤 6 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-指定项目输出到classes目录"><span class="nav-text">步骤 7 : 指定项目输出到classes目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-配置tomcat的server-xml-中的-context"><span class="nav-text">步骤 8 : 配置tomcat的server.xml 中的&lt;context&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-删除tomcat-webapps下的ROOT目录"><span class="nav-text">步骤 9 : 删除tomcat webapps下的ROOT目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-重启tomcat，访问http-127-0-0-1-hello"><span class="nav-text">步骤 10 : 重启tomcat，访问http:&#x2F;&#x2F;127.0.0.1&#x2F;hello</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-完整项目"><span class="nav-text">步骤 11 : 完整项目</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、获取参数"><span class="nav-text">2、获取参数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v2"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v2"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建-login-html"><span class="nav-text">步骤 3 : 创建 login.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-创建-LoginServlet"><span class="nav-text">步骤 4 : 创建 LoginServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-映射LoginServlet到路径login"><span class="nav-text">步骤 5 : 映射LoginServlet到路径login</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-在页面提交数据"><span class="nav-text">步骤 6 : 在页面提交数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、返回响应"><span class="nav-text">3、返回响应</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v3"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v3"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-LoginServlet"><span class="nav-text">步骤 3 : LoginServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-重启tomcat，提交数据"><span class="nav-text">步骤 4 : 重启tomcat，提交数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、调用流程"><span class="nav-text">4、调用流程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-流程图"><span class="nav-text">步骤 1 : 流程图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-login-html"><span class="nav-text">步骤 2 : login.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-login路径"><span class="nav-text">步骤 3 : &#x2F;login路径</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-找到对应的Servlet"><span class="nav-text">步骤 4 : 找到对应的Servlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-实例化Servlet对象"><span class="nav-text">步骤 5 : 实例化Servlet对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-调用doGet或者doPost"><span class="nav-text">步骤 6 : 调用doGet或者doPost</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-request获取参数"><span class="nav-text">步骤 7 : request获取参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-response设置响应"><span class="nav-text">步骤 8 : response设置响应</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-tomcat把html传递给浏览器"><span class="nav-text">步骤 9 : tomcat把html传递给浏览器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、service"><span class="nav-text">5、service()</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-doGet"><span class="nav-text">步骤 1 : doGet()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-doPost"><span class="nav-text">步骤 2 : doPost()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-service"><span class="nav-text">步骤 3 : service()</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、中文问题"><span class="nav-text">6、中文问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-1-获取中文的参数"><span class="nav-text">示例 1 : 获取中文的参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-2-返回中文的响应"><span class="nav-text">示例 2 : 返回中文的响应</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、生命周期"><span class="nav-text">7、生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-生命周期"><span class="nav-text">步骤 1 : 生命周期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-实例化"><span class="nav-text">步骤 2 : 实例化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-初始化"><span class="nav-text">步骤 3 : 初始化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-提供服务"><span class="nav-text">步骤 4 : 提供服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-销毁"><span class="nav-text">步骤 5 : 销毁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-被回收"><span class="nav-text">步骤 6 : 被回收</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、跳转"><span class="nav-text">8、跳转</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-首先准备两个页面-success-html-fail-html"><span class="nav-text">步骤 1 : 首先准备两个页面 success.html fail.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-服务端跳转"><span class="nav-text">步骤 2 : 服务端跳转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-客户端跳转"><span class="nav-text">步骤 3 : 客户端跳转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-服务端跳转与客户端跳转图示"><span class="nav-text">步骤 4 : 服务端跳转与客户端跳转图示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、自启动"><span class="nav-text">9、自启动</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v4"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v4"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-load-on-startup"><span class="nav-text">步骤 3 : load-on-startup</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、request常见用法"><span class="nav-text">10、request常见用法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-1-先运行，看到效果，再学习"><span class="nav-text">示例 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-2-模仿和排错"><span class="nav-text">示例 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-3-request的常见方法"><span class="nav-text">示例 3 : request的常见方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-4-获取参数"><span class="nav-text">示例 4 : 获取参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-5-获取头信息"><span class="nav-text">示例 5 : 获取头信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-6-服务端传参"><span class="nav-text">示例 6 : 服务端传参</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11、response-用法"><span class="nav-text">11、response 用法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-1-设置响应内容"><span class="nav-text">示例 1 : 设置响应内容</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-2-设置响应格式"><span class="nav-text">示例 2 : 设置响应格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-3-设置响应编码"><span class="nav-text">示例 3 : 设置响应编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-4-301或者302客户端跳转"><span class="nav-text">示例 4 : 301或者302客户端跳转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-5-设置不使用缓存"><span class="nav-text">示例 5 : 设置不使用缓存</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12、上传文件"><span class="nav-text">12、上传文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v5"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v5"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-首先准备上传页面-upload-html"><span class="nav-text">步骤 3 : 首先准备上传页面 upload.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-接着准备-UploadPhotoServlet"><span class="nav-text">步骤 4 : 接着准备 UploadPhotoServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-配置web-xml"><span class="nav-text">步骤 5 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-复制jar包"><span class="nav-text">步骤 6 : 复制jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-在项目中导入jar包"><span class="nav-text">步骤 7 : 在项目中导入jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-上传测试"><span class="nav-text">步骤 8 : 上传测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-如何处理其他非File字段"><span class="nav-text">步骤 9 : 如何处理其他非File字段</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、动态Web项目"><span class="nav-text">二、动态Web项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、创建"><span class="nav-text">1、创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v6"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v6"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-说明"><span class="nav-text">步骤 3 : 说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-新建Dynamic-Web-Project"><span class="nav-text">步骤 4 : 新建Dynamic Web Project</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-Servlet类"><span class="nav-text">步骤 5 : Servlet类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-解决HttpServlet找不到问题"><span class="nav-text">步骤 6 : 解决HttpServlet找不到问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-刷新项目"><span class="nav-text">步骤 7 : 刷新项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-web-xml"><span class="nav-text">步骤 8 : web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-通过Eclipse启动Tomcat-Run-On-Server"><span class="nav-text">步骤 9 : 通过Eclipse启动Tomcat-Run On Server</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-通过Eclipse启动Tomcat-服务器选择Tomcat-v7-0-Server"><span class="nav-text">步骤 10 : 通过Eclipse启动Tomcat-服务器选择Tomcat v7.0 Server</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-通过Eclipse启动Tomcat-指定Tomcat服务器地址"><span class="nav-text">步骤 11 : 通过Eclipse启动Tomcat-指定Tomcat服务器地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-通过Eclipse启动Tomcat-部署"><span class="nav-text">步骤 12 : 通过Eclipse启动Tomcat-部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-测试"><span class="nav-text">步骤 13 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-关闭Eclipse中的Tomcat"><span class="nav-text">步骤 14 : 关闭Eclipse中的Tomcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-15-Eclipse中启动Tomcat问题-端口"><span class="nav-text">步骤 15 : Eclipse中启动Tomcat问题-端口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-16-需要注意的几点"><span class="nav-text">步骤 16 : 需要注意的几点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-17-右上角可运行项目"><span class="nav-text">步骤 17 : 右上角可运行项目</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、切换"><span class="nav-text">2、切换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-切换到动态Web项目"><span class="nav-text">步骤 1 : 切换到动态Web项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-准备java-project"><span class="nav-text">步骤 2 : 准备java project</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-项目转换"><span class="nav-text">步骤 3 : 项目转换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-设置content-directory"><span class="nav-text">步骤 4 : 设置content directory</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-点击确认"><span class="nav-text">步骤 5 : 点击确认</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-转换成功"><span class="nav-text">步骤 6 : 转换成功</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、导入"><span class="nav-text">3、导入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-导入动态Web"><span class="nav-text">步骤 1 : 导入动态Web</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-下载动态Web项目"><span class="nav-text">步骤 2 : 下载动态Web项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-导入到Eclipse中1"><span class="nav-text">步骤 3 : 导入到Eclipse中1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-导入到Eclipse中2"><span class="nav-text">步骤 4 : 导入到Eclipse中2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-动态Web项目J2EE"><span class="nav-text">步骤 5 : 动态Web项目J2EE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-启动Tomcat"><span class="nav-text">步骤 6 : 启动Tomcat</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、无法配置Tomcat"><span class="nav-text">4、无法配置Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-现象"><span class="nav-text">步骤 1 : 现象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-解决办法"><span class="nav-text">步骤 2 : 解决办法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、无法启动Tomcat"><span class="nav-text">5、无法启动Tomcat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-现象-v2"><span class="nav-text">步骤 1 : 现象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-解决办法-v2"><span class="nav-text">步骤 2 : 解决办法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、idea"><span class="nav-text">6、idea</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、CRUD"><span class="nav-text">三、CRUD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、查询"><span class="nav-text">1、查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v7"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v7"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-准备实体类Hero"><span class="nav-text">步骤 4 : 准备实体类Hero</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-准备DAO-类-HeroDAO"><span class="nav-text">步骤 5 : 准备DAO 类 HeroDAO</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-创建表Hero的SQL"><span class="nav-text">步骤 6 : 创建表Hero的SQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-为web应用导入mysql-jdbc的jar包"><span class="nav-text">步骤 7 : 为web应用导入mysql-jdbc的jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-编写-HeroListServlet"><span class="nav-text">步骤 8 : 编写 HeroListServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-配置web-xml"><span class="nav-text">步骤 9 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-重启tomcat，访问http-127-0-0-1-listHero"><span class="nav-text">步骤 10 : 重启tomcat，访问http:&#x2F;&#x2F;127.0.0.1&#x2F;listHero</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、增加"><span class="nav-text">2、增加</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v8"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v8"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-准备增加的页面-addHero-html"><span class="nav-text">步骤 3 : 准备增加的页面 addHero.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-编写-HeroAddServlet"><span class="nav-text">步骤 4 : 编写 HeroAddServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-配置web-xml-v2"><span class="nav-text">步骤 5 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试"><span class="nav-text">步骤 6 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、删除"><span class="nav-text">3、删除</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v9"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v9"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-提供delete超链"><span class="nav-text">步骤 3 : 提供delete超链</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改HeroListServlet"><span class="nav-text">步骤 4 : 修改HeroListServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-配置web-xml-v3"><span class="nav-text">步骤 5 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-编写HeroDeleteServlet"><span class="nav-text">步骤 6 : 编写HeroDeleteServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、编辑"><span class="nav-text">4、编辑</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v10"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v10"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-修改HeroListServlet"><span class="nav-text">步骤 3 : 修改HeroListServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-配置web-xml"><span class="nav-text">步骤 4 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-准备HeroEditServlet"><span class="nav-text">步骤 5 : 准备HeroEditServlet</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、更新"><span class="nav-text">5、更新</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v11"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v11"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-编写-HeroUpdateServlet"><span class="nav-text">步骤 3 : 编写 HeroUpdateServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-配置web-xml-v2"><span class="nav-text">步骤 4 : 配置web.xml</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、弊端"><span class="nav-text">6、弊端</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-使用Servlet进行CRUD开发的弊端"><span class="nav-text">步骤 1 : 使用Servlet进行CRUD开发的弊端</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、JSON"><span class="nav-text">四、JSON</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、提交数据"><span class="nav-text">1、提交数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v12"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v12"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v2"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-资源"><span class="nav-text">步骤 4 : 资源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-submit-html"><span class="nav-text">步骤 5 : submit.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-SubmitServlet"><span class="nav-text">步骤 6 : SubmitServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-web-xml"><span class="nav-text">步骤 7 : web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、获取一个对象"><span class="nav-text">2、获取一个对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v13"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v13"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v3"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-资源-v2"><span class="nav-text">步骤 4 : 资源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-GetOneServlet"><span class="nav-text">步骤 5 : GetOneServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-web-xml"><span class="nav-text">步骤 6 : web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-getOne-html"><span class="nav-text">步骤 7 : getOne.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试-v2"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、获取多个对象"><span class="nav-text">3、获取多个对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v14"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v14"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v4"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-资源-v3"><span class="nav-text">步骤 4 : 资源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-GetManyServlet"><span class="nav-text">步骤 5 : GetManyServlet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-web-xml-v2"><span class="nav-text">步骤 6 : web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-getMany-html"><span class="nav-text">步骤 7 : getMany.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试-v3"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script
  async
  src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"
></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">潇 卟 甸</span>

  
</div>

<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>

-->



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
     我的第 <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 位朋友，
    </span>
  

  
    <span class="site-pv">
     历经 <span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次回眸才与你相遇
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: 'w1mVK8MFY7n2fWIKlq2t9EJn-gzGzoHsz',
        appKey: 'NMGzUaGqmpzSiSItkHBQGUaA',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("w1mVK8MFY7n2fWIKlq2t9EJn-gzGzoHsz", "NMGzUaGqmpzSiSItkHBQGUaA");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  


  

 <script src="/js/src/activate-power-mode.js"></script>
 <script>
   POWERMODE.colorful = true;
   POWERMODE.shake = false;
   document.body.addEventListener('input', POWERMODE);
 </script>




<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.min.js"></script>
<script>
  function timer() {
    var ages = moment.preciseDiff(moment(),moment(20200610,"YYYYMMDD"));
    ages = ages.replace(/years?/, "年");
    ages = ages.replace(/months?/, "月");
    ages = ages.replace(/days?/, "天");
    ages = ages.replace(/hours?/, "小时");
    ages = ages.replace(/minutes?/, "分");
    ages = ages.replace(/seconds?/, "秒");
    ages = ages.replace(/\d+/g, '<span style="color:#1890ff">$&</span>');
    div.innerHTML = `我已在此等候你 ${ages}`;
  }
  var div = document.createElement("div");
  //插入到copyright之后
  var copyright = document.querySelector(".copyright");
  document.querySelector(".footer-inner").insertBefore(div, copyright.nextSibling);
  timer();
  setInterval("timer()",1000)
</script>




<script>
  var OriginTitile = document.title;
  var titleTime;
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      document.title = "(つェ⊂)我藏好了哦~" + OriginTitile;
      clearTimeout(titleTime);
    } else {
      document.title = "(*´∇｀*) 被你发现啦~" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
      }, 2000);
    }
  });
</script>


  
</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>
