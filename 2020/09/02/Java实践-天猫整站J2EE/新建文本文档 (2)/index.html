<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="¶十一、后台-其他管理 ¶1、后台其他页面 在[后台-分类管理]里把设计思路，用到的设计模式，静态资源，JSP包含关系, 分页，增删改查典型操作等每个详细的操作都掰的很细了。 后台的其他管理页面，比如产品管理，订单管理等也有相近的功能，就不用讲解的那么细的，所以其他的管理页面，就每个页面放在一个知识点里讲解，这样大家学习起来更加紧凑。 ¶2、属性管理 ¶步骤 1 : 先运行，看到效果，再学习 老规">
<meta property="og:type" content="article">
<meta property="og:title" content="Java实践-天猫整站J2EE&#x2F;新建文本文档 (2)">
<meta property="og:url" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/index.html">
<meta property="og:site_name" content="伶仃浩瀚">
<meta property="og:description" content="¶十一、后台-其他管理 ¶1、后台其他页面 在[后台-分类管理]里把设计思路，用到的设计模式，静态资源，JSP包含关系, 分页，增删改查典型操作等每个详细的操作都掰的很细了。 后台的其他管理页面，比如产品管理，订单管理等也有相近的功能，就不用讲解的那么细的，所以其他的管理页面，就每个页面放在一个知识点里讲解，这样大家学习起来更加紧凑。 ¶2、属性管理 ¶步骤 1 : 先运行，看到效果，再学习 老规">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3781.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3783.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3787.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3788.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3789.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3790.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3791.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3792.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3793.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3796.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3797.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3801.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3802.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3803.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3804.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3805.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3810.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3811.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3812.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3813.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3820.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3824.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3825.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3828.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3832.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3837.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3839.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3842.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3843.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/4003.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/4004.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3853.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3854.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3855.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3858.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3859.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3860.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3856.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3857.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3863.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3864.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3867.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3868.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3872.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3878.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3880.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3882.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3883.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3884.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3885.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3886.png">
<meta property="og:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3887.png">
<meta property="article:published_time" content="2020-09-02T03:00:04.505Z">
<meta property="article:modified_time" content="2020-09-04T09:16:09.785Z">
<meta property="article:author" content="潇 卟 甸">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3781.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/09/02/Java实践-天猫整站J2EE/新建文本文档 (2)/"/>







<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

  <title>Java实践-天猫整站J2EE/新建文本文档 (2) | 伶仃浩瀚</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://xbd224694.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">伶仃浩瀚</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="潇 卟 甸">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/picture.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="伶仃浩瀚">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Java实践-天猫整站J2EE/新建文本文档 (2)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建时间" itemprop="dateCreated datePublished" datetime="2020-09-02T11:00:04+08:00">
                2020-09-02
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/" class="leancloud_visitors" data-flag-title="Java实践-天猫整站J2EE/新建文本文档 (2)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度 </span>
               
                 <span class="leancloud-visitors-count"></span>
	 <span> ℃ </span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  28.5k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  145 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="十一、后台-其他管理"><a class="header-anchor" href="#十一、后台-其他管理">¶</a>十一、后台-其他管理</h1>
<h2 id="1、后台其他页面"><a class="header-anchor" href="#1、后台其他页面">¶</a>1、后台其他页面</h2>
<p>在[后台-分类管理]里把设计思路，用到的设计模式，静态资源，JSP包含关系, 分页，增删改查典型操作等每个详细的操作都掰的很细了。 后台的其他管理页面，比如产品管理，订单管理等也有相近的功能，就不用讲解的那么细的，所以其他的管理页面，就每个页面放在一个知识点里讲解，这样大家学习起来更加紧凑。</p>
<h2 id="2、属性管理"><a class="header-anchor" href="#2、属性管理">¶</a>2、属性管理</h2>
<h3 id="步骤-1-先运行，看到效果，再学习"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习">¶</a>步骤 1 : 先运行，看到效果，再学习</h3>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h3 id="步骤-2-模仿和排错"><a class="header-anchor" href="#步骤-2-模仿和排错">¶</a>步骤 2 : 模仿和排错</h3>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h3 id="步骤-3-页面截图"><a class="header-anchor" href="#步骤-3-页面截图">¶</a>步骤 3 : 页面截图</h3>
<p>重启tomcat,通过访问地址</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/tmall/admin_property_list?cid=12</span><br></pre></td></tr></table></figure>
<p>可以看到属性管理的界面</p>
<p>注： 这cid=12是分类的id，根据你的实际运行情况，采取不同的id值</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3781.png" alt></p>
<h3 id="步骤-4-在分类管理页面上添加属性管理的超链"><a class="header-anchor" href="#步骤-4-在分类管理页面上添加属性管理的超链">¶</a>步骤 4 : 在分类管理页面上添加属性管理的超链</h3>
<p>接下来讲， 基于 [分类管理可运行项目 ]做了哪些工作以支持属性管理的操作。</p>
<p>首先，在listCategory.jsp里，加上属性管理这一列<br>
分别处于37行和51行</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span>属性管理<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"admin_property_list?cid=$&#123;c.id&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-th-list"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3783.png" alt></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function()&#123;</span><br><span class="line">     </span><br><span class="line">    $(<span class="string">"#addForm"</span>).submit(function()&#123;</span><br><span class="line">        <span class="keyword">if</span>(!checkEmpty(<span class="string">"name"</span>,<span class="string">"分类名称"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(!checkEmpty(<span class="string">"categoryPic"</span>,<span class="string">"分类图片"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;分类管理&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">    &lt;h1 class="label label-info" &gt;分类管理&lt;/h1&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"listDataTableDiv"</span>&gt;</span><br><span class="line">        &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover  table-condensed"</span>&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                    &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;图片&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;分类名称&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;属性管理&lt;/th&gt;</span><br><span class="line">&lt;!--                     &lt;th&gt;产品管理&lt;/th&gt; --&gt;</span><br><span class="line">                    &lt;th&gt;编辑&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;删除&lt;/th&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;thecs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span>&gt;</span><br><span class="line">                 </span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;img height="40px" src="img/category/$&#123;c.id&#125;.jpg"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                         </span><br><span class="line">                    &lt;td&gt;&lt;a href="admin_property_list?cid=$&#123;c.id&#125;"&gt;&lt;span class="glyphicon glyphicon-th-list"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;                   </span><br><span class="line">&lt;%--                     &lt;td&gt;&lt;a href="admin_product_list?cid=$&#123;c.id&#125;"&gt;&lt;span class="glyphicon glyphicon-shopping-cart"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;                    --%&gt;</span><br><span class="line">                    &lt;td&gt;&lt;a href="admin_category_edit?id=$&#123;c.id&#125;"&gt;&lt;span class="glyphicon glyphicon-edit"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;a deleteLink="true" href="admin_category_delete?id=$&#123;c.id&#125;"&gt;&lt;span class="   glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">     </span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pageDiv"</span>&gt;</span><br><span class="line">        &lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminPage.jsp"</span> %&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning addDiv"</span>&gt;</span><br><span class="line">      &lt;div class="panel-heading"&gt;新增分类&lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">            &lt;form method=<span class="string">"post"</span> id=<span class="string">"addForm"</span> action=<span class="string">"admin_category_add"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;分类名称&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input  id="name" name="name" type="text" class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;分类圖片&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;</span><br><span class="line">                            &lt;input id=<span class="string">"categoryPic"</span> accept=<span class="string">"image/*"</span> type=<span class="string">"file"</span> name=<span class="string">"filepath"</span> /&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                            &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminFooter.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-5-PropertyServlet类"><a class="header-anchor" href="#步骤-5-PropertyServlet类">¶</a>步骤 5 : PropertyServlet类</h3>
<p>准备PropertyServlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.Category;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.Property;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropertyServlet</span> <span class="keyword">extends</span> <span class="title">BaseBackServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line">         </span><br><span class="line">        String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        Property p = <span class="keyword">new</span> Property();</span><br><span class="line">        p.setCategory(c);</span><br><span class="line">        p.setName(name);</span><br><span class="line">        propertyDAO.add(p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_property_list?cid="</span>+cid;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Property p = propertyDAO.get(id);</span><br><span class="line">        propertyDAO.delete(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_property_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Property p = propertyDAO.get(id);</span><br><span class="line">        request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/editProperty.jsp"</span>;       </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        Property p = <span class="keyword">new</span> Property();</span><br><span class="line">        p.setCategory(c);</span><br><span class="line">        p.setId(id);</span><br><span class="line">        p.setName(name);</span><br><span class="line">        propertyDAO.update(p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_property_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line">        List&lt;Property&gt; ps = propertyDAO.list(cid, page.getStart(),page.getCount());</span><br><span class="line">        <span class="keyword">int</span> total = propertyDAO.getTotal(cid);</span><br><span class="line">        page.setTotal(total);</span><br><span class="line">        page.setParam(<span class="string">"&amp;cid="</span>+c.getId());</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"ps"</span>, ps);</span><br><span class="line">        request.setAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/listProperty.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-web-xml"><a class="header-anchor" href="#步骤-6-web-xml">¶</a>步骤 6 : web.xml</h3>
<p>接着在web.xml中配置/propertyServlet 路径</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.CategoryServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/categoryServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.PropertyServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/propertyServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.BackServletFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-listProperty-jsp-editProperty-jsp"><a class="header-anchor" href="#步骤-7-listProperty-jsp-editProperty-jsp">¶</a>步骤 7 : listProperty.jsp+editProperty.jsp</h3>
<p>然后是查询和编辑的jsp页面</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">    $(function() &#123;</span><br><span class="line"> </span><br><span class="line">        $(<span class="string">"#addForm"</span>).submit(function() &#123;</span><br><span class="line">            <span class="keyword">if</span> (checkEmpty(<span class="string">"name"</span>, <span class="string">"属性名称"</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;属性管理&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_category_list"&gt;所有分类&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_property_list?cid=$&#123;c.id&#125;"&gt;$&#123;c.name&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li class="active"&gt;属性管理&lt;/li&gt;</span><br><span class="line">    &lt;/ol&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"listDataTableDiv"</span>&gt;</span><br><span class="line">        &lt;table</span><br><span class="line">            <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover  table-condensed"</span>&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                    &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;属性名称&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;编辑&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;删除&lt;/th&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;ps&#125;"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line"> </span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;a href=<span class="string">"admin_property_edit?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                class="glyphicon glyphicon-edit"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">                            href=<span class="string">"admin_property_delete?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pageDiv"</span>&gt;</span><br><span class="line">        &lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminPage.jsp"</span>%&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning addDiv"</span>&gt;</span><br><span class="line">        &lt;div class="panel-heading"&gt;新增属性&lt;/div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">            &lt;form method=<span class="string">"post"</span> id=<span class="string">"addForm"</span> action=<span class="string">"admin_property_add"</span>&gt;</span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;属性名称&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"name"</span> name=<span class="string">"name"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">                            &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminFooter.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;编辑属性&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">    &lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_category_list"&gt;所有分类&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_property_list?cid=$&#123;p.category.id&#125;"&gt;$&#123;p.category.name&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li class="active"&gt;编辑属性&lt;/li&gt;</span><br><span class="line">    &lt;/ol&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning editDiv"</span>&gt;</span><br><span class="line">        &lt;div class="panel-heading"&gt;编辑属性&lt;/div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">            &lt;form method=<span class="string">"post"</span> id=<span class="string">"editForm"</span> action=<span class="string">"admin_property_update"</span>&gt;</span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"editTable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;属性名称&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"name"</span> name=<span class="string">"name"</span> value=<span class="string">"$&#123;p.name&#125;"</span></span><br><span class="line">                            type="text" class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                        &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"id"</span> value=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">                        &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;p.category.id&#125;"</span>&gt;</span><br><span class="line">                        &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-8-查询功能讲解"><a class="header-anchor" href="#步骤-8-查询功能讲解">¶</a>步骤 8 : 查询功能讲解</h3>
<p>查询访问的是PropertyServlet的list()方法</p>
<ol>
<li>获取分类 cid</li>
<li>基于cid，获取当前分类下的属性集合</li>
<li>获取当前分类下的属性总数，并且设置给分页page对象</li>
<li>拼接字符串&quot;&amp;cid=&quot;+c.getId()，设置给page对象的Param值。 因为属性分页都是基于当前分类下的分页，所以分页的时候需要传递这个cid</li>
<li>把属性集合设置到 request的 “ps” 属性上</li>
<li>把分类对象设置到 request的 “c” 属性上</li>
<li>把分页对象设置到 request的 “page” 对象上</li>
<li>服务端跳转到admin/listProperty.jsp页面</li>
<li>在listProperty.jsp页面上使用c:forEach 遍历ps集合，并显示</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3787.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">    Category c = categoryDAO.get(cid);</span><br><span class="line">    List&lt;Property&gt; ps = propertyDAO.list(cid, page.getStart(),page.getCount());</span><br><span class="line">    <span class="keyword">int</span> total = propertyDAO.getTotal(cid);</span><br><span class="line">    page.setTotal(total);</span><br><span class="line">    page.setParam(<span class="string">"&amp;cid="</span>+c.getId());</span><br><span class="line">     </span><br><span class="line">    request.setAttribute(<span class="string">"ps"</span>, ps);</span><br><span class="line">    request.setAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">    request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/listProperty.jsp"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">"$&#123;ps&#125;"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;a href=<span class="string">"admin_property_edit?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="glyphicon glyphicon-edit"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">            href=<span class="string">"admin_property_delete?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-9-增加功能讲解"><a class="header-anchor" href="#步骤-9-增加功能讲解">¶</a>步骤 9 : 增加功能讲解</h3>
<ol>
<li>在listProperty.jsp页面提交数据的时候，除了提交属性名称，还会提交cid</li>
<li>在PropertyServlet中根据获取到的cid,name参数，创建新的Property对象，并插入到数据库</li>
<li>客户端跳转到admin_property_list,并带上参数cid</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3788.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> id=<span class="string">"addForm"</span> action=<span class="string">"admin_property_add"</span>&gt;</span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;属性名称&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"name"</span> name=<span class="string">"name"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">                            &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/form&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">    Category c = categoryDAO.get(cid);</span><br><span class="line">     </span><br><span class="line">    String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    Property p = <span class="keyword">new</span> Property();</span><br><span class="line">    p.setCategory(c);</span><br><span class="line">    p.setName(name);</span><br><span class="line">    propertyDAO.add(p);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"@admin_property_list?cid="</span>+cid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-10-编辑功能讲解"><a class="header-anchor" href="#步骤-10-编辑功能讲解">¶</a>步骤 10 : 编辑功能讲解</h3>
<ol>
<li>在PropertyServlet的edit方法中，根据id获取Property对象</li>
<li>把Property对象放在request的 “p” 属性中</li>
<li>服务端跳转到admin/editProperty.jsp</li>
<li>在editProperty.jsp中显示属性名称</li>
<li>在editProperty.jsp中隐式提供id和cid</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"id"</span> value=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;p.category.id&#125;"</span>&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3789.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    Property p = propertyDAO.get(id);</span><br><span class="line">    request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/editProperty.jsp"</span>;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"id"</span> value=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;p.category.id&#125;"</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-11-修改功能讲解"><a class="header-anchor" href="#步骤-11-修改功能讲解">¶</a>步骤 11 : 修改功能讲解</h3>
<ol>
<li>在PropertyServlet的update方法中获取cid，id, name等参数</li>
<li>根据这些参数创建Property对象</li>
<li>借助propertyDAO更新这个对象到数据库</li>
<li>客户端跳转到admin_property_list，并带上参数cid</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3790.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">    Category c = categoryDAO.get(cid);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    Property p = <span class="keyword">new</span> Property();</span><br><span class="line">    p.setCategory(c);</span><br><span class="line">    p.setId(id);</span><br><span class="line">    p.setName(name);</span><br><span class="line">    propertyDAO.update(p);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"@admin_property_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-12-删除功能讲解"><a class="header-anchor" href="#步骤-12-删除功能讲解">¶</a>步骤 12 : 删除功能讲解</h3>
<ol>
<li>在PropertyServlet的delete方法中获取id</li>
<li>根据id获取Property对象</li>
<li>借助propertyDAO删除这个对象对应的数据</li>
<li>客户端跳转到admin_property_list，并带上参数cid</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3791.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    Property p = propertyDAO.get(id);</span><br><span class="line">    propertyDAO.delete(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"@admin_property_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-13-其他-面包屑导航"><a class="header-anchor" href="#步骤-13-其他-面包屑导航">¶</a>步骤 13 : 其他-面包屑导航</h3>
<p>在属性管理页面的页头，有一个面包屑导航<br>
第一个连接跳转到admin_category_list<br>
第二个连接跳转到admin_property_list?cid=</p>
<p>样式用的是[Bootstrap面包屑导航]</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3792.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">  &lt;li&gt;&lt;a href="admin_category_list"&gt;所有分类&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">  &lt;li&gt;&lt;a href="admin_property_list?cid=$&#123;c.id&#125;"&gt;$&#123;c.name&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">  &lt;li class="active"&gt;属性管理&lt;/li&gt;</span><br><span class="line">&lt;/ol&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-14-其他-分页"><a class="header-anchor" href="#步骤-14-其他-分页">¶</a>步骤 14 : 其他-分页</h3>
<p>这里的分页比起[分类管理中的分页]多了一个参数cid</p>
<ol>
<li>在PropertyServlet.list() 方法中，把&amp;cid= 参数设置到在page对象的param属性上</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.setParam(<span class="string">"&amp;cid="</span>+c.getId());</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>在adminPage.jsp页面中通过${page.param}取出这个参数</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3793.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function()&#123;</span><br><span class="line">    $(<span class="string">"ul.pagination li.disabled a"</span>).click(function()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;nav&gt;</span><br><span class="line">  &lt;ul <span class="class"><span class="keyword">class</span></span>=<span class="string">"pagination"</span>&gt;</span><br><span class="line">    &lt;li &lt;c:if test="$&#123;!page.hasPreviouse&#125;"&gt;class="disabled"&lt;/c:if&gt;&gt;</span><br><span class="line">      &lt;a  href=<span class="string">"?page.start=0$&#123;page.param&#125;"</span> aria-label=<span class="string">"Previous"</span> &gt;</span><br><span class="line">        &lt;span aria-hidden="true"&gt;«&lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;li &lt;c:if test="$&#123;!page.hasPreviouse&#125;"&gt;class="disabled"&lt;/c:if&gt;&gt;</span><br><span class="line">      &lt;a  href=<span class="string">"?page.start=$&#123;page.start-page.count&#125;$&#123;page.param&#125;"</span> aria-label=<span class="string">"Previous"</span> &gt;</span><br><span class="line">        &lt;span aria-hidden="true"&gt;‹&lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/li&gt;   </span><br><span class="line"> </span><br><span class="line">    &lt;c:forEach begin=<span class="string">"0"</span> end=<span class="string">"$&#123;page.totalPage-1&#125;"</span> varStatus=<span class="string">"status"</span>&gt;</span><br><span class="line">     </span><br><span class="line">            &lt;li &lt;c:if test="$&#123;status.index*page.count==page.start&#125;"&gt;class="disabled"&lt;/c:if&gt;&gt;</span><br><span class="line">                &lt;a </span><br><span class="line">                href=<span class="string">"?page.start=$&#123;status.index*page.count&#125;$&#123;page.param&#125;"</span></span><br><span class="line">                &lt;c:if test="$&#123;status.index*page.count==page.start&#125;"&gt;class="current"&lt;/c:if&gt;</span><br><span class="line">                &gt;$&#123;status.count&#125;&lt;/a&gt;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">         </span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;li &lt;c:if test="$&#123;!page.hasNext&#125;"&gt;class="disabled"&lt;/c:if&gt;&gt;</span><br><span class="line">      &lt;a href=<span class="string">"?page.start=$&#123;page.start+page.count&#125;$&#123;page.param&#125;"</span> aria-label=<span class="string">"Next"</span>&gt;</span><br><span class="line">        &lt;span aria-hidden="true"&gt;›&lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">    &lt;li &lt;c:if test="$&#123;!page.hasNext&#125;"&gt;class="disabled"&lt;/c:if&gt;&gt;</span><br><span class="line">      &lt;a href=<span class="string">"?page.start=$&#123;page.last&#125;$&#123;page.param&#125;"</span> aria-label=<span class="string">"Next"</span>&gt;</span><br><span class="line">        &lt;span aria-hidden="true"&gt;»&lt;/span&gt;</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">    &lt;/li&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">&lt;/nav&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-15-自己做一遍"><a class="header-anchor" href="#步骤-15-自己做一遍">¶</a>步骤 15 : 自己做一遍</h3>
<p>关于属性管理这一块的学习，推荐如下思路：</p>
<ol>
<li>
<p>先下载[可运行项目]，配置好了跑一边</p>
</li>
<li>
<p>根据接着的讲解，把里面的每一块代码的逻辑，思路，设计思想搞明白，不明不白的在对应页面下提问</p>
</li>
<li>
<p>都理清楚之后，把[可运行项目] 删掉，按照：查询，增加，删除，编辑，修改的顺序自己从头到尾做一遍</p>
</li>
</ol>
<p>只有，能够独立的做出来，才叫做把这些知识点的内容转化为自己的技能</p>
<h2 id="3、产品管理"><a class="header-anchor" href="#3、产品管理">¶</a>3、产品管理</h2>
<h3 id="步骤-1-先运行，看到效果，再学习-v2"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v2">¶</a>步骤 1 : 先运行，看到效果，再学习</h3>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h3 id="步骤-2-模仿和排错-v2"><a class="header-anchor" href="#步骤-2-模仿和排错-v2">¶</a>步骤 2 : 模仿和排错</h3>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h3 id="步骤-3-页面截图-v2"><a class="header-anchor" href="#步骤-3-页面截图-v2">¶</a>步骤 3 : 页面截图</h3>
<p>重启tomcat,通过访问地址</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/tmall/admin_product_list?cid=12</span><br></pre></td></tr></table></figure>
<p>可以看到产品管理的界面<br>
<strong>注：</strong> 这cid=12是分类的id，根据你的实际运行情况，采取不同的id值</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3796.png" alt></p>
<h3 id="步骤-4-在分类管理页面上添加产品管理的超链"><a class="header-anchor" href="#步骤-4-在分类管理页面上添加产品管理的超链">¶</a>步骤 4 : 在分类管理页面上添加产品管理的超链</h3>
<p>接下来讲， 接着上一步 [属性管理可运行项目] 做了哪些工作以支持产品管理的操作。</p>
<p>首先，在listCategory.jsp里，加上产品管理这一列<br>
分别处于37行和51行</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;th&gt;产品管理&lt;/th&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;a href="admin_product_list?cid=$&#123;c.id&#125;"&gt;&lt;span class="glyphicon glyphicon-shopping-cart"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3797.png" alt></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function()&#123;</span><br><span class="line">     </span><br><span class="line">    $(<span class="string">"#addForm"</span>).submit(function()&#123;</span><br><span class="line">        <span class="keyword">if</span>(!checkEmpty(<span class="string">"name"</span>,<span class="string">"分类名称"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(!checkEmpty(<span class="string">"categoryPic"</span>,<span class="string">"分类图片"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;分类管理&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">    &lt;h1 class="label label-info" &gt;分类管理&lt;/h1&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"listDataTableDiv"</span>&gt;</span><br><span class="line">        &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover  table-condensed"</span>&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                    &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;图片&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;分类名称&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;属性管理&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;产品管理&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;编辑&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;删除&lt;/th&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;thecs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span>&gt;</span><br><span class="line">                 </span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;img height="40px" src="img/category/$&#123;c.id&#125;.jpg"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                         </span><br><span class="line">                    &lt;td&gt;&lt;a href="admin_property_list?cid=$&#123;c.id&#125;"&gt;&lt;span class="glyphicon glyphicon-th-list"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;                   </span><br><span class="line">                    &lt;td&gt;&lt;a href="admin_product_list?cid=$&#123;c.id&#125;"&gt;&lt;span class="glyphicon glyphicon-shopping-cart"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;                  </span><br><span class="line">                    &lt;td&gt;&lt;a href="admin_category_edit?id=$&#123;c.id&#125;"&gt;&lt;span class="glyphicon glyphicon-edit"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;&lt;a deleteLink="true" href="admin_category_delete?id=$&#123;c.id&#125;"&gt;&lt;span class="   glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">     </span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pageDiv"</span>&gt;</span><br><span class="line">        &lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminPage.jsp"</span> %&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning addDiv"</span>&gt;</span><br><span class="line">      &lt;div class="panel-heading"&gt;新增分类&lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">            &lt;form method=<span class="string">"post"</span> id=<span class="string">"addForm"</span> action=<span class="string">"admin_category_add"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;分类名称&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input  id="name" name="name" type="text" class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;分类圖片&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;</span><br><span class="line">                            &lt;input id=<span class="string">"categoryPic"</span> accept=<span class="string">"image/*"</span> type=<span class="string">"file"</span> name=<span class="string">"filepath"</span> /&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                            &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminFooter.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-5-ProductServlet类"><a class="header-anchor" href="#步骤-5-ProductServlet类">¶</a>步骤 5 : ProductServlet类</h3>
<p>准备ProductServlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.Category;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.Product;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.Property;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.PropertyValue;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServlet</span> <span class="keyword">extends</span> <span class="title">BaseBackServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line">         </span><br><span class="line">        String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String subTitle= request.getParameter(<span class="string">"subTitle"</span>);</span><br><span class="line">        <span class="keyword">float</span> orignalPrice = Float.parseFloat(request.getParameter(<span class="string">"orignalPrice"</span>));</span><br><span class="line">        <span class="keyword">float</span> promotePrice = Float.parseFloat(request.getParameter(<span class="string">"promotePrice"</span>));</span><br><span class="line">        <span class="keyword">int</span> stock = Integer.parseInt(request.getParameter(<span class="string">"stock"</span>));</span><br><span class="line"> </span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line"> </span><br><span class="line">        p.setCategory(c);</span><br><span class="line">        p.setName(name);</span><br><span class="line">        p.setSubTitle(subTitle);</span><br><span class="line">        p.setOrignalPrice(orignalPrice);</span><br><span class="line">        p.setPromotePrice(promotePrice);</span><br><span class="line">        p.setStock(stock);</span><br><span class="line">        p.setCreateDate(<span class="keyword">new</span> Date());</span><br><span class="line"> </span><br><span class="line">        productDAO.add(p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+cid;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Product p = productDAO.get(id);</span><br><span class="line">        productDAO.delete(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Product p = productDAO.get(id);</span><br><span class="line">        request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/editProduct.jsp"</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">editPropertyValue</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Product p = productDAO.get(id);</span><br><span class="line">        request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">         </span><br><span class="line">        List&lt;Property&gt; pts= propertyDAO.list(p.getCategory().getId());</span><br><span class="line">        propertyValueDAO.init(p);</span><br><span class="line">         </span><br><span class="line">        List&lt;PropertyValue&gt; pvs = propertyValueDAO.list(p.getId());</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"pvs"</span>, pvs);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/editProductValue.jsp"</span>;       </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updatePropertyValue</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pvid = Integer.parseInt(request.getParameter(<span class="string">"pvid"</span>));</span><br><span class="line">        String value = request.getParameter(<span class="string">"value"</span>);</span><br><span class="line">         </span><br><span class="line">        PropertyValue pv =propertyValueDAO.get(pvid);</span><br><span class="line">        pv.setValue(value);</span><br><span class="line">        propertyValueDAO.update(pv);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"%success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        <span class="keyword">int</span> stock = Integer.parseInt(request.getParameter(<span class="string">"stock"</span>));</span><br><span class="line">        <span class="keyword">float</span> orignalPrice = Float.parseFloat(request.getParameter(<span class="string">"orignalPrice"</span>));</span><br><span class="line">        <span class="keyword">float</span> promotePrice = Float.parseFloat(request.getParameter(<span class="string">"promotePrice"</span>));</span><br><span class="line">        String subTitle= request.getParameter(<span class="string">"subTitle"</span>);</span><br><span class="line">        String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">         </span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line"> </span><br><span class="line">        p.setName(name);</span><br><span class="line">        p.setSubTitle(subTitle);</span><br><span class="line">        p.setOrignalPrice(orignalPrice);</span><br><span class="line">        p.setPromotePrice(promotePrice);</span><br><span class="line">        p.setStock(stock);</span><br><span class="line">        p.setId(id);</span><br><span class="line">        p.setCategory(c);      </span><br><span class="line"> </span><br><span class="line">        productDAO.update(p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; ps = productDAO.list(cid, page.getStart(),page.getCount());</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">int</span> total = productDAO.getTotal(cid);</span><br><span class="line">        page.setTotal(total);</span><br><span class="line">        page.setParam(<span class="string">"&amp;cid="</span>+c.getId());</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"ps"</span>, ps);</span><br><span class="line">        request.setAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/listProduct.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-web-xml-v2"><a class="header-anchor" href="#步骤-6-web-xml-v2">¶</a>步骤 6 : web.xml</h3>
<p>接着在web.xml中配置/productServlet 路径</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.CategoryServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ProductServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/productServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/categoryServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.PropertyServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/propertyServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.BackServletFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-listProduct-jsp-editProduct-jsp"><a class="header-anchor" href="#步骤-7-listProduct-jsp-editProduct-jsp">¶</a>步骤 7 : listProduct.jsp+editProduct.jsp</h3>
<p>然后是查询和编辑的jsp页面</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">    $(function() &#123;</span><br><span class="line">        $(<span class="string">"#addForm"</span>).submit(function() &#123;</span><br><span class="line">            <span class="keyword">if</span> (!checkEmpty(<span class="string">"name"</span>, <span class="string">"产品名称"</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"><span class="comment">//          if (!checkEmpty("subTitle", "小标题"))</span></span><br><span class="line"><span class="comment">//              return false;</span></span><br><span class="line">            <span class="keyword">if</span> (!checkNumber(<span class="string">"orignalPrice"</span>, <span class="string">"原价格"</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (!checkNumber(<span class="string">"promotePrice"</span>, <span class="string">"优惠价格"</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (!checkInt(<span class="string">"stock"</span>, <span class="string">"库存"</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;产品管理&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_category_list"&gt;所有分类&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_product_list?cid=$&#123;c.id&#125;"&gt;$&#123;c.name&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li class="active"&gt;产品管理&lt;/li&gt;</span><br><span class="line">    &lt;/ol&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"listDataTableDiv"</span>&gt;</span><br><span class="line">        &lt;table</span><br><span class="line">            <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover  table-condensed"</span>&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                    &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;图片&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;产品名称&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;产品小标题&lt;/th&gt;</span><br><span class="line">                    &lt;th width="53px"&gt;原价格&lt;/th&gt;</span><br><span class="line">                    &lt;th width="80px"&gt;优惠价格&lt;/th&gt;</span><br><span class="line">                    &lt;th width="80px"&gt;库存数量&lt;/th&gt;</span><br><span class="line">                    &lt;th width="80px"&gt;图片管理&lt;/th&gt;</span><br><span class="line">                    &lt;th width="80px"&gt;设置属性&lt;/th&gt;</span><br><span class="line">                    &lt;th width="42px"&gt;编辑&lt;/th&gt;</span><br><span class="line">                    &lt;th width="42px"&gt;删除&lt;/th&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;ps&#125;"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;</span><br><span class="line">                         </span><br><span class="line">                        &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;!empty p.firstProductImage&#125;"</span>&gt;</span><br><span class="line">                            &lt;img width=<span class="string">"40px"</span> src=<span class="string">"img/productSingle/$&#123;p.firstProductImage.id&#125;.jpg"</span>&gt;</span><br><span class="line">                        &lt;/c:if&gt;</span><br><span class="line">                         </span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.subTitle&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.orignalPrice&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.promotePrice&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;p.stock&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;a href=<span class="string">"admin_productImage_list?pid=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                class="glyphicon glyphicon-picture"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;a href=<span class="string">"admin_product_editPropertyValue?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                class="glyphicon glyphicon-th-list"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                         </span><br><span class="line">                        &lt;td&gt;&lt;a href=<span class="string">"admin_product_edit?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                class="glyphicon glyphicon-edit"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">                            href=<span class="string">"admin_product_delete?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pageDiv"</span>&gt;</span><br><span class="line">        &lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminPage.jsp"</span>%&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning addDiv"</span>&gt;</span><br><span class="line">        &lt;div class="panel-heading"&gt;新增产品&lt;/div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">            &lt;form method=<span class="string">"post"</span> id=<span class="string">"addForm"</span> action=<span class="string">"admin_product_add"</span>&gt;</span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;产品名称&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"name"</span> name=<span class="string">"name"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;产品小标题&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"subTitle"</span> name=<span class="string">"subTitle"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;原价格&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"orignalPrice"</span> value=<span class="string">"99.98"</span> name=<span class="string">"orignalPrice"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;优惠价格&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"promotePrice"</span>  value=<span class="string">"19.98"</span> name=<span class="string">"promotePrice"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;库存&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"stock"</span>  value=<span class="string">"99"</span> name=<span class="string">"stock"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">                            &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminFooter.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;编辑产品&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function() &#123;</span><br><span class="line">    $(<span class="string">"#editForm"</span>).submit(function() &#123;</span><br><span class="line">        <span class="keyword">if</span> (!checkEmpty(<span class="string">"name"</span>, <span class="string">"产品名称"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"><span class="comment">//          if (!checkEmpty("subTitle", "小标题"))</span></span><br><span class="line"><span class="comment">//              return false;</span></span><br><span class="line">        <span class="keyword">if</span> (!checkNumber(<span class="string">"orignalPrice"</span>, <span class="string">"原价格"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (!checkNumber(<span class="string">"promotePrice"</span>, <span class="string">"优惠价格"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (!checkInt(<span class="string">"stock"</span>, <span class="string">"库存"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">    &lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_category_list"&gt;所有分类&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_product_list?cid=$&#123;p.category.id&#125;"&gt;$&#123;p.category.name&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li class="active"&gt;$&#123;p.name&#125;&lt;/li&gt;</span><br><span class="line">      &lt;li class="active"&gt;编辑产品&lt;/li&gt;</span><br><span class="line">    &lt;/ol&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning editDiv"</span>&gt;</span><br><span class="line">        &lt;div class="panel-heading"&gt;编辑产品&lt;/div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">            &lt;form method=<span class="string">"post"</span> id=<span class="string">"editForm"</span> action=<span class="string">"admin_product_update"</span>&gt;</span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"editTable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;产品名称&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"name"</span> name=<span class="string">"name"</span> value=<span class="string">"$&#123;p.name&#125;"</span></span><br><span class="line">                            type="text" class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;产品小标题&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"subTitle"</span> name=<span class="string">"subTitle"</span> type=<span class="string">"text"</span></span><br><span class="line">                        value=<span class="string">"$&#123;p.subTitle&#125;"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;原价格&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"orignalPrice"</span> value=<span class="string">"$&#123;p.orignalPrice&#125;"</span> name=<span class="string">"orignalPrice"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;优惠价格&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"promotePrice"</span>  value=<span class="string">"$&#123;p.promotePrice&#125;"</span> name=<span class="string">"promotePrice"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;库存&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;input id=<span class="string">"stock"</span>  value=<span class="string">"$&#123;p.stock&#125;"</span> name=<span class="string">"stock"</span> type=<span class="string">"text"</span></span><br><span class="line">                            class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                                         </span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                        &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"id"</span> value=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">                        &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;p.category.id&#125;"</span>&gt;</span><br><span class="line">                        &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;&lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-8-查询功能讲解-v2"><a class="header-anchor" href="#步骤-8-查询功能讲解-v2">¶</a>步骤 8 : 查询功能讲解</h3>
<p>查询访问的是ProductServlet的list()方法</p>
<ol>
<li>获取分类 cid</li>
<li>基于cid，获取当前分类下的产品集合</li>
<li>获取当前分类下的产品总数，并且设置给分页page对象</li>
<li>拼接字符串&quot;&amp;cid=&quot;+c.getId()，设置给page对象的Param值。 因为产品分页都是基于当前分类下的分页，所以分页的时候需要传递这个cid</li>
<li>把产品集合设置到 request的 “ps” 属性上</li>
<li>把分类对象设置到 request的 “c” 属性上</li>
<li>把分页对象设置到 request的 “page” 对象上</li>
<li>服务端跳转到admin/listProduct.jsp页面</li>
<li>在listProduct.jsp页面上使用c:forEach 遍历ps集合，并显示</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3801.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">    Category c = categoryDAO.get(cid);</span><br><span class="line">     </span><br><span class="line">    List&lt;Product&gt; ps = productDAO.list(cid, page.getStart(),page.getCount());</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">int</span> total = productDAO.getTotal(cid);</span><br><span class="line">    page.setTotal(total);</span><br><span class="line">    page.setParam(<span class="string">"&amp;cid="</span>+c.getId());</span><br><span class="line">     </span><br><span class="line">    request.setAttribute(<span class="string">"ps"</span>, ps);</span><br><span class="line">    request.setAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">    request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/listProduct.jsp"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">"$&#123;ps&#125;"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;!empty p.firstProductImage&#125;"</span>&gt;</span><br><span class="line">            &lt;img width=<span class="string">"40px"</span> src=<span class="string">"img/productSingle/$&#123;p.firstProductImage.id&#125;.jpg"</span>&gt;</span><br><span class="line">        &lt;/c:if&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.subTitle&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.orignalPrice&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.promotePrice&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.stock&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;a href=<span class="string">"admin_productImage_list?pid=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="glyphicon glyphicon-picture"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;a href=<span class="string">"admin_product_editPropertyValue?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="glyphicon glyphicon-th-list"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;td&gt;&lt;a href=<span class="string">"admin_product_edit?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="glyphicon glyphicon-edit"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">            href=<span class="string">"admin_product_delete?id=$&#123;p.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-9-增加功能讲解-v2"><a class="header-anchor" href="#步骤-9-增加功能讲解-v2">¶</a>步骤 9 : 增加功能讲解</h3>
<ol>
<li>在listProduct.jsp提交数据的时候，除了提交产品名称，小标题，原价格，优惠价格，库存外还会提交cid</li>
<li>在ProductServlet中根据获取到的cid,name,subTitle,等参数，创建新的Product对象，并插入到数据库</li>
<li>客户端跳转到admin_product_list,并带上参数cid</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3802.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> id=<span class="string">"addForm"</span> action=<span class="string">"admin_product_add"</span>&gt;</span><br><span class="line">    &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;产品名称&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input id=<span class="string">"name"</span> name=<span class="string">"name"</span> type=<span class="string">"text"</span></span><br><span class="line">                class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;产品小标题&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input id=<span class="string">"subTitle"</span> name=<span class="string">"subTitle"</span> type=<span class="string">"text"</span></span><br><span class="line">                class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;原价格&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input id=<span class="string">"orignalPrice"</span> value=<span class="string">"99.98"</span> name=<span class="string">"orignalPrice"</span> type=<span class="string">"text"</span></span><br><span class="line">                class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;优惠价格&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input id=<span class="string">"promotePrice"</span>  value=<span class="string">"19.98"</span> name=<span class="string">"promotePrice"</span> type=<span class="string">"text"</span></span><br><span class="line">                class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;库存&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;input id=<span class="string">"stock"</span>  value=<span class="string">"99"</span> name=<span class="string">"stock"</span> type=<span class="string">"text"</span></span><br><span class="line">                class="form-control"&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">            &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">                &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">    Category c = categoryDAO.get(cid);</span><br><span class="line">     </span><br><span class="line">    String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">    String subTitle= request.getParameter(<span class="string">"subTitle"</span>);</span><br><span class="line">    <span class="keyword">float</span> orignalPrice = Float.parseFloat(request.getParameter(<span class="string">"orignalPrice"</span>));</span><br><span class="line">    <span class="keyword">float</span> promotePrice = Float.parseFloat(request.getParameter(<span class="string">"promotePrice"</span>));</span><br><span class="line">    <span class="keyword">int</span> stock = Integer.parseInt(request.getParameter(<span class="string">"stock"</span>));</span><br><span class="line"> </span><br><span class="line">    Product p = <span class="keyword">new</span> Product();</span><br><span class="line"> </span><br><span class="line">    p.setCategory(c);</span><br><span class="line">    p.setName(name);</span><br><span class="line">    p.setSubTitle(subTitle);</span><br><span class="line">    p.setOrignalPrice(orignalPrice);</span><br><span class="line">    p.setPromotePrice(promotePrice);</span><br><span class="line">    p.setStock(stock);</span><br><span class="line">    productDAO.add(p);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+cid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-10-编辑功能讲解-v2"><a class="header-anchor" href="#步骤-10-编辑功能讲解-v2">¶</a>步骤 10 : 编辑功能讲解</h3>
<ol>
<li>在ProductServlet的edit方法中，根据id获取Product对象</li>
<li>把Product对象放在request的 “p” 属性中</li>
<li>服务端跳转到admin/editProduct.jsp</li>
<li>在editProduct.jsp中显示属性名称</li>
<li>在editProduct.jsp中隐式提供id和cid</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"id"</span> value=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;p.category.id&#125;"</span>&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3803.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    Product p = productDAO.get(id);</span><br><span class="line">    request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/editProduct.jsp"</span>;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"id"</span> value=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"cid"</span> value=<span class="string">"$&#123;p.category.id&#125;"</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-11-修改功能讲解-v2"><a class="header-anchor" href="#步骤-11-修改功能讲解-v2">¶</a>步骤 11 : 修改功能讲解</h3>
<ol>
<li>在ProductServlet的update方法中获取cid，id, name,subTitle,price等参数</li>
<li>根据这些参数创建Product对象</li>
<li>借助productDAO更新这个对象到数据库</li>
<li>客户端跳转到admin_product_list，并带上参数cid</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3804.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">    Category c = categoryDAO.get(cid);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    <span class="keyword">int</span> stock = Integer.parseInt(request.getParameter(<span class="string">"stock"</span>));</span><br><span class="line">    <span class="keyword">float</span> orignalPrice = Float.parseFloat(request.getParameter(<span class="string">"orignalPrice"</span>));</span><br><span class="line">    <span class="keyword">float</span> promotePrice = Float.parseFloat(request.getParameter(<span class="string">"promotePrice"</span>));</span><br><span class="line">    String subTitle= request.getParameter(<span class="string">"subTitle"</span>);</span><br><span class="line">    String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">     </span><br><span class="line">    Product p = <span class="keyword">new</span> Product();</span><br><span class="line"> </span><br><span class="line">    p.setName(name);</span><br><span class="line">    p.setSubTitle(subTitle);</span><br><span class="line">    p.setOrignalPrice(orignalPrice);</span><br><span class="line">    p.setPromotePrice(promotePrice);</span><br><span class="line">    p.setStock(stock);</span><br><span class="line">    p.setId(id);</span><br><span class="line">    p.setCategory(c);      </span><br><span class="line"> </span><br><span class="line">    productDAO.update(p);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-12-删除功能讲解-v2"><a class="header-anchor" href="#步骤-12-删除功能讲解-v2">¶</a>步骤 12 : 删除功能讲解</h3>
<ol>
<li>在ProductServlet的delete方法中获取id</li>
<li>根据id获取Product对象</li>
<li>借助productDAO删除这个对象对应的数据</li>
<li>客户端跳转到admin_product_list，并带上参数cid</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3805.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    Product p = productDAO.get(id);</span><br><span class="line">    productDAO.delete(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-13-自己做一遍"><a class="header-anchor" href="#步骤-13-自己做一遍">¶</a>步骤 13 : 自己做一遍</h3>
<p>关于产品管理这一块的学习，推荐如下思路：</p>
<ol>
<li>
<p>先下载[可运行项目] ，配置好了跑一边</p>
</li>
<li>
<p>根据接着的讲解，把里面的每一块代码的逻辑，思路，设计思想搞明白，不明不白的在对应页面下提问</p>
</li>
<li>
<p>都理清楚之后，把[可运行项目] 删掉，按照：查询，增加，删除，编辑，修改的顺序自己从头到尾做一遍</p>
</li>
</ol>
<p>只有，能够独立的做出来，才叫做把这些知识点的内容转化为自己的技能</p>
<h2 id="4、产品图片管理"><a class="header-anchor" href="#4、产品图片管理">¶</a>4、产品图片管理</h2>
<h3 id="步骤-1-先运行，看到效果，再学习-v3"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v3">¶</a>步骤 1 : 先运行，看到效果，再学习</h3>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h3 id="步骤-2-模仿和排错-v3"><a class="header-anchor" href="#步骤-2-模仿和排错-v3">¶</a>步骤 2 : 模仿和排错</h3>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h3 id="步骤-3-页面截图-v3"><a class="header-anchor" href="#步骤-3-页面截图-v3">¶</a>步骤 3 : 页面截图</h3>
<p>重启tomcat,通过访问地址</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/tmall/admin_productImage_list?pid=4</span><br></pre></td></tr></table></figure>
<p>可以看到产品图片管理的界面<br>
<strong>注：</strong> 这pid=4是产品的id，根据你的实际运行情况，采取不同的id值</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3810.png" alt></p>
<h3 id="步骤-4-ProductImageServlet类"><a class="header-anchor" href="#步骤-4-ProductImageServlet类">¶</a>步骤 4 : ProductImageServlet类</h3>
<p>ProductImageServlet提供了list,add和delete方法。 edit和update方法直接返回null. 因为界面上没有修改功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.Product;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.ProductImage;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.ProductImageDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.util.ImageUtil;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductImageServlet</span> <span class="keyword">extends</span> <span class="title">BaseBackServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//上传文件的输入流</span></span><br><span class="line">        InputStream is = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//提交上传文件时的其他参数</span></span><br><span class="line">        Map&lt;String,String&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//解析上传</span></span><br><span class="line">        is = parseUpload(request, params);     </span><br><span class="line">         </span><br><span class="line">        <span class="comment">//根据上传的参数生成productImage对象</span></span><br><span class="line">        String type= params.get(<span class="string">"type"</span>);</span><br><span class="line">        <span class="keyword">int</span> pid = Integer.parseInt(params.get(<span class="string">"pid"</span>));</span><br><span class="line">        Product p =productDAO.get(pid);</span><br><span class="line">         </span><br><span class="line">        ProductImage pi = <span class="keyword">new</span> ProductImage();      </span><br><span class="line">        pi.setType(type);</span><br><span class="line">        pi.setProduct(p);</span><br><span class="line">        productImageDAO.add(pi);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//生成文件</span></span><br><span class="line">        String fileName = pi.getId()+ <span class="string">".jpg"</span>;</span><br><span class="line">        String imageFolder;</span><br><span class="line">        String imageFolder_small=<span class="keyword">null</span>;</span><br><span class="line">        String imageFolder_middle=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(ProductImageDAO.type_single.equals(pi.getType()))&#123;</span><br><span class="line">            imageFolder= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle"</span>);</span><br><span class="line">            imageFolder_small= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_small"</span>);</span><br><span class="line">            imageFolder_middle= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_middle"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">             </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            imageFolder= request.getSession().getServletContext().getRealPath(<span class="string">"img/productDetail"</span>);</span><br><span class="line">        File f = <span class="keyword">new</span> File(imageFolder, fileName);</span><br><span class="line">        f.getParentFile().mkdirs();</span><br><span class="line">         </span><br><span class="line">        <span class="comment">// 复制文件</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">null</span>!=is &amp;&amp; <span class="number">0</span>!=is.available())&#123;</span><br><span class="line">                <span class="keyword">try</span>(FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(f))&#123;</span><br><span class="line">                    <span class="keyword">byte</span> b[] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line">                    <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">while</span> (-<span class="number">1</span> != (length = is.read(b))) &#123;</span><br><span class="line">                        fos.write(b, <span class="number">0</span>, length);</span><br><span class="line">                    &#125;</span><br><span class="line">                    fos.flush();</span><br><span class="line">                    <span class="comment">//通过如下代码，把文件保存为jpg格式</span></span><br><span class="line">                    BufferedImage img = ImageUtil.change2jpg(f);</span><br><span class="line">                    ImageIO.write(img, <span class="string">"jpg"</span>, f);      </span><br><span class="line">                     </span><br><span class="line">                    <span class="keyword">if</span>(ProductImageDAO.type_single.equals(pi.getType()))&#123;</span><br><span class="line">                        File f_small = <span class="keyword">new</span> File(imageFolder_small, fileName);</span><br><span class="line">                        File f_middle = <span class="keyword">new</span> File(imageFolder_middle, fileName);</span><br><span class="line"> </span><br><span class="line">                        ImageUtil.resizeImage(f, <span class="number">56</span>, <span class="number">56</span>, f_small);</span><br><span class="line">                        ImageUtil.resizeImage(f, <span class="number">217</span>, <span class="number">190</span>, f_middle);</span><br><span class="line">                    &#125;</span><br><span class="line">                         </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_productImage_list?pid="</span>+p.getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        ProductImage pi = productImageDAO.get(id);</span><br><span class="line">        productImageDAO.delete(id);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">if</span>(ProductImageDAO.type_single.equals(pi.getType()))&#123;</span><br><span class="line">            String imageFolder_single= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle"</span>);</span><br><span class="line">            String imageFolder_small= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_small"</span>);</span><br><span class="line">            String imageFolder_middle= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_middle"</span>);</span><br><span class="line">             </span><br><span class="line">            File f_single =<span class="keyword">new</span> File(imageFolder_single,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_single.delete();</span><br><span class="line">            File f_small =<span class="keyword">new</span> File(imageFolder_small,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_small.delete();</span><br><span class="line">            File f_middle =<span class="keyword">new</span> File(imageFolder_middle,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_middle.delete();</span><br><span class="line">             </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            String imageFolder_detail= request.getSession().getServletContext().getRealPath(<span class="string">"img/productDetail"</span>);</span><br><span class="line">            File f_detail =<span class="keyword">new</span> File(imageFolder_detail,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_detail.delete();         </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_productImage_list?pid="</span>+pi.getProduct().getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;       </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;   </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pid = Integer.parseInt(request.getParameter(<span class="string">"pid"</span>));</span><br><span class="line">        Product p =productDAO.get(pid);</span><br><span class="line">        List&lt;ProductImage&gt; pisSingle = productImageDAO.list(p, ProductImageDAO.type_single);</span><br><span class="line">        List&lt;ProductImage&gt; pisDetail = productImageDAO.list(p, ProductImageDAO.type_detail);</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">        request.setAttribute(<span class="string">"pisSingle"</span>, pisSingle);</span><br><span class="line">        request.setAttribute(<span class="string">"pisDetail"</span>, pisDetail);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/listProductImage.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-5-web-xml"><a class="header-anchor" href="#步骤-5-web-xml">¶</a>步骤 5 : web.xml</h3>
<p>增加了对/productImageServlet的映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/productImageServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.CategoryServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ProductServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/productServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/categoryServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.PropertyServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/propertyServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.BackServletFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-listProductImage-jsp"><a class="header-anchor" href="#步骤-6-listProductImage-jsp">¶</a>步骤 6 : listProductImage.jsp</h3>
<p>增加listProductImage.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function()&#123;</span><br><span class="line">    $(<span class="string">".addFormSingle"</span>).submit(function()&#123;</span><br><span class="line">        <span class="keyword">if</span>(checkEmpty(<span class="string">"filepathSingle"</span>,<span class="string">"图片文件"</span>))&#123;</span><br><span class="line">            $(<span class="string">"#filepathSingle"</span>).value(<span class="string">""</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">".addFormDetail"</span>).submit(function()&#123;</span><br><span class="line">        <span class="keyword">if</span>(checkEmpty(<span class="string">"filepathDetail"</span>,<span class="string">"图片文件"</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;产品图片管理&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">        &lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href="admin_category_list"&gt;所有分类&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href="admin_product_list?cid=$&#123;p.category.id&#125;"&gt;$&#123;p.category.name&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">          &lt;li class="active"&gt;$&#123;p.name&#125;&lt;/li&gt;</span><br><span class="line">          &lt;li class="active"&gt;产品图片管理&lt;/li&gt;</span><br><span class="line">        &lt;/ol&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addPictureTable"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td <span class="class"><span class="keyword">class</span></span>=<span class="string">"addPictureTableTD"</span>&gt;</span><br><span class="line">              &lt;div&gt;</span><br><span class="line">                &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning addPictureDiv"</span>&gt;</span><br><span class="line">                    &lt;div class="panel-heading"&gt;新增产品&lt;b class="text-primary"&gt; 单个 &lt;/b&gt;图片&lt;/div&gt;</span><br><span class="line">                      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">                            &lt;form method=<span class="string">"post"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"addFormSingle"</span> action=<span class="string">"admin_productImage_add"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">                                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">                                    &lt;tr&gt;</span><br><span class="line">                                        &lt;td&gt;请选择本地图片 尺寸400X400 为佳&lt;/td&gt;</span><br><span class="line">                                    &lt;/tr&gt;</span><br><span class="line">                                    &lt;tr&gt;</span><br><span class="line">                                        &lt;td&gt;</span><br><span class="line">                                            &lt;input id=<span class="string">"filepathSingle"</span> type=<span class="string">"file"</span> name=<span class="string">"filepath"</span> /&gt;</span><br><span class="line">                                        &lt;/td&gt;</span><br><span class="line">                                    &lt;/tr&gt;</span><br><span class="line">                                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                                        &lt;td align=<span class="string">"center"</span>&gt;</span><br><span class="line">                                            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"type"</span> value=<span class="string">"type_single"</span> /&gt;</span><br><span class="line">                                            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"pid"</span> value=<span class="string">"$&#123;p.id&#125;"</span> /&gt;</span><br><span class="line">                                            &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">                                        &lt;/td&gt;</span><br><span class="line">                                    &lt;/tr&gt;</span><br><span class="line">                                &lt;/table&gt;</span><br><span class="line">                            &lt;/form&gt;</span><br><span class="line">                      &lt;/div&gt;</span><br><span class="line">                  &lt;/div&gt;           </span><br><span class="line">                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover  table-condensed"</span>&gt;</span><br><span class="line">                    &lt;thead&gt;</span><br><span class="line">                        &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                            &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                            &lt;th&gt;产品单个图片缩略图&lt;/th&gt;</span><br><span class="line">                            &lt;th&gt;删除&lt;/th&gt;</span><br><span class="line">                        &lt;/tr&gt;</span><br><span class="line">                    &lt;/thead&gt;</span><br><span class="line">                    &lt;tbody&gt;</span><br><span class="line">                        &lt;c:forEach items=<span class="string">"$&#123;pisSingle&#125;"</span> <span class="keyword">var</span>=<span class="string">"pi"</span>&gt;</span><br><span class="line">                            &lt;tr&gt;</span><br><span class="line">                                &lt;td&gt;$&#123;pi.id&#125;&lt;/td&gt;</span><br><span class="line">                                &lt;td&gt;</span><br><span class="line">                                &lt;a title="点击查看原图" href="img/productSingle/$&#123;pi.id&#125;.jpg"&gt;&lt;img height="50px" src="img/productSingle/$&#123;pi.id&#125;.jpg"&gt;&lt;/a&gt; </span><br><span class="line">                                &lt;/td&gt;</span><br><span class="line">                                &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">                                    href=<span class="string">"admin_productImage_delete?id=$&#123;pi.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                        class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">         </span><br><span class="line">                            &lt;/tr&gt;</span><br><span class="line">                        &lt;/c:forEach&gt;</span><br><span class="line">                    &lt;/tbody&gt;   </span><br><span class="line">                &lt;/table&gt; </span><br><span class="line">                         </span><br><span class="line">              &lt;/div&gt;         </span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">            &lt;td <span class="class"><span class="keyword">class</span></span>=<span class="string">"addPictureTableTD"</span>&gt;</span><br><span class="line">              &lt;div&gt;</span><br><span class="line">                 </span><br><span class="line">                &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel panel-warning addPictureDiv"</span>&gt;</span><br><span class="line">                    &lt;div class="panel-heading"&gt;新增产品&lt;b class="text-primary"&gt; 详情 &lt;/b&gt;图片&lt;/div&gt;</span><br><span class="line">                      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"panel-body"</span>&gt;</span><br><span class="line">                            &lt;form method=<span class="string">"post"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"addFormDetail"</span> action=<span class="string">"admin_productImage_add"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">                                &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">                                    &lt;tr&gt;</span><br><span class="line">                                        &lt;td&gt;请选择本地图片 宽度790  为佳&lt;/td&gt;</span><br><span class="line">                                    &lt;/tr&gt;</span><br><span class="line">                                    &lt;tr&gt;</span><br><span class="line">                                        &lt;td&gt;</span><br><span class="line">                                            &lt;input id=<span class="string">"filepathDetail"</span>  type=<span class="string">"file"</span> name=<span class="string">"filepath"</span> /&gt;</span><br><span class="line">                                        &lt;/td&gt;</span><br><span class="line">                                    &lt;/tr&gt;</span><br><span class="line">                                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">                                        &lt;td align=<span class="string">"center"</span>&gt;</span><br><span class="line">                                            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"type"</span> value=<span class="string">"type_detail"</span> /&gt;</span><br><span class="line">                                            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"pid"</span> value=<span class="string">"$&#123;p.id&#125;"</span> /&gt;</span><br><span class="line">                                            &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">                                        &lt;/td&gt;</span><br><span class="line">                                    &lt;/tr&gt;</span><br><span class="line">                                &lt;/table&gt;</span><br><span class="line">                            &lt;/form&gt;</span><br><span class="line">                      &lt;/div&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                  &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover  table-condensed"</span>&gt;</span><br><span class="line">                        &lt;thead&gt;</span><br><span class="line">                            &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                                &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                                &lt;th&gt;产品详情图片缩略图&lt;/th&gt;</span><br><span class="line">                                &lt;th&gt;删除&lt;/th&gt;</span><br><span class="line">                            &lt;/tr&gt;</span><br><span class="line">                        &lt;/thead&gt;</span><br><span class="line">                        &lt;tbody&gt;</span><br><span class="line">                            &lt;c:forEach items=<span class="string">"$&#123;pisDetail&#125;"</span> <span class="keyword">var</span>=<span class="string">"pi"</span>&gt;</span><br><span class="line">                                &lt;tr&gt;</span><br><span class="line">                                    &lt;td&gt;$&#123;pi.id&#125;&lt;/td&gt;</span><br><span class="line">                                    &lt;td&gt;</span><br><span class="line">                                        &lt;a title="点击查看原图" href="img/productDetail/$&#123;pi.id&#125;.jpg"&gt;&lt;img height="50px" src="img/productDetail/$&#123;pi.id&#125;.jpg"&gt;&lt;/a&gt;</span><br><span class="line">                                    &lt;/td&gt;</span><br><span class="line">                                    &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">                                        href=<span class="string">"admin_productImage_delete?id=$&#123;pi.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                                            class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">             </span><br><span class="line">                                &lt;/tr&gt;</span><br><span class="line">                            &lt;/c:forEach&gt;</span><br><span class="line">                        &lt;/tbody&gt;   </span><br><span class="line">                    &lt;/table&gt;                         </span><br><span class="line">              &lt;/div&gt;         </span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminFooter.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-查询功能讲解"><a class="header-anchor" href="#步骤-7-查询功能讲解">¶</a>步骤 7 : 查询功能讲解</h3>
<p>通过产品页面的图片管理访问ProductImageServlet的list()方法</p>
<ol>
<li>获取参数pid</li>
<li>根据pid获取Product对象</li>
<li>根据product对象获取单个图片的集合pisSingle</li>
<li>根据product对象获取详情图片的集合pisDetail</li>
<li>把product 对象，pisSingle ，pisDetail放在request上</li>
<li>服务端跳转到admin/listProductImage.jsp页面</li>
<li>在listProductImage.jsp，使用c:forEach 遍历pisSingle</li>
<li>在listProductImage.jsp，使用c:forEach 遍历pisDetail</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3811.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pid = Integer.parseInt(request.getParameter(<span class="string">"pid"</span>));</span><br><span class="line">    Product p =productDAO.get(pid);</span><br><span class="line">    List&lt;ProductImage&gt; pisSingle = productImageDAO.list(p, ProductImageDAO.type_single);</span><br><span class="line">    List&lt;ProductImage&gt; pisDetail = productImageDAO.list(p, ProductImageDAO.type_detail);</span><br><span class="line">     </span><br><span class="line">    request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">    request.setAttribute(<span class="string">"pisSingle"</span>, pisSingle);</span><br><span class="line">    request.setAttribute(<span class="string">"pisDetail"</span>, pisDetail);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/listProductImage.jsp"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">"$&#123;pisSingle&#125;"</span> <span class="keyword">var</span>=<span class="string">"pi"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;pi.id&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">        &lt;a title="点击查看原图" href="img/productSingle/$&#123;pi.id&#125;.jpg"&gt;&lt;img height="50px" src="img/productSingle/$&#123;pi.id&#125;.jpg"&gt;&lt;/a&gt; </span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">            href=<span class="string">"admin_productImage_delete?id=$&#123;pi.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">"$&#123;pisDetail&#125;"</span> <span class="keyword">var</span>=<span class="string">"pi"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;pi.id&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">            &lt;a title="点击查看原图" href="img/productDetail/$&#123;pi.id&#125;.jpg"&gt;&lt;img height="50px" src="img/productDetail/$&#123;pi.id&#125;.jpg"&gt;&lt;/a&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;a deleteLink=<span class="string">"true"</span></span><br><span class="line">            href=<span class="string">"admin_productImage_delete?id=$&#123;pi.id&#125;"</span>&gt;&lt;span</span><br><span class="line">                class="     glyphicon glyphicon-trash"&gt;&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-8-增加功能讲解"><a class="header-anchor" href="#步骤-8-增加功能讲解">¶</a>步骤 8 : 增加功能讲解</h3>
<p>增加产品图片分单个和详情两种，其区别在于增加的提交的type类型不一样。<br>
这里就对单个的进行讲解，详情图片的处理同理。<br>
首先， 在listProductImage.jsp准备一个form，提交到admin_productImage_add</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"addFormSingle"</span> action=<span class="string">"admin_productImage_add"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>接着在ProductImageServlet的add()方法中进行处理</p>
<ol>
<li>parseUpload 获取上传文件的输入流</li>
<li>parseUpload 方法会修改params 参数，并且把浏览器提交的type,pid信息放在其中</li>
<li>从params 中取出type,pid信息，并根据这个type,pid，借助productImageDAO，向数据库中插入数据。</li>
<li>根据request.getSession().getServletContext().getRealPath( “img/productSingle”)，定位到存放分类图片的目录<br>
除了productSingle，还有productSingle_middle和productSingle_small。 因为每上传一张图片，都会有对应的正常，中等和小的三种大小图片，并且放在3个不同的目录下</li>
<li>文件命名以保存到数据库的分类对象的id+&quot;.jpg&quot;的格式命名</li>
<li>根据步骤1获取的输入流，把浏览器提交的文件，复制到目标文件</li>
<li>借助ImageUtil.change2jpg()方法把格式真正转化为jpg，而不仅仅是后缀名为.jpg</li>
<li>再借助ImageUtil.resizeImage把正常大小的图片，改变大小之后，分别复制到productSingle_middle和productSingle_small目录下。</li>
<li>处理完毕之后，客户端条跳转到admin_productImage_list?pid=，并带上pid。</li>
</ol>
<p>详情图片做的是一样的事情，区别在于复制到目录productDetail下，并且不需要改变大小。</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3812.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"addFormSingle"</span> action=<span class="string">"admin_productImage_add"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">    &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"addTable"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;请选择本地图片 尺寸400X400 为佳&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;input id=<span class="string">"filepathSingle"</span> type=<span class="string">"file"</span> name=<span class="string">"filepath"</span> /&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"submitTR"</span>&gt;</span><br><span class="line">            &lt;td align=<span class="string">"center"</span>&gt;</span><br><span class="line">                &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"type"</span> value=<span class="string">"type_single"</span> /&gt;</span><br><span class="line">                &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"pid"</span> value=<span class="string">"$&#123;p.id&#125;"</span> /&gt;</span><br><span class="line">                &lt;button type="submit" class="btn btn-success"&gt;提 交&lt;/button&gt;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//上传文件的输入流</span></span><br><span class="line">        InputStream is = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">//提交上传文件时的其他参数</span></span><br><span class="line">        Map&lt;String,String&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//解析上传</span></span><br><span class="line">        is = parseUpload(request, params);     </span><br><span class="line">         </span><br><span class="line">        <span class="comment">//根据上传的参数生成productImage对象</span></span><br><span class="line">        String type= params.get(<span class="string">"type"</span>);</span><br><span class="line">        <span class="keyword">int</span> pid = Integer.parseInt(params.get(<span class="string">"pid"</span>));</span><br><span class="line">        Product p =productDAO.get(pid);</span><br><span class="line">         </span><br><span class="line">        ProductImage pi = <span class="keyword">new</span> ProductImage();      </span><br><span class="line">        pi.setType(type);</span><br><span class="line">        pi.setProduct(p);</span><br><span class="line">        productImageDAO.add(pi);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//生成文件</span></span><br><span class="line">        String fileName = pi.getId()+ <span class="string">".jpg"</span>;</span><br><span class="line">        String imageFolder;</span><br><span class="line">        String imageFolder_small=<span class="keyword">null</span>;</span><br><span class="line">        String imageFolder_middle=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(ProductImageDAO.type_single.equals(pi.getType()))&#123;</span><br><span class="line">            imageFolder= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle"</span>);</span><br><span class="line">            imageFolder_small= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_small"</span>);</span><br><span class="line">            imageFolder_middle= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_middle"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">             </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            imageFolder= request.getSession().getServletContext().getRealPath(<span class="string">"img/productDetail"</span>);</span><br><span class="line">        File f = <span class="keyword">new</span> File(imageFolder, fileName);</span><br><span class="line">        f.getParentFile().mkdirs();</span><br><span class="line">         </span><br><span class="line">        <span class="comment">// 复制文件</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">null</span>!=is &amp;&amp; <span class="number">0</span>!=is.available())&#123;</span><br><span class="line">                <span class="keyword">try</span>(FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(f))&#123;</span><br><span class="line">                    <span class="keyword">byte</span> b[] = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line">                    <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">while</span> (-<span class="number">1</span> != (length = is.read(b))) &#123;</span><br><span class="line">                        fos.write(b, <span class="number">0</span>, length);</span><br><span class="line">                    &#125;</span><br><span class="line">                    fos.flush();</span><br><span class="line">                    <span class="comment">//通过如下代码，把文件保存为jpg格式</span></span><br><span class="line">                    BufferedImage img = ImageUtil.change2jpg(f);</span><br><span class="line">                    ImageIO.write(img, <span class="string">"jpg"</span>, f);      </span><br><span class="line">                     </span><br><span class="line">                    <span class="keyword">if</span>(ProductImageDAO.type_single.equals(pi.getType()))&#123;</span><br><span class="line">                        File f_small = <span class="keyword">new</span> File(imageFolder_small, fileName);</span><br><span class="line">                        File f_middle = <span class="keyword">new</span> File(imageFolder_middle, fileName);</span><br><span class="line"> </span><br><span class="line">                        ImageUtil.resizeImage(f, <span class="number">56</span>, <span class="number">56</span>, f_small);</span><br><span class="line">                        ImageUtil.resizeImage(f, <span class="number">217</span>, <span class="number">190</span>, f_middle);</span><br><span class="line">                    &#125;</span><br><span class="line">                         </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_productImage_list?pid="</span>+p.getId();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-9-删除功能讲解"><a class="header-anchor" href="#步骤-9-删除功能讲解">¶</a>步骤 9 : 删除功能讲解</h3>
<p>点击删除超链，进入ProductImageServlet的delete方法</p>
<ol>
<li>获取id</li>
<li>根据id获取ProductImage 对象pi</li>
<li>借助productImageDAO，删除数据</li>
<li>如果是单个图片，那么删除3张正常，中等，小号图片</li>
<li>如果是详情图片，那么删除一张图片</li>
<li>客户端跳转到admin_productImage_list地址</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3813.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        ProductImage pi = productImageDAO.get(id);</span><br><span class="line">        productImageDAO.delete(id);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">if</span>(ProductImageDAO.type_single.equals(pi.getType()))&#123;</span><br><span class="line">            String imageFolder_single= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle"</span>);</span><br><span class="line">            String imageFolder_small= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_small"</span>);</span><br><span class="line">            String imageFolder_middle= request.getSession().getServletContext().getRealPath(<span class="string">"img/productSingle_middle"</span>);</span><br><span class="line">             </span><br><span class="line">            File f_single =<span class="keyword">new</span> File(imageFolder_single,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_single.delete();</span><br><span class="line">            File f_small =<span class="keyword">new</span> File(imageFolder_small,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_small.delete();</span><br><span class="line">            File f_middle =<span class="keyword">new</span> File(imageFolder_middle,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_middle.delete();</span><br><span class="line">             </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            String imageFolder_detail= request.getSession().getServletContext().getRealPath(<span class="string">"img/productDetail"</span>);</span><br><span class="line">            File f_detail =<span class="keyword">new</span> File(imageFolder_detail,pi.getId()+<span class="string">".jpg"</span>);</span><br><span class="line">            f_detail.delete();         </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_productImage_list?pid="</span>+pi.getProduct().getId();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-10-编辑和修改"><a class="header-anchor" href="#步骤-10-编辑和修改">¶</a>步骤 10 : 编辑和修改</h3>
<p>因为只有图片，就不提供编辑和修改功能。 要做修改，先删除，再增加即可</p>
<h2 id="5、产品属性值设置"><a class="header-anchor" href="#5、产品属性值设置">¶</a>5、产品属性值设置</h2>
<h3 id="步骤-1-先运行，看到效果，再学习-v4"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v4">¶</a>步骤 1 : 先运行，看到效果，再学习</h3>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h3 id="步骤-2-模仿和排错-v4"><a class="header-anchor" href="#步骤-2-模仿和排错-v4">¶</a>步骤 2 : 模仿和排错</h3>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h3 id="步骤-3-页面截图-v4"><a class="header-anchor" href="#步骤-3-页面截图-v4">¶</a>步骤 3 : 页面截图</h3>
<p>重启tomcat后访问地址：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/tmall/admin_product_editPropertyValue?id=4</span><br></pre></td></tr></table></figure>
<p>可以看到产品属性设置的界面<br>
<strong>注：</strong> 这pid=4是产品的id，根据你的实际运行情况，采取不同的id值</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3820.png" alt></p>
<h3 id="步骤-4-PropertyValueServlet"><a class="header-anchor" href="#步骤-4-PropertyValueServlet">¶</a>步骤 4 : PropertyValueServlet</h3>
<p>并没有PropertyValueServlet类，对于PropertyValue编辑和修改的支持放了在ProductServlet中进行：<br>
主要是editPropertyValue、updatePropertyValue这两个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.Category;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.Product;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.Property;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.PropertyValue;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServlet</span> <span class="keyword">extends</span> <span class="title">BaseBackServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line">         </span><br><span class="line">        String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        String subTitle= request.getParameter(<span class="string">"subTitle"</span>);</span><br><span class="line">        <span class="keyword">float</span> orignalPrice = Float.parseFloat(request.getParameter(<span class="string">"orignalPrice"</span>));</span><br><span class="line">        <span class="keyword">float</span> promotePrice = Float.parseFloat(request.getParameter(<span class="string">"promotePrice"</span>));</span><br><span class="line">        <span class="keyword">int</span> stock = Integer.parseInt(request.getParameter(<span class="string">"stock"</span>));</span><br><span class="line"> </span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line"> </span><br><span class="line">        p.setCategory(c);</span><br><span class="line">        p.setName(name);</span><br><span class="line">        p.setSubTitle(subTitle);</span><br><span class="line">        p.setOrignalPrice(orignalPrice);</span><br><span class="line">        p.setPromotePrice(promotePrice);</span><br><span class="line">        p.setStock(stock);</span><br><span class="line">         </span><br><span class="line">        productDAO.add(p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+cid;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Product p = productDAO.get(id);</span><br><span class="line">        productDAO.delete(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Product p = productDAO.get(id);</span><br><span class="line">        request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/editProduct.jsp"</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">editPropertyValue</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Product p = productDAO.get(id);</span><br><span class="line">        request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">         </span><br><span class="line">        propertyValueDAO.init(p);</span><br><span class="line">         </span><br><span class="line">        List&lt;PropertyValue&gt; pvs = propertyValueDAO.list(p.getId());</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"pvs"</span>, pvs);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/editProductValue.jsp"</span>;       </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updatePropertyValue</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pvid = Integer.parseInt(request.getParameter(<span class="string">"pvid"</span>));</span><br><span class="line">        String value = request.getParameter(<span class="string">"value"</span>);</span><br><span class="line">         </span><br><span class="line">        PropertyValue pv =propertyValueDAO.get(pvid);</span><br><span class="line">        pv.setValue(value);</span><br><span class="line">        propertyValueDAO.update(pv);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"%success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        <span class="keyword">int</span> stock = Integer.parseInt(request.getParameter(<span class="string">"stock"</span>));</span><br><span class="line">        <span class="keyword">float</span> orignalPrice = Float.parseFloat(request.getParameter(<span class="string">"orignalPrice"</span>));</span><br><span class="line">        <span class="keyword">float</span> promotePrice = Float.parseFloat(request.getParameter(<span class="string">"promotePrice"</span>));</span><br><span class="line">        String subTitle= request.getParameter(<span class="string">"subTitle"</span>);</span><br><span class="line">        String name= request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">         </span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line"> </span><br><span class="line">        p.setName(name);</span><br><span class="line">        p.setSubTitle(subTitle);</span><br><span class="line">        p.setOrignalPrice(orignalPrice);</span><br><span class="line">        p.setPromotePrice(promotePrice);</span><br><span class="line">        p.setStock(stock);</span><br><span class="line">        p.setId(id);</span><br><span class="line">        p.setCategory(c);      </span><br><span class="line"> </span><br><span class="line">        productDAO.update(p);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_product_list?cid="</span>+p.getCategory().getId();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cid = Integer.parseInt(request.getParameter(<span class="string">"cid"</span>));</span><br><span class="line">        Category c = categoryDAO.get(cid);</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; ps = productDAO.list(cid, page.getStart(),page.getCount());</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">int</span> total = productDAO.getTotal(cid);</span><br><span class="line">        page.setTotal(total);</span><br><span class="line">        page.setParam(<span class="string">"&amp;cid="</span>+c.getId());</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"ps"</span>, ps);</span><br><span class="line">        request.setAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/listProduct.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-5-web-xml-v2"><a class="header-anchor" href="#步骤-5-web-xml-v2">¶</a>步骤 5 : web.xml</h3>
<p>因为没有ProductValueServlet类，所以就没有新增加映射</p>
<h3 id="步骤-6-editProductValue-jsp"><a class="header-anchor" href="#步骤-6-editProductValue-jsp">¶</a>步骤 6 : editProductValue.jsp</h3>
<p>增加editProductValue.jsp</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;编辑产品属性值&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function() &#123;</span><br><span class="line">    $(<span class="string">"input.pvValue"</span>).keyup(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> value = $(<span class="keyword">this</span>).val();</span><br><span class="line">        <span class="keyword">var</span> page = <span class="string">"admin_product_updatePropertyValue"</span>;</span><br><span class="line">        <span class="keyword">var</span> pvid = $(<span class="keyword">this</span>).attr(<span class="string">"pvid"</span>);</span><br><span class="line">        <span class="keyword">var</span> parentSpan = $(<span class="keyword">this</span>).parent(<span class="string">"span"</span>);</span><br><span class="line">        parentSpan.css(<span class="string">"border"</span>,<span class="string">"1px solid yellow"</span>);</span><br><span class="line">        $.post(</span><br><span class="line">                page,</span><br><span class="line">                &#123;<span class="string">"value"</span>:value,<span class="string">"pvid"</span>:pvid&#125;,</span><br><span class="line">                function(result)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="string">"success"</span>==result)</span><br><span class="line">                        parentSpan.css(<span class="string">"border"</span>,<span class="string">"1px solid green"</span>);</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        parentSpan.css(<span class="string">"border"</span>,<span class="string">"1px solid red"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            );     </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">    &lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"breadcrumb"</span>&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_category_list"&gt;所有分类&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li&gt;&lt;a href="admin_product_list?cid=$&#123;p.category.id&#125;"&gt;$&#123;p.category.name&#125;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">      &lt;li class="active"&gt;$&#123;p.name&#125;&lt;/li&gt;</span><br><span class="line">      &lt;li class="active"&gt;编辑产品属性&lt;/li&gt;</span><br><span class="line">    &lt;/ol&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"editPVDiv"</span>&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;pvs&#125;"</span> <span class="keyword">var</span>=<span class="string">"pv"</span>&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"eachPV"</span>&gt;</span><br><span class="line">                &lt;span class="pvName" &gt;$&#123;pv.property.name&#125;&lt;/span&gt;</span><br><span class="line">                &lt;span class="pvValue"&gt;&lt;input class="pvValue" pvid="$&#123;pv.id&#125;" type="text" value="$&#123;pv.value&#125;"&gt;&lt;/span&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;div style="clear:both"&gt;&lt;/div&gt; </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-编辑功能讲解"><a class="header-anchor" href="#步骤-7-编辑功能讲解">¶</a>步骤 7 : 编辑功能讲解</h3>
<p>通过产品管理界面的设置属性，跳到编辑页面<br>
调用ProductServlet的editPropertyValue方法：</p>
<ol>
<li>获取参数id</li>
<li>根据id获取Product对象p</li>
<li>初始化属性值： propertyValueDAO.init§。 因为如果是第一次访问，这些属性值是不存在的。</li>
<li>根据Product的id，获取产品对应的属性值集合</li>
<li>属性值集合放在request的 “pvs” 属性上</li>
<li>服务端跳转到admin/editProductValue.jsp 上</li>
<li>在editProductValue.jsp上，用c:forEach遍历出这些属性值</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3824.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editPropertyValue</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    Product p = productDAO.get(id);</span><br><span class="line">    request.setAttribute(<span class="string">"p"</span>, p);</span><br><span class="line">     </span><br><span class="line">    List&lt;Property&gt; pts= propertyDAO.list(p.getCategory().getId());</span><br><span class="line">    propertyValueDAO.init(p);</span><br><span class="line">     </span><br><span class="line">    List&lt;PropertyValue&gt; pvs = propertyValueDAO.list(p.getId());</span><br><span class="line">     </span><br><span class="line">    request.setAttribute(<span class="string">"pvs"</span>, pvs);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/editProductValue.jsp"</span>;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-8-修改功能讲解"><a class="header-anchor" href="#步骤-8-修改功能讲解">¶</a>步骤 8 : 修改功能讲解</h3>
<p>修改功能采用的是[使用post方式提交ajax]的异步调用方式</p>
<ol>
<li>是监听输入框上的keyup事件</li>
<li>获取输入框里的值</li>
<li>获取输入框上的自定义属性pvid，这就是当前PropertyValue对应的id</li>
<li>把边框的颜色修改为黄色，表示正在修改的意思</li>
<li>借助JQuery的ajax函数 $.post，把id和值，提交到admin_product_updatePropertyValue</li>
<li>admin_product_updatePropertyValue导致ProductServlet的updatePropertyValue方法被调用<br>
6.1 获取pvid<br>
6.2 获取value<br>
6.3 基于pvid和value,更新PropertyValue对象<br>
6.4 返回&quot;%success&quot;</li>
<li>BaseBackServlet根据返回值&quot;%success&quot;，直接输出字符串&quot;success&quot; 到浏览器</li>
<li>浏览器判断如果返回值是&quot;success&quot;,那么就把边框设置为绿色，表示修改成功，否则设置为红色，表示修改失败</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3825.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"input.pvValue"</span>).keyup(function()&#123;</span><br><span class="line">    <span class="keyword">var</span> value = $(<span class="keyword">this</span>).val();</span><br><span class="line">    <span class="keyword">var</span> page = <span class="string">"admin_product_updatePropertyValue"</span>;</span><br><span class="line">    <span class="keyword">var</span> pvid = $(<span class="keyword">this</span>).attr(<span class="string">"pvid"</span>);</span><br><span class="line">    <span class="keyword">var</span> parentSpan = $(<span class="keyword">this</span>).parent(<span class="string">"span"</span>);</span><br><span class="line">    parentSpan.css(<span class="string">"border"</span>,<span class="string">"1px solid yellow"</span>);</span><br><span class="line">    $.post(</span><br><span class="line">            page,</span><br><span class="line">            &#123;<span class="string">"value"</span>:value,<span class="string">"pvid"</span>:pvid&#125;,</span><br><span class="line">            function(result)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="string">"success"</span>==result)</span><br><span class="line">                    parentSpan.css(<span class="string">"border"</span>,<span class="string">"1px solid green"</span>);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    parentSpan.css(<span class="string">"border"</span>,<span class="string">"1px solid red"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        );     </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">updatePropertyValue</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pvid = Integer.parseInt(request.getParameter(<span class="string">"pvid"</span>));</span><br><span class="line">    String value = request.getParameter(<span class="string">"value"</span>);</span><br><span class="line">     </span><br><span class="line">    PropertyValue pv =propertyValueDAO.get(pvid);</span><br><span class="line">    pv.setValue(value);</span><br><span class="line">    propertyValueDAO.update(pv);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"%success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-9-删除，增加功能不需要"><a class="header-anchor" href="#步骤-9-删除，增加功能不需要">¶</a>步骤 9 : 删除，增加功能不需要</h3>
<p>属性的维护是在分类中进行，这里仅仅做值的设置。 不提供删除和增加功能</p>
<h2 id="6、用户管理"><a class="header-anchor" href="#6、用户管理">¶</a>6、用户管理</h2>
<h3 id="步骤-1-先运行，看到效果，再学习-v5"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v5">¶</a>步骤 1 : 先运行，看到效果，再学习</h3>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h3 id="步骤-2-模仿和排错-v5"><a class="header-anchor" href="#步骤-2-模仿和排错-v5">¶</a>步骤 2 : 模仿和排错</h3>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h3 id="步骤-3-准备数据"><a class="header-anchor" href="#步骤-3-准备数据">¶</a>步骤 3 : 准备数据</h3>
<p>因为用户信息是前台注册的时候增加的，截至目前为止，还没有讲到前台的功能。所以需要手动在数据库中增加数据，以便于观察运行的效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">insert into user values(null,&#39;测试用户1&#39;,&#39;password1&#39;);</span><br><span class="line">insert into user values(null,&#39;测试用户2&#39;,&#39;password2&#39;);</span><br><span class="line">insert into user values(null,&#39;测试用户3&#39;,&#39;password3&#39;);</span><br><span class="line">insert into user values(null,&#39;测试用户4&#39;,&#39;password4&#39;);</span><br><span class="line">insert into user values(null,&#39;测试用户5&#39;,&#39;password5&#39;);</span><br></pre></td></tr></table></figure>
<h3 id="步骤-4-页面截图"><a class="header-anchor" href="#步骤-4-页面截图">¶</a>步骤 4 : 页面截图</h3>
<p>用户这部分做的比较简单，只有查询，为什么呢？</p>
<ol>
<li>用户的增加，是交由前台注册行为产生的，后台不需要自己进行增加</li>
<li>用户信息不能删除。 用户信息是最重要的业务信息，不可以删除</li>
<li>用户资料的修改，也应该有前台用户自己进行，而不是后台操作。比如修改密码</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3828.png" alt></p>
<h3 id="步骤-5-UserServlet"><a class="header-anchor" href="#步骤-5-UserServlet">¶</a>步骤 5 : UserServlet</h3>
<p>UserServlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.util.HtmlUtils;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.User;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> <span class="keyword">extends</span> <span class="title">BaseBackServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;       </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; us = userDAO.list(page.getStart(),page.getCount());</span><br><span class="line">        <span class="keyword">int</span> total = userDAO.getTotal();</span><br><span class="line">        page.setTotal(total);</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"us"</span>, us);</span><br><span class="line">        request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/listUser.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-web-xml-v3"><a class="header-anchor" href="#步骤-6-web-xml-v3">¶</a>步骤 6 : web.xml</h3>
<p>增加对/userServlet的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UserServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.UserServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UserServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/userServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/productImageServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.CategoryServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ProductServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/productServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/categoryServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.PropertyServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/propertyServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.BackServletFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-listUser-jsp"><a class="header-anchor" href="#步骤-7-listUser-jsp">¶</a>步骤 7 : listUser.jsp</h3>
<p>listUser.jsp页面</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;用户管理&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">    &lt;h1 class="label label-info" &gt;用户管理&lt;/h1&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"listDataTableDiv"</span>&gt;</span><br><span class="line">        &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover  table-condensed"</span>&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                    &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;用户名称&lt;/th&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;us&#125;"</span> <span class="keyword">var</span>=<span class="string">"u"</span>&gt;</span><br><span class="line">                 </span><br><span class="line">                &lt;tr&gt;</span><br><span class="line">                    &lt;td&gt;$&#123;u.id&#125;&lt;/td&gt;</span><br><span class="line">                    &lt;td&gt;$&#123;u.name&#125;&lt;/td&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pageDiv"</span>&gt;</span><br><span class="line">        &lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminPage.jsp"</span> %&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminFooter.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-8-查询功能讲解-v3"><a class="header-anchor" href="#步骤-8-查询功能讲解-v3">¶</a>步骤 8 : 查询功能讲解</h3>
<p>点击后台管理上方导航中的 用户管理，进入用户查询界面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/tmall/admin_user_list</span></span><br></pre></td></tr></table></figure>
<p>UserServlet的list方法被调用</p>
<ol>
<li>借助userDAO查询用户集合</li>
<li>设置分页信息</li>
<li>把用户集合设置到request的&quot;us&quot;属性上</li>
<li>把分页对象设置到request的&quot;page&quot;属性上</li>
<li>服务端跳转到admin/listUser.jsp页面</li>
<li>在listUser.jsp用c:forEach遍历&quot;us&quot;集合</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3832.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    List&lt;User&gt; us = userDAO.list(page.getStart(),page.getCount());</span><br><span class="line">    <span class="keyword">int</span> total = userDAO.getTotal();</span><br><span class="line">    page.setTotal(total);</span><br><span class="line">     </span><br><span class="line">    request.setAttribute(<span class="string">"us"</span>, us);</span><br><span class="line">    request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/listUser.jsp"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">"$&#123;us&#125;"</span> <span class="keyword">var</span>=<span class="string">"u"</span>&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">    &lt;td&gt;$&#123;u.id&#125;&lt;/td&gt;</span><br><span class="line">    &lt;td&gt;$&#123;u.name&#125;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-9-增加，删除，修改功能"><a class="header-anchor" href="#步骤-9-增加，删除，修改功能">¶</a>步骤 9 : 增加，删除，修改功能</h3>
<p>增加交由前台用户注册功能<br>
删除不提供（用户信息是最重要的资料）<br>
修改不提供，应该由前台用户自己完成</p>
<h2 id="7、订单管理"><a class="header-anchor" href="#7、订单管理">¶</a>7、订单管理</h2>
<h3 id="步骤-1-先运行，看到效果，再学习-v6"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v6">¶</a>步骤 1 : 先运行，看到效果，再学习</h3>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h3 id="步骤-2-模仿和排错-v6"><a class="header-anchor" href="#步骤-2-模仿和排错-v6">¶</a>步骤 2 : 模仿和排错</h3>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h3 id="步骤-3-准备数据SQL"><a class="header-anchor" href="#步骤-3-准备数据SQL">¶</a>步骤 3 : 准备数据SQL</h3>
<p>订单数据，以及其赌赢的订单项数据，都是由前台功能增加的。<br>
为了在后台演示效果，需要自己在数据库中插入数据</p>
<ol>
<li>订单：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert INTO order_ VALUES (1,&#39;201608241638122609867&#39;,&#39;某某市，某某区，某某街道，某某号 &#39;,&#39;610000&#39;,&#39;某某某&#39;,&#39;15111111111&#39;,NULL,&#39;2016-12-30&#39;,NULL,NULL,NULL,14,&#39;waitDelivery&#39;);</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 倒数第二个参数<strong>14</strong>是对应的用户id，需要在数据库中存在，请根据自己的数据信息自行修改。</p>
<ol start="2">
<li>订单项</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert INTO orderitem VALUES (1,2,1,14,2);</span><br><span class="line">insert INTO orderitem VALUES (2,3,1,14,2);</span><br></pre></td></tr></table></figure>
<p>注： 第二个参数2、3分别对应的产品id，需要在数据库中存在，请根据自己的数据信息自行修改。</p>
<h3 id="步骤-4-页面截图-v2"><a class="header-anchor" href="#步骤-4-页面截图-v2">¶</a>步骤 4 : 页面截图</h3>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3837.png" alt></p>
<h3 id="步骤-5-OrderServlet-java"><a class="header-anchor" href="#步骤-5-OrderServlet-java">¶</a>步骤 5 : OrderServlet.java</h3>
<p>因为订单的增加和删除，都是在前台进行的。 所以OrderServlet提供的是list方法和delivery(发货)方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.Order;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.OrderDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderServlet</span> <span class="keyword">extends</span> <span class="title">BaseBackServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delivery</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">        Order o = orderDAO.get(id);</span><br><span class="line">        o.setDeliveryDate(<span class="keyword">new</span> Date());</span><br><span class="line">        o.setStatus(OrderDAO.waitConfirm);</span><br><span class="line">        orderDAO.update(o);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"@admin_order_list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;   </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        List&lt;Order&gt; os = orderDAO.list(page.getStart(),page.getCount());</span><br><span class="line">        orderItemDAO.fill(os);</span><br><span class="line">        <span class="keyword">int</span> total = orderDAO.getTotal();</span><br><span class="line">        page.setTotal(total);</span><br><span class="line">         </span><br><span class="line">        request.setAttribute(<span class="string">"os"</span>, os);</span><br><span class="line">        request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"admin/listOrder.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-Order-java"><a class="header-anchor" href="#步骤-6-Order-java">¶</a>步骤 6 : Order.java</h3>
<p>为了显示订单状态，就需要把[Order]类的getStatusDesc方法从注释中释放出来。</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3839.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.bean;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="comment">//import tmall.dao.OrderDAO;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.dao.OrderDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String orderCode;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String post;</span><br><span class="line">    <span class="keyword">private</span> String receiver;</span><br><span class="line">    <span class="keyword">private</span> String mobile;</span><br><span class="line">    <span class="keyword">private</span> String userMessage;</span><br><span class="line">    <span class="keyword">private</span> Date createDate;</span><br><span class="line">    <span class="keyword">private</span> Date payDate;</span><br><span class="line">    <span class="keyword">private</span> Date deliveryDate;</span><br><span class="line">    <span class="keyword">private</span> Date confirmDate;</span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> List&lt;OrderItem&gt; orderItems;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> total;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> totalNumber;</span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStatusDesc</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String desc =<span class="string">"未知"</span>;</span><br><span class="line">        <span class="keyword">switch</span>(status)&#123;</span><br><span class="line">            <span class="keyword">case</span> OrderDAO.waitPay:</span><br><span class="line">                desc=<span class="string">"待付款"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> OrderDAO.waitDelivery:</span><br><span class="line">                desc=<span class="string">"待发货"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> OrderDAO.waitConfirm:</span><br><span class="line">                desc=<span class="string">"待收货"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> OrderDAO.waitReview:</span><br><span class="line">                desc=<span class="string">"等评价"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> OrderDAO.finish:</span><br><span class="line">                desc=<span class="string">"完成"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> OrderDAO.delete:</span><br><span class="line">                desc=<span class="string">"刪除"</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                desc=<span class="string">"未知"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> desc;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> post;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPost</span><span class="params">(String post)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.post = post;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMobile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mobile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMobile</span><span class="params">(String mobile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mobile = mobile;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUserMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMessage;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserMessage</span><span class="params">(String userMessage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userMessage = userMessage;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getCreateDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> createDate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCreateDate</span><span class="params">(Date createDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.createDate = createDate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getPayDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> payDate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPayDate</span><span class="params">(Date payDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.payDate = payDate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getDeliveryDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deliveryDate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDeliveryDate</span><span class="params">(Date deliveryDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.deliveryDate = deliveryDate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getConfirmDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> confirmDate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConfirmDate</span><span class="params">(Date confirmDate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.confirmDate = confirmDate;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReceiver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> receiver;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReceiver</span><span class="params">(String receiver)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getOrderCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderCode;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderCode</span><span class="params">(String orderCode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderCode = orderCode;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title">getOrderItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderItems;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderItems</span><span class="params">(List&lt;OrderItem&gt; orderItems)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderItems = orderItems;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTotal</span><span class="params">(<span class="keyword">float</span> total)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.total = total;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> status;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatus</span><span class="params">(String status)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.status = status;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getTotalNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> totalNumber;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTotalNumber</span><span class="params">(<span class="keyword">int</span> totalNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.totalNumber = totalNumber;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-web-xml"><a class="header-anchor" href="#步骤-7-web-xml">¶</a>步骤 7 : web.xml</h3>
<p>在web.xml中配置/orderServlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>OrderServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.OrderServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>OrderServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/orderServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UserServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.UserServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>UserServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/userServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductImageServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/productImageServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.CategoryServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ProductServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ProductServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/productServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>CategoryServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/categoryServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.PropertyServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>PropertyServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/propertyServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.EncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>EncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>tmall.filter.BackServletFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BackServletFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="步骤-8-listOrder-jsp"><a class="header-anchor" href="#步骤-8-listOrder-jsp">¶</a>步骤 8 : listOrder.jsp</h3>
<p>增加listOrder.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminHeader.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminNavigator.jsp"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function()&#123;</span><br><span class="line">    $(<span class="string">"button.orderPageCheckOrderItems"</span>).click(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> oid = $(<span class="keyword">this</span>).attr(<span class="string">"oid"</span>);</span><br><span class="line">        $(<span class="string">"tr.orderPageOrderItemTR[oid="</span>+oid+<span class="string">"]"</span>).toggle();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;订单管理&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"workingArea"</span>&gt;</span><br><span class="line">    &lt;h1 class="label label-info" &gt;订单管理&lt;/h1&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"listDataTableDiv"</span>&gt;</span><br><span class="line">        &lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-striped table-bordered table-hover1  table-condensed"</span>&gt;</span><br><span class="line">            &lt;thead&gt;</span><br><span class="line">                &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"success"</span>&gt;</span><br><span class="line">                    &lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;状态&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;金额&lt;/th&gt;</span><br><span class="line">                    &lt;th width="100px"&gt;商品数量&lt;/th&gt;</span><br><span class="line">                    &lt;th width="100px"&gt;买家名称&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;创建时间&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;支付时间&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;发货时间&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;确认收货时间&lt;/th&gt;</span><br><span class="line">                    &lt;th width="120px"&gt;操作&lt;/th&gt;</span><br><span class="line">                &lt;/tr&gt;</span><br><span class="line">            &lt;/thead&gt;</span><br><span class="line">            &lt;tbody&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;os&#125;"</span> <span class="keyword">var</span>=<span class="string">"o"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;o.id&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;$&#123;o.statusDesc&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;￥&lt;fmt:formatNumber type="number" value="$&#123;o.total&#125;" minFractionDigits="2"/&gt;&lt;/td&gt;</span><br><span class="line">                        &lt;td align="center"&gt;$&#123;o.totalNumber&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;td align="center"&gt;$&#123;o.user.name&#125;&lt;/td&gt;</span><br><span class="line">                         </span><br><span class="line">                        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.createDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.payDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.deliveryDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line">                        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.confirmDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">                        &lt;td&gt;</span><br><span class="line">                            &lt;button oid=$&#123;o.id&#125; class="orderPageCheckOrderItems btn btn-primary btn-xs"&gt;查看详情&lt;/button&gt;</span><br><span class="line">                             </span><br><span class="line">                            &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;o.status=='waitDelivery'&#125;"</span>&gt;</span><br><span class="line">                                &lt;a href=<span class="string">"admin_order_delivery?id=$&#123;o.id&#125;"</span>&gt;</span><br><span class="line">                                    &lt;button class="btn btn-primary btn-xs"&gt;发货&lt;/button&gt;</span><br><span class="line">                                &lt;/a&gt;                         </span><br><span class="line">                            &lt;/c:if&gt;</span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"orderPageOrderItemTR"</span>  oid=$&#123;o.id&#125;&gt;</span><br><span class="line">                        &lt;td colspan=<span class="string">"10"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">                             </span><br><span class="line">                            &lt;div  <span class="class"><span class="keyword">class</span></span>=<span class="string">"orderPageOrderItem"</span>&gt;</span><br><span class="line">                                &lt;table width=<span class="string">"800px"</span> align=<span class="string">"center"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"orderPageOrderItemTable"</span>&gt;</span><br><span class="line">                                    &lt;c:forEach items=<span class="string">"$&#123;o.orderItems&#125;"</span> <span class="keyword">var</span>=<span class="string">"oi"</span>&gt;</span><br><span class="line">                                        &lt;tr&gt;</span><br><span class="line">                                            &lt;td align=<span class="string">"left"</span>&gt;</span><br><span class="line">                                                &lt;img width=<span class="string">"40px"</span> height=<span class="string">"40px"</span> src=<span class="string">"img/productSingle/$&#123;oi.product.firstProductImage.id&#125;.jpg"</span>&gt;</span><br><span class="line">                                            &lt;/td&gt;</span><br><span class="line">                                             </span><br><span class="line">                                            &lt;td&gt;</span><br><span class="line">                                                &lt;a href=<span class="string">"foreproduct?pid=$&#123;oi.product.id&#125;"</span>&gt;</span><br><span class="line">                                                    &lt;span&gt;$&#123;oi.product.name&#125;&lt;/span&gt;</span><br><span class="line">                                                &lt;/a&gt;                                         </span><br><span class="line">                                            &lt;/td&gt;</span><br><span class="line">                                            &lt;td align=<span class="string">"right"</span>&gt;</span><br><span class="line">                                             </span><br><span class="line">                                                &lt;span class="text-muted"&gt;$&#123;oi.number&#125;个&lt;/span&gt;                                              </span><br><span class="line">                                            &lt;/td&gt;</span><br><span class="line">                                            &lt;td align=<span class="string">"right"</span>&gt;</span><br><span class="line">                                             </span><br><span class="line">                                                &lt;span class="text-muted"&gt;单价：￥$&#123;oi.product.promotePrice&#125;&lt;/span&gt;                                             </span><br><span class="line">                                            &lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">                                        &lt;/tr&gt;</span><br><span class="line">                                    &lt;/c:forEach&gt;</span><br><span class="line">                                 </span><br><span class="line">                                &lt;/table&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                         </span><br><span class="line">                        &lt;/td&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">            &lt;/tbody&gt;</span><br><span class="line">        &lt;/table&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pageDiv"</span>&gt;</span><br><span class="line">        &lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminPage.jsp"</span> %&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"../include/admin/adminFooter.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-9-查询功能讲解"><a class="header-anchor" href="#步骤-9-查询功能讲解">¶</a>步骤 9 : 查询功能讲解</h3>
<p>访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/tmall/admin_order_list</span></span><br></pre></td></tr></table></figure>
<p>即可看到订单查询界面。<br>
admin_order_list 导致OrderServlet.list()方法被调用</p>
<ol>
<li>分页查询订单信息</li>
<li>借助orderItemDAO.fill()方法为这些订单填充上orderItems信息</li>
<li>服务端跳转到admin/listOrder.jsp页面</li>
<li>在listOrder.jsp借助c:forEach把订单集合遍历出来</li>
<li>遍历订单的时候，再把当前订单的orderItem订单项集合遍历出来</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3842.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    List&lt;Order&gt; os = orderDAO.list(page.getStart(),page.getCount());</span><br><span class="line">    orderItemDAO.fill(os);</span><br><span class="line">    <span class="keyword">int</span> total = orderDAO.getTotal();</span><br><span class="line">    page.setTotal(total);</span><br><span class="line">     </span><br><span class="line">    request.setAttribute(<span class="string">"os"</span>, os);</span><br><span class="line">    request.setAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"admin/listOrder.jsp"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">"$&#123;os&#125;"</span> <span class="keyword">var</span>=<span class="string">"o"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;o.id&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;o.statusDesc&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;￥&lt;fmt:formatNumber type="number" value="$&#123;o.total&#125;" minFractionDigits="2"/&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td align="center"&gt;$&#123;o.totalNumber&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td align="center"&gt;$&#123;o.user.name&#125;&lt;/td&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.createDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.payDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.deliveryDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&lt;fmt:formatDate value="$&#123;o.confirmDate&#125;" pattern="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">        &lt;td&gt;</span><br><span class="line">            &lt;button oid=$&#123;o.id&#125; class="orderPageCheckOrderItems btn btn-primary btn-xs"&gt;查看详情&lt;/button&gt;</span><br><span class="line">             </span><br><span class="line">            &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;o.status=='waitDelivery'&#125;"</span>&gt;</span><br><span class="line">                &lt;a href=<span class="string">"admin_order_delivery?id=$&#123;o.id&#125;"</span>&gt;</span><br><span class="line">                    &lt;button class="btn btn-primary btn-xs"&gt;发货&lt;/button&gt;</span><br><span class="line">                &lt;/a&gt;                         </span><br><span class="line">            &lt;/c:if&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr <span class="class"><span class="keyword">class</span></span>=<span class="string">"orderPageOrderItemTR"</span>  oid=$&#123;o.id&#125;&gt;</span><br><span class="line">        &lt;td colspan=<span class="string">"10"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">             </span><br><span class="line">            &lt;div  <span class="class"><span class="keyword">class</span></span>=<span class="string">"orderPageOrderItem"</span>&gt;</span><br><span class="line">                &lt;table width=<span class="string">"800px"</span> align=<span class="string">"center"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"orderPageOrderItemTable"</span>&gt;</span><br><span class="line">                    &lt;c:forEach items=<span class="string">"$&#123;o.orderItems&#125;"</span> <span class="keyword">var</span>=<span class="string">"oi"</span>&gt;</span><br><span class="line">                        &lt;tr&gt;</span><br><span class="line">                            &lt;td align=<span class="string">"left"</span>&gt;</span><br><span class="line">                                &lt;img width=<span class="string">"40px"</span> height=<span class="string">"40px"</span> src=<span class="string">"img/productSingle/$&#123;oi.product.firstProductImage.id&#125;.jpg"</span>&gt;</span><br><span class="line">                            &lt;/td&gt;</span><br><span class="line">                             </span><br><span class="line">                            &lt;td&gt;</span><br><span class="line">                                &lt;a href=<span class="string">"foreproduct?pid=$&#123;oi.product.id&#125;"</span>&gt;</span><br><span class="line">                                    &lt;span&gt;$&#123;oi.product.name&#125;&lt;/span&gt;</span><br><span class="line">                                &lt;/a&gt;                                         </span><br><span class="line">                            &lt;/td&gt;</span><br><span class="line">                            &lt;td align=<span class="string">"right"</span>&gt;</span><br><span class="line">                             </span><br><span class="line">                                &lt;span class="text-muted"&gt;$&#123;oi.number&#125;个&lt;/span&gt;                                              </span><br><span class="line">                            &lt;/td&gt;</span><br><span class="line">                            &lt;td align=<span class="string">"right"</span>&gt;</span><br><span class="line">                             </span><br><span class="line">                                &lt;span class="text-muted"&gt;单价：￥$&#123;oi.product.promotePrice&#125;&lt;/span&gt;                                             </span><br><span class="line">                            &lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">                        &lt;/tr&gt;</span><br><span class="line">                    &lt;/c:forEach&gt;</span><br><span class="line">                 </span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-10-发货功能讲解"><a class="header-anchor" href="#步骤-10-发货功能讲解">¶</a>步骤 10 : 发货功能讲解</h3>
<p>当订单状态是waitDelivery的时候，就会出现发货按钮</p>
<ol>
<li>发货按钮链接跳转到admin_order_delivery</li>
<li>OrderServlet.delivery()方法被调用<br>
2.1 根据id获取Order对象<br>
2.2 修改发货时间，设置发货状态<br>
2.3 更新到数据库<br>
2.4 客户端跳转到admin_order_list页面</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3843.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">delivery</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id = Integer.parseInt(request.getParameter(<span class="string">"id"</span>));</span><br><span class="line">    Order o = orderDAO.get(id);</span><br><span class="line">    o.setDeliveryDate(<span class="keyword">new</span> Date());</span><br><span class="line">    o.setStatus(OrderDAO.waitConfirm);</span><br><span class="line">    orderDAO.update(o);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"@admin_order_list"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-11-增加，修改，删除功能"><a class="header-anchor" href="#步骤-11-增加，修改，删除功能">¶</a>步骤 11 : 增加，修改，删除功能</h3>
<p>订单的增加和删除功能交由前台完成，后台不提供</p>
<h1 id="十二、原型-前端"><a class="header-anchor" href="#十二、原型-前端">¶</a>十二、原型-前端</h1>
<h2 id="1、概述"><a class="header-anchor" href="#1、概述">¶</a>1、概述</h2>
<p>在开发功能之前，都会先有原型界面。 通常原型界面的数据不是真实的，是临时写在页面上，为用户提供一个直观的界面感受的。</p>
<p>原型的目的通常有两个：</p>
<ol>
<li>
<p>用于和客户沟通交流，一图胜千言，哪里可以保留，哪里需要修改，在原型界面的基础上，就可以高效率的沟通了。</p>
</li>
<li>
<p>指导功能开发，有可视的原型界面，开发人员可以更准确的设计系统和功能，同时在设计系统的过程中，又能反过来验证是否支持这些界面上的功能。</p>
</li>
</ol>
<p>本章节开始，列罗出了主要的前端原型界面。 因为是模仿天猫官网，所以这些前端原型本身的设计和开发就有相当的难度， 如何从零开始设计和制作这些前端页面请在[模仿天猫前端教程]中学习，就不在[本天猫整站教程]中展开了。</p>
<p>[本天猫整站教程]中关于前端的关注点，着重落在如何获取服务端的数据，显示在页面上，以及前端页面与服务端的同步/异步数据交互上。</p>
<h3 id="步骤-1-真正开发的时候会直接使用这些前端页面吗？"><a class="header-anchor" href="#步骤-1-真正开发的时候会直接使用这些前端页面吗？">¶</a>步骤 1 : 真正开发的时候会直接使用这些前端页面吗？</h3>
<p>事实上，这些前端页面都是相当复杂的，真正开发的时候，也不会完全在这些页面上进行，而是把一个复杂的前端页面拆成了多个便于维护与理解的小的jsp文件。<br>
比如首页[home.jsp]就是由多个[home.jsp 公共文件]和一个[homePage.jsp]组成。</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/4003.png" alt></p>
<h3 id="步骤-2-homePage-jsp-又由多个子jsp文件组成"><a class="header-anchor" href="#步骤-2-homePage-jsp-又由多个子jsp文件组成">¶</a>步骤 2 : homePage.jsp 又由多个子jsp文件组成</h3>
<p>[homePage.jsp ]又由多个子jsp文件组成，这样每个文件就相对于整篇的前端页面来讲，简单了不少，更加利于理解与消化</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/4004.png" alt></p>
<h3 id="步骤-3-这些前端原型的作用"><a class="header-anchor" href="#步骤-3-这些前端原型的作用">¶</a>步骤 3 : 这些前端原型的作用</h3>
<p>这些前端原型的作用，主要还是用于和客户沟通，让大家对工作的真正状态有一定的模拟。 如果对前端页面本身的布局，样式十分感兴趣，请跳转到[模仿天猫前端教程]</p>
<h2 id="2、首页"><a class="header-anchor" href="#2、首页">¶</a>2、首页</h2>
<p><strong>说明</strong> 这些是前端页面原型的整合代码，在实际开发中是不会像这样把那么多的标签，元素，样式，js放在一个页面里的。 在本教程中会把大的页面拆分成为容易理解，维护的小文件，在后续的章节会讲解到。</p>
<h3 id="步骤-1-效果"><a class="header-anchor" href="#步骤-1-效果">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="3、分类页"><a class="header-anchor" href="#3、分类页">¶</a>3、分类页</h2>
<h3 id="步骤-1-效果-v2"><a class="header-anchor" href="#步骤-1-效果-v2">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="4、产品页面"><a class="header-anchor" href="#4、产品页面">¶</a>4、产品页面</h2>
<h3 id="步骤-1-效果-v3"><a class="header-anchor" href="#步骤-1-效果-v3">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="5、购物车页面"><a class="header-anchor" href="#5、购物车页面">¶</a>5、购物车页面</h2>
<h3 id="步骤-1-效果-v4"><a class="header-anchor" href="#步骤-1-效果-v4">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="6、我的订单页面"><a class="header-anchor" href="#6、我的订单页面">¶</a>6、我的订单页面</h2>
<h3 id="步骤-1-效果-v5"><a class="header-anchor" href="#步骤-1-效果-v5">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="7、结算页面"><a class="header-anchor" href="#7、结算页面">¶</a>7、结算页面</h2>
<h3 id="步骤-1-效果-v6"><a class="header-anchor" href="#步骤-1-效果-v6">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="8、查询结果页"><a class="header-anchor" href="#8、查询结果页">¶</a>8、查询结果页</h2>
<h3 id="步骤-1-效果-v7"><a class="header-anchor" href="#步骤-1-效果-v7">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="9、支付页面"><a class="header-anchor" href="#9、支付页面">¶</a>9、支付页面</h2>
<h3 id="步骤-1-效果-v8"><a class="header-anchor" href="#步骤-1-效果-v8">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="10、支付成功页面"><a class="header-anchor" href="#10、支付成功页面">¶</a>10、支付成功页面</h2>
<h3 id="步骤-1-效果-v9"><a class="header-anchor" href="#步骤-1-效果-v9">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="11、确认收货页面"><a class="header-anchor" href="#11、确认收货页面">¶</a>11、确认收货页面</h2>
<h3 id="步骤-1-效果-v10"><a class="header-anchor" href="#步骤-1-效果-v10">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="12、收货成功页面"><a class="header-anchor" href="#12、收货成功页面">¶</a>12、收货成功页面</h2>
<h3 id="步骤-1-效果-v11"><a class="header-anchor" href="#步骤-1-效果-v11">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="13、评价页面"><a class="header-anchor" href="#13、评价页面">¶</a>13、评价页面</h2>
<h3 id="步骤-1-效果-v12"><a class="header-anchor" href="#步骤-1-效果-v12">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h2 id="14、登录页面"><a class="header-anchor" href="#14、登录页面">¶</a>14、登录页面</h2>
<h3 id="步骤-1-效果-v13"><a class="header-anchor" href="#步骤-1-效果-v13">¶</a>步骤 1 : 效果</h3>
<p>**注：**这里的原型是展示效果，让大家有个感性的认识，编码不在这里进行，项目开发过程会在后面的章节从零开始。</p>
<h1 id="十三、前台-首页"><a class="header-anchor" href="#十三、前台-首页">¶</a>十三、前台-首页</h1>
<h2 id="1、概述-v2"><a class="header-anchor" href="#1、概述-v2">¶</a>1、概述</h2>
<p>前台也包括许多功能， 与[后台-分类管理]类似的，首先把[前台-首页]这个功能单独拿出来，进行精讲。[前台-首页] 消化吸收好之后，再进行其他前台功能的开发。</p>
<ol>
<li>
<p>前台无需登录<br>
从前台模块之间的依赖性，以及开发顺序的合理性来考虑，把前台功能分为了 [无需登录] 即可使用的功能，和[需要登录] 才能访问的功能。 建立在前一步[前台-首页]的基础之上，开始进行一系列的[无需登录]功能开发。</p>
</li>
<li>
<p>前台需要登录<br>
接着是[需要登录的前台功能]。 这部分功能基本上都是和购物相关的。 因此，一开始先把[购物流程] 单独拿出来捋清楚，其中还特别注明了[购物流程环节与表关系]，这样能够更好的建立对前端购物功能的理解。随着这部分功能的开发，就会进入订单生成部分，在此之前，先准备了一个 [订单状态图]，在理解了这个图之后，可以更好的进行订单相关功能的开发。</p>
</li>
</ol>
<h2 id="2、可运行项目"><a class="header-anchor" href="#2、可运行项目">¶</a>2、可运行项目</h2>
<h3 id="步骤-1-先看效果"><a class="header-anchor" href="#步骤-1-先看效果">¶</a>步骤 1 : 先看效果</h3>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3853.png" alt></p>
<h3 id="步骤-2-可运行项目"><a class="header-anchor" href="#步骤-2-可运行项目">¶</a>步骤 2 : 可运行项目</h3>
<ol>
<li>
<p>首先下载右边的tmall.rar</p>
</li>
<li>
<p>解压到e:/project/tmall</p>
</li>
<li>
<p>使用下个步骤的[导入SQL语句]</p>
</li>
<li>
<p>然后重启tomcat</p>
</li>
<li>
<p>访问页面</p>
</li>
</ol>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/tmall/</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong><br>
<a href="http://127.0.0.1:8080/tmall/" target="_blank" rel="noopener">http://127.0.0.1:8080/tmall/</a> 跳转到了地址 <a href="http://127.0.0.1:8080/tmall/forehome" target="_blank" rel="noopener">http://127.0.0.1:8080/tmall/forehome</a></p>
<h3 id="步骤-3-导入SQL语句"><a class="header-anchor" href="#步骤-3-导入SQL语句">¶</a>步骤 3 : 导入SQL语句</h3>
<p>tmall.rar只包含了项目必须的代码，但是没有数据，为了看到首页的运行效果，还必须导入数据。</p>
<p>在右侧下载 sql 文件，然后使用如下的 命令行方式导入。如果没有安装mysql,可以参考[安装mysql-server]<br>
<strong>注：</strong> 不要用 navicat,mysql-front 等工具导入，因为数据量大，这些工具处理不了，会报奇奇怪怪的错误。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;D:\tools\MYSQL\mysql-5.1.57-win32\bin\mysql.exe&quot; -u root -padmin --default-character-set&#x3D;utf8 tmall &lt; d:\tmall.sql</span><br></pre></td></tr></table></figure>
<p><strong>注:</strong> D:\tools\MYSQL\mysql-5.1.57-win32\bin\mysql.exe 这个路径是我的mysql.exe的路径，根据实际情况换成自己的mysql运行路径<br>
<strong>注:</strong> tmall.sql下载后，放在 d:\tmall.sql 这个位置</p>
<h3 id="步骤-4-限制性"><a class="header-anchor" href="#步骤-4-限制性">¶</a>步骤 4 : 限制性</h3>
<p>为了正常显示这个首页效果，包含了17种分类，每种分类下有5种商品，每个商品下大约又有大小不同，单个和详情总供10张左右图片。这样累计下来图片文件就有1777张。</p>
<p>仅仅每个分类下5种商品，项目文件压缩包tmall.rar的大小就是200多M了，完整的[模仿天猫]下每个分类下平均有60个产品，总计2个G左右，考虑到学习需要下那么大的文件很不方便，就不提供了。</p>
<p>因为每个分类下只有5种产品，所有在推荐产品列表里看到的数据就有限，只能看到5种，而不是[模仿天猫]上看到的比较丰富的内容。</p>
<p>如果为了看到更多的内容，需要自己在后台手动增加新的产品</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3854.png" alt></p>
<h2 id="3、静态资源"><a class="header-anchor" href="#3、静态资源">¶</a>3、静态资源</h2>
<h3 id="步骤-1-图片资源-site目录"><a class="header-anchor" href="#步骤-1-图片资源-site目录">¶</a>步骤 1 : 图片资源-site目录</h3>
<p>和[分类管理中讲到的图片资源]一样，在img目录下的site目录放着所有要用到的静态图片，如猫耳朵什么的</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3855.png" alt></p>
<h3 id="步骤-2-图片资源-轮播图片"><a class="header-anchor" href="#步骤-2-图片资源-轮播图片">¶</a>步骤 2 : 图片资源-轮播图片</h3>
<p>除了[图片资源-site目录]之外，还有轮播用的图片资源</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3858.png" alt></p>
<h3 id="步骤-3-图片资源-分类图片"><a class="header-anchor" href="#步骤-3-图片资源-分类图片">¶</a>步骤 3 : 图片资源-分类图片</h3>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3859.png" alt></p>
<h3 id="步骤-4-图片资源-产品图片"><a class="header-anchor" href="#步骤-4-图片资源-产品图片">¶</a>步骤 4 : 图片资源-产品图片</h3>
<p>产品对应的图片有4个目录，分别是</p>
<ol>
<li>productSingle<br>
产品正常尺寸图片</li>
<li>productSingle_middle<br>
产品中等尺寸图片</li>
<li>productSingle_small<br>
产品小号尺寸图片</li>
<li>productDetail<br>
产品详情图片</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3860.png" alt></p>
<h3 id="步骤-5-css"><a class="header-anchor" href="#步骤-5-css">¶</a>步骤 5 : css</h3>
<p>在css目录里有3个子目录</p>
<ol>
<li>back<br>
这个目录里有一个style.css,这是后台界面用到的样式</li>
<li>bootstrap<br>
这里存放的是bootstrap的css样式文件</li>
<li>fore<br>
这个目录里也有一个style.css,这是前台界面用到的样式</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3856.png" alt></p>
<h3 id="步骤-6-js"><a class="header-anchor" href="#步骤-6-js">¶</a>步骤 6 : js</h3>
<p>js目录下有两个子目录<br>
/bootstrap<br>
bootstrap用到的js文件<br>
/jquery<br>
jquery用到的js文件</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3857.png" alt></p>
<h3 id="步骤-7-img-rar"><a class="header-anchor" href="#步骤-7-img-rar">¶</a>步骤 7 : img.rar</h3>
<p>这1777张产品图片就统一放在右侧的img.rar下载，后续学习要用到的时候，就在这里下载.</p>
<p>因为图片很多，在后续学习的每个知识点里的可运行项目下载里就不再提供图片下载了，否则每个都需要200M大小，给学习带来不便。</p>
<h2 id="4、FILTER配合SERVLET"><a class="header-anchor" href="#4、FILTER配合SERVLET">¶</a>4、FILTER配合SERVLET</h2>
<h3 id="步骤-1-一个路径对应一个Servlet的弊端"><a class="header-anchor" href="#步骤-1-一个路径对应一个Servlet的弊端">¶</a>步骤 1 : 一个路径对应一个Servlet的弊端</h3>
<p>与后台管理类似的，前台也存在按照传统方式一个路径对应一个Servlet的冗长的web.xml配置以及大量servlet类的问题。</p>
<p>与后台管理同样的，采用[Filter配合Servlet的设计模式]来大大简化这么一个配置问题。</p>
<h3 id="步骤-2-简化之后的效果"><a class="header-anchor" href="#步骤-2-简化之后的效果">¶</a>步骤 2 : 简化之后的效果</h3>
<p>采用了[Filter配合Servlet的设计模式]之后，web.xml配置文件里对于前端值需要一个配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ForeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ForeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ForeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/foreServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在这么一个ForeServlet类里，就提供了所有前端需要用到的业务方法</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3863.png" alt></p>
<h3 id="步骤-3-原理流程图"><a class="header-anchor" href="#步骤-3-原理流程图">¶</a>步骤 3 : 原理流程图</h3>
<p>那么是如何做到一个ForeServlet类，就能完成本来需要n个Servlet类才能完成的功能的呢？</p>
<p>让我们借助流程图来分析，为什么访问forehome的时候，ForeServlet的home()方法会被调用</p>
<p>1.现在访问路径是 <a href="http://127.0.0.1:8080/tmall/forehome" target="_blank" rel="noopener">http://127.0.0.1:8080/tmall/forehome</a><br>
2. 过滤器ForeServletFilter进行拦截，判断访问的地址是否以/fore开头,并且不以/foreServlet开头. 为什么要排除/foreServlet呢？ 因为/foreServlet是web.xml中实际配置的Servlet，filter需要对这个路径访问放行。 各位可以试试不要这句话会有什么效果<br>
3. 如果是，那么做如下操作<br>
3.1 取出fore之后的值home<br>
3.2 服务端跳转到foreServlet，并且把home这个值传递过去<br>
4. foreServlet 继承了BaseForeServlet，其service方法会被调用。 在service中，借助反射技术，根据传递过来的值 home，调用对应foreServlet 中的方法home()<br>
5. 这样就实现了当访问的路径是 forehome的时候，就会调用foreServlet.home()方法这样一个效果</p>
<p>换句话说:<br>
如果访问的路径是forecategory，就会调用foreServlet.category()方法<br>
如果访问的路径是forecart，就会调用foreServlet.cart()方法<br>
如果访问的路径是foresearch，就会调用foreServlet.search()方法<br>
。。。</p>
<p>如此这般，一个foreServlet类，就完成了本来需要n个Servlet类才能完成的功能。</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3864.png" alt></p>
<h3 id="步骤-4-代码讲解-ForeServletFilter"><a class="header-anchor" href="#步骤-4-代码讲解-ForeServletFilter">¶</a>步骤 4 : 代码讲解 - ForeServletFilter</h3>
<p>那么ForeServletFilter类到底是如何工作的呢？ 接下来我们此类进行代码讲解。</p>
<ol>
<li>首先在web.xml配置文件中，让所有的请求都会经过ForeServletFilter</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>还是假设访问的路径是：</li>
</ol>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/tmall/forehome</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>在ForeServletFilter 中通过request.getRequestURI()取出访问的uri: /tmall/forehome</li>
<li>然后截掉/tmall，得到路径/forehome</li>
<li>判断其是否以/fore开头,并且不是/foreServlet开头</li>
<li>如果是，取出fore之后的值home，并且服务端跳转到foreServlet</li>
<li>在跳转之前，还取出了home字符串，然后通过request.setAttribute的方式，借助服务端跳转，传递到foreServlet里去</li>
</ol>
<p><strong>注：</strong> 关于36-44行，是用于当用户登录之后，从session中获取用户对象，并根据这个用户对象获取购物车中的物品总数。 关于这块内容，在后续讲到页头信息展示的时候，会再详细讲解，这里一笔带过。</p>
<p><strong>注：</strong> 关于48-52行，是用于在[simpleSearch.jsp] 简单搜索栏下显示分类链接用的，学到那个地方的时候，会再拿出来讲解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.filter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.StringUtils;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.Category;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.OrderItem;</span><br><span class="line"><span class="keyword">import</span> tmall.bean.User;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.OrderItemDAO;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForeServletFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) req;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line">        String contextPath=request.getServletContext().getContextPath();</span><br><span class="line">        request.getServletContext().setAttribute(<span class="string">"contextPath"</span>, contextPath);</span><br><span class="line">         </span><br><span class="line">        User user =(User) request.getSession().getAttribute(<span class="string">"user"</span>);</span><br><span class="line">        <span class="keyword">int</span> cartTotalItemNumber= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span>!=user)&#123;</span><br><span class="line">            List&lt;OrderItem&gt; ois = <span class="keyword">new</span> OrderItemDAO().listByUser(user.getId());</span><br><span class="line">            <span class="keyword">for</span> (OrderItem oi : ois) &#123;</span><br><span class="line">                cartTotalItemNumber+=oi.getNumber();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        request.setAttribute(<span class="string">"cartTotalItemNumber"</span>, cartTotalItemNumber);</span><br><span class="line">         </span><br><span class="line">        List&lt;Category&gt; cs=(List&lt;Category&gt;) request.getAttribute(<span class="string">"cs"</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span>==cs)&#123;</span><br><span class="line">            cs=<span class="keyword">new</span> CategoryDAO().list();</span><br><span class="line">            request.setAttribute(<span class="string">"cs"</span>, cs);        </span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        String uri = request.getRequestURI();</span><br><span class="line">        uri =StringUtils.remove(uri, contextPath);</span><br><span class="line">        <span class="keyword">if</span>(uri.startsWith(<span class="string">"/fore"</span>)&amp;&amp;!uri.startsWith(<span class="string">"/foreServlet"</span>))&#123;</span><br><span class="line">            String method = StringUtils.substringAfterLast(uri,<span class="string">"/fore"</span> );</span><br><span class="line">            request.setAttribute(<span class="string">"method"</span>, method);</span><br><span class="line">            req.getRequestDispatcher(<span class="string">"/foreServlet"</span>).forward(request, response);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig arg0)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-5-代码讲解-ForeServlet和BaseForeServlet"><a class="header-anchor" href="#步骤-5-代码讲解-ForeServlet和BaseForeServlet">¶</a>步骤 5 : 代码讲解 - ForeServlet和BaseForeServlet</h3>
<p>接着流程就到了foreServlet这里。<br>
根据web.xml中的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ForeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/foreServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>服务端跳转/foreServlet就到了ForeServlet这个类里</p>
<ol>
<li>首先ForeServlet继承了BaseForeServlet，而BaseForeServlet又继承了HttpServlet</li>
<li>服务端跳转过来之后，会访问ForeServlet的doGet()或者doPost()方法</li>
<li>在访问doGet()或者doPost()之前，会访问service()方法</li>
<li>BaseForeServlet中重写了service() 方法，所以流程就进入到了service()中</li>
<li>在service()方法中有三块内容<br>
5.1 第一块是获取分页信息<br>
5.2 第二块是根据反射访问对应的方法<br>
5.3 第三块是根据对应方法的返回值，进行服务端跳转、客户端跳转、或者直接输出字符串。</li>
<li>第一块：分页信息实际上在前台并没有用到，目前前台并没有提供分页功能。</li>
<li>第二块：取到从ForeServletFilter中request.setAttribute()传递过来的值 home，<br>
根据这个值home，借助反射机制调用ForeServlet类中的home()方法<br>
这样就达到了ForeServlet.home()方法被调用的效果</li>
<li>第三块： 判断根据home的返回值&quot;home.jsp&quot;，即没有&quot;%“开头，也没有”@&quot;,那么就调用request.getRequestDispatcher(redirect).forward(request, response);进行服务端跳转到 “home.jsp” 页面</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.Category;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForeServlet</span> <span class="keyword">extends</span> <span class="title">BaseForeServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">home</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs= <span class="keyword">new</span> CategoryDAO().list();</span><br><span class="line">        <span class="keyword">new</span> ProductDAO().fill(cs);</span><br><span class="line">        <span class="keyword">new</span> ProductDAO().fillByRow(cs);</span><br><span class="line">        request.setAttribute(<span class="string">"cs"</span>, cs);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"home.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.OrderDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.OrderItemDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.ProductImageDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.PropertyDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.PropertyValueDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.ReviewDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.UserDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseForeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">protected</span> CategoryDAO categoryDAO = <span class="keyword">new</span> CategoryDAO();</span><br><span class="line">    <span class="keyword">protected</span> OrderDAO orderDAO = <span class="keyword">new</span> OrderDAO();</span><br><span class="line">    <span class="keyword">protected</span> OrderItemDAO orderItemDAO = <span class="keyword">new</span> OrderItemDAO();</span><br><span class="line">    <span class="keyword">protected</span> ProductDAO productDAO = <span class="keyword">new</span> ProductDAO();</span><br><span class="line">    <span class="keyword">protected</span> ProductImageDAO productImageDAO = <span class="keyword">new</span> ProductImageDAO();</span><br><span class="line">    <span class="keyword">protected</span> PropertyDAO propertyDAO = <span class="keyword">new</span> PropertyDAO();</span><br><span class="line">    <span class="keyword">protected</span> PropertyValueDAO propertyValueDAO = <span class="keyword">new</span> PropertyValueDAO();</span><br><span class="line">    <span class="keyword">protected</span> ReviewDAO reviewDAO = <span class="keyword">new</span> ReviewDAO();</span><br><span class="line">    <span class="keyword">protected</span> UserDAO userDAO = <span class="keyword">new</span> UserDAO();</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">             </span><br><span class="line">            <span class="keyword">int</span> start= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> count = <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                start = Integer.parseInt(request.getParameter(<span class="string">"page.start"</span>));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                 </span><br><span class="line">            &#125;</span><br><span class="line">             </span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                count = Integer.parseInt(request.getParameter(<span class="string">"page.count"</span>));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">             </span><br><span class="line">            Page page = <span class="keyword">new</span> Page(start,count);</span><br><span class="line">             </span><br><span class="line">            String method = (String) request.getAttribute(<span class="string">"method"</span>);</span><br><span class="line"> </span><br><span class="line">            Method m = <span class="keyword">this</span>.getClass().getMethod(method, javax.servlet.http.HttpServletRequest<span class="class">.<span class="keyword">class</span>,</span></span><br><span class="line"><span class="class">                    <span class="title">javax</span>.<span class="title">servlet</span>.<span class="title">http</span>.<span class="title">HttpServletResponse</span>.<span class="title">class</span>,<span class="title">Page</span>.<span class="title">class</span>)</span>;</span><br><span class="line">             </span><br><span class="line">            String redirect = m.invoke(<span class="keyword">this</span>,request, response,page).toString();</span><br><span class="line">             </span><br><span class="line">            <span class="keyword">if</span>(redirect.startsWith(<span class="string">"@"</span>))</span><br><span class="line">                response.sendRedirect(redirect.substring(<span class="number">1</span>));</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(redirect.startsWith(<span class="string">"%"</span>))</span><br><span class="line">                response.getWriter().print(redirect.substring(<span class="number">1</span>));</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                request.getRequestDispatcher(redirect).forward(request, response);</span><br><span class="line">             </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ForeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>tmall.servlet.ForeServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ForeServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/foreServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-一个Servlet类就能满足所有前端业务要求"><a class="header-anchor" href="#步骤-6-一个Servlet类就能满足所有前端业务要求">¶</a>步骤 6 : 一个Servlet类就能满足所有前端业务要求</h3>
<p>通过这样一种模式，一个Servlet类就能满足所有前端业务要求，这就为代码的维护带来的极大的便利性</p>
<ol>
<li>不需要写大量的Servlet类</li>
<li>不需要在web.xml中维护大量的映射关系</li>
<li>当有扩展需求的时候，在ForeServlet中增加一个方法即可。</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3867.png" alt></p>
<h2 id="5、HOME方法"><a class="header-anchor" href="#5、HOME方法">¶</a>5、HOME方法</h2>
<h3 id="步骤-1-MVC-设计思想"><a class="header-anchor" href="#步骤-1-MVC-设计思想">¶</a>步骤 1 : MVC 设计思想</h3>
<p>根据 [MVC设计模式]的思想，做J2EE web应用，从MVC的角度来看，就是把不同的数据显示在不同的页面上。</p>
<p>数据就是 <strong>模型</strong> ( bean, dao )<br>
页面就是 <strong>视图</strong> ( jsp )<br>
控制不同的模型显示在不同的视图上，这件事，就是由控制器来完成 ( servlet )</p>
<p>所以分类管理，从MVC的角度来看，就是把多条分类Category数据放在一个集合里， 让listCategory.jsp 这个视图去显示出来。</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3868.png" alt></p>
<h3 id="步骤-2-首页需要什么数据？"><a class="header-anchor" href="#步骤-2-首页需要什么数据？">¶</a>步骤 2 : 首页需要什么数据？</h3>
<p>那么首页需要什么数据呢？ 从 [首页展示需求分析]上来看：</p>
<ol>
<li>
<p>在横向导航栏上提供4个分类连接</p>
</li>
<li>
<p>在纵向导航栏上提供全部17个分类连接</p>
</li>
<li>
<p>当鼠标移动到某一个纵向分类连接的时候，显示这个分类下的推荐商品</p>
</li>
<li>
<p>按照每种分类显示5个商品的方式，显示所有17种分类</p>
</li>
</ol>
<h3 id="步骤-3-home方法"><a class="header-anchor" href="#步骤-3-home方法">¶</a>步骤 3 : home方法</h3>
<p>为了提供[首页需要的数据]，home()方法进行了如下操作：<br>
获取所有17种分类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Category&gt; cs= <span class="keyword">new</span> CategoryDAO().list();</span><br></pre></td></tr></table></figure>
<p>为这些分类填充<strong>产品集合</strong>，即为每个Category对象，设置products属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> ProductDAO().fill(cs);</span><br></pre></td></tr></table></figure>
<p>为这些分类填充<strong>推荐产品集合</strong>，即为每个Category对象，设置productsByRow属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> ProductDAO().fillByRow(cs);</span><br></pre></td></tr></table></figure>
<p>把分类集合设置在request的&quot;cs&quot;属性上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.setAttribute(<span class="string">"cs"</span>, cs);</span><br></pre></td></tr></table></figure>
<p>服务端跳转到home.jsp</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"home.jsp"</span>;</span><br></pre></td></tr></table></figure>
<p>参考：[Category] ，[ProductDAO非CRUD方法]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> tmall.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> tmall.bean.Category;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> tmall.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ForeServlet</span> <span class="keyword">extends</span> <span class="title">BaseForeServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">home</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Page page)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs= <span class="keyword">new</span> CategoryDAO().list();</span><br><span class="line">        <span class="keyword">new</span> ProductDAO().fill(cs);</span><br><span class="line">        <span class="keyword">new</span> ProductDAO().fillByRow(cs);</span><br><span class="line">        request.setAttribute(<span class="string">"cs"</span>, cs);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"home.jsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6、HOME-JSP"><a class="header-anchor" href="#6、HOME-JSP">¶</a>6、HOME.JSP</h2>
<h3 id="步骤-1-前台页面的特点"><a class="header-anchor" href="#步骤-1-前台页面的特点">¶</a>步骤 1 : 前台页面的特点</h3>
<p>观察[模仿天猫前端]，可以发现前台页面有如下特点：</p>
<ol>
<li>有共同的置顶导航</li>
<li>有共同的搜索栏</li>
<li>有共同的页脚</li>
</ol>
<p>根据这样的特点，在设计前台jsp页面的时候，就制作了很多公共页面，其他前台页面就共享这些公共页面，使得开发和维护成本降低不少</p>
<h3 id="步骤-2-home-jsp-所包含页面"><a class="header-anchor" href="#步骤-2-home-jsp-所包含页面">¶</a>步骤 2 : home.jsp 所包含页面</h3>
<p>根据前台页面的特点，我们把home.jsp设计成如代码所示。</p>
<ol>
<li>header.jsp<br>
引入标准标签库，js,css，自定义javascript函数等</li>
<li>top.jsp<br>
置顶导航</li>
<li>search.jsp<br>
搜索栏</li>
<li>homePage.jsp<br>
首页业务页面</li>
<li>footer.jsp<br>
页脚</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3872.png" alt></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"include/header.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"include/top.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"include/search.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"include/home/homePage.jsp"</span>%&gt;</span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"include/footer.jsp"</span>%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-3-header-jsp"><a class="header-anchor" href="#步骤-3-header-jsp">¶</a>步骤 3 : header.jsp</h3>
<p>header.jsp 做了如下工作</p>
<ol>
<li>声明为html5格式</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br></pre></td></tr></table></figure>
<p>2.让浏览器以UTF显示中文，本页面的中文文字采用UTF-8编码，启动EL表达式</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">	pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>引入标准标签库</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/fmt"</span> prefix=<span class="string">'fmt'</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"fn"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/functions"</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>c通常用于条件判断和遍历<br>
fmt用于格式化日期和货币<br>
fn用于校验长度<br>
更多的关于JSTL的查看[这里]</p>
<ol start="4">
<li>引入bootstrap和jquery</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src="js/jquery/2.0.0/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;link href=<span class="string">"css/bootstrap/3.3.6/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">&lt;script src="js/bootstrap/3.3.6/bootstrap.min.js"&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>自定义前端样式</li>
</ol>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link href=<span class="string">"css/fore/style.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>除了轮播和图标，前端几乎没用Bootstrap中的样式，所有的自定义样式都在这个文件里。</p>
<ol start="6">
<li>各种自定义函数和事件监听。</li>
</ol>
<p>这些内容在[模仿天猫前端教程]中详细讲解，本项目专注于服务端的内容，就不一一展开了</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/fmt"</span> prefix=<span class="string">'fmt'</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"fn"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/functions"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;html&gt;</span><br><span class="line"> </span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;script src="js/jquery/2.0.0/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link href=<span class="string">"css/bootstrap/3.3.6/bootstrap.min.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">    &lt;script src="js/bootstrap/3.3.6/bootstrap.min.js"&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link href=<span class="string">"css/fore/style.css"</span> rel=<span class="string">"stylesheet"</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function">function <span class="title">formatMoney</span><span class="params">(num)</span></span>&#123;</span><br><span class="line">    num = num.toString().replace(/\$|\,/g,<span class="string">''</span>); </span><br><span class="line">    <span class="keyword">if</span>(isNaN(num)) </span><br><span class="line">        num = <span class="string">"0"</span>; </span><br><span class="line">    sign = (num == (num = Math.abs(num))); </span><br><span class="line">    num = Math.floor(num*<span class="number">100</span>+<span class="number">0.50000000001</span>); </span><br><span class="line">    cents = num%<span class="number">100</span>; </span><br><span class="line">    num = Math.floor(num/<span class="number">100</span>).toString(); </span><br><span class="line">    <span class="keyword">if</span>(cents&lt;<span class="number">10</span>) </span><br><span class="line">    cents = <span class="string">"0"</span> + cents; </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; Math.floor((num.length-(<span class="number">1</span>+i))/<span class="number">3</span>); i++) </span><br><span class="line">    num = num.substring(<span class="number">0</span>,num.length-(<span class="number">4</span>*i+<span class="number">3</span>))+<span class="string">','</span>+ </span><br><span class="line">    num.substring(num.length-(<span class="number">4</span>*i+<span class="number">3</span>)); </span><br><span class="line">    <span class="keyword">return</span> (((sign)?<span class="string">''</span>:<span class="string">'-'</span>) + num + <span class="string">'.'</span> + cents); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">function <span class="title">checkEmpty</span><span class="params">(id, name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> value = $(<span class="string">"#"</span>+id).val();</span><br><span class="line">    <span class="keyword">if</span>(value.length==<span class="number">0</span>)&#123;</span><br><span class="line">         </span><br><span class="line">        $(<span class="string">"#"</span>+id)[<span class="number">0</span>].focus();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">$(function()&#123;</span><br><span class="line"> </span><br><span class="line">    $(<span class="string">"a.productDetailTopReviewLink"</span>).click(function()&#123;</span><br><span class="line">        $(<span class="string">"div.productReviewDiv"</span>).show();</span><br><span class="line">        $(<span class="string">"div.productDetailDiv"</span>).hide();</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"a.productReviewTopPartSelectedLink"</span>).click(function()&#123;</span><br><span class="line">        $(<span class="string">"div.productReviewDiv"</span>).hide();</span><br><span class="line">        $(<span class="string">"div.productDetailDiv"</span>).show();      </span><br><span class="line">    &#125;);</span><br><span class="line">     </span><br><span class="line">    $(<span class="string">"span.leaveMessageTextareaSpan"</span>).hide();</span><br><span class="line">    $(<span class="string">"img.leaveMessageImg"</span>).click(function()&#123;</span><br><span class="line">         </span><br><span class="line">        $(<span class="keyword">this</span>).hide();</span><br><span class="line">        $(<span class="string">"span.leaveMessageTextareaSpan"</span>).show();</span><br><span class="line">        $(<span class="string">"div.orderItemSumDiv"</span>).css(<span class="string">"height"</span>,<span class="string">"100px"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">     </span><br><span class="line">    $(<span class="string">"div#footer a[href$=#nowhere]"</span>).click(function()&#123;</span><br><span class="line">        alert(<span class="string">"模仿天猫的连接，并没有跳转到实际的页面"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">     </span><br><span class="line">    $(<span class="string">"a.wangwanglink"</span>).click(function()&#123;</span><br><span class="line">        alert(<span class="string">"模仿旺旺的图标，并不会打开旺旺"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"a.notImplementLink"</span>).click(function()&#123;</span><br><span class="line">        alert(<span class="string">"这个功能没做，蛤蛤~"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">     </span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"> </span><br><span class="line">&lt;body&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-4-top-jsp"><a class="header-anchor" href="#步骤-4-top-jsp">¶</a>步骤 4 : top.jsp</h3>
<p>置顶导航页面<br>
这里会根据用户是否登录，决定是否显示退出按钮，或者登录注册按钮，以及购物车中的商品数量</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;nav <span class="class"><span class="keyword">class</span></span>=<span class="string">"top "</span>&gt;</span><br><span class="line">        &lt;a href=<span class="string">"$&#123;contextPath&#125;"</span>&gt;</span><br><span class="line">            &lt;span style="color:#C40000;margin:0px" class=" glyphicon glyphicon-home redColor"&gt;&lt;/span&gt;</span><br><span class="line">            天猫首页</span><br><span class="line">        &lt;/a&gt; </span><br><span class="line">         </span><br><span class="line">        &lt;span&gt;喵，欢迎来天猫&lt;/span&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;!empty user&#125;"</span>&gt;</span><br><span class="line">            &lt;a href="login.jsp"&gt;$&#123;user.name&#125;&lt;/a&gt;</span><br><span class="line">            &lt;a href="forelogout"&gt;退出&lt;/a&gt;    </span><br><span class="line">        &lt;/c:if&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;empty user&#125;"</span>&gt;</span><br><span class="line">            &lt;a href="login.jsp"&gt;请登录&lt;/a&gt;</span><br><span class="line">            &lt;a href="register.jsp"&gt;免费注册&lt;/a&gt;    </span><br><span class="line">        &lt;/c:if&gt;</span><br><span class="line"> </span><br><span class="line">        &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"pull-right"</span>&gt;</span><br><span class="line">            &lt;a href="forebought"&gt;我的订单&lt;/a&gt;</span><br><span class="line">            &lt;a href=<span class="string">"forecart"</span>&gt;</span><br><span class="line">            &lt;span style="color:#C40000;margin:0px" class=" glyphicon glyphicon-shopping-cart redColor"&gt;&lt;/span&gt;</span><br><span class="line">            购物车&lt;strong&gt;$&#123;cartTotalItemNumber&#125;&lt;/strong&gt;件&lt;/a&gt;      </span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">         </span><br><span class="line">&lt;/nav&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-5-search-jsp"><a class="header-anchor" href="#步骤-5-search-jsp">¶</a>步骤 5 : search.jsp</h3>
<p>这里会从request的属性&quot;cs&quot; 中获取到分类集合，并取第5个到第8个，一共4个来显示。</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3878.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;a href=<span class="string">"$&#123;contextPath&#125;"</span>&gt;</span><br><span class="line">        &lt;img id=<span class="string">"logo"</span> src=<span class="string">"img/site/logo.gif"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"logo"</span>&gt;</span><br><span class="line">    &lt;/a&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;form action=<span class="string">"foresearch"</span> method=<span class="string">"post"</span> &gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"searchDiv"</span>&gt;</span><br><span class="line">            &lt;input name=<span class="string">"keyword"</span> type=<span class="string">"text"</span> placeholder=<span class="string">"时尚男鞋  太阳镜 "</span>&gt;</span><br><span class="line">            &lt;button  type="submit" class="searchButton"&gt;搜索&lt;/button&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"searchBelow"</span>&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;st.count&gt;=5 and st.count&lt;=8&#125;"</span>&gt;</span><br><span class="line">                        &lt;span&gt;</span><br><span class="line">                            &lt;a href=<span class="string">"forecategory?cid=$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">                                $&#123;c.name&#125;</span><br><span class="line">                            &lt;/a&gt;</span><br><span class="line">                            &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;st.count!=8&#125;"</span>&gt;             </span><br><span class="line">                                &lt;span&gt;|&lt;/span&gt;             </span><br><span class="line">                            &lt;/c:if&gt;</span><br><span class="line">                        &lt;/span&gt;          </span><br><span class="line">                    &lt;/c:if&gt;</span><br><span class="line">                &lt;/c:forEach&gt;     </span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-homePage-jsp"><a class="header-anchor" href="#步骤-6-homePage-jsp">¶</a>步骤 6 : homePage.jsp</h3>
<p>这是首页业务页面，将在[homePage.jsp]中详细讲解，在此就不展开了。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;title&gt;模仿天猫官网&lt;/title&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"homepageDiv"</span>&gt;</span><br><span class="line">    &lt;%<span class="meta">@include</span> file=<span class="string">"categoryAndcarousel.jsp"</span>%&gt;</span><br><span class="line">    &lt;%<span class="meta">@include</span> file=<span class="string">"homepageCategoryProducts.jsp"</span>%&gt; </span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-footer-jsp"><a class="header-anchor" href="#步骤-7-footer-jsp">¶</a>步骤 7 : footer.jsp</h3>
<p>页脚部分,除了显示页脚的静态信息外，还包含了modal.jsp<br>
这个modal.jsp里提供了两个模态窗口</p>
<ol>
<li>登录模态窗口<br>
当用户在未登录状态，于产品页点击购买的时候会弹出</li>
<li>删除模态窗口<br>
当用户在我的订单页面,和购物车页面进行删除操作的时候，就会弹出模态删除窗口。</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3880.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//footer.jsp</span></span><br><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"modal.jsp"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div id=<span class="string">"footer"</span>  <span class="class"><span class="keyword">class</span></span>=<span class="string">"footer"</span> style=<span class="string">"display: block;"</span>&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div id=<span class="string">"footer_ensure"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"footer_ensure"</span>&gt;</span><br><span class="line">            &lt;a href=<span class="string">"#nowhere"</span>&gt;</span><br><span class="line">                &lt;img src=<span class="string">"img/site/ensure.png"</span>&gt;</span><br><span class="line">            &lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div id=<span class="string">"footer_desc"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"footer_desc"</span>&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"descColumn"</span>&gt;</span><br><span class="line">                &lt;span class="descColumnTitle"&gt;购物指南&lt;/span&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;免费注册&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;开通支付宝&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;支付宝充值&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"descColumn"</span>&gt;</span><br><span class="line">                &lt;span class="descColumnTitle"&gt;天猫保障&lt;/span&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;发票保障&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;售后规则&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;缺货赔付&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"descColumn"</span>&gt;</span><br><span class="line">                &lt;span class="descColumnTitle"&gt;支付方式&lt;/span&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;快捷支付&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;信用卡&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;蚂蚁花呗&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;货到付款&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"descColumn"</span>&gt;</span><br><span class="line">                &lt;span class="descColumnTitle"&gt;商家服务&lt;/span&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;商家入驻&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;商家中心&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;天猫智库&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;天猫规则&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;物流服务&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;喵言喵语&lt;/a&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;运营服务&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"descColumn"</span>&gt;</span><br><span class="line">                &lt;span class="descColumnTitle"&gt;手机天猫&lt;/span&gt;</span><br><span class="line">                &lt;a href="#nowhere" &gt;&lt;img src="img/site/ma.png"&gt;&lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">             </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div style="clear:both"&gt;&lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;img id=<span class="string">"cateye"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"cateye"</span> src=<span class="string">"img/site/cateye.png"</span>&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div id=<span class="string">"copyright"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"copyright"</span>&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"white_link"</span> &gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;关于天猫&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt; 帮助中心&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;开放平台&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  诚聘英才&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;联系我们&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;网站合作&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;法律声明&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;知识产权&lt;/a&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  廉正举报    &lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"white_link"</span> &gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt; 阿里巴巴集团&lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt; 淘宝网&lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;天猫 &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  聚划算&lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;全球速卖通&lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;阿里巴巴国际交易市场&lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;1688&lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;阿里妈妈&lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  阿里旅行·去啊 &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  阿里云计算   &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  阿里通信    &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  YunOS   &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  阿里旅行·去啊 &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;   万网 &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  高德  &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt; 优视   &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  友盟  &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  虾米  &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  天天动听    &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  来往  &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  钉钉  &lt;/a&gt;&lt;span class="slash"&gt;|&lt;/span&gt;</span><br><span class="line">            &lt;a href="#nowhere" &gt;  支付宝         &lt;/a&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"license"</span>&gt;</span><br><span class="line">            &lt;span&gt;增值电信业务经营许可证： 浙B2-20110446&lt;/span&gt;</span><br><span class="line">            &lt;span&gt;网络文化经营许可证：浙网文[2015]0295-065号&lt;/span&gt;</span><br><span class="line">            &lt;span&gt;互联网医疗保健信息服务 审核同意书 浙卫网审【2014】6号 &lt;/span&gt;</span><br><span class="line">            &lt;span&gt;互联网药品信息服务资质证书编号：浙-（经营性）-2012-0005&lt;/span&gt;</span><br><span class="line">            &lt;div class="copyRightYear"&gt;© 2003-2016 TMALL.COM 版权所有&lt;/div&gt;</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;img src=<span class="string">"img/site/copyRight1.jpg"</span>&gt;</span><br><span class="line">                &lt;img src=<span class="string">"img/site/copyRight2.jpg"</span>&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//modal.jsp</span></span><br><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal "</span> id=<span class="string">"loginModal"</span> tabindex=<span class="string">"-1"</span> role=<span class="string">"dialog"</span> &gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-dialog loginDivInProductPageModalDiv"</span>&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-content"</span>&gt;</span><br><span class="line">                    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"loginDivInProductPage"</span>&gt;</span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"loginErrorMessageDiv"</span>&gt;</span><br><span class="line">                            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"alert alert-danger"</span> &gt;</span><br><span class="line">                              &lt;button type="button" class="close" data-dismiss="alert" aria-label="Close"&gt;&lt;/button&gt;</span><br><span class="line">                                &lt;span class="errorMessage"&gt;&lt;/span&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                             </span><br><span class="line">                        &lt;div class="login_acount_text"&gt;账户登录&lt;/div&gt;</span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"loginInput "</span> &gt;</span><br><span class="line">                            &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"loginInputIcon "</span>&gt;</span><br><span class="line">                                &lt;span class=" glyphicon glyphicon-user"&gt;&lt;/span&gt;</span><br><span class="line">                            &lt;/span&gt;</span><br><span class="line">                            &lt;input id=<span class="string">"name"</span> name=<span class="string">"name"</span> placeholder=<span class="string">"手机/会员名/邮箱"</span> type=<span class="string">"text"</span>&gt;        </span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                         </span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"loginInput "</span> &gt;</span><br><span class="line">                            &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"loginInputIcon "</span>&gt;</span><br><span class="line">                                &lt;span class=" glyphicon glyphicon-lock"&gt;&lt;/span&gt;</span><br><span class="line">                            &lt;/span&gt;</span><br><span class="line">                            &lt;input id=<span class="string">"password"</span> name=<span class="string">"password"</span>  type=<span class="string">"password"</span> placeholder=<span class="string">"密码"</span> type=<span class="string">"text"</span>&gt;          </span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                                    &lt;span class="text-danger"&gt;不要输入真实的天猫账号密码&lt;/span&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">                        &lt;div&gt;</span><br><span class="line">                            &lt;a href="#nowhere"&gt;忘记登录密码&lt;/a&gt;</span><br><span class="line">                            &lt;a href="register.jsp" class="pull-right"&gt;免费注册&lt;/a&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div style=<span class="string">"margin-top:20px"</span>&gt;</span><br><span class="line">                            &lt;button class="btn btn-block redButton loginSubmitButton" type="submit"&gt;登录&lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;   </span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal"</span> id=<span class="string">"deleteConfirmModal"</span> tabindex=<span class="string">"-1"</span> role=<span class="string">"dialog"</span> &gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-dialog deleteConfirmModalDiv"</span>&gt;</span><br><span class="line">       &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-content"</span>&gt;</span><br><span class="line">          &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-header"</span>&gt;</span><br><span class="line">            &lt;button data-dismiss="modal" class="close" type="button"&gt;&lt;span aria-hidden="true"&gt;×&lt;/span&gt;&lt;span class="sr-only"&gt;Close&lt;/span&gt;&lt;/button&gt;</span><br><span class="line">            &lt;h4 class="modal-title"&gt;确认删除？&lt;/h4&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"modal-footer"</span>&gt;</span><br><span class="line">            &lt;button data-dismiss="modal" class="btn btn-default" type="button"&gt;关闭&lt;/button&gt;</span><br><span class="line">            &lt;button class="btn btn-primary deleteConfirmButton" id="submit" type="button"&gt;确认&lt;/button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h2 id="7、HOMEPAGE-JSP"><a class="header-anchor" href="#7、HOMEPAGE-JSP">¶</a>7、HOMEPAGE.JSP</h2>
<h3 id="步骤-1-homePage-jsp-的复杂性"><a class="header-anchor" href="#步骤-1-homePage-jsp-的复杂性">¶</a>步骤 1 : homePage.jsp 的复杂性</h3>
<p>在homePage中要显示如下内容<br>
1 天猫超市连接右侧有4个分类数据<br>
2 竖状导航栏显示17个分类数据<br>
3 每个分类又再对应不同的推荐产品集合<br>
4 中部会显示17个分类<br>
5 每个分类又显示前5款产品<br>
6 每款产品又会显示第一张图片，标题，价格等信息</p>
<p>倘若把这些功能都在一个jsp中开发出来看，那么这个jsp就会变得非常的长，并且难以维护和扩展。在这里，就可以借鉴[home.jsp]的思路，把一个大的页面，拆成各个小的jsp，这样维护起来就相对容易了</p>
<h3 id="步骤-2-homePage-jsp-所包含页面关系"><a class="header-anchor" href="#步骤-2-homePage-jsp-所包含页面关系">¶</a>步骤 2 : homePage.jsp 所包含页面关系</h3>
<ol>
<li>categoryAndcarousel.jsp<br>
分类和轮播<br>
1.1 categoryMenu.jsp<br>
竖状分类菜单<br>
1.2 productsAsideCategorys.jsp<br>
竖状分类菜单右侧的推荐产品列表<br>
1.3 carousel.jsp<br>
轮播</li>
<li>homepageCategoryProducts.jsp<br>
主题的17种分类以及每种分类对应的5个产品</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3882.png" alt></p>
<h3 id="步骤-3-categoryAndcarousel-jsp"><a class="header-anchor" href="#步骤-3-categoryAndcarousel-jsp">¶</a>步骤 3 : categoryAndcarousel.jsp</h3>
<p>categoryAndcarousel.jsp 页面利用ForeServlet传递过来的数据，天猫国际几个字旁边显示4个分类超链<br>
另外包含了其他3个页面：<br>
categoryMenu.jsp<br>
productsAsideCategorys.jsp<br>
carousel.jsp<br>
这3个页面在接下来的步骤就会讲到</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3883.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="function">function <span class="title">showProductsAsideCategorys</span><span class="params">(cid)</span></span>&#123;</span><br><span class="line">    $(<span class="string">"div.eachCategory[cid="</span>+cid+<span class="string">"]"</span>).css(<span class="string">"background-color"</span>,<span class="string">"white"</span>);</span><br><span class="line">    $(<span class="string">"div.eachCategory[cid="</span>+cid+<span class="string">"] a"</span>).css(<span class="string">"color"</span>,<span class="string">"#87CEFA"</span>);</span><br><span class="line">    $(<span class="string">"div.productsAsideCategorys[cid="</span>+cid+<span class="string">"]"</span>).show();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function">function <span class="title">hideProductsAsideCategorys</span><span class="params">(cid)</span></span>&#123;</span><br><span class="line">    $(<span class="string">"div.eachCategory[cid="</span>+cid+<span class="string">"]"</span>).css(<span class="string">"background-color"</span>,<span class="string">"#e2e2e3"</span>);</span><br><span class="line">    $(<span class="string">"div.eachCategory[cid="</span>+cid+<span class="string">"] a"</span>).css(<span class="string">"color"</span>,<span class="string">"#000"</span>);</span><br><span class="line">    $(<span class="string">"div.productsAsideCategorys[cid="</span>+cid+<span class="string">"]"</span>).hide();</span><br><span class="line">&#125;</span><br><span class="line">$(function()&#123;</span><br><span class="line">    $(<span class="string">"div.eachCategory"</span>).mouseenter(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> cid = $(<span class="keyword">this</span>).attr(<span class="string">"cid"</span>);</span><br><span class="line">        showProductsAsideCategorys(cid);</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"div.eachCategory"</span>).mouseleave(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> cid = $(<span class="keyword">this</span>).attr(<span class="string">"cid"</span>);</span><br><span class="line">        hideProductsAsideCategorys(cid);</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"div.productsAsideCategorys"</span>).mouseenter(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> cid = $(<span class="keyword">this</span>).attr(<span class="string">"cid"</span>);</span><br><span class="line">        showProductsAsideCategorys(cid);</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"div.productsAsideCategorys"</span>).mouseleave(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> cid = $(<span class="keyword">this</span>).attr(<span class="string">"cid"</span>);</span><br><span class="line">        hideProductsAsideCategorys(cid);</span><br><span class="line">    &#125;);</span><br><span class="line">     </span><br><span class="line">    $(<span class="string">"div.rightMenu span"</span>).mouseenter(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> left = $(<span class="keyword">this</span>).position().left;</span><br><span class="line">        <span class="keyword">var</span> top = $(<span class="keyword">this</span>).position().top;</span><br><span class="line">        <span class="keyword">var</span> width = $(<span class="keyword">this</span>).css(<span class="string">"width"</span>);</span><br><span class="line">        <span class="keyword">var</span> destLeft = parseInt(left) + parseInt(width)/<span class="number">2</span>;</span><br><span class="line">        $(<span class="string">"img#catear"</span>).css(<span class="string">"left"</span>,destLeft);</span><br><span class="line">        $(<span class="string">"img#catear"</span>).css(<span class="string">"top"</span>,top-<span class="number">20</span>);</span><br><span class="line">        $(<span class="string">"img#catear"</span>).fadeIn(<span class="number">500</span>);</span><br><span class="line">                 </span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"div.rightMenu span"</span>).mouseleave(function()&#123;</span><br><span class="line">        $(<span class="string">"img#catear"</span>).hide();</span><br><span class="line">    &#125;);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span> left = $(<span class="string">"div#carousel-of-product"</span>).offset().left;</span><br><span class="line">    $(<span class="string">"div.categoryMenu"</span>).css(<span class="string">"left"</span>,left-<span class="number">20</span>);</span><br><span class="line">    $(<span class="string">"div.categoryWithCarousel div.head"</span>).css(<span class="string">"margin-left"</span>,left);</span><br><span class="line">    $(<span class="string">"div.productsAsideCategorys"</span>).css(<span class="string">"left"</span>,left-<span class="number">20</span>);</span><br><span class="line">     </span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;img src=<span class="string">"img/site/catear.png"</span> id=<span class="string">"catear"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"catear"</span>/&gt;</span><br><span class="line">     </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"categoryWithCarousel"</span>&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"headbar show1"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"head "</span>&gt;</span><br><span class="line">     </span><br><span class="line">        &lt;span style="margin-left:10px" class="glyphicon glyphicon-th-list"&gt;&lt;/span&gt;</span><br><span class="line">        &lt;span style="margin-left:10px" &gt;商品分类&lt;/span&gt;</span><br><span class="line">         </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"rightMenu"</span>&gt;</span><br><span class="line">        &lt;span&gt;&lt;a href=""&gt;&lt;img src="img/site/chaoshi.png"/&gt;&lt;/a&gt;&lt;/span&gt;</span><br><span class="line">        &lt;span&gt;&lt;a href=""&gt;&lt;img src="img/site/guoji.png"/&gt;&lt;/a&gt;&lt;/span&gt;</span><br><span class="line"> </span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">            &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;st.count&lt;=4&#125;"</span>&gt;</span><br><span class="line">                &lt;span&gt;</span><br><span class="line">                &lt;a href=<span class="string">"forecategory?cid=$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">                    $&#123;c.name&#125;</span><br><span class="line">                &lt;/a&gt;&lt;/span&gt;        </span><br><span class="line">            &lt;/c:if&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div style=<span class="string">"position: relative"</span>&gt;</span><br><span class="line">    &lt;%<span class="meta">@include</span> file=<span class="string">"categoryMenu.jsp"</span> %&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div style=<span class="string">"position: relative;left: 0;top: 0;"</span>&gt;</span><br><span class="line">    &lt;%<span class="meta">@include</span> file=<span class="string">"productsAsideCategorys.jsp"</span> %&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@include</span> file=<span class="string">"carousel.jsp"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"carouselBackgroundDiv"</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-4-categoryMenu-jsp"><a class="header-anchor" href="#步骤-4-categoryMenu-jsp">¶</a>步骤 4 : categoryMenu.jsp</h3>
<p>categoryMenu.jsp 显示左侧的竖状分类导航</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3884.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">     </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"categoryMenu"</span>&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span>&gt;</span><br><span class="line">            &lt;div cid=<span class="string">"$&#123;c.id&#125;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"eachCategory"</span>&gt;</span><br><span class="line">                &lt;span class="glyphicon glyphicon-link"&gt;&lt;/span&gt;</span><br><span class="line">                &lt;a href=<span class="string">"forecategory?cid=$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">                    $&#123;c.name&#125;</span><br><span class="line">                &lt;/a&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-5-productsAsideCategorys-jsp"><a class="header-anchor" href="#步骤-5-productsAsideCategorys-jsp">¶</a>步骤 5 : productsAsideCategorys.jsp</h3>
<p>productsAsideCategorys.jsp 进行了三层遍历</p>
<ol>
<li>先取出每个分类</li>
<li>然后取出每个分类的productsByRow集合</li>
<li>根据productsByRow集合，取出每个产品，把产品的subTitle信息里的第一个单词取出来显示。</li>
</ol>
<p>JQuery代码解释：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">这个是用于随机挑选一个产品作为推荐产品，来进行高亮显示。 严格的说，应该是后台设置那个产品是推荐产品，不过这里偷懒了，直接在前端按照<span class="number">20</span>%的概率，随机挑选了一个产品。</span><br><span class="line">$(<span class="string">"div.productsAsideCategorys div.row a"</span>).each(function()&#123;</span><br><span class="line">	<span class="keyword">var</span> v = Math.round(Math.random() *<span class="number">6</span>);</span><br><span class="line">	<span class="keyword">if</span>(v == <span class="number">1</span>)</span><br><span class="line">		$(<span class="keyword">this</span>).css(<span class="string">"color"</span>,<span class="string">"#87CEFA"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3885.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">$(function()&#123;</span><br><span class="line">    $(<span class="string">"div.productsAsideCategorys div.row a"</span>).each(function()&#123;</span><br><span class="line">        <span class="keyword">var</span> v = Math.round(Math.random() *<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">if</span>(v == <span class="number">1</span>)</span><br><span class="line">            $(<span class="keyword">this</span>).css(<span class="string">"color"</span>,<span class="string">"#87CEFA"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span>&gt;</span><br><span class="line">    &lt;div cid=<span class="string">"$&#123;c.id&#125;"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"productsAsideCategorys"</span>&gt;</span><br><span class="line">      </span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;c.productsByRow&#125;"</span> <span class="keyword">var</span>=<span class="string">"ps"</span>&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"row show1"</span>&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;ps&#125;"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;!empty p.subTitle&#125;"</span>&gt;</span><br><span class="line">                        &lt;a href=<span class="string">"foreproduct?pid=$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">                            &lt;c:forEach items=<span class="string">"$&#123;fn:split(p.subTitle, ' ')&#125;"</span> <span class="keyword">var</span>=<span class="string">"title"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">                                &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;st.index==0&#125;"</span>&gt;</span><br><span class="line">                                    $&#123;title&#125;</span><br><span class="line">                                &lt;/c:if&gt;</span><br><span class="line">                            &lt;/c:forEach&gt;</span><br><span class="line">                        &lt;/a&gt;</span><br><span class="line">                    &lt;/c:if&gt;</span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">                &lt;div class="seperator"&gt;&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;       </span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/div&gt;           </span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-6-carousel-jsp"><a class="header-anchor" href="#步骤-6-carousel-jsp">¶</a>步骤 6 : carousel.jsp</h3>
<p>轮播部分，都是静态的页面，没有用到服务端数据</p>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3886.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">     </span><br><span class="line">&lt;div id=<span class="string">"carousel-of-product"</span>  <span class="class"><span class="keyword">class</span></span>=<span class="string">"carousel-of-product carousel slide1"</span> data-ride=<span class="string">"carousel"</span>&gt;</span><br><span class="line">  &lt;!-- Indicators --&gt;</span><br><span class="line">  &lt;ol <span class="class"><span class="keyword">class</span></span>=<span class="string">"carousel-indicators"</span>&gt;</span><br><span class="line">    &lt;li data-target="#carousel-of-product" data-slide-to="0" class="active"&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li data-target="#carousel-of-product" data-slide-to="1"&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li data-target="#carousel-of-product" data-slide-to="2"&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li data-target="#carousel-of-product" data-slide-to="3"&gt;&lt;/li&gt;</span><br><span class="line">  &lt;/ol&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;!-- Wrapper <span class="keyword">for</span> slides --&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"carousel-inner"</span> role=<span class="string">"listbox"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"item active"</span>&gt;</span><br><span class="line">      &lt;img <span class="class"><span class="keyword">class</span></span>=<span class="string">"carousel carouselImage"</span> src=<span class="string">"img/lunbo/1.jpg"</span> &gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;</span><br><span class="line">      &lt;img  <span class="class"><span class="keyword">class</span></span>=<span class="string">"carouselImage"</span> src=<span class="string">"img/lunbo/2.jpg"</span> &gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;</span><br><span class="line">        &lt;img  <span class="class"><span class="keyword">class</span></span>=<span class="string">"carouselImage"</span> src=<span class="string">"img/lunbo/3.jpg"</span> &gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"item"</span>&gt;</span><br><span class="line">        &lt;img  <span class="class"><span class="keyword">class</span></span>=<span class="string">"carouselImage"</span> src=<span class="string">"img/lunbo/4.jpg"</span> &gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;!-- Controls --&gt;</span><br><span class="line">&lt;!--   &lt;a <span class="class"><span class="keyword">class</span></span>=<span class="string">"left carousel-control"</span> href=<span class="string">"#carousel-of-product"</span> role=<span class="string">"button"</span> data-slide=<span class="string">"prev"</span>&gt; --&gt;</span><br><span class="line">&lt;!--     &lt;span class="glyphicon glyphicon-chevron-left" aria-hidden="true"&gt;&lt;/span&gt; --&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!--   &lt;/a&gt; --&gt;</span><br><span class="line">&lt;!--   &lt;a <span class="class"><span class="keyword">class</span></span>=<span class="string">"right carousel-control"</span> href=<span class="string">"#carousel-of-product"</span> role=<span class="string">"button"</span> data-slide=<span class="string">"next"</span>&gt; --&gt;</span><br><span class="line">&lt;!--     &lt;span class="glyphicon glyphicon-chevron-right" aria-hidden="true"&gt;&lt;/span&gt; --&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!--   &lt;/a&gt; --&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-7-homepageCategoryProducts-jsp"><a class="header-anchor" href="#步骤-7-homepageCategoryProducts-jsp">¶</a>步骤 7 : homepageCategoryProducts.jsp</h3>
<p>homepageCategoryProducts.jsp 进行了2次遍历</p>
<ol>
<li>遍历所有的分类，取出每个分类对象</li>
<li>遍历分类对象的products集合，取出每个产品，然后显示该产品的标题，图片，价格等信息</li>
</ol>
<p><img src="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/3887.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;empty param.categorycount&#125;"</span>&gt;</span><br><span class="line">    &lt;c:set <span class="keyword">var</span>=<span class="string">"categorycount"</span> scope=<span class="string">"page"</span> value=<span class="string">"100"</span>/&gt;</span><br><span class="line">&lt;/c:if&gt;</span><br><span class="line"> </span><br><span class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;!empty param.categorycount&#125;"</span>&gt;</span><br><span class="line">    &lt;c:set <span class="keyword">var</span>=<span class="string">"categorycount"</span> scope=<span class="string">"page"</span> value=<span class="string">"$&#123;param.categorycount&#125;"</span>/&gt;</span><br><span class="line">&lt;/c:if&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"homepageCategoryProducts"</span>&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"stc"</span>&gt;</span><br><span class="line">        &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;stc.count&lt;=categorycount&#125;"</span>&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"eachHomepageCategoryProducts"</span>&gt;</span><br><span class="line">                &lt;div class="left-mark"&gt;&lt;/div&gt;</span><br><span class="line">                &lt;span class="categoryTitle"&gt;$&#123;c.name&#125;&lt;/span&gt;</span><br><span class="line">                &lt;br&gt;</span><br><span class="line">                &lt;c:forEach items=<span class="string">"$&#123;c.products&#125;"</span> <span class="keyword">var</span>=<span class="string">"p"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">                    &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;st.count&lt;=5&#125;"</span>&gt;</span><br><span class="line">                        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"productItem"</span> &gt;</span><br><span class="line">                            &lt;a href="foreproduct?pid=$&#123;p.id&#125;"&gt;&lt;img width="100px" src="img/productSingle_middle/$&#123;p.firstProductImage.id&#125;.jpg"&gt;&lt;/a&gt;</span><br><span class="line">                            &lt;a <span class="class"><span class="keyword">class</span></span>=<span class="string">"productItemDescLink"</span> href=<span class="string">"foreproduct?pid=$&#123;p.id&#125;"</span>&gt;</span><br><span class="line">                                &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"productItemDesc"</span>&gt;[热销]</span><br><span class="line">                                $&#123;fn:substring(p.name, <span class="number">0</span>, <span class="number">20</span>)&#125;</span><br><span class="line">                                &lt;/span&gt;</span><br><span class="line">                            &lt;/a&gt;</span><br><span class="line">                            &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"productPrice"</span>&gt;</span><br><span class="line">                                &lt;fmt:formatNumber type=<span class="string">"number"</span> value=<span class="string">"$&#123;p.promotePrice&#125;"</span> minFractionDigits=<span class="string">"2"</span>/&gt;</span><br><span class="line">                            &lt;/span&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/c:if&gt;              </span><br><span class="line">                &lt;/c:forEach&gt;</span><br><span class="line">                &lt;div style="clear:both"&gt;&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/c:if&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;img id=<span class="string">"endpng"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"endpng"</span> src=<span class="string">"img/site/end.png"</span>&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h3 id="步骤-8-总结"><a class="header-anchor" href="#步骤-8-总结">¶</a>步骤 8 : 总结</h3>
<p>虽然首页显示的内容非常多，可以说是前端里最复杂的一个展示页面，但是通过这种拆成小块jsp的思路，每个jsp页面的功能就相对单一了。 可以更好的帮助大家理解。</p>

      
    </div>
    
    
    

    <div>
     
         <div>
 
  <div style="text-align:center;color:#bfbfbf;font-size:16px;">
   <span>-------- 本文结束 </span>
   <i class="fa fa-paw"></i>
   <span> 感谢阅读 --------</span>
  </div>
 
</div>
     
    </div>

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="潇 卟 甸 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="潇 卟 甸 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/08/31/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3/" rel="next" title="Java实践-天猫整站J2EE/新建文本文档">
                <i class="fa fa-chevron-left"></i> Java实践-天猫整站J2EE/新建文本文档
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/09/04/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(3)/" rel="prev" title="Java实践-天猫整站J2EE/新建文本文档 (3)">
                Java实践-天猫整站J2EE/新建文本文档 (3) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <a href="/">
              <img class="site-author-image" itemprop="image"
                src="/uploads/picture.jpg"
                alt="潇 卟 甸" />
              </a>
            
              <p class="site-author-name" itemprop="name">潇 卟 甸</p>
              <p class="site-description motion-element" itemprop="description">总结自己一些知识，一些事</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">48</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

			
				<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
				<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
				<div class="widget-wrap">
					<div id="myCanvasContainer" class="widget tagcloud">
						<canvas width="250" height="250" id="resCanvas" style="width=100%">
							<ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%AE%9E%E8%B7%B5/" rel="tag">Java实践</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/b%E7%AB%99%E8%A7%86%E9%A2%91/" rel="tag">b站视频</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E7%BA%A7/" rel="tag">中级</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%96%9C%E9%A9%AC%E6%8B%89%E9%9B%85/" rel="tag">喜马拉雅</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80/" rel="tag">基础</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E8%AF%AD/" rel="tag">日语</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E4%BB%A3%E7%A0%81/" rel="tag">源代码</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%B5%E5%AD%90%E4%B9%A6/" rel="tag">电子书</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a><span class="tag-list-count">32</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BE%8E%E5%8C%96/" rel="tag">美化</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%B1%E8%AF%AD/" rel="tag">英语</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" rel="tag">计算机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E6%8E%A8%E8%8D%90/" rel="tag">读书推荐</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E9%98%B6/" rel="tag">进阶</a><span class="tag-list-count">3</span></li></ul>
						</canvas>
					</div>
				</div>
			

          </nav>

          

          
		  
		  <!-- 添加近期文章 -->
			
				<div class="links-of-blogroll motion-element links-of-blogroll-block">
				<div class="links-of-blogroll-title">
				<!-- modify icon to fire by szw -->
				<i class="fa fa-history fa-" aria-hidden="true"></i>
				近期文章
				</div>
				<ul class="links-of-blogroll-list">
				
				
					<li>
					<a href="/2020/09/05/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(4)/" title="Java实践-天猫整站J2EE/新建文本文档 (4)" target="_blank">Java实践-天猫整站J2EE/新建文本文档 (4)</a>
					</li>
				
					<li>
					<a href="/2020/09/04/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(3)/" title="Java实践-天猫整站J2EE/新建文本文档 (3)" target="_blank">Java实践-天猫整站J2EE/新建文本文档 (3)</a>
					</li>
				
					<li>
					<a href="/2020/09/02/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3%20(2)/" title="Java实践-天猫整站J2EE/新建文本文档 (2)" target="_blank">Java实践-天猫整站J2EE/新建文本文档 (2)</a>
					</li>
				
					<li>
					<a href="/2020/08/31/Java%E5%AE%9E%E8%B7%B5-%E5%A4%A9%E7%8C%AB%E6%95%B4%E7%AB%99J2EE/%E6%96%B0%E5%BB%BA%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3/" title="Java实践-天猫整站J2EE/新建文本文档" target="_blank">Java实践-天猫整站J2EE/新建文本文档</a>
					</li>
				
					<li>
					<a href="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/" title="J2EE【HOW2J】" target="_blank">J2EE【HOW2J】</a>
					</li>
				
				</ul>
			</div>
			

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐阅读
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://sushan102.top/posts/1410804403/" title="博客搭建" target="_blank">博客搭建</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://how2j.cn?p=154642" title="HOW2J" target="_blank">HOW2J</a>
                  </li>
                
              </ul>
            </div>
          
		  
		  
			
		  
		  <div style="">
  <canvas id="canvas" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();
</script>


        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#十一、后台-其他管理"><span class="nav-text">十一、后台-其他管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、后台其他页面"><span class="nav-text">1、后台其他页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、属性管理"><span class="nav-text">2、属性管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-模仿和排错"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-页面截图"><span class="nav-text">步骤 3 : 页面截图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-在分类管理页面上添加属性管理的超链"><span class="nav-text">步骤 4 : 在分类管理页面上添加属性管理的超链</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-PropertyServlet类"><span class="nav-text">步骤 5 : PropertyServlet类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-web-xml"><span class="nav-text">步骤 6 : web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-listProperty-jsp-editProperty-jsp"><span class="nav-text">步骤 7 : listProperty.jsp+editProperty.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-8-查询功能讲解"><span class="nav-text">步骤 8 : 查询功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-9-增加功能讲解"><span class="nav-text">步骤 9 : 增加功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-10-编辑功能讲解"><span class="nav-text">步骤 10 : 编辑功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-11-修改功能讲解"><span class="nav-text">步骤 11 : 修改功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-12-删除功能讲解"><span class="nav-text">步骤 12 : 删除功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-13-其他-面包屑导航"><span class="nav-text">步骤 13 : 其他-面包屑导航</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-14-其他-分页"><span class="nav-text">步骤 14 : 其他-分页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-15-自己做一遍"><span class="nav-text">步骤 15 : 自己做一遍</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、产品管理"><span class="nav-text">3、产品管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v2"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-模仿和排错-v2"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-页面截图-v2"><span class="nav-text">步骤 3 : 页面截图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-在分类管理页面上添加产品管理的超链"><span class="nav-text">步骤 4 : 在分类管理页面上添加产品管理的超链</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-ProductServlet类"><span class="nav-text">步骤 5 : ProductServlet类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-web-xml-v2"><span class="nav-text">步骤 6 : web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-listProduct-jsp-editProduct-jsp"><span class="nav-text">步骤 7 : listProduct.jsp+editProduct.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-8-查询功能讲解-v2"><span class="nav-text">步骤 8 : 查询功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-9-增加功能讲解-v2"><span class="nav-text">步骤 9 : 增加功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-10-编辑功能讲解-v2"><span class="nav-text">步骤 10 : 编辑功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-11-修改功能讲解-v2"><span class="nav-text">步骤 11 : 修改功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-12-删除功能讲解-v2"><span class="nav-text">步骤 12 : 删除功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-13-自己做一遍"><span class="nav-text">步骤 13 : 自己做一遍</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、产品图片管理"><span class="nav-text">4、产品图片管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v3"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-模仿和排错-v3"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-页面截图-v3"><span class="nav-text">步骤 3 : 页面截图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-ProductImageServlet类"><span class="nav-text">步骤 4 : ProductImageServlet类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-web-xml"><span class="nav-text">步骤 5 : web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-listProductImage-jsp"><span class="nav-text">步骤 6 : listProductImage.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-查询功能讲解"><span class="nav-text">步骤 7 : 查询功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-8-增加功能讲解"><span class="nav-text">步骤 8 : 增加功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-9-删除功能讲解"><span class="nav-text">步骤 9 : 删除功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-10-编辑和修改"><span class="nav-text">步骤 10 : 编辑和修改</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、产品属性值设置"><span class="nav-text">5、产品属性值设置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v4"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-模仿和排错-v4"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-页面截图-v4"><span class="nav-text">步骤 3 : 页面截图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-PropertyValueServlet"><span class="nav-text">步骤 4 : PropertyValueServlet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-web-xml-v2"><span class="nav-text">步骤 5 : web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-editProductValue-jsp"><span class="nav-text">步骤 6 : editProductValue.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-编辑功能讲解"><span class="nav-text">步骤 7 : 编辑功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-8-修改功能讲解"><span class="nav-text">步骤 8 : 修改功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-9-删除，增加功能不需要"><span class="nav-text">步骤 9 : 删除，增加功能不需要</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、用户管理"><span class="nav-text">6、用户管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v5"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-模仿和排错-v5"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-准备数据"><span class="nav-text">步骤 3 : 准备数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-页面截图"><span class="nav-text">步骤 4 : 页面截图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-UserServlet"><span class="nav-text">步骤 5 : UserServlet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-web-xml-v3"><span class="nav-text">步骤 6 : web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-listUser-jsp"><span class="nav-text">步骤 7 : listUser.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-8-查询功能讲解-v3"><span class="nav-text">步骤 8 : 查询功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-9-增加，删除，修改功能"><span class="nav-text">步骤 9 : 增加，删除，修改功能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、订单管理"><span class="nav-text">7、订单管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v6"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-模仿和排错-v6"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-准备数据SQL"><span class="nav-text">步骤 3 : 准备数据SQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-页面截图-v2"><span class="nav-text">步骤 4 : 页面截图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-OrderServlet-java"><span class="nav-text">步骤 5 : OrderServlet.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-Order-java"><span class="nav-text">步骤 6 : Order.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-web-xml"><span class="nav-text">步骤 7 : web.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-8-listOrder-jsp"><span class="nav-text">步骤 8 : listOrder.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-9-查询功能讲解"><span class="nav-text">步骤 9 : 查询功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-10-发货功能讲解"><span class="nav-text">步骤 10 : 发货功能讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-11-增加，修改，删除功能"><span class="nav-text">步骤 11 : 增加，修改，删除功能</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十二、原型-前端"><span class="nav-text">十二、原型-前端</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、概述"><span class="nav-text">1、概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-真正开发的时候会直接使用这些前端页面吗？"><span class="nav-text">步骤 1 : 真正开发的时候会直接使用这些前端页面吗？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-homePage-jsp-又由多个子jsp文件组成"><span class="nav-text">步骤 2 : homePage.jsp 又由多个子jsp文件组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-这些前端原型的作用"><span class="nav-text">步骤 3 : 这些前端原型的作用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、首页"><span class="nav-text">2、首页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、分类页"><span class="nav-text">3、分类页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v2"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、产品页面"><span class="nav-text">4、产品页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v3"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、购物车页面"><span class="nav-text">5、购物车页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v4"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、我的订单页面"><span class="nav-text">6、我的订单页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v5"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、结算页面"><span class="nav-text">7、结算页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v6"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8、查询结果页"><span class="nav-text">8、查询结果页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v7"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9、支付页面"><span class="nav-text">9、支付页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v8"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10、支付成功页面"><span class="nav-text">10、支付成功页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v9"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11、确认收货页面"><span class="nav-text">11、确认收货页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v10"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12、收货成功页面"><span class="nav-text">12、收货成功页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v11"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13、评价页面"><span class="nav-text">13、评价页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v12"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14、登录页面"><span class="nav-text">14、登录页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-效果-v13"><span class="nav-text">步骤 1 : 效果</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十三、前台-首页"><span class="nav-text">十三、前台-首页</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、概述-v2"><span class="nav-text">1、概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、可运行项目"><span class="nav-text">2、可运行项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-先看效果"><span class="nav-text">步骤 1 : 先看效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-可运行项目"><span class="nav-text">步骤 2 : 可运行项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-导入SQL语句"><span class="nav-text">步骤 3 : 导入SQL语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-限制性"><span class="nav-text">步骤 4 : 限制性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、静态资源"><span class="nav-text">3、静态资源</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-图片资源-site目录"><span class="nav-text">步骤 1 : 图片资源-site目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-图片资源-轮播图片"><span class="nav-text">步骤 2 : 图片资源-轮播图片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-图片资源-分类图片"><span class="nav-text">步骤 3 : 图片资源-分类图片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-图片资源-产品图片"><span class="nav-text">步骤 4 : 图片资源-产品图片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-css"><span class="nav-text">步骤 5 : css</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-js"><span class="nav-text">步骤 6 : js</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-img-rar"><span class="nav-text">步骤 7 : img.rar</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、FILTER配合SERVLET"><span class="nav-text">4、FILTER配合SERVLET</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-一个路径对应一个Servlet的弊端"><span class="nav-text">步骤 1 : 一个路径对应一个Servlet的弊端</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-简化之后的效果"><span class="nav-text">步骤 2 : 简化之后的效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-原理流程图"><span class="nav-text">步骤 3 : 原理流程图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-代码讲解-ForeServletFilter"><span class="nav-text">步骤 4 : 代码讲解 - ForeServletFilter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-代码讲解-ForeServlet和BaseForeServlet"><span class="nav-text">步骤 5 : 代码讲解 - ForeServlet和BaseForeServlet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-一个Servlet类就能满足所有前端业务要求"><span class="nav-text">步骤 6 : 一个Servlet类就能满足所有前端业务要求</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、HOME方法"><span class="nav-text">5、HOME方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-MVC-设计思想"><span class="nav-text">步骤 1 : MVC 设计思想</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-首页需要什么数据？"><span class="nav-text">步骤 2 : 首页需要什么数据？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-home方法"><span class="nav-text">步骤 3 : home方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、HOME-JSP"><span class="nav-text">6、HOME.JSP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-前台页面的特点"><span class="nav-text">步骤 1 : 前台页面的特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-home-jsp-所包含页面"><span class="nav-text">步骤 2 : home.jsp 所包含页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-header-jsp"><span class="nav-text">步骤 3 : header.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-top-jsp"><span class="nav-text">步骤 4 : top.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-search-jsp"><span class="nav-text">步骤 5 : search.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-homePage-jsp"><span class="nav-text">步骤 6 : homePage.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-footer-jsp"><span class="nav-text">步骤 7 : footer.jsp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7、HOMEPAGE-JSP"><span class="nav-text">7、HOMEPAGE.JSP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1-homePage-jsp-的复杂性"><span class="nav-text">步骤 1 : homePage.jsp 的复杂性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-2-homePage-jsp-所包含页面关系"><span class="nav-text">步骤 2 : homePage.jsp 所包含页面关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-3-categoryAndcarousel-jsp"><span class="nav-text">步骤 3 : categoryAndcarousel.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-4-categoryMenu-jsp"><span class="nav-text">步骤 4 : categoryMenu.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-5-productsAsideCategorys-jsp"><span class="nav-text">步骤 5 : productsAsideCategorys.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-6-carousel-jsp"><span class="nav-text">步骤 6 : carousel.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-7-homepageCategoryProducts-jsp"><span class="nav-text">步骤 7 : homepageCategoryProducts.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-8-总结"><span class="nav-text">步骤 8 : 总结</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script
  async
  src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"
></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">潇 卟 甸</span>

  
</div>

<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>

-->



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
     我的第 <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 位朋友，
    </span>
  

  
    <span class="site-pv">
     历经 <span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次回眸才与你相遇
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: 'w1mVK8MFY7n2fWIKlq2t9EJn-gzGzoHsz',
        appKey: 'NMGzUaGqmpzSiSItkHBQGUaA',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("w1mVK8MFY7n2fWIKlq2t9EJn-gzGzoHsz", "NMGzUaGqmpzSiSItkHBQGUaA");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  


  

 <script src="/js/src/activate-power-mode.js"></script>
 <script>
   POWERMODE.colorful = true;
   POWERMODE.shake = false;
   document.body.addEventListener('input', POWERMODE);
 </script>




<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.min.js"></script>
<script>
  function timer() {
    var ages = moment.preciseDiff(moment(),moment(20200610,"YYYYMMDD"));
    ages = ages.replace(/years?/, "年");
    ages = ages.replace(/months?/, "月");
    ages = ages.replace(/days?/, "天");
    ages = ages.replace(/hours?/, "小时");
    ages = ages.replace(/minutes?/, "分");
    ages = ages.replace(/seconds?/, "秒");
    ages = ages.replace(/\d+/g, '<span style="color:#1890ff">$&</span>');
    div.innerHTML = `我已在此等候你 ${ages}`;
  }
  var div = document.createElement("div");
  //插入到copyright之后
  var copyright = document.querySelector(".copyright");
  document.querySelector(".footer-inner").insertBefore(div, copyright.nextSibling);
  timer();
  setInterval("timer()",1000)
</script>




<script>
  var OriginTitile = document.title;
  var titleTime;
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      document.title = "(つェ⊂)我藏好了哦~" + OriginTitile;
      clearTimeout(titleTime);
    } else {
      document.title = "(*´∇｀*) 被你发现啦~" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
      }, 2000);
    }
  });
</script>


  
</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>
