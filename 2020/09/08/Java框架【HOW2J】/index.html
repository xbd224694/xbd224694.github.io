<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Java,编程,进阶," />










<meta name="description" content="地址：https:&#x2F;&#x2F;how2j.cn?p&#x3D;154642">
<meta property="og:type" content="article">
<meta property="og:title" content="Java框架【HOW2J】">
<meta property="og:url" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/index.html">
<meta property="og:site_name" content="伶仃浩瀚">
<meta property="og:description" content="地址：https:&#x2F;&#x2F;how2j.cn?p&#x3D;154642">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1816.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4330.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4331.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/68.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1868.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6608.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1817.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1818.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1819.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1820.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1821.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1822.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1823.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1824.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/95.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1825.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/97.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/99.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/100.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1826.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/108.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/121.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/122.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/123.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/125.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/126.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/118.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1827.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1830.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1831.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/3101.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1841.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/129.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5849.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/132.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/133.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/134.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1870.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5414.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/139.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1871.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1844.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/144.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1874.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1845.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1834.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1835.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/145.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1836.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/158.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1846.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1837.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1847.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/165.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1848.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/173.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1849.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/187.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1850.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/189.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1838.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1851.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1839.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1853.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4476.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4478.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1852.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/175.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5431.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1854.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1855.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/184.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1856.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1857.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1840.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1858.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/152.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1859.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/154.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/155.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1860.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1862.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5436.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4053.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4056.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4562.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4563.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4564.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/214.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1876.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/217.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4077.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4078.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4079.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4083.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1878.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1863.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/221.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4087.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4487.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4491.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4489.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1879.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5445.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/209.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1866.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1867.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5447.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1864.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1865.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/226.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5848.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/231.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4534.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4531.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/240.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1881.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/3105.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/3106.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5883.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4136.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4138.png">
<meta property="og:image" content="http://yoursite.com/2020/09/java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4142.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4151.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5845.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1899.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1899.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1890.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1894.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1896.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1897.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1905.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1903.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1904.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1906.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1909.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1917.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1915.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1920.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1919.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1922.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1925.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1927.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1930.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1931.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1937.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4543.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4542.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4195.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4199.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4200.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4204.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4205.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4214.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4221.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4222.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4233.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4234.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4237.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4241.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4252.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4253.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4254.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4266.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4267.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4270.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4274.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4279.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4321.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4319.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4323.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4327.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4337.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4348.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4349.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4350.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4352.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4362.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4367.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4369.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4370.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4374.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5855.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5856.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4377.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4378.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4458.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4462.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4465.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4472.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5874.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5879.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4495.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4604.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4503.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4504.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4518.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4555.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4553.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5862.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5863.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5870.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4559.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5843.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5846.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4582.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4575.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4578.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4580.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6682.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6684.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6686.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7111.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7116.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7117.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7119.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7120.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7121.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7124.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7126.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7127.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7128.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7129.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7130.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7131.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7133.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7136.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7137.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7138.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7140.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7143.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7144.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7145.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7147.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7150.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7152.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7153.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7156.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7157.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7161.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7162.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7165.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7167.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7168.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8657.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8658.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8659.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8662.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8663.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8664.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7170.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7181.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7188.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7196.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7655.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7198.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7204.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7213.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7221.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/9142.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8803.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8807.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8808.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7223.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7226.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7229.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7233.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7245.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7246.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7247.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8057.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8058.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8069.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7689.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7694.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7695.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7696.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7698.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7699.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7700.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7702.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7710.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7713.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7717.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7724.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7727.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7728.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7729.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7730.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7734.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7756.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8032.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8036.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8041.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8047.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8046.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8048.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8699.png">
<meta property="og:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8700.png">
<meta property="og:image" content="http://yoursite.com/2020/09/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8701.png">
<meta property="article:published_time" content="2020-09-08T11:14:25.000Z">
<meta property="article:modified_time" content="2020-10-15T10:03:49.492Z">
<meta property="article:author" content="潇 卟 甸">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="进阶">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1816.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/09/08/Java框架【HOW2J】/"/>







<script>
    (function(){
        if('224694'){
            if (prompt('请输入文章密码') !== '224694'){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

  <title>Java框架【HOW2J】 | 伶仃浩瀚</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://xbd224694.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">伶仃浩瀚</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="潇 卟 甸">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/picture.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="伶仃浩瀚">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Java框架【HOW2J】</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建时间" itemprop="dateCreated datePublished" datetime="2020-09-08T19:14:25+08:00">
                2020-09-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/How2j/" itemprop="url" rel="index">
                    <span itemprop="name">How2j</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/" class="leancloud_visitors" data-flag-title="Java框架【HOW2J】">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">热度 </span>
               
                 <span class="leancloud-visitors-count"></span>
	 <span> ℃ </span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  163.6k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  778 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>地址：<a href="https://how2j.cn?p=154642" target="_blank" rel="noopener">https://how2j.cn?p=154642</a></strong></p>
<a id="more"></a>
<h1 id="壹、HIBERNATE"><a class="header-anchor" href="#壹、HIBERNATE">¶</a>壹、HIBERNATE</h1>
<h2 id="一、基础"><a class="header-anchor" href="#一、基础">¶</a>一、基础</h2>
<h3 id="1、hello-hibernate"><a class="header-anchor" href="#1、hello-hibernate">¶</a>1、hello hibernate</h3>
<p>使用JDBC做数据库相关功能开发会做很多重复性的工作，比如创建连接，关闭连接，把字段逐一映射到属性中。 Hibernate把这一切都封装起来了，使得数据库访问变得轻松而简单，代码也更加容易维护。</p>
<p>第一次使用Hibernate会有一个比较多步骤的配置过程，以后再使用，就很简单了。</p>
<p><strong>必读：</strong> 基于框架的程序要成功运行，对于JAR包的版本，配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致框架程序运行失败。 如果你是第一次学习本框架，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-学习之前先看效果"><a class="header-anchor" href="#步骤-1-学习之前先看效果">¶</a>步骤 1 : 学习之前先看效果</h4>
<p>本例演示如何使用hibernate往数据库插入一条数据。<br>
如图，这条iphone7的产品数据，就是<strong>由hibernate插入的</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1816.png" alt></p>
<h4 id="步骤-2-创建数据库"><a class="header-anchor" href="#步骤-2-创建数据库">¶</a>步骤 2 : 创建数据库</h4>
<p>首先准备数据库test<br>
如果没有安装数据库，请参考 [安装mysql-server]</p>
<p><strong>注：</strong> 新安装的数据库账号密码是root:admin, 后续的配置里，也是用的这个账号密码。如果密码不是这个，本知识点右上角的可运行项目跑不起来，所以尽量修改密码为admin, 修改密码办法：[修改root密码]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database test;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-创建表"><a class="header-anchor" href="#步骤-3-创建表">¶</a>步骤 3 : 创建表</h4>
<p>准备表product_， 有3个字段，分别是<br>
主键id(自增长)<br>
字符串格式的name<br>
浮点数格式的price</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use test;</span><br><span class="line"> </span><br><span class="line">CREATE TABLE product_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  name varchar(30) ,</span><br><span class="line">  price float ,</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) DEFAULT CHARSET&#x3D;UTF8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-创建一个java-project"><a class="header-anchor" href="#步骤-4-创建一个java-project">¶</a>步骤 4 : 创建一个java project</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4330.png" alt></p>
<h4 id="步骤-5-导入hibernate所依赖的jar包"><a class="header-anchor" href="#步骤-5-导入hibernate所依赖的jar包">¶</a>步骤 5 : 导入hibernate所依赖的jar包</h4>
<p>在右上角下载lib.rar,并解压到hibernate的项目目录下： e:\project\hibernate\lib 这个位置。<br>
然后为这个java project导入jar包<br>
导包步骤： 右键project-&gt;property-&gt;java build path-&gt;libaries-&gt;add external jars<br>
<strong>注</strong> 务必使用我提供的jar包，hibernate不同版本之间的jar包存在兼容性问题，如果你使用的是从hibernate官网下载的不同版本的Jar包，那么按照这个教程的配置方式，不一定走得通。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4331.png" alt></p>
<h4 id="步骤-6-创建实体类"><a class="header-anchor" href="#步骤-6-创建实体类">¶</a>步骤 6 : 创建实体类</h4>
<p>实体类 Product 用于映射数据库中的表product_</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-配置-Product-hbm-xml"><a class="header-anchor" href="#步骤-7-配置-Product-hbm-xml">¶</a>步骤 7 : 配置 Product.hbm.xml</h4>
<p>在包com.how2java.pojo下 新建一个配置文件Product.hbm.xml， 用于映射Product类对应数据库中的product_表<br>
<strong>注:</strong> 文件名 Product.hbm.xml <strong>P</strong>一定要大写，要和类保持一致</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>表示<strong>类Product</strong>对应<strong>表product_</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>表示<strong>属性id</strong>,映射表里的<strong>字段id</strong><br>
&lt;generator class=“native”&gt; 意味着id的自增长方式采用数据库的本地方式</p>
<p>如果是连接oracle数据库，可以[指定sequnce作为id自增长方式]</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里配置的时候，只写了属性name,没有通过column=“name” 显式的指定字段，那么字段的名字也是name.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-配置-hibernate-cfg-xml"><a class="header-anchor" href="#步骤-8-配置-hibernate-cfg-xml">¶</a>步骤 8 : 配置 hibernate.cfg.xml</h4>
<p>在<strong>src目录</strong>下创建 hibernate.cfg.xml<br>
配置访问数据库要用到的驱动，url，账号密码等等<br>
其他配置及含义：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这表示使用MYSQL方言。 什么方言呢？ 因为在代码层面，开发人员不用关心底层到底用Oracle还是Mysql，写的代码都是一样的。 可是Oracle和Mysql所用的sql语句的语法是有所区别的，那么这件事就交给Hibernate来做了。这个时候就需要告诉Hibernate底层用的是什么数据库，它才知道应该用什么样的“方言” 去对话。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这是Hibernate事务管理方式，即每个线程一个事务</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这表示是否在控制台显示执行的sql语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这表示是否会自动更新数据库的表结构，有这句话，其实是不需要[创建表]的，因为Hibernate会自动去创建表结构</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>这表示Hibernate会去识别Product这个实体类</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-测试类-TestHibernate"><a class="header-anchor" href="#步骤-9-测试类-TestHibernate">¶</a>步骤 9 : 测试类 TestHibernate</h4>
<p>创建一个Product对象，并通过hibernate把这个对象，插入到数据库中</p>
<p>hibernate的基本步骤是：</p>
<ol>
<li>获取SessionFactory</li>
<li>通过SessionFactory 获取一个Session</li>
<li>在Session基础上开启一个事务</li>
<li>通过调用Session的save方法把对象保存到数据库</li>
<li>提交事务</li>
<li>关闭Session</li>
<li>关闭SessionFactory</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/68.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line">        p.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        p.setPrice(<span class="number">7000</span>);</span><br><span class="line">        s.save(p);</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-基本原理图"><a class="header-anchor" href="#步骤-10-基本原理图">¶</a>步骤 10 : 基本原理图</h4>
<p>应用程序通过Hibernate把 一个 Product对象插入到数据库的product_表中<br>
<strong>hibernate.cfg.xml</strong> 配置文件提供链接数据库的基本信息<br>
账号 密码 驱动 数据库ip 端口<br>
<strong>Product.hbm.xml</strong> 提供对象与表的映射关系<br>
对应哪个表？ 什么属性，对应什么字段</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1868.png" alt></p>
<h4 id="步骤-11-可运行项目"><a class="header-anchor" href="#步骤-11-可运行项目">¶</a>步骤 11 : 可运行项目</h4>
<p>右上角有本知识点对应的，可运行项目。<br>
如果自己配置老是不成功，下载右上角的hibernate.rar解压后运行，然后比对与自己的代码的区别，找出问题所在。</p>
<h4 id="步骤-12-关于运行警告信息"><a class="header-anchor" href="#步骤-12-关于运行警告信息">¶</a>步骤 12 : 关于运行警告信息</h4>
<p>运行起来之后会出现如图所示的三行警告信息，这是因为没有进行slf4j配置，所以出现的警告信息，不影响运行。</p>
<p>要解决这个问题，需要引入log4j的jar和配置文件，和当前Hibernate学习无关，为了把注意力集中在Hibernate本身的学习上，站长就不提供log4j那些东西了。 不影响运行的，大家往下学习好啦</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6608.png" alt></p>
<h4 id="步骤-13-练习"><a class="header-anchor" href="#步骤-13-练习">¶</a>步骤 13 : 练习</h4>
<p>参考本例，做一个Category类的练习。<br>
Category有属性 id,name。 对应的表是category，字段是id,name</p>
<p>创建一个Category，设置其name为&quot;分类1&quot; ,然后通过hibernate插入到数据库</p>
<h3 id="2、插入数据"><a class="header-anchor" href="#2、插入数据">¶</a>2、插入数据</h3>
<p>通过for循环插入10个Product对象到数据库</p>
<h4 id="步骤-1-先运行，看到效果，再学习"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错"><a class="header-anchor" href="#步骤-2-模仿和排错">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果"><a class="header-anchor" href="#步骤-3-效果">¶</a>步骤 3 : 效果</h4>
<p>通过Hibernate可以很方便的批量插入数据到数据库中，这是插入10条数据的效果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1817.png" alt></p>
<h4 id="步骤-4-插入数据到数据库"><a class="header-anchor" href="#步骤-4-插入数据到数据库">¶</a>步骤 4 : 插入数据到数据库</h4>
<p>使用Session的save方法插入数据。 这里插入多条数据，是为了后面学习删除，分页等功能做铺垫</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            Product p = <span class="keyword">new</span> Product();</span><br><span class="line">            p.setName(<span class="string">"iphone"</span>+i);</span><br><span class="line">            p.setPrice(i);</span><br><span class="line">            s.save(p);         </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当更新或者保存大批量数据的时候，可以每固定数量的时候，进行清理缓存，同时清除缓存：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addUsers</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Session session = HibernateUtil.currentSession();</span><br><span class="line">        Transaction transaction = session.beginTransaction();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">100</span>;i++)&#123;</span><br><span class="line">            User user = <span class="keyword">new</span> User();</span><br><span class="line">            user.setName(<span class="string">"W"</span>+i);</span><br><span class="line">            user.setSex(<span class="string">"man"</span>);</span><br><span class="line">            session.save(user);</span><br><span class="line">            <span class="comment">//每插入20个执行一次</span></span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">20</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="comment">//将session的缓存中的数据与数据库同步。</span></span><br><span class="line">                session.flush();</span><br><span class="line">                <span class="comment">//清除缓存</span></span><br><span class="line">                session.clear();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        transaction.commit();</span><br><span class="line">        HibernateUtil.closeSession();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、对象的三种状态-瞬时-持久-脱管"><a class="header-anchor" href="#3、对象的三种状态-瞬时-持久-脱管">¶</a>3、对象的三种状态 瞬时 持久 脱管</h3>
<p>实体类对象在Hibernate中有3种状态<br>
分别是瞬时，持久和脱管</p>
<p><strong>瞬时</strong> 指的是没有和hibernate发生任何关系，在数据库中也没有对应的记录，一旦JVM结束，这个对象也就消失了<br>
<strong>持久</strong> 指得是一个对象和hibernate发生联系，有对应的session,并且在数据库中有对应的一条记录<br>
<strong>脱管</strong> 指的是一个对象虽然在数据库中有对应的一条记录，但是它所对应的session已经关闭了</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v2"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v2">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v2"><a class="header-anchor" href="#步骤-2-模仿和排错-v2">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-代码演示3种状态"><a class="header-anchor" href="#步骤-3-代码演示3种状态">¶</a>步骤 3 : 代码演示3种状态</h4>
<p>new 了一个Product();，在数据库中还没有对应的记录，这个时候Product对象的状态是<strong>瞬时的</strong>。</p>
<p>通过Session的save把该对象保存在了数据库中，该对象也和Session之间产生了联系，此时状态是<strong>持久的</strong>。</p>
<p>最后把Session关闭了，这个对象在数据库中虽然有对应的数据，但是已经和Session失去了联系，相当于脱离了管理，状态就是<strong>脱管的</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line">        p.setName(<span class="string">"p1"</span>);</span><br><span class="line">        System.out.println(<span class="string">"此时p是瞬时状态"</span>);</span><br><span class="line">        s.save(p);</span><br><span class="line">        System.out.println(<span class="string">"此时p是持久状态"</span>);</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        System.out.println(<span class="string">"此时p是脱管状态"</span>);</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、通过ID获取一个对象"><a class="header-anchor" href="#4、通过ID获取一个对象">¶</a>4、通过ID获取一个对象</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v3"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v3">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v3"><a class="header-anchor" href="#步骤-2-模仿和排错-v3">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v2"><a class="header-anchor" href="#步骤-3-效果-v2">¶</a>步骤 3 : 效果</h4>
<p>获取到<strong>id=6</strong>的产品的名称</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1818.png" alt></p>
<h4 id="步骤-4-通过ID获取一个对象"><a class="header-anchor" href="#步骤-4-通过ID获取一个对象">¶</a>步骤 4 : 通过ID获取一个对象</h4>
<p>调用Session的get方法，根据id获取对象。 除了id之外，还需要传递一个[类对象]，毕竟需要知道获取的是哪个对象</p>
<p>除了使用get方法，还可以使用load获取对象。 请参考[get和load的区别]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">  </span><br><span class="line">        Product p =(Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 6)</span>;</span><br><span class="line">          </span><br><span class="line">        System.out.println(<span class="string">"id=6的产品名称是: "</span>+p.getName());</span><br><span class="line">          </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、删除一条数据"><a class="header-anchor" href="#5、删除一条数据">¶</a>5、删除一条数据</h3>
<p>根据id把对象从表里删除掉<br>
**注意:**hibernate在删除一条数据之前，先要通过id把这条记录取出来</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v4"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v4">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v4"><a class="header-anchor" href="#步骤-2-模仿和排错-v4">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-删除一条数据"><a class="header-anchor" href="#步骤-3-删除一条数据">¶</a>步骤 3 : 删除一条数据</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        Product p =(Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line">        s.delete(p);</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6、修改-更新-一个对象"><a class="header-anchor" href="#6、修改-更新-一个对象">¶</a>6、修改(更新)一个对象</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v5"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v5">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v5"><a class="header-anchor" href="#步骤-2-模仿和排错-v5">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-先看修改后的效果"><a class="header-anchor" href="#步骤-3-先看修改后的效果">¶</a>步骤 3 : 先看修改后的效果</h4>
<p>通过Hibernate修改数据库中的数据。 把id=6的产品名称修改为 iphone-modifed</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1819.png" alt></p>
<h4 id="步骤-4-修改一个对象的属性，并更新到数据库中"><a class="header-anchor" href="#步骤-4-修改一个对象的属性，并更新到数据库中">¶</a>步骤 4 : 修改一个对象的属性，并更新到数据库中</h4>
<ol>
<li>根据id获取该对象</li>
<li>修改该对象的属性</li>
<li>通过Session的update方法把变化更新到数据库中</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        Product p =(Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 6)</span>;</span><br><span class="line">         </span><br><span class="line">        System.out.println(p.getName());</span><br><span class="line">         </span><br><span class="line">        p.setName(<span class="string">"iphone-modified"</span>);</span><br><span class="line">         </span><br><span class="line">        s.update(p);</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7、使用HQL进行查询"><a class="header-anchor" href="#7、使用HQL进行查询">¶</a>7、使用HQL进行查询</h3>
<p>HQL（<strong>H</strong>ibernate <strong>Q</strong>uery <strong>L</strong>anguage）是hibernate专门用于查询数据的语句，有别于SQL，HQL 更接近于面向对象的思维方式。</p>
<p>比如使用的是类的名字Product,而非表格的名字product_</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v6"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v6">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v6"><a class="header-anchor" href="#步骤-2-模仿和排错-v6">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-先看查询的结果"><a class="header-anchor" href="#步骤-3-先看查询的结果">¶</a>步骤 3 : 先看查询的结果</h4>
<p>这是通过Hibernate对所有数据查询的结果页面</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1820.png" alt></p>
<h4 id="步骤-4-使用HQL-根据name进行模糊查询"><a class="header-anchor" href="#步骤-4-使用HQL-根据name进行模糊查询">¶</a>步骤 4 : 使用HQL,根据name进行模糊查询</h4>
<ol>
<li>首先根据hql创建一个Query对象</li>
<li>设置参数(和基1的PreparedStatement不一样，Query是基0的)</li>
<li>通过Query对象的list()方法即返回查询的结果了。</li>
</ol>
<p><strong>注：</strong> 使用hql的时候，用的是类名Product,而不是表名product_<br>
<strong>注：</strong> 使用hql的时候，<strong>不需要</strong>在前面加 <strong>select *</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        String name = <span class="string">"iphone"</span>;</span><br><span class="line">        Query q =s.createQuery(<span class="string">"from Product p where p.name like ?"</span>);</span><br><span class="line">        q.setString(<span class="number">0</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>);</span><br><span class="line">        List&lt;Product&gt; ps= q.list();</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p.getName());</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8、使用CRITERIA进行查询"><a class="header-anchor" href="#8、使用CRITERIA进行查询">¶</a>8、使用CRITERIA进行查询</h3>
<p>使用Criteria进行数据查询。<br>
与HQL和SQL的区别是Criteria 完全是 <strong>面向对象的方式</strong>在进行数据查询，将不再看到有sql语句的痕迹</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v7"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v7">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v7"><a class="header-anchor" href="#步骤-2-模仿和排错-v7">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-先看用Criteria-查询的效果"><a class="header-anchor" href="#步骤-3-先看用Criteria-查询的效果">¶</a>步骤 3 : 先看用Criteria 查询的效果</h4>
<p>和使用HQL 进行查询得到的结果一样</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1821.png" alt></p>
<h4 id="步骤-4-使用Criteria-根据name进行模糊查询"><a class="header-anchor" href="#步骤-4-使用Criteria-根据name进行模糊查询">¶</a>步骤 4 : 使用Criteria,根据name进行模糊查询</h4>
<p>使用Criteria 查询数据</p>
<ol>
<li>通过session的createCriteria创建一个Criteria 对象</li>
<li>Criteria.add 增加约束。 在本例中增加一个对name的模糊查询(like)</li>
<li>调用list()方法返回查询结果的集合</li>
</ol>
<p>除此之外，Criteria 还可以很方便的进行进行[分页查询]和[获取总数]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Criteria;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.Restrictions;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        String name = <span class="string">"iphone"</span>;</span><br><span class="line">          </span><br><span class="line">        Criteria c= s.createCriteria(Product<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        c.add(Restrictions.like(<span class="string">"name"</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>));</span><br><span class="line">        List&lt;Product&gt; ps = c.list();</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="9、使用标准SQL语句进行查询"><a class="header-anchor" href="#9、使用标准SQL语句进行查询">¶</a>9、使用标准SQL语句进行查询</h3>
<p>通过标准SQL语句进行查询<br>
Hibernate依然保留了对标准SQL语句的支持，在一些场合，比如多表联合查询，并且有分组统计函数的情况下，标准SQL语句依然是效率较高的一种选择</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v8"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v8">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v8"><a class="header-anchor" href="#步骤-2-模仿和排错-v8">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-先看使用标准SQL语句查询的效果"><a class="header-anchor" href="#步骤-3-先看使用标准SQL语句查询的效果">¶</a>步骤 3 : 先看使用标准SQL语句查询的效果</h4>
<p>与使用 [HQL]和[Criteria] 进行查询的效果一样</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1822.png" alt></p>
<h4 id="步骤-4-使用标准SQL-根据name进行模糊查询"><a class="header-anchor" href="#步骤-4-使用标准SQL-根据name进行模糊查询">¶</a>步骤 4 : 使用标准SQL,根据name进行模糊查询</h4>
<p>使用Session的createSQLQuery方法执行标准SQL语句</p>
<p>因为标准SQL语句有可能返回各种各样的结果，比如多表查询，分组统计结果等等。 <strong>不能保证</strong>其查询结果能够<strong>装进一个Product对象中</strong>，所以返回的集合里的每一个元素是一个对象数组。 然后再通过下标把这个对象数组中的数据取出来。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        String name = <span class="string">"iphone"</span>;</span><br><span class="line">         </span><br><span class="line">        String sql = <span class="string">"select * from product_ p where p.name like '%"</span>+name+<span class="string">"%'"</span>;</span><br><span class="line">         </span><br><span class="line">        Query q= s.createSQLQuery(sql);</span><br><span class="line">        List&lt;Object[]&gt; list= q.list();</span><br><span class="line">        <span class="keyword">for</span> (Object[] os : list) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Object filed: os) &#123;</span><br><span class="line">                System.out.print(filed+<span class="string">"\t"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、关系"><a class="header-anchor" href="#二、关系">¶</a>二、关系</h2>
<h3 id="1、实现多对一"><a class="header-anchor" href="#1、实现多对一">¶</a>1、实现多对一</h3>
<p>一个Product对应一个Category<br>
一个Category对应多个Product</p>
<p>所以Product和Category是<strong>多对一</strong>的关系<br>
本例讲解如何使用Hibernate实现多对一关系</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v9"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v9">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v9"><a class="header-anchor" href="#步骤-2-模仿和排错-v9">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v3"><a class="header-anchor" href="#步骤-3-效果-v3">¶</a>步骤 3 : 效果</h4>
<p>通过多对一关系，设置了<strong>id=8的产品</strong>对应 <strong>id=1的分类</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1823.png" alt></p>
<h4 id="步骤-4-准备Category-java"><a class="header-anchor" href="#步骤-4-准备Category-java">¶</a>步骤 4 : 准备Category.java</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-准备Category-hbm-xml"><a class="header-anchor" href="#步骤-5-准备Category-hbm-xml">¶</a>步骤 5 : 准备Category.hbm.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-为Product-java增加Category属性"><a class="header-anchor" href="#步骤-6-为Product-java增加Category属性">¶</a>步骤 6 : 为Product.java增加Category属性</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">    Category category;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-在Product-hbm-xml中设置Category-多对一关系"><a class="header-anchor" href="#步骤-7-在Product-hbm-xml中设置Category-多对一关系">¶</a>步骤 7 : 在Product.hbm.xml中设置Category 多对一关系</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"Category"</span> <span class="attr">column</span>=<span class="string">"cid"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用many-to-one 标签设置多对一关系<br>
<strong>name=“category”</strong> 对应Product类中的category属性<br>
<strong>class=“Category”</strong> 表示对应Category类<br>
<strong>column=“cid”</strong> 表示指向 category_表的外键</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"Category"</span> <span class="attr">column</span>=<span class="string">"cid"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-在hibernate-cfg-xml中增加Category的映射"><a class="header-anchor" href="#步骤-8-在hibernate-cfg-xml中增加Category的映射">¶</a>步骤 8 : 在hibernate.cfg.xml中增加Category的映射</h4>
<p>新增Category映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=GBK<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.hbm.xml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-TestHibernate-测试many-to-one关系"><a class="header-anchor" href="#步骤-9-TestHibernate-测试many-to-one关系">¶</a>步骤 9 : TestHibernate 测试many-to-one关系</h4>
<p>在这个测试例子中，增加了一个新的Category对象&quot;c1&quot;<br>
并将其设置为id=8的product的category</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">         </span><br><span class="line">        Category c =<span class="keyword">new</span> Category();</span><br><span class="line">        c.setName(<span class="string">"c1"</span>);</span><br><span class="line">        s.save(c);</span><br><span class="line">         </span><br><span class="line">        Product p = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 8)</span>;</span><br><span class="line">        p.setCategory(c);</span><br><span class="line">        s.update(p);</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2、实现一对多"><a class="header-anchor" href="#2、实现一对多">¶</a>2、实现一对多</h3>
<p>一个Product对应一个Category<br>
一个Category对应多个Product</p>
<p>所以Category和Product是<strong>一对多</strong>的关系<br>
本例讲解如何使用Hibernate实现一对多关系</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v10"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v10">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v10"><a class="header-anchor" href="#步骤-2-模仿和排错-v10">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v4"><a class="header-anchor" href="#步骤-3-效果-v4">¶</a>步骤 3 : 效果</h4>
<p>获取id=1分类下的所有商品</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1824.png" alt></p>
<h4 id="步骤-4-为Category增加一个Set集合"><a class="header-anchor" href="#步骤-4-为Category增加一个Set集合">¶</a>步骤 4 : 为Category增加一个Set集合</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    Set&lt;Product&gt; products;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(Set&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-为Category-hbm-xml增加one-to-many映射"><a class="header-anchor" href="#步骤-5-为Category-hbm-xml增加one-to-many映射">¶</a>步骤 5 : 为Category.hbm.xml增加one-to-many映射</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>&lt;set</strong> 用于设置一对多([多对多]也是他)关系，也可以用list，设置稍复杂点，这里使用简单的set来入门。<br>
<strong>name=“products”</strong> 对应 Category类中的products属性<br>
<strong>lazy=“false”</strong> 表示不使用延迟加载。关于延迟加载，请参考[关系的延迟加载]<br>
<strong>&lt;key column=“cid” not-null=“false” /&gt;</strong> 表示外键是cid，可以为空<br>
<strong>&lt;one-to-many class=“Product” /&gt;</strong> 表示一对多所对应的类是Product</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">                 </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-TestHibernate-测试one-to-many关系"><a class="header-anchor" href="#步骤-6-TestHibernate-测试one-to-many关系">¶</a>步骤 6 : TestHibernate 测试one-to-many关系</h4>
<p>首先获取id=1的category,然后通过getProducts() 直接取出其所对应的所有product</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">         </span><br><span class="line">        Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        Set&lt;Product&gt; ps = c.getProducts();</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、实现多对多"><a class="header-anchor" href="#3、实现多对多">¶</a>3、实现多对多</h3>
<p>一种Product可以被多个User购买<br>
一个User可以购买多种Product</p>
<p>所以Product和User之间的关系是<strong>多对多</strong> many-to-many<br>
要实现多对多关系，必须有一张<strong>中间表</strong> user_product 用于维护 User和Product之间的关系</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v11"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v11">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v11"><a class="header-anchor" href="#步骤-2-模仿和排错-v11">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-User-java"><a class="header-anchor" href="#步骤-3-User-java">¶</a>步骤 3 : User.java</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    Set&lt;Product&gt; products;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(Set&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-User-hbm-xml"><a class="header-anchor" href="#步骤-4-User-hbm-xml">¶</a>步骤 4 : User.hbm.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"User"</span> <span class="attr">table</span>=<span class="string">"user_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">table</span>=<span class="string">"user_product"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"uid"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span>       </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-Product-java"><a class="header-anchor" href="#步骤-5-Product-java">¶</a>步骤 5 : Product.java</h4>
<p>增加了对应Users的集合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">    Category category;</span><br><span class="line">    Set&lt;User&gt; users;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsers</span><span class="params">(Set&lt;User&gt; users)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.users = users;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-Product-hbm-xml"><a class="header-anchor" href="#步骤-6-Product-hbm-xml">¶</a>步骤 6 : Product.hbm.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"Category"</span> <span class="attr">column</span>=<span class="string">"cid"</span> /&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"users"</span> <span class="attr">table</span>=<span class="string">"user_product"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"pid"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">class</span>=<span class="string">"User"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span>       </span><br><span class="line">                 </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-在hibernate-cfg-xml中增加User的映射"><a class="header-anchor" href="#步骤-7-在hibernate-cfg-xml中增加User的映射">¶</a>步骤 7 : 在hibernate.cfg.xml中增加User的映射</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=GBK<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.hbm.xml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/User.hbm.xml"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-TestHibernate-测试many-to-many关系"><a class="header-anchor" href="#步骤-8-TestHibernate-测试many-to-many关系">¶</a>步骤 8 : TestHibernate 测试many-to-many关系</h4>
<p>首先增加3个用户<br>
然后演示产品1被用户1，2,3购买</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/95.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.User;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">   </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">          </span><br><span class="line">        <span class="comment">//增加3个用户</span></span><br><span class="line">        Set&lt;User&gt; users = <span class="keyword">new</span> HashSet();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            User u =<span class="keyword">new</span> User();</span><br><span class="line">            u.setName(<span class="string">"user"</span>+i);</span><br><span class="line">            users.add(u);</span><br><span class="line">            s.save(u);</span><br><span class="line">        &#125;</span><br><span class="line">          </span><br><span class="line">        <span class="comment">//产品1被用户1,2,3购买</span></span><br><span class="line">        Product p1 = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">          </span><br><span class="line">        p1.setUsers(users);</span><br><span class="line">        s.save(p1);</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三、各类概念"><a class="header-anchor" href="#三、各类概念">¶</a>三、各类概念</h2>
<h3 id="1、如何支持事务"><a class="header-anchor" href="#1、如何支持事务">¶</a>1、如何支持事务</h3>
<p>Hibernate的任何对数据有改动的操作，都应该被放在事务里面.<br>
在事务中的多个操作行为，要么都成功，要么都失败</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v12"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v12">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v12"><a class="header-anchor" href="#步骤-2-模仿和排错-v12">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v5"><a class="header-anchor" href="#步骤-3-效果-v5">¶</a>步骤 3 : 效果</h4>
<p>在同一个事务中做了两件事情</p>
<ol>
<li>删除id=1的产品</li>
<li>修改id=2的产品，使得其产品名称超过了数据库中设置的长度30.<br>
提交事务。</li>
</ol>
<p>第二个任务失败了，但是因为在同一个事务中，所以第一个任务也没有生效。因此id=1的产品，依然保留下来了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1825.png" alt></p>
<h4 id="步骤-4-TestHibernate-事务"><a class="header-anchor" href="#步骤-4-TestHibernate-事务">¶</a>步骤 4 : TestHibernate 事务</h4>
<p>hibernate中的事务由s.beginTransaction();开始<br>
由s.getTransaction().commit();结束<br>
本例子，执行了两个操作<br>
第一个，删除id=1的产品，这个是会成功的<br>
第二个，修改id=2的产品，使得其产品名称超过了数据库中设置的长度30，这个是会失败的。<br>
因为这两个操作都是在一个事务中，而且第二个操作失败了，所以最后的结果是两个操作都没有生效</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        Product p = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        s.delete(p);</span><br><span class="line"> </span><br><span class="line">        Product p2 = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 2)</span>;</span><br><span class="line">        p2.setName(<span class="string">"长度超过30的字符串作为产品名称长度超过30的字符串作为产品名称长度超过30的字符串作为产品名称长度超过30的字符串作为产品名称"</span>);</span><br><span class="line">        s.update(p2);</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-MYSQL-表的类型必须是INNODB才支持事务"><a class="header-anchor" href="#步骤-5-MYSQL-表的类型必须是INNODB才支持事务">¶</a>步骤 5 : MYSQL 表的类型必须是INNODB才支持事务</h4>
<p>在Mysql中，只有当表的类型是INNODB的时候，才支持事务，所以需要把表的类型设置为INNODB,否则无法观察到事务.</p>
<p>修改表的类型为INNODB的SQL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table product_ ENGINE  &#x3D; innodb;</span><br></pre></td></tr></table></figure>
<p>查看表的类型的SQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show table status from test;</span><br></pre></td></tr></table></figure>
<p>不过有个前提，就是当前的MYSQL服务器本身要支持INNODB,如果不支持，请看 [开启MYSQL INNODB的办法]</p>
<h3 id="2、属性延迟加载-LAZYLOAD"><a class="header-anchor" href="#2、属性延迟加载-LAZYLOAD">¶</a>2、属性延迟加载 LAZYLOAD</h3>
<p>hibernate中的<strong>延迟加载</strong>(lazyload)分[属性的延迟加载]和[关系的延迟加载]</p>
<p>属性的延迟加载:<br>
当使用<strong>load</strong>的方式来获取对象的时候，只有访问了这个对象的属性，hibernate才会到数据库中进行查询。否则不会访问数据库</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v13"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v13">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v13"><a class="header-anchor" href="#步骤-2-模仿和排错-v13">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-演示属性的延迟加载"><a class="header-anchor" href="#步骤-3-演示属性的延迟加载">¶</a>步骤 3 : 演示属性的延迟加载</h4>
<p>在打印log1之前，是不会打印出sql语句的，只有在访问属性“getName()&quot;的时候，才会访问数据库</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/97.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">     </span><br><span class="line">        Product p = (Product)s.load(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log1"</span>);</span><br><span class="line">        System.out.println(p.getName());</span><br><span class="line">        System.out.println(<span class="string">"log2"</span>);</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、关系延迟加载"><a class="header-anchor" href="#3、关系延迟加载">¶</a>3、关系延迟加载</h3>
<p>延迟加载又叫lazyload，在one-many many-many的时候都可以使用关系的延迟加载</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v14"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v14">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v14"><a class="header-anchor" href="#步骤-2-模仿和排错-v14">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-修改配置文件-Category-hbm-xml"><a class="header-anchor" href="#步骤-3-修改配置文件-Category-hbm-xml">¶</a>步骤 3 : 修改配置文件 Category.hbm.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>改为</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>表示通过Category获取产品是<strong>延迟加载的</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">                 </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-lazy-true的代码演示"><a class="header-anchor" href="#步骤-4-lazy-true的代码演示">¶</a>步骤 4 : lazy=true的代码演示</h4>
<p>执行15行的时候，只会查询Category表的信息，不会查询product_表</p>
<p>只有在执行18行，通过category取products的时候，才会进行对product_表的查询</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/99.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"log1"</span>);</span><br><span class="line">        System.out.println(c.getProducts());</span><br><span class="line">        System.out.println(<span class="string">"log1"</span>);</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、级联"><a class="header-anchor" href="#4、级联">¶</a>4、级联</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v15"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v15">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v15"><a class="header-anchor" href="#步骤-2-模仿和排错-v15">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-什么是级联"><a class="header-anchor" href="#步骤-3-什么是级联">¶</a>步骤 3 : 什么是级联</h4>
<p>什么是级联？ 简单的说，没有配置级联的时候，删除分类，其对应的产品不会被删除。 但是如果配置了恰当的级联，那么删除分类的时候，其对应的产品都会被删除掉。</p>
<h4 id="步骤-4-4种级联"><a class="header-anchor" href="#步骤-4-4种级联">¶</a>步骤 4 : 4种级联</h4>
<p>包括上一步说的删除用得级联，级联有4种类型：<br>
all：所有操作都执行级联操作；<br>
none：所有操作都不执行级联操作；<br>
delete：删除时执行级联操作；<br>
save-update：保存和更新时执行级联操作；<br>
级联通常用在one-many和many-to-many上，几乎不用在many-one上。</p>
<h4 id="步骤-5-delete-级联"><a class="header-anchor" href="#步骤-5-delete-级联">¶</a>步骤 5 : delete 级联</h4>
<p>在[一对多]代码的基础之上，修改TestHibernate类为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 3)</span>;</span><br><span class="line">s.delete(c);</span><br></pre></td></tr></table></figure>
<p>并且为Category.hbm.xml 加上</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">cascade</span>=<span class="string">"delete"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>运行代码就会发现，删除分类的时候，会把分类下对应的产品都删除掉，否则只会把产品对应的cid设置为空</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 3)</span>;</span><br><span class="line">        s.delete(c);</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">  </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">cascade</span>=<span class="string">"delete"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">                  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">      </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-save-update-级联"><a class="header-anchor" href="#步骤-6-save-update-级联">¶</a>步骤 6 : save-update 级联</h4>
<p>在[一对多]代码的基础之上，修改TestHibernate类为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line">Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">p1.setName(<span class="string">"product_501"</span>);</span><br><span class="line">Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">p2.setName(<span class="string">"product_502"</span>);</span><br><span class="line">Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">p3.setName(<span class="string">"product_503"</span>);</span><br></pre></td></tr></table></figure>
<p>并且为Category.hbm.xml 加上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;set name=<span class="string">"products"</span> cascade=<span class="string">"save-update"</span> lazy=<span class="string">"false"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>运行代码就会发现，这3个[瞬时状态]的产品对象虽然没有添加到数据库里，但是在事务提交的时候，会把他们3个[持久化]。 如果没有cascade=“save-update”，就会报错</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line">         </span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setName(<span class="string">"product_501"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setName(<span class="string">"product_502"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setName(<span class="string">"product_503"</span>);</span><br><span class="line"> </span><br><span class="line">        c.getProducts().add(p1);</span><br><span class="line">        c.getProducts().add(p2);</span><br><span class="line">        c.getProducts().add(p3);</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main4delete</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">          SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">            Session s = sf.openSession();</span><br><span class="line">            s.beginTransaction();</span><br><span class="line">            Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 3)</span>;</span><br><span class="line">            s.delete(c);</span><br><span class="line">            s.getTransaction().commit();</span><br><span class="line">            s.close();</span><br><span class="line">            sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">  </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">cascade</span>=<span class="string">"save-update"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">                  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">      </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-all和none级联"><a class="header-anchor" href="#步骤-7-all和none级联">¶</a>步骤 7 : all和none级联</h4>
<p>all 就是 delete+save-update<br>
none 就是没有，默认就是none</p>
<h3 id="5、什么是HIBERNATE的一级缓存"><a class="header-anchor" href="#5、什么是HIBERNATE的一级缓存">¶</a>5、什么是HIBERNATE的一级缓存</h3>
<p>hibernate默认是开启一级缓存的，一级缓存存放在session上</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v16"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v16">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v16"><a class="header-anchor" href="#步骤-2-模仿和排错-v16">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-两次获取id-1的category对象"><a class="header-anchor" href="#步骤-3-两次获取id-1的category对象">¶</a>步骤 3 : 两次获取id=1的category对象</h4>
<p>第一次通过id=1获取对象的时候，session中是<strong>没有对应缓存对象</strong>的，所以会在&quot;log1&quot;后出现sql查询语句。<br>
第二次通过id=1获取对象的时候，session中<strong>有对应的缓存对象</strong>，所以在&quot;log2&quot;后不会出现sql查询语句</p>
<p>所以总共会看到一次SQL语句出现</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/100.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">   </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        System.out.println(<span class="string">"log1"</span>);</span><br><span class="line">        Category c1 = (Category)s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log2"</span>);</span><br><span class="line">        Category c2= (Category)s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log3"</span>);       </span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6、如何进行HIBERNATE的EHCACHE二级缓存配置"><a class="header-anchor" href="#6、如何进行HIBERNATE的EHCACHE二级缓存配置">¶</a>6、如何进行HIBERNATE的EHCACHE二级缓存配置</h3>
<p>Hibernate的一级缓存是在Session上，二级缓存是在SessionFactory上</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v17"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v17">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v17"><a class="header-anchor" href="#步骤-2-模仿和排错-v17">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-先看没有开启二级缓存的情况"><a class="header-anchor" href="#步骤-3-先看没有开启二级缓存的情况">¶</a>步骤 3 : 先看没有开启二级缓存的情况</h4>
<p>创建了两个Session<br>
在第一个Session里<br>
第一次获取id=1的Category <strong>会</strong>执行SQL语句<br>
第二次获取id=1的Category，<strong>不会</strong>执行SQL语句，因为有[一级缓存]<br>
在第二个Session里<br>
获取id=1的Category，<strong>会</strong>执行SQL语句，因为在第二个Session，没有缓存该对象。<br>
所以总共会看到两条SQL语句。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1826.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        Category p1 = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        Category p2 = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        Session s2 = sf.openSession();</span><br><span class="line">        s2.beginTransaction();</span><br><span class="line">        Category p3 = (Category) s2.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line"> </span><br><span class="line">        s2.getTransaction().commit();</span><br><span class="line">        s2.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-hibernate-cfg-xml-中增加对二级缓存的配置"><a class="header-anchor" href="#步骤-4-hibernate-cfg-xml-中增加对二级缓存的配置">¶</a>步骤 4 : hibernate.cfg.xml 中增加对二级缓存的配置</h4>
<p>在hibernate.cfg.xml中开启二级缓存的配置<br>
hibernate本身不提供二级缓存，都是使用第三方的二级缓存插件<br>
这里使用的是 EhCache提供的二级缓存</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=GBK<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.cache.use_second_level_cache"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.cache.provider_class"</span>&gt;</span>org.hibernate.cache.EhCacheProvider<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">          </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.hbm.xml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/User.hbm.xml"</span> /&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-ehcache-xml"><a class="header-anchor" href="#步骤-5-ehcache-xml">¶</a>步骤 5 : ehcache.xml</h4>
<p>在src目录下，创建一个ehcache.xml用于EHCache的缓存配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ehcache</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">"java.io.tmpdir"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">defaultCache</span></span></span><br><span class="line"><span class="tag">        <span class="attr">maxElementsInMemory</span>=<span class="string">"10000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">eternal</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">timeToIdleSeconds</span>=<span class="string">"120"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">timeToLiveSeconds</span>=<span class="string">"120"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">overflowToDisk</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-设置HBM"><a class="header-anchor" href="#步骤-6-设置HBM">¶</a>步骤 6 : 设置HBM</h4>
<p>对于要进行二级缓存的实体类，进行配置，增加<br>
&lt;cache usage=“read-only” /&gt;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cache</span> <span class="attr">usage</span>=<span class="string">"read-only"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">                 </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试效果"><a class="header-anchor" href="#步骤-7-测试效果">¶</a>步骤 7 : 测试效果</h4>
<p>使用不同的session,都去获取id=1的category,只会访问一次数据库。因为第二次获取虽然没有从第二个session中拿到缓存，但是从sessionfactory中拿到了Category缓存对象</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/108.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">         </span><br><span class="line">        Category c1 = (Category)s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log1"</span>);</span><br><span class="line">        Category c2= (Category)s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log2"</span>);</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        Session s2 = sf.openSession();</span><br><span class="line">        s2.beginTransaction();</span><br><span class="line">        Category c3 = (Category)s2.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log3"</span>);</span><br><span class="line">  </span><br><span class="line">        s2.getTransaction().commit();</span><br><span class="line">        s2.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7、实现分页查询"><a class="header-anchor" href="#7、实现分页查询">¶</a>7、实现分页查询</h3>
<p>使用Criteria进行分页查询<br>
无论你使用的是Oracle,Mysql,NoSQL还是DB2，分页查询的代码写法都是一样的</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v18"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v18">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v18"><a class="header-anchor" href="#步骤-2-模仿和排错-v18">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-分页，从第3个开始，一共查询5个Product"><a class="header-anchor" href="#步骤-3-分页，从第3个开始，一共查询5个Product">¶</a>步骤 3 : 分页，从第3个开始，一共查询5个Product</h4>
<p>Hibernate使用Criteria 来进行分页查询<br>
<strong>c.setFirstResult(2);</strong> 表示从第3条数据开始<br>
<strong>c.setMaxResults(5);</strong> 表示一共查询5条数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Criteria;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.Restrictions;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">  </span><br><span class="line">        String name = <span class="string">"iphone"</span>;</span><br><span class="line">          </span><br><span class="line">        Criteria c= s.createCriteria(Product<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        c.add(Restrictions.like(<span class="string">"name"</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>));</span><br><span class="line">        c.setFirstResult(<span class="number">2</span>);</span><br><span class="line">        c.setMaxResults(<span class="number">5</span>);</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; ps = c.list();</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p.getName());</span><br><span class="line">             </span><br><span class="line">        &#125;</span><br><span class="line">          </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8、GET和LOAD的区别"><a class="header-anchor" href="#8、GET和LOAD的区别">¶</a>8、GET和LOAD的区别</h3>
<p>通过id获取Product对象有两种方式，分别是<strong>get</strong>和<strong>load</strong><br>
他们的区别分别在于</p>
<ol>
<li>
<p>延迟加载</p>
</li>
<li>
<p>对于id不存在的时候的处理</p>
</li>
</ol>
<h4 id="步骤-1-先运行，看到效果，再学习-v19"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v19">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v19"><a class="header-anchor" href="#步骤-2-模仿和排错-v19">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-延迟加载"><a class="header-anchor" href="#步骤-3-延迟加载">¶</a>步骤 3 : 延迟加载</h4>
<p>load方式是延迟加载，只有属性被访问的时候才会调用sql语句<br>
get方式是非延迟加载，无论后面的代码是否会访问到属性，马上执行sql语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        System.out.println(<span class="string">"log1"</span>);</span><br><span class="line">        Product p = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log2"</span>);</span><br><span class="line">        Product p2 = (Product) s.load(Product<span class="class">.<span class="keyword">class</span>, 2)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log3"</span>);</span><br><span class="line">        System.out.println(p2.getName());</span><br><span class="line">        System.out.println(<span class="string">"log4"</span>);</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-对于id不存在的对象的处理"><a class="header-anchor" href="#步骤-4-对于id不存在的对象的处理">¶</a>步骤 4 : 对于id不存在的对象的处理</h4>
<p>都通过id=500去获取对象</p>
<ol>
<li>get方式会返回null</li>
<li>load方式会抛出异常</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        System.out.println(<span class="string">"log1"</span>);</span><br><span class="line">        Product p = (Product)s.get(Product<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log2"</span>);</span><br><span class="line">        Product p2 = (Product)s.load(Product<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line">        System.out.println(<span class="string">"log3"</span>);</span><br><span class="line">         </span><br><span class="line">        Product p3 = (Product)s.get(Product<span class="class">.<span class="keyword">class</span>, 500)</span>;</span><br><span class="line">        System.out.println(<span class="string">"p3="</span>+p3);</span><br><span class="line">         </span><br><span class="line">        Product p4 = (Product)s.load(Product<span class="class">.<span class="keyword">class</span>, 500)</span>;</span><br><span class="line">        System.out.println(<span class="string">"p3="</span>+p4);</span><br><span class="line">         </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="9、OPENSESSION与GETCURRENTSESSION的区别"><a class="header-anchor" href="#9、OPENSESSION与GETCURRENTSESSION的区别">¶</a>9、OPENSESSION与GETCURRENTSESSION的区别</h3>
<p>Hibernate有两种方式获得session,分别是：<br>
<strong>openSession</strong>和<strong>getCurrentSession</strong><br>
他们的区别在于</p>
<ol>
<li>
<p>获取的是否是同一个session对象<br>
openSession每次都会得到一个新的Session对象<br>
getCurrentSession在同一个线程中，每次都是获取相同的Session对象，但是在不同的线程中获取的是不同的Session对象</p>
</li>
<li>
<p>事务提交的必要性<br>
openSession只有在增加，删除，修改的时候需要事务，查询时不需要的<br>
getCurrentSession是所有操作都必须放在事务中进行，并且提交事务后，session就自动关闭，不能够再进行关闭</p>
</li>
</ol>
<h4 id="步骤-1-先运行，看到效果，再学习-v20"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v20">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v20"><a class="header-anchor" href="#步骤-2-模仿和排错-v20">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-OpenSession每次都会得到一个新的Session对象"><a class="header-anchor" href="#步骤-3-OpenSession每次都会得到一个新的Session对象">¶</a>步骤 3 : OpenSession每次都会得到一个新的Session对象</h4>
<p>OpenSession每次都会得到一个新的Session对象，所以System.out.println(s1==s2);会打印false</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/121.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">  </span><br><span class="line">        Session s1 = sf.openSession();</span><br><span class="line">        Session s2 = sf.openSession();</span><br><span class="line">         </span><br><span class="line">        System.out.println(s1==s2);</span><br><span class="line">         </span><br><span class="line">        s1.close();</span><br><span class="line">        s2.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-相同线程的getCurrentSession"><a class="header-anchor" href="#步骤-4-相同线程的getCurrentSession">¶</a>步骤 4 : 相同线程的getCurrentSession</h4>
<p>如果是同一个线程(本例是在主线程里)，每次获取的都是相同的Session</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/122.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s1 = sf.getCurrentSession();</span><br><span class="line">        Session s2 = sf.getCurrentSession();</span><br><span class="line"> </span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line"> </span><br><span class="line">        s1.close();</span><br><span class="line"><span class="comment">//      s2.close();</span></span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-不同线程的getCurrentSession"><a class="header-anchor" href="#步骤-5-不同线程的getCurrentSession">¶</a>步骤 5 : 不同线程的getCurrentSession</h4>
<p>如果是不同线程，每次获取的都是不同的Session</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/123.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> Session s1;</span><br><span class="line">    <span class="keyword">static</span> Session s2;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">final</span> SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                s1 = sf.getCurrentSession();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        t1.start();</span><br><span class="line"> </span><br><span class="line">        Thread t2 = <span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                s2 = sf.getCurrentSession();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        t2.start();</span><br><span class="line">        t1.join();</span><br><span class="line">        t2.join();</span><br><span class="line"> </span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-openSession查询时候不需要事务"><a class="header-anchor" href="#步骤-6-openSession查询时候不需要事务">¶</a>步骤 6 : openSession查询时候不需要事务</h4>
<p>如果是做增加，修改，删除是必须放在事务里进行的。 但是如果是查询或者get，那么对于openSession而言就不需要放在事务中进行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> Session s1;</span><br><span class="line">    <span class="keyword">static</span> Session s2;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s1 = sf.openSession();</span><br><span class="line"> </span><br><span class="line">        s1.get(Product<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line"> </span><br><span class="line">        s1.close();</span><br><span class="line"> </span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-getCurrentSession所有操作都必须放在事务中"><a class="header-anchor" href="#步骤-7-getCurrentSession所有操作都必须放在事务中">¶</a>步骤 7 : getCurrentSession所有操作都必须放在事务中</h4>
<p>对于getCurrentSession而言所有操作都必须放在事务中，甚至于查询和get都需要事务。<br>
16行的get没有放在事务中，就会导致异常产生</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/125.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s1 = sf.getCurrentSession();</span><br><span class="line"> </span><br><span class="line">        s1.get(Product<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line"> </span><br><span class="line">        s1.close();</span><br><span class="line"> </span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-getCurrentSession在提交事务后，session自动关闭"><a class="header-anchor" href="#步骤-8-getCurrentSession在提交事务后，session自动关闭">¶</a>步骤 8 : getCurrentSession在提交事务后，session自动关闭</h4>
<p>22行，在事务关闭后，试图关闭session,就会报session已经关闭的异常</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/126.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line"> </span><br><span class="line">        Session s1 = sf.getCurrentSession();</span><br><span class="line"> </span><br><span class="line">        s1.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        s1.get(Product<span class="class">.<span class="keyword">class</span>, 5)</span>;</span><br><span class="line"> </span><br><span class="line">        s1.getTransaction().commit();</span><br><span class="line">         </span><br><span class="line">        s1.close();</span><br><span class="line"> </span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="10、N-1-什么意思？-以及LIST和ITERATOR的区别"><a class="header-anchor" href="#10、N-1-什么意思？-以及LIST和ITERATOR的区别">¶</a>10、N+1 什么意思？ 以及LIST和ITERATOR的区别</h3>
<p>Hibernate有缓存机制，可以通过用id作为key把product对象保存在缓存中</p>
<p>同时hibernate也提供Query的查询方式。假设数据库中有100条记录，其中有30条记录在缓存中，但是使用Query的list方法，就会所有的100条数据都从数据库中查询，而<strong>无视这30条缓存中</strong>的记录</p>
<p>N+1是什么意思呢，首先执行一条sql语句，去查询这100条记录，但是，只返回这100条记录的ID<br>
然后再根据id,进行进一步查询。</p>
<p>如果id在缓存中，就从缓存中获取product对象了，否则再从数据库中获取</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v21"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v21">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v21"><a class="header-anchor" href="#步骤-2-模仿和排错-v21">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-Hibernate使用Iterator实现N-1"><a class="header-anchor" href="#步骤-3-Hibernate使用Iterator实现N-1">¶</a>步骤 3 : Hibernate使用Iterator实现N 1</h4>
<p>首先通过Query的iterator把所有满足条件的Product的<strong>id</strong>查出来</p>
<p>然后再通过it.next()查询每一个对象<br>
如果这个对象在缓存中，就直接从缓存中取了<br>
否则就从数据库中获取</p>
<p>N+1中的1，就是指只返回id的SQL语句，N指的是如果在缓存中找不到对应的数据，就到数据库中去查</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/118.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">  </span><br><span class="line">        String name = <span class="string">"iphone"</span>;</span><br><span class="line">         </span><br><span class="line">        Query q =s.createQuery(<span class="string">"from Product p where p.name like ?"</span>);</span><br><span class="line">         </span><br><span class="line">        q.setString(<span class="number">0</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>);</span><br><span class="line">        </span><br><span class="line">        Iterator&lt;Product&gt; it= q.iterate();</span><br><span class="line">        <span class="keyword">while</span>(it.hasNext())&#123;</span><br><span class="line">            Product p =it.next();</span><br><span class="line">            System.out.println(p.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="11、如何查询总数"><a class="header-anchor" href="#11、如何查询总数">¶</a>11、如何查询总数</h3>
<p>返回满足条件的总数</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v22"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v22">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v22"><a class="header-anchor" href="#步骤-2-模仿和排错-v22">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-查询总数"><a class="header-anchor" href="#步骤-3-查询总数">¶</a>步骤 3 : 查询总数</h4>
<p>首先还是准备一个有统计函数的语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from ....</span><br></pre></td></tr></table></figure>
<p>根据这条SQL语句创建一个Query对象，调用Query对象的uniqueResult()方法，返回一个long型的数据，即查询总数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">  </span><br><span class="line">        String name = <span class="string">"iphone"</span>;</span><br><span class="line">         </span><br><span class="line">        Query q =s.createQuery(<span class="string">"select count(*) from Product p where p.name like ?"</span>);</span><br><span class="line">        q.setString(<span class="number">0</span>, <span class="string">"%"</span>+name+<span class="string">"%"</span>);</span><br><span class="line">        <span class="keyword">long</span> total= (Long) q.uniqueResult();</span><br><span class="line">        System.out.println(total);</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="12、乐观锁原理以及其配置方法"><a class="header-anchor" href="#12、乐观锁原理以及其配置方法">¶</a>12、乐观锁原理以及其配置方法</h3>
<p>Hibernate使用乐观锁来处理脏数据问题</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v23"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v23">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v23"><a class="header-anchor" href="#步骤-2-模仿和排错-v23">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-首先看不使用乐观锁的情况"><a class="header-anchor" href="#步骤-3-首先看不使用乐观锁的情况">¶</a>步骤 3 : 首先看不使用乐观锁的情况</h4>
<p>故意创造一个场景来制造脏数据。</p>
<ol>
<li>通过session1得到<strong>id=1</strong>的对象 product1</li>
<li>在product1原来价格的基础上增加1000</li>
<li>更新product1之前，通过session2得到<strong>id=1</strong>的对象product2</li>
<li>在product2原来价格的基础上增加1000</li>
<li>更新product1</li>
<li>更新product2</li>
</ol>
<p>最后结果是product的价格只增加了1000，而不是2000</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1827.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s1 = sf.openSession();</span><br><span class="line">        Session s2 = sf.openSession();</span><br><span class="line"> </span><br><span class="line">        s1.beginTransaction();</span><br><span class="line">        s2.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        Product p1 = (Product) s1.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"产品原本价格是: "</span> + p1.getPrice());</span><br><span class="line"> </span><br><span class="line">        p1.setPrice(p1.getPrice() + <span class="number">1000</span>);</span><br><span class="line"> </span><br><span class="line">        Product p2 = (Product) s2.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        p2.setPrice(p2.getPrice() + <span class="number">1000</span>);</span><br><span class="line"> </span><br><span class="line">        s1.update(p1);</span><br><span class="line">        s2.update(p2);</span><br><span class="line"> </span><br><span class="line">        s1.getTransaction().commit();</span><br><span class="line">        s2.getTransaction().commit();</span><br><span class="line"> </span><br><span class="line">        Product p = (Product) s1.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"经过两次价格增加后，价格变为: "</span> + p.getPrice());</span><br><span class="line"> </span><br><span class="line">        s1.close();</span><br><span class="line">        s2.close();</span><br><span class="line"> </span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-修改配置文件-Product-hbm-xml"><a class="header-anchor" href="#步骤-4-修改配置文件-Product-hbm-xml">¶</a>步骤 4 : 修改配置文件 Product.hbm.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">version</span> <span class="attr">name</span>=<span class="string">"version"</span> <span class="attr">column</span>=<span class="string">"ver"</span> <span class="attr">type</span>=<span class="string">"int"</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>增加一个version字段，用于版本信息控制。这就是乐观锁的核心机制。</p>
<p>比如session1获取product1的时候，version=1。 那么session1更新product1的时候，就需要确保version还是1才可以进行更新，并且更新结束后，把version改为2。</p>
<p><strong>注意：</strong> version元素必须紧跟着id后面，否则会出错。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--version元素必须紧挨着id后面  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span> <span class="attr">name</span>=<span class="string">"version"</span> <span class="attr">column</span>=<span class="string">"ver"</span> <span class="attr">type</span>=<span class="string">"int"</span>&gt;</span><span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"Category"</span> <span class="attr">column</span>=<span class="string">"cid"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"users"</span> <span class="attr">table</span>=<span class="string">"user_product"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"pid"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">class</span>=<span class="string">"User"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-修改-Product-java"><a class="header-anchor" href="#步骤-5-修改-Product-java">¶</a>步骤 5 : 修改 Product.java</h4>
<p>增加version属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">    Category category;</span><br><span class="line">    <span class="keyword">int</span> version;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVersion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> version;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVersion</span><span class="params">(<span class="keyword">int</span> version)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.version = version;</span><br><span class="line">    &#125;</span><br><span class="line">    Set&lt;User&gt; users;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsers</span><span class="params">(Set&lt;User&gt; users)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.users = users;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-重新运行一样的代码"><a class="header-anchor" href="#步骤-6-重新运行一样的代码">¶</a>步骤 6 : 重新运行一样的代码</h4>
<p>做同样的业务就会抛出异常，提示该行已经被其他事务删除或者修改过了，本次修改无法生效。</p>
<p>这样就保证了数据的一致性。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1830.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s1 = sf.openSession();</span><br><span class="line">        Session s2 = sf.openSession();</span><br><span class="line"> </span><br><span class="line">        s1.beginTransaction();</span><br><span class="line">        s2.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        Product p1 = (Product) s1.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        System.out.println(<span class="string">"产品原本价格是: "</span> + p1.getPrice());</span><br><span class="line"> </span><br><span class="line">        p1.setPrice(p1.getPrice() + <span class="number">1000</span>);</span><br><span class="line"> </span><br><span class="line">        Product p2 = (Product) s2.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        p2.setPrice(p2.getPrice() + <span class="number">1000</span>);</span><br><span class="line"> </span><br><span class="line">        s1.update(p1);</span><br><span class="line">        s2.update(p2);</span><br><span class="line"> </span><br><span class="line">        s1.getTransaction().commit();</span><br><span class="line">        s2.getTransaction().commit();</span><br><span class="line"> </span><br><span class="line">        Product p = (Product) s1.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"经过两次价格增加后，价格变为: "</span> + p.getPrice());</span><br><span class="line"> </span><br><span class="line">        s1.close();</span><br><span class="line">        s2.close();</span><br><span class="line"> </span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-原理"><a class="header-anchor" href="#步骤-7-原理">¶</a>步骤 7 : 原理</h4>
<ol>
<li>假设数据库中产品的价格是10000，version是10</li>
<li>session1,session2分别获取了该对象</li>
<li>都修改了对象的价格</li>
<li>session1试图保存到数据库，检测version依旧=10，成功保存，并把version修改为11</li>
<li>session2试图保存到数据库，检测version=11，说明该数据已经被其他人动过了。 保存失败，抛出异常</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1831.png" alt></p>
<h3 id="13、C3P0数据库连接池配置办法"><a class="header-anchor" href="#13、C3P0数据库连接池配置办法">¶</a>13、C3P0数据库连接池配置办法</h3>
<p>建立数据库连接时比较消耗时间的，所以通常都会采用数据库连接池的技术来建立多条数据库连接，并且在将来持续使用，从而节约掉建立数据库连接的时间<br>
hibernate本身是提供了数据库连接池的，但是hibernate官网也不推荐使用他自带的数据库连接池。<br>
一般都会使用第三方的数据库连接池<br>
C3P0是免费的第三方的数据库连接池，并且有不错的表现<br>
右边可以下载c3p0的jar包</p>
<p>**注：**当运行次数不大的时候，从运行效果上来看，是看不出区别的。 只有在高并发量的情况下，才会体会出来。本知识主要是提供这个相关配置办法，以供以后有需要的时候，查询与修改方便。</p>
<p>参考：[自己开发一个连接池]</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v24"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v24">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v24"><a class="header-anchor" href="#步骤-2-模仿和排错-v24">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-jar包"><a class="header-anchor" href="#步骤-3-jar包">¶</a>步骤 3 : jar包</h4>
<p>记得导入右上角的c3p0专用的jar包</p>
<h4 id="步骤-4-进行c3p0连接池的配置"><a class="header-anchor" href="#步骤-4-进行c3p0连接池的配置">¶</a>步骤 4 : 进行c3p0连接池的配置</h4>
<p>加上高亮的配置即可，代码无需做任何改动</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=GBK<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">          </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.provider_class"</span>&gt;</span> </span><br><span class="line">            org.hibernate.connection.C3P0ConnectionProvider </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.max_size"</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.min_size"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.timeout"</span>&gt;</span>50000<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.max_statements"</span>&gt;</span>100<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.idle_test_period"</span>&gt;</span>3000<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="comment">&lt;!-- 当连接池耗尽并接到获得连接的请求，则新增加连接的数量 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.acquire_increment"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="comment">&lt;!-- 是否验证，检查连接 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.c3p0.validate"</span>&gt;</span>false<span class="tag">&lt;/<span class="name">property</span>&gt;</span>           </span><br><span class="line">          </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.hbm.xml"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/User.hbm.xml"</span> /&gt;</span></span><br><span class="line">          </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-Category-hbm-xml"><a class="header-anchor" href="#步骤-5-Category-hbm-xml">¶</a>步骤 5 : Category.hbm.xml</h4>
<p>记得要把上一步的二级缓存的相关配置去掉</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;cache usage="read-only" /&gt;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">                 </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试"><a class="header-anchor" href="#步骤-6-测试">¶</a>步骤 6 : 测试</h4>
<p>**注：**当运行次数不大的时候，从运行效果上来看，是看不出区别的。 只有在高并发量的情况下，才会体会出来。本知识主要是提供这个相关配置办法，以供以后有需要的时候，查询与修改方便。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/3101.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">   </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">   </span><br><span class="line">        s.createQuery(<span class="string">"from Category"</span>).list();</span><br><span class="line">           </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="四、注解"><a class="header-anchor" href="#四、注解">¶</a>四、注解</h2>
<h3 id="1、在HIBERNATE中使用注解示例"><a class="header-anchor" href="#1、在HIBERNATE中使用注解示例">¶</a>1、在HIBERNATE中使用注解示例</h3>
<p>Hibernate的注解是什么？ 简单的说，本来放在hbm.xml文件里的映射信息，现在不用配置文件做了，改由注解来完成</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v25"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v25">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v25"><a class="header-anchor" href="#步骤-2-模仿和排错-v25">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-删除表"><a class="header-anchor" href="#步骤-3-删除表">¶</a>步骤 3 : 删除表</h4>
<p>因为前面的某些教程修改了product_的表结构，所以这里先把product_表删除一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table product_;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-Product-hbm-xml"><a class="header-anchor" href="#步骤-4-Product-hbm-xml">¶</a>步骤 4 : Product.hbm.xml</h4>
<p>这是Product.hbm.xml，用于提供类与表的映射，以及属性与表字段的映射关系</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">      </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-注解方式"><a class="header-anchor" href="#步骤-5-注解方式">¶</a>步骤 5 : 注解方式</h4>
<p>现在直接在类上使用注解，来达到相同的配置效果。<br>
关于这些注解的解释，在接下来的知识点讲解：[类和属性注解]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"price"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-hibernate-cfg-xml-配置文件改动"><a class="header-anchor" href="#步骤-6-hibernate-cfg-xml-配置文件改动">¶</a>步骤 6 : hibernate.cfg.xml 配置文件改动</h4>
<p>为了能够让hibernate支持这种注解的方式，还需要做一个改动:<br>
把hibernate.cfg.xml配置文件中的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>注释掉，采用：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>这种写法，其他所有代码都不用改变，这样就可以一样实现[hibernate的CRUD操作]</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.characterEncoding"</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;mapping resource="com/how2java/pojo/Product.hbm.xml" /&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2、类与属性"><a class="header-anchor" href="#2、类与属性">¶</a>2、类与属性</h3>
<h4 id="步骤-1-hibernate-注解分类"><a class="header-anchor" href="#步骤-1-hibernate-注解分类">¶</a>步骤 1 : hibernate 注解分类</h4>
<p>hibernate里常用注解包括，类注解，属性注解，关系注解，其他的注解<br>
本知识点讲解类注解和属性注解</p>
<h4 id="步骤-2-类注解"><a class="header-anchor" href="#步骤-2-类注解">¶</a>步骤 2 : 类注解</h4>
<p>在[注解示例-注解方式的Product]中，Product类声明前面有两个注解：@Entity 和 @Table(name = “product_”)<br>
@Entity 表示这是一个实体类，用于映射表<br>
@Table(name = “product_”) 表示这是一个类，映射到的表名:product_</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-属性注解"><a class="header-anchor" href="#步骤-3-属性注解">¶</a>步骤 3 : 属性注解</h4>
<p>然后是属性注解，属性注解是配置在属性对应的getter方法上的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Id</span></span><br><span class="line"><span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY) </span><br><span class="line"><span class="meta">@Column</span>(name = <span class="string">"id"</span>)   </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@Id 表示这是主键<br>
@GeneratedValue(strategy = GenerationType.IDENTITY) 表示自增长方式使用mysql自带的<br>
@Column(name = “id”) 表示映射到字段id<br>
<strong>注：</strong> 其他自增长方式请查看 [注解手册]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>表示name属性映射表的name字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Column</span>(name = <span class="string">"price"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>表示price属性映射表的price字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"price"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、多对一关系映射注解，一对多关系映射注解，多对多关系映射"><a class="header-anchor" href="#3、多对一关系映射注解，一对多关系映射注解，多对多关系映射">¶</a>3、多对一关系映射注解，一对多关系映射注解，多对多关系映射</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v26"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v26">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v26"><a class="header-anchor" href="#步骤-2-模仿和排错-v26">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-多对一注解"><a class="header-anchor" href="#步骤-3-多对一注解">¶</a>步骤 3 : 多对一注解</h4>
<p>把[多对一]改成用注解来实现</p>
<ol>
<li>
<p>把Category的id和name字段改为支持注解<br>
<strong>注：</strong> 分类的getName上并没有加上@Column(name=“name”)，也可以达到映射的效果。 因为getName方法默认会被认为是字段映射。 除非加上了@Transient 才表示不进行映射</p>
</li>
<li>
<p>把Product的getCategory进行多对一映射</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ManyToOne</span></span><br><span class="line">   <span class="meta">@JoinColumn</span>(name=<span class="string">"cid"</span>) </span><br><span class="line">   <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> category;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>@ManyToOne 表示多对一关系<br>
@JoinColumn(name=“cid”) 表示关系字段是cid<br>
对比xml中的映射方式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">class</span>=<span class="string">"Category"</span> <span class="attr">column</span>=<span class="string">"cid"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>为hibernate.cfg.xml 添加Category的映射</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"category_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToOne;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">     </span><br><span class="line">    Category category;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"price"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@ManyToOne</span></span><br><span class="line">    <span class="meta">@JoinColumn</span>(name=<span class="string">"cid"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.characterEncoding"</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;mapping resource="com/how2java/pojo/Product.hbm.xml" /&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span> /&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-一对多注解"><a class="header-anchor" href="#步骤-4-一对多注解">¶</a>步骤 4 : 一对多注解</h4>
<p>在上一步的基础上做如下改动</p>
<ol>
<li>为Category再加product集合，并提供getter和setter</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;Product&gt; products;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> products;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(Set&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.products = products;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>给getProducts方法加上一对多注解</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OneToMany</span>(fetch=FetchType.EAGER)</span><br><span class="line"><span class="meta">@JoinColumn</span>(name=<span class="string">"cid"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> products;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>@OneToMany 表示一对多,fetch=FetchType.EAGER 表示不进行延迟加载(FetchType.LAZY表示要进行延迟加载)<br>
@JoinColumn(name=“cid”) 表示映射字段<br>
对比xml中的映射方式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">not-null</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>修改TestHibernate为</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">       Session s = sf.openSession();</span><br><span class="line">       s.beginTransaction();</span><br><span class="line">       Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">       s.getTransaction().commit();</span><br><span class="line">       s.close();</span><br><span class="line">       sf.close();</span><br><span class="line">       Set&lt;Product&gt; ps = c.getProducts();</span><br><span class="line">       <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">           System.out.println(p.getName());</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.OneToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"category_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    Set&lt;Product&gt; products;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@OneToMany</span>(fetch=FetchType.EAGER)</span><br><span class="line">    <span class="meta">@JoinColumn</span>(name=<span class="string">"cid"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(Set&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">        Category c = (Category) s.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">        Set&lt;Product&gt; ps = c.getProducts();</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-多对多注解"><a class="header-anchor" href="#步骤-5-多对多注解">¶</a>步骤 5 : 多对多注解</h4>
<ol>
<li>在[基于XML配置的多对多知识点]的基础上进行多对多注解的修改</li>
</ol>
<p>​	2.像上两步那样，为Product,User,Category 加上类和属性注解</p>
<ol start="3">
<li>
<p>加上[多对一注解]ManyToOne</p>
</li>
<li>
<p>加上[一对多注解]OneToMany</p>
</li>
<li>
<p>ManyToMany<br>
为Product的getUsers加上</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ManyToMany</span>(cascade=CascadeType.ALL,fetch=FetchType.EAGER)</span><br><span class="line">  <span class="meta">@JoinTable</span>(</span><br><span class="line">          name=<span class="string">"user_product"</span>,</span><br><span class="line">          joinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"pid"</span>),</span><br><span class="line">          inverseJoinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"uid"</span>)</span><br><span class="line">  )    </span><br><span class="line">  <span class="function"><span class="keyword">public</span> Set&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> users;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>对比Product.hbm.xml中的配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"users"</span> <span class="attr">table</span>=<span class="string">"user_product"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"pid"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">column</span>=<span class="string">"uid"</span> <span class="attr">class</span>=<span class="string">"User"</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>为User的getProducts加上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ManyToMany</span>(cascade=CascadeType.ALL,fetch=FetchType.EAGER)</span><br><span class="line">    <span class="meta">@JoinTable</span>(</span><br><span class="line">            name=<span class="string">"user_product"</span>,</span><br><span class="line">            joinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"uid"</span>),</span><br><span class="line">            inverseJoinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"pid"</span>)</span><br><span class="line">    )    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>对比User.hbm.xml中的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"products"</span> <span class="attr">table</span>=<span class="string">"user_product"</span> <span class="attr">lazy</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"uid"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">class</span>=<span class="string">"Product"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="6">
<li>hibernate.cfg.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.User"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="7">
<li>运行TestHibernate</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinTable;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"user_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    Set&lt;Product&gt; products;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@ManyToMany</span>(cascade=CascadeType.ALL,fetch=FetchType.EAGER)</span><br><span class="line">    <span class="meta">@JoinTable</span>(</span><br><span class="line">            name=<span class="string">"user_product"</span>,</span><br><span class="line">            joinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"uid"</span>),</span><br><span class="line">            inverseJoinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"pid"</span>)</span><br><span class="line">    )   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(Set&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinTable;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"user_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    Set&lt;Product&gt; products;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@ManyToMany</span>(cascade=CascadeType.ALL,fetch=FetchType.EAGER)</span><br><span class="line">    <span class="meta">@JoinTable</span>(</span><br><span class="line">            name=<span class="string">"user_product"</span>,</span><br><span class="line">            joinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"uid"</span>),</span><br><span class="line">            inverseJoinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"pid"</span>)</span><br><span class="line">    )   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(Set&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinTable;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToOne;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"product_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">    Category category;</span><br><span class="line">    Set&lt;User&gt; users;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@ManyToMany</span>(cascade=CascadeType.ALL,fetch=FetchType.EAGER)</span><br><span class="line">    <span class="meta">@JoinTable</span>(</span><br><span class="line">            name=<span class="string">"user_product"</span>,</span><br><span class="line">            joinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"pid"</span>),</span><br><span class="line">            inverseJoinColumns=<span class="meta">@JoinColumn</span>(name=<span class="string">"uid"</span>)</span><br><span class="line">    )   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsers</span><span class="params">(Set&lt;User&gt; users)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.users = users;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@ManyToOne</span></span><br><span class="line">    <span class="meta">@JoinColumn</span>(name=<span class="string">"cid"</span>)    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.OneToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"category_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    Set&lt;Product&gt; products;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@OneToMany</span>(fetch=FetchType.EAGER)</span><br><span class="line">    <span class="meta">@JoinColumn</span>(name=<span class="string">"cid"</span>)    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(Set&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.User;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestHibernate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure().buildSessionFactory();</span><br><span class="line">   </span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line">          </span><br><span class="line"><span class="comment">//        //增加3个用户</span></span><br><span class="line">        Set&lt;User&gt; users = <span class="keyword">new</span> HashSet();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            User u =<span class="keyword">new</span> User();</span><br><span class="line">            u.setName(<span class="string">"user"</span>+i);</span><br><span class="line">            users.add(u);</span><br><span class="line">            s.save(u);</span><br><span class="line">        &#125;</span><br><span class="line">          </span><br><span class="line">        <span class="comment">//产品1被用户1,2,3购买</span></span><br><span class="line">        Product p1 = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line"> </span><br><span class="line">        p1.setUsers(users);</span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/test?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.characterEncoding"</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.User"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="4、常见注解一览"><a class="header-anchor" href="#4、常见注解一览">¶</a>4、常见注解一览</h3>
<p>这里列出了常用的注解以供使用的时候查询</p>
<h4 id="步骤-1-类相关注解"><a class="header-anchor" href="#步骤-1-类相关注解">¶</a>步骤 1 : 类相关注解</h4>
<p>@Entity —— 将一个类声明为一个实体bean(即一个持久化POJO类)<br>
@Table —— 注解声明了该实体bean映射指定的表（table）,目录（catalog）和schema的名字</p>
<h4 id="步骤-2-属性相关注解"><a class="header-anchor" href="#步骤-2-属性相关注解">¶</a>步骤 2 : 属性相关注解</h4>
<p><strong>@Id</strong> —— 注解声明了该实体bean的标识属性（对应表中的主键）。<br>
<strong>@Column</strong> —— 注解声明了属性到列的映射。该注解有如下的属性<br>
name 可选，列名（默认值是属性名）<br>
unique 可选，是否在该列上设置唯一约束（默认值false）<br>
nullable 可选，是否设置该列的值可以为空（默认值false）<br>
insertable 可选，该列是否作为生成的insert语句中的一个列（默认值true）<br>
updatable 可选，该列是否作为生成的update语句中的一个列（默认值true）<br>
columnDefinition 可选，为这个特定列覆盖sql ddl片段（这可能导致无法在不同数据库间移植）<br>
table 可选，定义对应的表（默认为主表）<br>
length 可选，列长度（默认值255）<br>
precision 可选，列十进制精度（decimal precision)(默认值0）<br>
scale 可选，如果列十进制数值范围（decimal scale）可用，在此设置（默认值0）<br>
<strong>@GeneratedValue</strong> —— 注解声明了主键的生成策略。该注解有如下属性<br>
strategy 指定生成的策略（JPA定义的），这是一个GenerationType。默认是GenerationType. AUTO<br>
GenerationType.AUTO 主键由程序控制<br>
GenerationType.TABLE 使用一个特定的数据库表格来保存主键<br>
GenerationType.IDENTITY 主键由数据库自动生成（主要是自动增长类型）<br>
GenerationType.SEQUENCE 根据底层数据库的序列来生成主键，条件是数据库支持序列。（这个值要与generator一起使用）<br>
generator 指定生成主键使用的生成器（可能是orcale中的序列）。<br>
<strong>@SequenceGenerator</strong> —— 注解声明了一个数据库序列。该注解有如下属性<br>
name 表示该表主键生成策略名称，它被引用在@GeneratedValue中设置的“gernerator”值中<br>
sequenceName 表示生成策略用到的数据库序列名称。<br>
initialValue 表示主键初始值，默认为0.<br>
allocationSize 每次主键值增加的大小，例如设置成1，则表示每次创建新记录后自动加1，默认为50.</p>
<h4 id="步骤-3-关系相关注解"><a class="header-anchor" href="#步骤-3-关系相关注解">¶</a>步骤 3 : 关系相关注解</h4>
<p><strong>@ManyToOne</strong> 设置多对一关联<br>
方法一<br>
@ManyToOne(cascade={CasCadeType.PERSIST,CascadeType.MERGE})<br>
@JoinColumn(name=“外键”)<br>
public 主表类 get主表类(){return 主表对象}<br>
方法二<br>
@ManyToOne(cascade={CascadeType.PERSIST,CascadeType.MERGE})<br>
@JoinTable(name=“关联表名”，<br>
joinColumns = @JoinColumn(name=“主表外键”),<br>
inverseJoinColumns = @JoinColumns(name=“从表外键”)<br>
)<br>
<strong>@OneToMany</strong> 设置一对多关联。<br>
方法一 。<br>
“一端”配置<br>
@OneToMany(mappedBy=&quot;“多端”的属性&quot;)<br>
public List&lt;“多端”类&gt; get“多端”列表(){return “多端”列表}<br>
“多端”配置参考@ManyToOne.<br>
方法二<br>
“一端”配置<br>
@OneToMany(mappedBy=&quot;“多端”的属性&quot;)<br>
@MapKey(name=&quot;“多端”做为Key的属性&quot;)<br>
public Map&lt;“多端”做为Key的属性的类,主表类&gt; get“多端”列表（）{return “多端”列表}<br>
“多端”配置参考@ManyToOne.<br>
方法三 使用这种配置，在为“一端”添加“多端”时，可以修改“多端”的外键。<br>
“一端”配置<br>
@OneToMany<br>
@JoinColumn(name=&quot;“多端”外键&quot;)<br>
public List&lt;“多端”类&gt; get“多端”列表(){return “多端”列表}<br>
“多端”配置参考@ManyToOne.</p>
<h3 id="5、HIBERNATE-应该使用注解还是XML配置文件？"><a class="header-anchor" href="#5、HIBERNATE-应该使用注解还是XML配置文件？">¶</a>5、HIBERNATE 应该使用注解还是XML配置文件？</h3>
<p>那么到底该用注解，还是xml文件配置方式呢？ 他们各自有各自的优缺点：</p>
<p>XML配置方式：<br>
优：容易编辑，配置比较集中，方便修改，在大业务量的系统里面，通过xml配置会方便后人理解整个系统的架构，修改之后直接重启应用即可<br>
缺：比较繁琐，配置形态丑陋, 配置文件过多的时候难以管理<br>
注解方式：<br>
优：方便，简洁，配置信息和 Java 代码放在一起，有助于增强程序的内聚性。<br>
缺：分散到各个class文件中，所以不宜维护, 修改之后你需要重新打包，发布，重启应用。</p>
<p><strong>个人体会：</strong> 小项目，参与人数不多，不复杂的用注解，开发快速。 复杂项目，多人交互，配置量大，维护复杂度高的，用配置文件。</p>
<h3 id="6、注解运行原理"><a class="header-anchor" href="#6、注解运行原理">¶</a>6、注解运行原理</h3>
<p>为什么采用注解就可以替换掉hbm.xml配置文件了？ 在[注解教程] 以及[仿Hibernate注解]章节有专门的阐述。</p>
<h1 id="贰、STRUTS"><a class="header-anchor" href="#贰、STRUTS">¶</a>贰、STRUTS</h1>
<h2 id="一、基础-v2"><a class="header-anchor" href="#一、基础-v2">¶</a>一、基础</h2>
<h3 id="1、Hello-Struts"><a class="header-anchor" href="#1、Hello-Struts">¶</a>1、Hello Struts</h3>
<p>Struts2 是基于MVC的WEB框架<br>
在Hello Struts中，将展示最基本的Struts的配置<br>
后续的学习都在这个基础上进行</p>
<p><strong>必读：</strong> 基于框架的程序要成功运行，对于JAR包的版本，配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致框架程序运行失败。 如果你是第一次学习本框架，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v27"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v27">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>Struts需要做不少步骤，任何一步部做漏了，做错了，都有可能失败，这样会影响学习的信心，并且误以为本教程是走不通的。</p>
<p>所以先下载右上角的可运行项目 struts.rar，解压后导入到eclipse中，启动Tomcat，观察是否正常运行。确定可以运行，确定教程是可以跑得起来的，再学习下面的内容。</p>
<p>导入到Eclipse中并运行的办法请参考：[导入动态Web项目到Eclipse中]</p>
<p>部署成功之后，测试地址，应该看到如图所示的效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/index</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 这是动态项目格式，不支持[独立Tomcat方式部署]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1841.png" alt></p>
<h4 id="步骤-2-模仿和排错-v27"><a class="header-anchor" href="#步骤-2-模仿和排错-v27">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-在eclipse中创建Web动态项目struts"><a class="header-anchor" href="#步骤-3-在eclipse中创建Web动态项目struts">¶</a>步骤 3 : 在eclipse中创建Web动态项目struts</h4>
<p>在eclipse中新建项目struts，使用dynamic web project的方式。 不熟悉这种方式的同学，请参考 [使用Dynamic Web Project的方式开发J2EE应用]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/129.png" alt></p>
<h4 id="步骤-4-导入jar包"><a class="header-anchor" href="#步骤-4-导入jar包">¶</a>步骤 4 : 导入jar包</h4>
<p>下载右上角的lib.rar，解压后复制到WEB-INF/lib里</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5849.png" alt></p>
<h4 id="步骤-5-新建web-xml"><a class="header-anchor" href="#步骤-5-新建web-xml">¶</a>步骤 5 : 新建web.xml</h4>
<p>在WEB-INF目录下新建web.xml<br>
其中配置了一个 Filter, 所有的请求都被过滤给了这个 Filter<br>
org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">            org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>FORWARD<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-配置struts-xml"><a class="header-anchor" href="#步骤-6-配置struts-xml">¶</a>步骤 6 : 配置struts.xml</h4>
<p>在<strong>src目录</strong>下创建一个struts.xml文件<br>
这是最简单的struts.xml配置<br>
其效果是当访问index路径的时候，服务端跳转到index.jsp</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/132.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-创建index-jsp"><a class="header-anchor" href="#步骤-7-创建index-jsp">¶</a>步骤 7 : 创建index.jsp</h4>
<p>在<strong>web目录</strong>下创建index.jsp，<br>
其内容很简单 就是一句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello Struts2 World</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/133.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello Struts2 World</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-部署在tomcat中，重启测试"><a class="header-anchor" href="#步骤-8-部署在tomcat中，重启测试">¶</a>步骤 8 : 部署在tomcat中，重启测试</h4>
<p>部署在Tomcat中，重启tomcat，然后访问地址，观察效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/index</span></span><br></pre></td></tr></table></figure>
<p>相当于实现了servlet的[服务端跳转]到index.jsp的功能<br>
部署办法请参考 [通过Eclipse启动Tomcat-Run On Server]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/134.png" alt></p>
<h4 id="步骤-9-思路图"><a class="header-anchor" href="#步骤-9-思路图">¶</a>步骤 9 : 思路图</h4>
<ol>
<li>所有的访问都会被web.xml中配置的Struts 的 Filter所拦截</li>
<li>拦截之后，就进入struts的工作流程</li>
<li>访问的地址是/index,根据struts按照 struts.xml中的配置，服务端跳转到index.jsp</li>
<li>显示index.jsp的内容</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1870.png" alt></p>
<h4 id="步骤-10-可运行项目"><a class="header-anchor" href="#步骤-10-可运行项目">¶</a>步骤 10 : 可运行项目</h4>
<p>在右上角有本知识点对应的可运行项目下载 ,实在自己搞不出来，就下载解压出来比较一下</p>
<h4 id="步骤-11-练习"><a class="header-anchor" href="#步骤-11-练习">¶</a>步骤 11 : 练习</h4>
<p>准备一个hello.jsp文件</p>
<p>通过配置struts.xml实现访问路径 /hello 跳转到 hello.jsp</p>
<h3 id="2、IDEA"><a class="header-anchor" href="#2、IDEA">¶</a>2、IDEA</h3>
<p>此教程使用Eclipse下的Web Dynamic Web Project风格创建，可是有部分同学更倾向于使用idea来启动web项目，不过在idea导入eclipse的Dynamic Web Project风格项目的时候由常常走不通，为此专门制作了：[如何使用IDEA导入并启动Eclipse下的的 Dynamic Web Project]，协助学习曲线更平滑些。</p>
<h3 id="3、显示数据到JSP"><a class="header-anchor" href="#3、显示数据到JSP">¶</a>3、显示数据到JSP</h3>
<p>把Model的数据显示在视图JSP上</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v28"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v28">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>访问测试页面：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/showProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5414.png" alt></p>
<h4 id="步骤-2-模仿和排错-v28"><a class="header-anchor" href="#步骤-2-模仿和排错-v28">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-Product-java-用于存放数据"><a class="header-anchor" href="#步骤-3-Product-java-用于存放数据">¶</a>步骤 3 : Product.java 用于存放数据</h4>
<p>Model层使用一个简单的Product用于存放数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.bean;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-ProductAction用于控制"><a class="header-anchor" href="#步骤-4-ProductAction用于控制">¶</a>步骤 4 : ProductAction用于控制</h4>
<p>9-10行准备数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-在struts-xml中配置跳转"><a class="header-anchor" href="#步骤-5-在struts-xml中配置跳转">¶</a>步骤 5 : 在struts.xml中配置跳转</h4>
<p>该配置表示 访问路径**/showProduct**会调用 ProductAction 类的 show 方法<br>
服务端跳转到show.jsp</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-show-jsp"><a class="header-anchor" href="#步骤-6-show-jsp">¶</a>步骤 6 : show.jsp</h4>
<p>在<strong>web目录</strong>下创建show.jsp文件<br>
通过[EL表达式]，取出product的name<br>
<strong>注：</strong> ${product}会访问对应的Action的 **getProduct()**方法</p>
<p><strong>注：</strong> 严格地说，是Struts通过getProudct()方法返回product对象，然后再把product对象通过request.setAttribute(“product”, product) 放在&quot;product&quot; 这个key上，这样就方便EL表达式去取出来了</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">$&#123;product.name&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试"><a class="header-anchor" href="#步骤-7-测试">¶</a>步骤 7 : 测试</h4>
<p>重启tomcat 访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/showProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/139.png" alt></p>
<h4 id="步骤-8-原理图"><a class="header-anchor" href="#步骤-8-原理图">¶</a>步骤 8 : 原理图</h4>
<ol>
<li>访问路径 /showProduct</li>
<li>所有访问都被struts的filter所拦截，并进入struts的工作流程</li>
<li>根据配置文件struts.xml, 会执行ProductAction的show方法</li>
<li>在show方法中，将实例属性product指向一个新的对象，并设置名称为iphone7</li>
<li>服务端跳转到show.jsp</li>
<li>在show.jsp中，访问ProductAction.getProduct() 获取实例属性product,并显示其名称iphone7</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1871.png" alt></p>
<h4 id="步骤-9-练习"><a class="header-anchor" href="#步骤-9-练习">¶</a>步骤 9 : 练习</h4>
<p>访问路径 /showTime 跳转到页面 showTime.jsp，并且在showTime.jsp中显示当前时间</p>
<h3 id="4、提交数据到ACTION"><a class="header-anchor" href="#4、提交数据到ACTION">¶</a>4、提交数据到ACTION</h3>
<p>jsp提交product的name到action<br>
然后action又跳转回showProduct.jsp把提交上来的name显示出来</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v29"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v29">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v29"><a class="header-anchor" href="#步骤-2-模仿和排错-v29">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v6"><a class="header-anchor" href="#步骤-3-效果-v6">¶</a>步骤 3 : 效果</h4>
<p>访问提交数据地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>在页面显示 <strong>提交的数据</strong> “iphone”</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1844.png" alt></p>
<h4 id="步骤-4-addProduct-jsp"><a class="header-anchor" href="#步骤-4-addProduct-jsp">¶</a>步骤 4 : addProduct.jsp</h4>
<p>最简单的提交数据的form<br>
(提交中文可能有问题，关于中文问题，在[struts中文问题]章节有专门的讲解)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;form action=<span class="string">"addProduct"</span>&gt;</span><br><span class="line"> &lt;input type=<span class="string">"text"</span> name=<span class="string">"product.name"</span>&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line"> &lt;input type=<span class="string">"submit"</span> value=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-配置struts-xml"><a class="header-anchor" href="#步骤-5-配置struts-xml">¶</a>步骤 5 : 配置struts.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-ProductAction增加add方法"><a class="header-anchor" href="#步骤-6-ProductAction增加add方法">¶</a>步骤 6 : ProductAction增加add方法</h4>
<p><a href="http://xn--addProduct-eh3r.xn--jspfieldproduct-nz3x21dbw5pfsb01p17d552j.name" target="_blank" rel="noopener">在addProduct.jsp中提交数据的field是product.name</a><br>
会自动调用<strong>对应的Action</strong>的<strong>setProduct</strong>(Product product)方法进行数据的注入<br>
所以ProductAction必须提供setProduct(Product product)方法<br>
在执行到第14行的时候，jsp传过来的name已经被注入进了属性product中了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"product.name:"</span>+product.getName());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试-v2"><a class="header-anchor" href="#步骤-7-测试-v2">¶</a>步骤 7 : 测试</h4>
<p>重启tomcat，访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>并提交数据</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/144.png" alt></p>
<h4 id="步骤-8-原理图-v2"><a class="header-anchor" href="#步骤-8-原理图-v2">¶</a>步骤 8 : 原理图</h4>
<ol>
<li>访问路径 /addProduct</li>
<li>所有访问都被struts的filter所拦截，并进入struts的工作流程</li>
<li>根据配置文件struts.xml, 会执行ProductAction的add方法</li>
<li>在add方法执行之前，Struts生成一个新的product对象，并把页面传递过来的name设置在该对象上，接着把该对象通过setProduct()方法，注入ProductAction</li>
<li>服务端跳转到show.jsp</li>
<li>在show.jsp中，访问ProductAction.getProduct() 获取注入的product,并显示其名称</li>
</ol>
<h4 id="步骤-9-练习-v2"><a class="header-anchor" href="#步骤-9-练习-v2">¶</a><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1874.png" alt>步骤 9 : 练习</h4>
<p>在页面上新增加age字段，提交到Action</p>
<p>为product新增加一个age属性，并提供setter和getter</p>
<p>最后在show.jsp上显示页面提交的age数据</p>
<h3 id="5、中文问题"><a class="header-anchor" href="#5、中文问题">¶</a>5、中文问题</h3>
<p>Struts的中文问题，由3部分组成</p>
<ol>
<li>jsp提交数据的时候，必须是UTF-8编码的</li>
<li>struts拿到数据后进行UTF-8解码</li>
<li>服务端跳转到jsp进行显示的时候，要指定浏览器使用UTF-8进行显示<br>
UTF-8可以换成GBK或者GB2312，但是必须统一，不能混用</li>
</ol>
<h4 id="步骤-1-先运行，看到效果，再学习-v30"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v30">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v30"><a class="header-anchor" href="#步骤-2-模仿和排错-v30">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v7"><a class="header-anchor" href="#步骤-3-效果-v7">¶</a>步骤 3 : 效果</h4>
<p>访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>提交中文<br>
按照本章节，进行中文相关的配合后能够正确地提交中文，以及显示中文了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1845.png" alt></p>
<h4 id="步骤-4-提交数据的-addProduct-jsp"><a class="header-anchor" href="#步骤-4-提交数据的-addProduct-jsp">¶</a>步骤 4 : 提交数据的 addProduct.jsp</h4>
<p>提交数据的时候指定编码方式UTF-8<br>
并且设置form 的method为<strong>post</strong>方式</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;form action=<span class="string">"addProduct"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line"> &lt;input type=<span class="string">"text"</span> name=<span class="string">"product.name"</span>&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line"> &lt;input type=<span class="string">"submit"</span> value=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-struts-xml"><a class="header-anchor" href="#步骤-5-struts-xml">¶</a>步骤 5 : struts.xml</h4>
<p>指定解码方式为UTF-8</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-显示数据的-show-jsp"><a class="header-anchor" href="#步骤-6-显示数据的-show-jsp">¶</a>步骤 6 : 显示数据的 show.jsp</h4>
<p>服务端跳转到jsp进行显示的时候，要指定浏览器使用UTF-8进行显示</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">$&#123;product.name&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试-v3"><a class="header-anchor" href="#步骤-7-测试-v3">¶</a>步骤 7 : 测试</h4>
<p>重启tomcat，访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>提交中文</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1834.png" alt></p>
<h3 id="6、启动失败，出现错误ERROR-FILTERSTART-应该如何调试"><a class="header-anchor" href="#6、启动失败，出现错误ERROR-FILTERSTART-应该如何调试">¶</a>6、启动失败，出现错误ERROR FILTERSTART 应该如何调试</h3>
<p>在tomcat启动struts web应用的时候，如果出现了struts配置上的错误，你可能只能看到一个 Error FilterStart的提示，而看不到详细的错误原因。</p>
<p>这样就加大了定位和解决问题的难度</p>
<p>这是因为默认配置下，struts把日志输出关闭了<br>
为了把日志输出开启便于调试，需要增加log4j.xml这个配置文件</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v31"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v31">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v31"><a class="header-anchor" href="#步骤-2-模仿和排错-v31">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-故意制造一个struts的配置错误"><a class="header-anchor" href="#步骤-3-故意制造一个struts的配置错误">¶</a>步骤 3 : 故意制造一个struts的配置错误</h4>
<p>在11行，故意制造一个错误，把ProductAction写成ProductAction<strong>1</strong></p>
<p>这样struts就会启动失败，虽然启动失败了，但是tomcat给出的错误信息非常有限，很不利于调试。 无法知道到底哪里写错了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1835.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction1"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-在src目录下增加log4j-xml"><a class="header-anchor" href="#步骤-4-在src目录下增加log4j-xml">¶</a>步骤 4 : 在src目录下增加log4j.xml</h4>
<p>在src目录下增加log4j.xml，打开日志功能</p>
<p>然后重新启动tomcat即可看到具体struts启动失败错误原因</p>
<p>如图所示，可以看到很明确的错误原因，ProductAction1类的<strong>ClassNotFoundException</strong></p>
<p>参考[log4j 入门教程]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/145.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">log4j</span>:configuration <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//log4j/log4j Configuration//EN"</span> <span class="meta-string">"log4j.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">log4j:configuration</span> <span class="attr">xmlns:log4j</span>=<span class="string">"http://jakarta.apache.org/log4j/"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"STDOUT"</span> <span class="attr">class</span>=<span class="string">"org.apache.log4j.ConsoleAppender"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">"org.apache.log4j.PatternLayout"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"ConversionPattern"</span> <span class="attr">value</span>=<span class="string">"%d %-5p %c.%M:%L - %m%n"</span>/&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">&lt;!-- specify the logging level for loggers from other libraries --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"com.opensymphony"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">"DEBUG"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.apache.struts2"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">"DEBUG"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">&lt;!-- for all other loggers log only debug and above log messages --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">priority</span> <span class="attr">value</span>=<span class="string">"INFO"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"STDOUT"</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">log4j:configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-关闭log4j-xml日志输出"><a class="header-anchor" href="#步骤-5-关闭log4j-xml日志输出">¶</a>步骤 5 : 关闭log4j.xml日志输出</h4>
<p>有了log4j.xml日志输出可以帮助调试，但是也会导致struts的启动变慢。</p>
<p>关闭log4j.xml日志输出很简单，直接把log4j.xml命名成其他文件即可，以后要用再把名字改回来，很方便</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1836.png" alt></p>
<h3 id="7、获取-REQUEST对象和-RESPONSE对象"><a class="header-anchor" href="#7、获取-REQUEST对象和-RESPONSE对象">¶</a>7、获取 REQUEST对象和 RESPONSE对象</h3>
<p>在struts中也可以获取servlet包中的request和response对象</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v32"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v32">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v32"><a class="header-anchor" href="#步骤-2-模仿和排错-v32">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-获取request和response对象"><a class="header-anchor" href="#步骤-3-获取request和response对象">¶</a>步骤 3 : 获取request和response对象</h4>
<p>修改ProductAction的show方法，获取request和response对象<br>
访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/showProduct</span></span><br></pre></td></tr></table></figure>
<p><strong>在Tomcat的控制台输出</strong> 可以看到Struts使用类StrutsRequestWrapper对HttpServletRequest进行了封装</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/158.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        HttpServletRequest request = ServletActionContext.getRequest();</span><br><span class="line">        HttpServletResponse response = ServletActionContext.getResponse();</span><br><span class="line"> </span><br><span class="line">        System.out.println(<span class="string">"request:\t"</span> + request);</span><br><span class="line">        System.out.println(<span class="string">"response:\t"</span> + response);</span><br><span class="line"> </span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">        Map m = ActionContext.getContext().getSession();</span><br><span class="line">        m.put(<span class="string">"name"</span>, product.getName());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// public void validate()&#123;</span></span><br><span class="line">    <span class="comment">// if ( product.getName().length() == 0 )&#123;</span></span><br><span class="line">    <span class="comment">// addFieldError( "product.name", "name can't be empty" );</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8、获取SESSION对象"><a class="header-anchor" href="#8、获取SESSION对象">¶</a>8、获取SESSION对象</h3>
<p>struts中的Session有两个<br>
一个是传统的servlet包下的HttpSession<br>
另一个是Struts中自己定义的Session</p>
<p><strong>传统的</strong>servlet包下的session的获取办法是：<br>
ServletActionContext.getRequest().getSession();<br>
使用该方法，需要在eclipse的项目中导入servlet-api.jar，可以在右边下载</p>
<p><strong>新的Session</strong>的获取办法是<br>
Map m = ActionContext.getContext().getSession();<br>
这个session以Map类的形式出现，其中的值和HttpSession中的值是同步的</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v33"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v33">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v33"><a class="header-anchor" href="#步骤-2-模仿和排错-v33">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v8"><a class="header-anchor" href="#步骤-3-效果-v8">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址,提交数据：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>可以观察到从session中获取的name</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1846.png" alt></p>
<h4 id="步骤-4-在ProductAction的add方法中访问Session"><a class="header-anchor" href="#步骤-4-在ProductAction的add方法中访问Session">¶</a>步骤 4 : 在ProductAction的add方法中访问Session</h4>
<p>在add方法中获取Struts定义的Session</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map m = ActionContext.getContext().getSession();</span><br></pre></td></tr></table></figure>
<p>然后把 name放进去</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map m = ActionContext.getContext().getSession();</span><br><span class="line">        m.put(<span class="string">"name"</span>, product.getName());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-在show-jsp中把通过EL表达式把session中的数据取出来"><a class="header-anchor" href="#步骤-5-在show-jsp中把通过EL表达式把session中的数据取出来">¶</a>步骤 5 : 在show.jsp中把通过EL表达式把session中的数据取出来</h4>
<p>EL表达式可以直接从session中把数据取出来</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">$&#123;product.name&#125;</span><br><span class="line"> </span><br><span class="line">$&#123;name&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v2"><a class="header-anchor" href="#步骤-6-测试-v2">¶</a>步骤 6 : 测试</h4>
<p>通过</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>增加数据</p>
<p>在show.jsp中就可以看到session中的name</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1837.png" alt></p>
<h3 id="9、如何上传文件"><a class="header-anchor" href="#9、如何上传文件">¶</a>9、如何上传文件</h3>
<p>与[通过Servet进行上传文件]比较起来，Struts的上传文件就简单很多</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v34"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v34">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v34"><a class="header-anchor" href="#步骤-2-模仿和排错-v34">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v9"><a class="header-anchor" href="#步骤-3-效果-v9">¶</a>步骤 3 : 效果</h4>
<p>通过测试页面上传文件：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/upload.jsp</span></span><br></pre></td></tr></table></figure>
<p>这是通过struts上传成功后看到的效果<br>
第一行表示 文件被上传到了tomcat下的<br>
第二行表示 上传的文件名是rar.bat<br>
第三行表示 上传的文件的mime type，application/octet-stream，二进制文件</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1847.png" alt></p>
<h4 id="步骤-4-首先准备-upload-jsp"><a class="header-anchor" href="#步骤-4-首先准备-upload-jsp">¶</a>步骤 4 : 首先准备 upload.jsp</h4>
<p>上传一定要为form加上<strong>enctype=“multipart/form-data”</strong>，表示提交的数据是二进制的<br>
并且必须是<strong>method=&quot;post&quot;</strong></p>
<p>使用struts的s:file标签标识上传文件框</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:file name=<span class="string">"doc"</span> label=<span class="string">"upload"</span> /&gt;</span><br></pre></td></tr></table></figure>
<p>这里name使用<strong>doc</strong>会和服务端的相应代码匹配</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">language</span>=<span class="string">"java"</span> <span class="attr">contentType</span>=<span class="string">"text/html; charset=UTF-8"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span> <span class="attr">isELIgnored</span>=<span class="string">"false"</span>%&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">%@page</span> <span class="attr">isELIgnored</span>=<span class="string">"false"</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">prefix</span>=<span class="string">"s"</span> <span class="attr">uri</span>=<span class="string">"/struts-tags"</span> %&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"upload"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  上传文件 : <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"doc"</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"上传"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-UploadAction"><a class="header-anchor" href="#步骤-5-UploadAction">¶</a>步骤 5 : UploadAction</h4>
<p>在upload.jsp中file字段对应的name是&quot;doc&quot;<br>
所以在action中，必须准备3个属性，分别是<br>
File <strong>doc</strong>;<br>
String <strong>doc</strong>FileName;<br>
String <strong>doc</strong>ContentType;<br>
属性名字不能使用其他的，必须基于“<strong>doc</strong>&quot;<br>
然后为这3个属性提供getter setter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.FileUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.ServletActionContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadAction</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    File doc;</span><br><span class="line">    String docFileName;</span><br><span class="line">    String docContentType;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> File <span class="title">getDoc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> doc;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDoc</span><span class="params">(File doc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doc = doc;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDocFileName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> docFileName;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDocFileName</span><span class="params">(String docFileName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.docFileName = docFileName;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDocContentType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> docContentType;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDocContentType</span><span class="params">(String docContentType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.docContentType = docContentType;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(doc);</span><br><span class="line">        System.out.println(docFileName);</span><br><span class="line">        System.out.println(docContentType);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-struts-xml"><a class="header-anchor" href="#步骤-6-struts-xml">¶</a>步骤 6 : struts.xml</h4>
<p>为upload路径配置UploadAction，并返回success.jsp</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>addProduct.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"upload"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.UploadAction"</span> <span class="attr">method</span>=<span class="string">"upload"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-success-jsp"><a class="header-anchor" href="#步骤-7-success-jsp">¶</a>步骤 7 : success.jsp</h4>
<p>分别显示doc,docFileName,docContentType</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">uploaded success</span><br><span class="line"> </span><br><span class="line">$&#123;doc&#125;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">$&#123;docFileName&#125;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">$&#123;docContentType&#125;</span><br><span class="line">&lt;br/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试"><a class="header-anchor" href="#步骤-8-测试">¶</a>步骤 8 : 测试</h4>
<p>重启tomcat，访问页面，进行文件上传提交</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/upload.jsp</span></span><br></pre></td></tr></table></figure>
<p>第一行表示上传后被放在tomcat的work目录下，并且以.tmp命名<br>
第二行是上传文件本来的名字<br>
第三行是上传文件的mime type</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/165.png" alt></p>
<p>将上传的图片显示出来</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"> </span><br><span class="line">        FileInputStream fileInputStream = <span class="keyword">new</span> FileInputStream(doc);</span><br><span class="line">        FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(<span class="string">"E:\\projects\\mvc\\struts\\src\\main\\webapp\\img\\"</span> + docFileName);</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">int</span> read = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> ((read = fileInputStream.read(bytes)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            fileOutputStream.write(bytes, <span class="number">0</span>, read);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        fileInputStream.close();</span><br><span class="line">        fileOutputStream.close();</span><br><span class="line"> </span><br><span class="line">        HttpServletRequest request = ServletActionContext.getRequest();</span><br><span class="line">        HttpServletResponse response = ServletActionContext.getResponse();</span><br><span class="line">        String filePath = <span class="string">"img/"</span>+docFileName;</span><br><span class="line">        request.setAttribute(<span class="string">"img"</span>, filePath);</span><br><span class="line"> </span><br><span class="line">        System.out.println(doc);</span><br><span class="line">        System.out.println(docFileName);</span><br><span class="line">        System.out.println(docContentType);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">-------------------------------------success.jsp---------------------------------------------------------</span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">uploaded success</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;img src = <span class="string">"$&#123;img&#125;"</span> width=<span class="string">"300px"</span>/&gt;</span><br><span class="line">$&#123;doc&#125;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">$&#123;docFileName&#125;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">$&#123;docContentType&#125;</span><br><span class="line">&lt;br/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="10、上传文件最大值"><a class="header-anchor" href="#10、上传文件最大值">¶</a>10、上传文件最大值</h3>
<p>struts上传文件的大小默认是比较小的只有2M，可以进行设置</p>
<h4 id="步骤-1-struts-xml"><a class="header-anchor" href="#步骤-1-struts-xml">¶</a>步骤 1 : struts.xml</h4>
<p>设置上传文件最大大小为10m</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.multipart.maxSize"</span> <span class="attr">value</span>=<span class="string">"10240000"</span>/&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>addProduct.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"upload"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.UploadAction"</span> <span class="attr">method</span>=<span class="string">"upload"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="二、标签"><a class="header-anchor" href="#二、标签">¶</a>二、标签</h2>
<h3 id="1、FORM-标签"><a class="header-anchor" href="#1、FORM-标签">¶</a>1、FORM 标签</h3>
<p>与[jstl标准标签库]类似的，struts有专属标签库<br>
form标签用于提交数据</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v35"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v35">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v35"><a class="header-anchor" href="#步骤-2-模仿和排错-v35">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-修改addProduct-jsp"><a class="header-anchor" href="#步骤-3-修改addProduct-jsp">¶</a>步骤 3 : 修改addProduct.jsp</h4>
<p>使用struts标签库</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;html&gt;</span><br><span class="line"> </span><br><span class="line">&lt;body&gt;</span><br><span class="line"> </span><br><span class="line">&lt;s:form action=<span class="string">"addProduct"</span>&gt;</span><br><span class="line"> </span><br><span class="line">  &lt;s:textfield name=<span class="string">"product.name"</span> label=<span class="string">"product name"</span> /&gt;</span><br><span class="line">  &lt;s:submit value=<span class="string">"Submit"</span> /&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/s:form&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-访问http-127-0-0-1-addProduct-jsp"><a class="header-anchor" href="#步骤-4-访问http-127-0-0-1-addProduct-jsp">¶</a>步骤 4 : 访问http://127.0.0.1/addProduct.jsp</h4>
<p>访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>通过浏览器查看源码可以发现，struts把表单里的内容自动转换成了table</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"addProduct"</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">action</span>=<span class="string">"addProduct.action"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"wwFormTable"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"tdLabel"</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"addProduct_product_name"</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span>product name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"product.name"</span> <span class="attr">value</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">"addProduct_product_name"</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"2"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"right"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">id</span>=<span class="string">"addProduct_0"</span> <span class="attr">value</span>=<span class="string">"Submit"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2、使用S-ITERATOR-标签遍历集合"><a class="header-anchor" href="#2、使用S-ITERATOR-标签遍历集合">¶</a>2、使用S:ITERATOR 标签遍历集合</h3>
<p>与[JSTL标准标签库]的[c:forEach]类似的，struts也提供了一个s:iterator用于遍历一个集合中的数据</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v36"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v36">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v36"><a class="header-anchor" href="#步骤-2-模仿和排错-v36">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v10"><a class="header-anchor" href="#步骤-3-效果-v10">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>这是通过<strong>s:iterator</strong>标签遍历一个集合的结果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1848.png" alt></p>
<h4 id="步骤-4-为ProductAction增加list方法"><a class="header-anchor" href="#步骤-4-为ProductAction增加list方法">¶</a>步骤 4 : 为ProductAction增加list方法</h4>
<ol>
<li>为ProductAction增加一个products属性，类型是List，并提供getter setter</li>
<li>为ProductAction增加一个list()方法，为products添加3个product对象，并返回“list&quot;</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Product&gt; products;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        products=<span class="keyword">new</span> ArrayList();</span><br><span class="line">  </span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setId(<span class="number">1</span>);</span><br><span class="line">        p1.setName(<span class="string">"product1"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setId(<span class="number">2</span>);</span><br><span class="line">        p2.setName(<span class="string">"product2"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setId(<span class="number">3</span>);</span><br><span class="line">        p3.setName(<span class="string">"product3"</span>);</span><br><span class="line">  </span><br><span class="line">        products.add(p1);</span><br><span class="line">        products.add(p2);</span><br><span class="line">        products.add(p3);</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-struts-xml-v2"><a class="header-anchor" href="#步骤-5-struts-xml-v2">¶</a>步骤 5 : struts.xml</h4>
<p>配置路径listProduct，并返回list.jsp</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"listProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span>list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-list-jsp"><a class="header-anchor" href="#步骤-6-list-jsp">¶</a>步骤 6 : list.jsp</h4>
<p>使用<strong>s:iterator</strong>标签进行遍历<br>
<strong>value</strong> 表示集合<br>
<strong>var</strong> 表示遍历出来的元素<br>
<strong>st</strong> 表示遍历出来的元素状态<br>
<strong>st.index</strong> 当前行号 基0<br>
<strong>st.count</strong> 当前行号 基1<br>
<strong>st.first</strong> 是否是第一个元素<br>
<strong>st.last</strong> 是否是最后一个元素<br>
<strong>st.odd</strong> 是否是奇数<br>
<strong>st.even</strong> 是否是偶数</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;style&gt;</span><br><span class="line">table &#123;</span><br><span class="line">    border-collapse: collapse;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">td &#123;</span><br><span class="line">    border: <span class="number">1</span>px solid gray;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"> </span><br><span class="line">&lt;table align=<span class="string">"center"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;st.index&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;st.count&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;st.first&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;st.last&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;st.odd&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;st.even&lt;/td&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;s:iterator value=<span class="string">"products"</span> <span class="keyword">var</span>=<span class="string">"p"</span> status=<span class="string">"st"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;st.index&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;st.count&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;st.first&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;st.last&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;st.odd&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;st.even&#125;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/s:iterator&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试-v4"><a class="header-anchor" href="#步骤-7-测试-v4">¶</a>步骤 7 : 测试</h4>
<p>重启tomcat，访问网页</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/173.png" alt></p>
<h3 id="3、如何使用CHECKBOXLIST-标签"><a class="header-anchor" href="#3、如何使用CHECKBOXLIST-标签">¶</a>3、如何使用CHECKBOXLIST 标签</h3>
<p>遍历3个product成为checkbox<br>
并且第2个和第3个是默认选中的</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v37"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v37">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v37"><a class="header-anchor" href="#步骤-2-模仿和排错-v37">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v11"><a class="header-anchor" href="#步骤-3-效果-v11">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>以checkbox的方式遍历出集合中的数据，第2个和第3个是<strong>默认选中</strong>的</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1849.png" alt></p>
<h4 id="步骤-4-ProductAction-java"><a class="header-anchor" href="#步骤-4-ProductAction-java">¶</a>步骤 4 : ProductAction.java</h4>
<p>除了前例中准备的products<br>
再新增一个属性ListselectedProducts，用于存放哪些产品被选中了<br>
<strong>注意</strong>： ListselectedProducts 里<strong>放的是id</strong>，而不是对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> List&lt;Product&gt; products;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; selectedProducts;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getSelectedProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> selectedProducts;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSelectedProducts</span><span class="params">(List&lt;Integer&gt; selectedProducts)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.selectedProducts = selectedProducts;</span><br><span class="line">    &#125;   </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        products=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        selectedProducts = <span class="keyword">new</span> ArrayList();</span><br><span class="line">  </span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setId(<span class="number">1</span>);</span><br><span class="line">        p1.setName(<span class="string">"product1"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setId(<span class="number">2</span>);</span><br><span class="line">        p2.setName(<span class="string">"product2"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setId(<span class="number">3</span>);</span><br><span class="line">   </span><br><span class="line">        p3.setName(<span class="string">"product3"</span>);</span><br><span class="line">  </span><br><span class="line">        products.add(p1);</span><br><span class="line">        products.add(p2);</span><br><span class="line">        products.add(p3);</span><br><span class="line">         </span><br><span class="line">        selectedProducts.add(<span class="number">2</span>);</span><br><span class="line">        selectedProducts.add(<span class="number">3</span>);</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-list-jsp"><a class="header-anchor" href="#步骤-5-list-jsp">¶</a>步骤 5 : list.jsp</h4>
<p>使用<strong>s:checkboxlist</strong>标签<br>
value：哪些被选中<br>
name：提交到服务端用的名称<br>
list:用于遍历的集合<br>
listValue:显示的checkbox的名称<br>
listKey:checkbox的value</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;s:checkboxlist value=<span class="string">"selectedProducts"</span> name=<span class="string">"product.id"</span></span><br><span class="line">    list=<span class="string">"products"</span> listValue=<span class="string">"name"</span> listKey=<span class="string">"id"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v3"><a class="header-anchor" href="#步骤-6-测试-v3">¶</a>步骤 6 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/187.png" alt></p>
<h3 id="4、如何使用-S-RADIO-标签"><a class="header-anchor" href="#4、如何使用-S-RADIO-标签">¶</a>4、如何使用&lt;S:RADIO&gt;标签</h3>
<p>遍历products成为radio，并选中第二个</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v38"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v38">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v38"><a class="header-anchor" href="#步骤-2-模仿和排错-v38">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v12"><a class="header-anchor" href="#步骤-3-效果-v12">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>以单选框的方式遍历集合中的数据，<strong>默认选中第二个</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1850.png" alt></p>
<h4 id="步骤-4-修改-list-jsp"><a class="header-anchor" href="#步骤-4-修改-list-jsp">¶</a>步骤 4 : 修改 list.jsp</h4>
<p>在前例checkbox标签的基础上增加s:radio标签<br>
value表示：哪项被选中<br>
name表示：提交到服务端用的名称<br>
list:用于遍历的集合<br>
listValue:显示的radio的名称<br>
listKey:radio的value</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;s:radio name=<span class="string">"product.id"</span> value=<span class="string">"2"</span> list=<span class="string">"products"</span> listValue=<span class="string">"name"</span></span><br><span class="line">    listKey=<span class="string">"id"</span> /&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试"><a class="header-anchor" href="#步骤-5-测试">¶</a>步骤 5 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/189.png" alt></p>
<h3 id="5、如何使用S-SELECT-标签"><a class="header-anchor" href="#5、如何使用S-SELECT-标签">¶</a>5、如何使用S:SELECT 标签</h3>
<p>遍历products成为select标签<br>
默认选中第2个和第3个</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v39"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v39">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v39"><a class="header-anchor" href="#步骤-2-模仿和排错-v39">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v13"><a class="header-anchor" href="#步骤-3-效果-v13">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1838.png" alt></p>
<h4 id="步骤-4-修改-list-jsp-v2"><a class="header-anchor" href="#步骤-4-修改-list-jsp-v2">¶</a>步骤 4 : 修改 list.jsp</h4>
<p>使用s:select标签<br>
name表示：提交到服务端用的名称<br>
list:用于遍历的集合<br>
listKey:每个option的value<br>
listValue:显示的名称<br>
multiple:true表示可以选中多行<br>
size=&quot;3&quot;表示默认显示3行<br>
value表示：哪些被选中</p>
<p><strong>注:</strong> 可以增加一个属性 theme=“simple” 使得最后生成的最简单的风格的html，否则就会有一些奇奇怪怪的tr td<br>
或者直接在struts.xml中加一句 Servlet下载文件<br>
<strong>&lt;constant name=“struts.ui.theme” value=“simple”/&gt;</strong><br>
<strong>注:</strong> 如果要增加class，需要使用属性: cssClass</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;s:select label=<span class="string">"products"</span></span><br><span class="line">       name=<span class="string">"product.id"</span></span><br><span class="line">       list=<span class="string">"products"</span></span><br><span class="line">       listKey=<span class="string">"id"</span></span><br><span class="line">       listValue=<span class="string">"name"</span></span><br><span class="line">       multiple=<span class="string">"true"</span></span><br><span class="line">       size=<span class="string">"3"</span></span><br><span class="line">       value=<span class="string">"selectedProducts"</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试-v2"><a class="header-anchor" href="#步骤-5-测试-v2">¶</a>步骤 5 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1851.png" alt></p>
<h3 id="6、使用ITERATOR-迭代遍历集合中的集合"><a class="header-anchor" href="#6、使用ITERATOR-迭代遍历集合中的集合">¶</a>6、使用ITERATOR 迭代遍历集合中的集合</h3>
<p>有部分业务需求需要遍历list中的list<br>
比如当前页面需要显示多个category，每个分类下又对应多个product</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v40"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v40">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v40"><a class="header-anchor" href="#步骤-2-模仿和排错-v40">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v14"><a class="header-anchor" href="#步骤-3-效果-v14">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1839.png" alt></p>
<h4 id="步骤-4-创建Category-java"><a class="header-anchor" href="#步骤-4-创建Category-java">¶</a>步骤 4 : 创建Category.java</h4>
<p>Category除了有id和name属性外，还有List属性<br>
表示category和product是一对多关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.bean;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    List&lt;Product&gt; products;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-ProductAction-java"><a class="header-anchor" href="#步骤-5-ProductAction-java">¶</a>步骤 5 : ProductAction.java</h4>
<p>在list()中准备数据<br>
两个category，并且每个category对应3个product</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> List&lt;Category&gt; categories =<span class="keyword">new</span> ArrayList();</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">getCategories</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categories;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategories</span><span class="params">(List&lt;Category&gt; categories)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.categories = categories;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Category category1 =<span class="keyword">new</span> Category();</span><br><span class="line">        category1.setId(<span class="number">1</span>);</span><br><span class="line">        category1.setName(<span class="string">"category1"</span>);</span><br><span class="line">         </span><br><span class="line">        Category category2 =<span class="keyword">new</span> Category();</span><br><span class="line">        category2.setId(<span class="number">2</span>);</span><br><span class="line">        category2.setName(<span class="string">"category2"</span>);</span><br><span class="line">         </span><br><span class="line">        categories.add(category1);</span><br><span class="line">        categories.add(category2);</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; products1=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setId(<span class="number">1</span>);</span><br><span class="line">        p1.setName(<span class="string">"product1"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setId(<span class="number">2</span>);</span><br><span class="line">        p2.setName(<span class="string">"product2"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setId(<span class="number">3</span>);</span><br><span class="line">        p3.setName(<span class="string">"product3"</span>);</span><br><span class="line">  </span><br><span class="line">        products1.add(p1);</span><br><span class="line">        products1.add(p2);</span><br><span class="line">        products1.add(p3);</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; products2=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        Product p4 = <span class="keyword">new</span> Product();</span><br><span class="line">        p4.setId(<span class="number">4</span>);</span><br><span class="line">        p4.setName(<span class="string">"product4"</span>);</span><br><span class="line">        Product p5 = <span class="keyword">new</span> Product();</span><br><span class="line">        p5.setId(<span class="number">5</span>);</span><br><span class="line">        p5.setName(<span class="string">"product5"</span>);</span><br><span class="line">        Product p6 = <span class="keyword">new</span> Product();</span><br><span class="line">        p6.setId(<span class="number">6</span>);</span><br><span class="line">        p6.setName(<span class="string">"product6"</span>);</span><br><span class="line">         </span><br><span class="line">        products2.add(p4);</span><br><span class="line">        products2.add(p5);</span><br><span class="line">        products2.add(p6);</span><br><span class="line">         </span><br><span class="line">        category1.setProducts(products1);</span><br><span class="line">        category2.setProducts(products2);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-list-jsp-v2"><a class="header-anchor" href="#步骤-6-list-jsp-v2">¶</a>步骤 6 : list.jsp</h4>
<p>遍历每一个category，接着把每个category下对应的products也遍历出来</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;table border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;products&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;s:iterator value=<span class="string">"categories"</span> <span class="keyword">var</span>=<span class="string">"c"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;s:iterator value=<span class="string">"#c.products"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">                    $&#123;p.name&#125;&lt;br/&gt;</span><br><span class="line">                &lt;/s:iterator&gt;        </span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/s:iterator&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/table&gt;</span><br><span class="line"> </span><br><span class="line">&lt;s:debug/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试-v5"><a class="header-anchor" href="#步骤-7-测试-v5">¶</a>步骤 7 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1853.png" alt></p>
<h2 id="三、其他"><a class="header-anchor" href="#三、其他">¶</a>三、其他</h2>
<h3 id="1、调试1"><a class="header-anchor" href="#1、调试1">¶</a>1、调试1</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v41"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v41">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v41"><a class="header-anchor" href="#步骤-2-模仿和排错-v41">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v15"><a class="header-anchor" href="#步骤-3-效果-v15">¶</a>步骤 3 : 效果</h4>
<p>如图所示，访问如下路径，可以看到当前struts配置了哪些Action可以使用</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/config-browser/actionNames</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4476.png" alt></p>
<h4 id="步骤-4-jar"><a class="header-anchor" href="#步骤-4-jar">¶</a>步骤 4 : jar</h4>
<p>下载右上角的struts2-config-browser-plugin-2.2.3.1.jar，并复制到WEB-INF/lib目录下</p>
<h4 id="步骤-5-访问页面"><a class="header-anchor" href="#步骤-5-访问页面">¶</a>步骤 5 : 访问页面</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/config-browser/actionNames</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4478.png" alt></p>
<h3 id="2、使用S-DEBUG进行调试"><a class="header-anchor" href="#2、使用S-DEBUG进行调试">¶</a>2、使用S:DEBUG进行调试</h3>
<p>有的时候<strong>jsp上不显示action传递过来的数据</strong>，有可能的原因是action并<strong>没有传递</strong>任何数据</p>
<p>这个时候我们就需要工具来查看action到底有没有传递数据</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v42"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v42">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v42"><a class="header-anchor" href="#步骤-2-模仿和排错-v42">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v16"><a class="header-anchor" href="#步骤-3-效果-v16">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>如图，可以看到ProductAction传递过来的product,selectedProducts,products等数据</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1852.png" alt></p>
<h4 id="步骤-4-list-jsp"><a class="header-anchor" href="#步骤-4-list-jsp">¶</a>步骤 4 : list.jsp</h4>
<p>修改办法很简单，直接增加s:debug</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;table&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line"> </span><br><span class="line">&lt;s:iterator value=<span class="string">"products"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/s:iterator&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/table&gt;</span><br><span class="line"> </span><br><span class="line">&lt;s:debug/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试-v3"><a class="header-anchor" href="#步骤-5-测试-v3">¶</a>步骤 5 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>点击[Debug] 即可</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/175.png" alt></p>
<h3 id="3、使用使用通配符匹配"><a class="header-anchor" href="#3、使用使用通配符匹配">¶</a>3、使用使用通配符匹配</h3>
<p>学习到目前为止，<strong>add</strong>，<strong>show</strong>, <strong>list</strong>分别需要进行配置<br>
通过<strong>通配符匹配</strong>可以把这3个配置整合在一个配置中实现</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v43"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v43">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
访问如下地址,可以看到通配符方式也是可以得到一样的结果的</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5431.png" alt></p>
<h4 id="步骤-2-模仿和排错-v43"><a class="header-anchor" href="#步骤-2-模仿和排错-v43">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-struts-xml"><a class="header-anchor" href="#步骤-3-struts-xml">¶</a>步骤 3 : struts.xml</h4>
<p>*Product 表示所有以Product结尾的路径，都会匹配在这个Action上<br>
method={1}表示第一个通配符<br>
如果访问的是addProduct就会调用add方法<br>
如果访问的是listProduct就会调用list方法<br>
以此类推</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"*Product"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"&#123;1&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span>list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-测试"><a class="header-anchor" href="#步骤-4-测试">¶</a>步骤 4 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1854.png" alt></p>
<h3 id="4、如何使用拦截器的例子"><a class="header-anchor" href="#4、如何使用拦截器的例子">¶</a>4、如何使用拦截器的例子</h3>
<p>拦截器可以简单地看成是Struts中的&quot;<a href="https://how2j.cn/k/filter/filter-tutorial/588.html" target="_blank" rel="noopener">filter</a>&quot;<br>
拦截器可以拦截指定的Action，并且对Action进行相应的操作<br>
在本例里，拦截了ProductAction，并且注入了当前时间</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v44"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v44">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v44"><a class="header-anchor" href="#步骤-2-模仿和排错-v44">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v17"><a class="header-anchor" href="#步骤-3-效果-v17">¶</a>步骤 3 : 效果</h4>
<p>在本例中，通过拦截器 ProductAction 被注入了Date，所以可以在页面上看到当前时间.<br>
访问如下测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1855.png" alt></p>
<h4 id="步骤-4-ProductAction-java-v2"><a class="header-anchor" href="#步骤-4-ProductAction-java-v2">¶</a>步骤 4 : ProductAction.java</h4>
<p>准备一个Date属性，用于被<strong>拦截器注入时间</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getDate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> date;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDate</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.date = date;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> List&lt;Category&gt; categories =<span class="keyword">new</span> ArrayList();</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">getCategories</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categories;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategories</span><span class="params">(List&lt;Category&gt; categories)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.categories = categories;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Category category1 =<span class="keyword">new</span> Category();</span><br><span class="line">        category1.setId(<span class="number">1</span>);</span><br><span class="line">        category1.setName(<span class="string">"category1"</span>);</span><br><span class="line">         </span><br><span class="line">        Category category2 =<span class="keyword">new</span> Category();</span><br><span class="line">        category2.setId(<span class="number">2</span>);</span><br><span class="line">        category2.setName(<span class="string">"category2"</span>);</span><br><span class="line">         </span><br><span class="line">        categories.add(category1);</span><br><span class="line">        categories.add(category2);</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; products1=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setId(<span class="number">1</span>);</span><br><span class="line">        p1.setName(<span class="string">"product1"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setId(<span class="number">2</span>);</span><br><span class="line">        p2.setName(<span class="string">"product2"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setId(<span class="number">3</span>);</span><br><span class="line">        p3.setName(<span class="string">"product3"</span>);</span><br><span class="line">  </span><br><span class="line">        products1.add(p1);</span><br><span class="line">        products1.add(p2);</span><br><span class="line">        products1.add(p3);</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; products2=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        Product p4 = <span class="keyword">new</span> Product();</span><br><span class="line">        p4.setId(<span class="number">4</span>);</span><br><span class="line">        p4.setName(<span class="string">"product4"</span>);</span><br><span class="line">        Product p5 = <span class="keyword">new</span> Product();</span><br><span class="line">        p5.setId(<span class="number">5</span>);</span><br><span class="line">        p5.setName(<span class="string">"product5"</span>);</span><br><span class="line">        Product p6 = <span class="keyword">new</span> Product();</span><br><span class="line">        p6.setId(<span class="number">6</span>);</span><br><span class="line">        p6.setName(<span class="string">"product6"</span>);</span><br><span class="line">         </span><br><span class="line">        products2.add(p4);</span><br><span class="line">        products2.add(p5);</span><br><span class="line">        products2.add(p6);</span><br><span class="line">         </span><br><span class="line">        category1.setProducts(products1);</span><br><span class="line">        category2.setProducts(products2);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-list-jsp-v2"><a class="header-anchor" href="#步骤-5-list-jsp-v2">¶</a>步骤 5 : list.jsp</h4>
<p>用于显示时间<br>
当然现在是显示不出来的，因为还没有拦截器对ProductAction进行时间注入</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">$&#123;date&#125;</span><br><span class="line"> </span><br><span class="line">&lt;table border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;products&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;s:iterator value=<span class="string">"categories"</span> <span class="keyword">var</span>=<span class="string">"c"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;</span><br><span class="line">                &lt;s:iterator value=<span class="string">"#c.products"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">                    $&#123;p.name&#125;&lt;br/&gt;</span><br><span class="line">                &lt;/s:iterator&gt;        </span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/s:iterator&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/table&gt;</span><br><span class="line"> </span><br><span class="line">&lt;s:debug/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-创建拦截器"><a class="header-anchor" href="#步骤-6-创建拦截器">¶</a>步骤 6 : 创建拦截器</h4>
<p>把拦截到的Action强制转换成 ProductAction，并设置当前时间（注入）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.interceptor;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.action.ProductAction;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionInvocation;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.interceptor.AbstractInterceptor;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateInterceptor</span> <span class="keyword">extends</span> <span class="title">AbstractInterceptor</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">intercept</span><span class="params">(ActionInvocation invocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       ProductAction action = (ProductAction)invocation.getAction();</span><br><span class="line">       action.setDate(<span class="keyword">new</span> Date());</span><br><span class="line">       <span class="keyword">return</span> invocation.invoke();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-配置struts-xml"><a class="header-anchor" href="#步骤-7-配置struts-xml">¶</a>步骤 7 : 配置struts.xml</h4>
<p>10-12 声明dateInterceptor<br>
16 对ProductAction使用拦截器dateInterceptor<br>
17 一旦使用了自定义的拦截器，本来配置在action上的默认的拦截器就失效了。 所以需要再加上defaultStack</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">interceptors</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">interceptor</span> <span class="attr">name</span>=<span class="string">"dateInterceptor"</span> <span class="attr">class</span>=<span class="string">"com.how2java.interceptor.DateInterceptor"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">interceptors</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"*Product*"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"&#123;1&#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"dateInterceptor"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">interceptor-ref</span> <span class="attr">name</span>=<span class="string">"defaultStack"</span> /&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span>list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试-v2"><a class="header-anchor" href="#步骤-8-测试-v2">¶</a>步骤 8 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>即可看到被注入的当前时间</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/184.png" alt></p>
<h3 id="5、客户端跳转"><a class="header-anchor" href="#5、客户端跳转">¶</a>5、客户端跳转</h3>
<p>Struts 默认跳转方法是服务端跳转<br>
本例演示如何进行客户端跳转</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v45"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v45">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v45"><a class="header-anchor" href="#步骤-2-模仿和排错-v45">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v18"><a class="header-anchor" href="#步骤-3-效果-v18">¶</a>步骤 3 : 效果</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addPageProduct</span></span><br></pre></td></tr></table></figure>
<p>通过[firefox的调试工具]可以看到，访问页面addPageProduct, [302]客户端跳转到了addProduct.jsp</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1856.png" alt></p>
<h4 id="步骤-4-ProductAction-java-v3"><a class="header-anchor" href="#步骤-4-ProductAction-java-v3">¶</a>步骤 4 : ProductAction.java</h4>
<p>新增addPage方法，返回“addPage&quot;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> List&lt;Product&gt; products;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; selectedProducts;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getSelectedProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> selectedProducts;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSelectedProducts</span><span class="params">(List&lt;Integer&gt; selectedProducts)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.selectedProducts = selectedProducts;</span><br><span class="line">    &#125;   </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        products=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        selectedProducts = <span class="keyword">new</span> ArrayList();</span><br><span class="line">  </span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setId(<span class="number">1</span>);</span><br><span class="line">        p1.setName(<span class="string">"product1"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setId(<span class="number">2</span>);</span><br><span class="line">        p2.setName(<span class="string">"product2"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setId(<span class="number">3</span>);</span><br><span class="line">   </span><br><span class="line">        p3.setName(<span class="string">"product3"</span>);</span><br><span class="line">  </span><br><span class="line">        products.add(p1);</span><br><span class="line">        products.add(p2);</span><br><span class="line">        products.add(p3);</span><br><span class="line">         </span><br><span class="line">        selectedProducts.add(<span class="number">2</span>);</span><br><span class="line">        selectedProducts.add(<span class="number">3</span>);</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addPage</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"addPage"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-struts-xml-v3"><a class="header-anchor" href="#步骤-5-struts-xml-v3">¶</a>步骤 5 : struts.xml</h4>
<p>配置客户端跳转<br>
在result标签里加上新的属性： type=“redirect”</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addPageProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"addPage"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"addPage"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>addProduct.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"listProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span>list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v4"><a class="header-anchor" href="#步骤-6-测试-v4">¶</a>步骤 6 : 测试</h4>
<p>重启tomcat，访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addPageProduct</span></span><br></pre></td></tr></table></figure>
<h3 id="6、如何进行客户端跳转传参"><a class="header-anchor" href="#6、如何进行客户端跳转传参">¶</a>6、如何进行客户端跳转传参</h3>
<p>客户端跳转传参</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v46"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v46">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v46"><a class="header-anchor" href="#步骤-2-模仿和排错-v46">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v19"><a class="header-anchor" href="#步骤-3-效果-v19">¶</a>步骤 3 : 效果</h4>
<p>如图访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">127.0.0.1:8080/struts/addPageProduct</span></span><br></pre></td></tr></table></figure>
<p>看到的是客户端跳转，并且传递了参数过去</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1857.png" alt></p>
<h4 id="步骤-4-ProductAction-java-v4"><a class="header-anchor" href="#步骤-4-ProductAction-java-v4">¶</a>步骤 4 : ProductAction.java</h4>
<ol>
<li>准备name属性</li>
<li>在addPage()中设置name的值</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Product&gt; products;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; selectedProducts;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getSelectedProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> selectedProducts;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSelectedProducts</span><span class="params">(List&lt;Integer&gt; selectedProducts)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.selectedProducts = selectedProducts;</span><br><span class="line">    &#125;   </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">        products=<span class="keyword">new</span> ArrayList();</span><br><span class="line">        selectedProducts = <span class="keyword">new</span> ArrayList();</span><br><span class="line">  </span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setId(<span class="number">1</span>);</span><br><span class="line">        p1.setName(<span class="string">"product1"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setId(<span class="number">2</span>);</span><br><span class="line">        p2.setName(<span class="string">"product2"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setId(<span class="number">3</span>);</span><br><span class="line">   </span><br><span class="line">        p3.setName(<span class="string">"product3"</span>);</span><br><span class="line">  </span><br><span class="line">        products.add(p1);</span><br><span class="line">        products.add(p2);</span><br><span class="line">        products.add(p3);</span><br><span class="line">         </span><br><span class="line">        selectedProducts.add(<span class="number">2</span>);</span><br><span class="line">        selectedProducts.add(<span class="number">3</span>);</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addPage</span><span class="params">()</span></span>&#123;</span><br><span class="line">        name = <span class="string">"default name"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"addPage"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-struts-xml-v4"><a class="header-anchor" href="#步骤-5-struts-xml-v4">¶</a>步骤 5 : struts.xml</h4>
<p>设置参数传递<br>
增加?name=${name}</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addPageProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"addPage"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"addPage"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>addProduct.jsp?name=$&#123;name&#125;<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"listProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span>list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-addProduct-jsp"><a class="header-anchor" href="#步骤-6-addProduct-jsp">¶</a>步骤 6 : addProduct.jsp</h4>
<p>获取参数：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;form action=<span class="string">"addProduct"</span>&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;input type=<span class="string">"text"</span> name=<span class="string">"product.name"</span> value=<span class="string">"$&#123;param.name&#125;"</span>&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line"> &lt;input type=<span class="string">"submit"</span> value=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试-v6"><a class="header-anchor" href="#步骤-7-测试-v6">¶</a>步骤 7 : 测试</h4>
<p>访问网页</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">127.0.0.1:8080/struts/addPageProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1840.png" alt></p>
<h3 id="7、表单验证"><a class="header-anchor" href="#7、表单验证">¶</a>7、表单验证</h3>
<p>虽然struts的表单验证，挺傻的，但是我们还是讲一讲</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v47"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v47">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v47"><a class="header-anchor" href="#步骤-2-模仿和排错-v47">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v20"><a class="header-anchor" href="#步骤-3-效果-v20">¶</a>步骤 3 : 效果</h4>
<p>访问测试页面：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>如果提交产品名称为空，就会提示 <strong>name can’t be empty</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1858.png" alt></p>
<h4 id="步骤-4-在ProductAction中增加validate-方法"><a class="header-anchor" href="#步骤-4-在ProductAction中增加validate-方法">¶</a>步骤 4 : 在ProductAction中增加validate()方法</h4>
<p>在这个例子里，如果输入的name是空的，就会提示name can’t be empty<br>
注意： ProductAction类要继承 ActionSupport</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ( product.getName().length() == <span class="number">0</span> )&#123;</span><br><span class="line">            addFieldError( <span class="string">"product.name"</span>, <span class="string">"name can't be empty"</span> );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-增加一个input-的result"><a class="header-anchor" href="#步骤-5-增加一个input-的result">¶</a>步骤 5 : 增加一个input 的result</h4>
<p>这个配置的作用是如果validate校验没有通过，那么需要通过Input跳转到输入界面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"input"</span>&gt;</span>addProduct.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-错误提示信息显示成红色"><a class="header-anchor" href="#步骤-6-错误提示信息显示成红色">¶</a>步骤 6 : 错误提示信息显示成红色</h4>
<p>为了让错误提示信息显示成红色，增加struts的head标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">taglib</span> <span class="attr">prefix</span>=<span class="string">"s"</span> <span class="attr">uri</span>=<span class="string">"/struts-tags"</span> %&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">s:head</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">s:form</span> <span class="attr">action</span>=<span class="string">"addProduct"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"product.name"</span> <span class="attr">label</span>=<span class="string">"product name"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">s:submit</span> <span class="attr">value</span>=<span class="string">"Submit"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">s:form</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试-v7"><a class="header-anchor" href="#步骤-7-测试-v7">¶</a>步骤 7 : 测试</h4>
<p>重启tomcat，访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>并且不输入信息提交</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/152.png" alt></p>
<h3 id="8、XML-表单验证"><a class="header-anchor" href="#8、XML-表单验证">¶</a>8、XML 表单验证</h3>
<p>和使用[valiation]方法进行表单验证一样，这个也挺傻得，但是我们还是讲一讲<br>
使用xml进行表单验证，使得表单验证和业务代码完全分离开了</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v48"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v48">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v48"><a class="header-anchor" href="#步骤-2-模仿和排错-v48">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v21"><a class="header-anchor" href="#步骤-3-效果-v21">¶</a>步骤 3 : 效果</h4>
<p>访问测试页面：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>和[表单验证]的效果一样，不输入产品名称就提交数据，会提示错误。</p>
<p>只是这一次使用xml的方式来进行校验</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1859.png" alt></p>
<h4 id="步骤-4-把ProductAction中的validate-方法去掉"><a class="header-anchor" href="#步骤-4-把ProductAction中的validate-方法去掉">¶</a>步骤 4 : 把ProductAction中的validate()方法去掉</h4>
<p>因为本例讲解如何用xml来进行校验，所以把validate()去掉，免得混淆</p>
<h4 id="步骤-5-新建文件ProductAction-validation-xml"><a class="header-anchor" href="#步骤-5-新建文件ProductAction-validation-xml">¶</a>步骤 5 : 新建文件ProductAction-validation.xml</h4>
<p>文件一定要放在和ProductAction相同的包下面<br>
文件命名必须是{actionname}-validation.xml</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/154.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">validators</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"-//OpenSymphony Group//XWork Validator 1.0.2//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.opensymphony.com/xwork/xwork-validator-1.0.2.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">validators</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">validator</span> <span class="attr">type</span>=<span class="string">"requiredstring"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"fieldname"</span>&gt;</span>product.name<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">message</span>&gt;</span>name is required.<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">validator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">validators</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v5"><a class="header-anchor" href="#步骤-6-测试-v5">¶</a>步骤 6 : 测试</h4>
<p>重启tomcat，访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>并且不输入信息提交</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/155.png" alt></p>
<h3 id="9、ACTION是多实例的"><a class="header-anchor" href="#9、ACTION是多实例的">¶</a>9、ACTION是多实例的</h3>
<p>在默认设置下，Action是多实例的，每次访问都会创建新的Action实例</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v49"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v49">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v49"><a class="header-anchor" href="#步骤-2-模仿和排错-v49">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v22"><a class="header-anchor" href="#步骤-3-效果-v22">¶</a>步骤 3 : 效果</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>多次访问可以看到对应的ProductAction是不同的实例</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1860.png" alt></p>
<h4 id="步骤-4-修改ProductAction"><a class="header-anchor" href="#步骤-4-修改ProductAction">¶</a>步骤 4 : 修改ProductAction</h4>
<p>在ProductAction的构造方法里打印this</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProductAction</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"product action instance: "</span> + <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Product&gt; products;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">        products=<span class="keyword">new</span> ArrayList();</span><br><span class="line">   </span><br><span class="line">        Product p1 = <span class="keyword">new</span> Product();</span><br><span class="line">        p1.setId(<span class="number">1</span>);</span><br><span class="line">        p1.setName(<span class="string">"product1"</span>);</span><br><span class="line">        Product p2 = <span class="keyword">new</span> Product();</span><br><span class="line">        p2.setId(<span class="number">2</span>);</span><br><span class="line">        p2.setName(<span class="string">"product2"</span>);</span><br><span class="line">        Product p3 = <span class="keyword">new</span> Product();</span><br><span class="line">        p3.setId(<span class="number">3</span>);</span><br><span class="line">        p3.setName(<span class="string">"product3"</span>);</span><br><span class="line">   </span><br><span class="line">        products.add(p1);</span><br><span class="line">        products.add(p2);</span><br><span class="line">        products.add(p3);</span><br><span class="line">   </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试-v4"><a class="header-anchor" href="#步骤-5-测试-v4">¶</a>步骤 5 : 测试</h4>
<p>重启tomcat，访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/listProduct</span></span><br></pre></td></tr></table></figure>
<p>多访问几次，可以看到是不同的Action实例</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1862.png" alt></p>
<h3 id="10、使用注解方式进行配置实例"><a class="header-anchor" href="#10、使用注解方式进行配置实例">¶</a>10、使用注解方式进行配置实例</h3>
<p>以上的教程都是基于XML进行配置的，除此之外，Struts还能够基于[注解]进行配置</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v50"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v50">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>访问页面：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/showProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5436.png" alt></p>
<h4 id="步骤-2-模仿和排错-v50"><a class="header-anchor" href="#步骤-2-模仿和排错-v50">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前面的教程"><a class="header-anchor" href="#步骤-3-基于前面的教程">¶</a>步骤 3 : 基于前面的教程</h4>
<p>这个知识，基于[显示数据到JSP] 这个知识点，把其由xml配置方式，改造为注解方式</p>
<h4 id="步骤-4-jar-v2"><a class="header-anchor" href="#步骤-4-jar-v2">¶</a>步骤 4 : jar</h4>
<ol>
<li>
<p>为了使struts支持注解，需要用到struts2-convention-plugin-x.x.x.jar 这个jar包，在前面的教程中是没有使用的，所以这里需要从右侧下载</p>
</li>
<li>
<p>下载好了之后，放在WEB-INF/lib 下</p>
</li>
<li>
<p>不仅如此，还要在项目导入jar，以使得eclipse能够编译通过</p>
</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4053.png" alt></p>
<h4 id="步骤-5-注释掉struts-xml"><a class="header-anchor" href="#步骤-5-注释掉struts-xml">¶</a>步骤 5 : 注释掉struts.xml</h4>
<p>接着就把struts.xml中的配置信息注释掉，以确保最后生效的是注解方式</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">&lt;!--   &lt;action name="showProduct" class="com.how2java.action.ProductAction" method="show"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;result name="show"&gt;show.jsp&lt;/result&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--   &lt;/action&gt;     --&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-添加注解"><a class="header-anchor" href="#步骤-6-添加注解">¶</a>步骤 6 : 添加注解</h4>
<p>然后就是在ProductAction类上面添加注解</p>
<ol>
<li>在类前面添加3个注解</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Namespace</span>(<span class="string">"/"</span>)</span><br></pre></td></tr></table></figure>
<p>表示访问路径，如果是@Namespace(&quot;/test&quot;)，那么访问的时候，就需要写成http://127.0.0.1:8080/struts/test/showProduct</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ParentPackage</span>(<span class="string">"struts-default"</span>)</span><br></pre></td></tr></table></figure>
<p>与配置文件中的struts-default相同，表示使用默认的一套拦截器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(name=<span class="string">"show"</span>, location=<span class="string">"/show.jsp"</span>),</span><br><span class="line">        <span class="meta">@Result</span>(name=<span class="string">"home"</span>, location=<span class="string">"/index.jsp"</span>)&#125;)</span><br></pre></td></tr></table></figure>
<p>预先定义多个results, “show” 返回&quot;/show.jsp&quot; , “home” 返回 “/index.jsp”.<br>
<strong>注：</strong> 这里并没有用到&quot;home&quot;,写出来的目的是为了演示这种定义多个result 的代码风格。</p>
<ol start="2">
<li>在show方法前加上注解：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Action</span>(<span class="string">"showProduct"</span>)</span><br></pre></td></tr></table></figure>
<p>表示当访问路径是showProduct的时候，就会调用show方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Action;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Namespace;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.ParentPackage;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Results;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.bean.Product;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Namespace</span>(<span class="string">"/"</span>)</span><br><span class="line"><span class="meta">@ParentPackage</span>(<span class="string">"struts-default"</span>)</span><br><span class="line"><span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(name=<span class="string">"show"</span>, location=<span class="string">"/show.jsp"</span>),</span><br><span class="line">        <span class="meta">@Result</span>(name=<span class="string">"home"</span>, location=<span class="string">"/index.jsp"</span>)&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">    <span class="meta">@Action</span>(<span class="string">"showProduct"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product = <span class="keyword">new</span> Product();</span><br><span class="line">        product.setName(<span class="string">"iphone7"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-运行测试"><a class="header-anchor" href="#步骤-7-运行测试">¶</a>步骤 7 : 运行测试</h4>
<p>与[显示数据到JSP]一样，访问如下路径就可以看到一样的结果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts/showProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4056.png" alt></p>
<h4 id="步骤-8-其他常用注解"><a class="header-anchor" href="#步骤-8-其他常用注解">¶</a>步骤 8 : 其他常用注解</h4>
<p>Namespace：指定命名空间。<br>
ParentPackage：指定父包。</p>
<p>Result：提供了Action结果的映射。（一个结果的映射）<br>
Results：“Result”注解列表<br>
ResultPath：指定结果页面的基路径。</p>
<p>Action：指定Action的访问URL。<br>
Actions：“Action”注解列表。</p>
<p>ExceptionMapping：指定异常映射。（映射一个声明异常）<br>
ExceptionMappings：一级声明异常的数组。</p>
<p>InterceptorRef：拦截器引用。<br>
InterceptorRefs：拦截器引用组。</p>
<p>一般说来，不是所有的注解都会用到，真正用到哪个的时候再来查一下就知道怎么回事了。</p>
<h4 id="步骤-9-总结"><a class="header-anchor" href="#步骤-9-总结">¶</a>步骤 9 : 总结</h4>
<p>可以看出来，注解方式，就是把本来做在struts.xml里的事情，搬到了Action类里面来做。<br>
那么到底应该用注解还是配置呢？从个人经验来讲，小项目适合用注解，大项目因为其复杂性，采用注解会导致配置信息难以维护和查询，更适合采用xml配置方式。</p>
<p>关于注解是如何生效的，请查看[自定义注解]相关知识。</p>
<h1 id="叁、SPRING"><a class="header-anchor" href="#叁、SPRING">¶</a>叁、SPRING</h1>
<h2 id="一、教程"><a class="header-anchor" href="#一、教程">¶</a>一、教程</h2>
<h3 id="1、IOC-DI"><a class="header-anchor" href="#1、IOC-DI">¶</a>1、IOC/DI</h3>
<p>Spring是一个基于IOC和AOP的结构J2EE系统的框架<br>
IOC 反转控制 是Spring的基础，Inversion Of Control<br>
简单说就是创建对象由以前的程序员自己new 构造方法来调用，变成了交由Spring创建对象<br>
DI 依赖注入 Dependency Inject. 简单地说就是拿到的对象的属性，已经被注入好相关值了，直接使用即可。</p>
<p><strong>必读：</strong> 基于框架的程序要成功运行，对于JAR包的版本，配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致框架程序运行失败。 如果你是第一次学习本框架，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v51"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v51">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v51"><a class="header-anchor" href="#步骤-2-模仿和排错-v51">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-本知识点目的"><a class="header-anchor" href="#步骤-3-本知识点目的">¶</a>步骤 3 : 本知识点目的</h4>
<p>本知识点通过运行TestSpring演示如何用Spring获取一个对象，并打印其name</p>
<h4 id="步骤-4-新建项目"><a class="header-anchor" href="#步骤-4-新建项目">¶</a>步骤 4 : 新建项目</h4>
<p>在e:\project\spring目录下新建spring项目 (java project类型)</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4562.png" alt></p>
<h4 id="步骤-5-下载包"><a class="header-anchor" href="#步骤-5-下载包">¶</a>步骤 5 : 下载包</h4>
<p>下载右上角的lib.rar，并解压到 e:/project/spring/lib 目录下</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4563.png" alt></p>
<h4 id="步骤-6-导入包"><a class="header-anchor" href="#步骤-6-导入包">¶</a>步骤 6 : 导入包</h4>
<p>把jar包导入到项目中，导包办法：右键 project-&gt;properties-&gt;java build path-&gt;libaries-&gt;add external jars</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4564.png" alt></p>
<h4 id="步骤-7-pojo"><a class="header-anchor" href="#步骤-7-pojo">¶</a>步骤 7 : pojo</h4>
<p>准备pojo Category，用来演示IOC和DI</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-applicationContext-xml"><a class="header-anchor" href="#步骤-8-applicationContext-xml">¶</a>步骤 8 : applicationContext.xml</h4>
<p>在src目录下新建applicationContext.xml文件<br>
applicationContext.xml是Spring的核心配置文件，通过关键字c即可获取Category对象，该对象获取的时候，即被注入了字符串&quot;category 1“到name属性中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"category 1"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-TestSpring"><a class="header-anchor" href="#步骤-9-TestSpring">¶</a>步骤 9 : TestSpring</h4>
<p>测试代码，演示通过spring获取Category对象，以及该对象被注入的name属性。<br>
如图所示，可以打印出通过Spring拿到的Category对象的name属性</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/214.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line"> </span><br><span class="line">        Category c = (Category) context.getBean(<span class="string">"c"</span>);</span><br><span class="line">         </span><br><span class="line">        System.out.println(c.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-原理图"><a class="header-anchor" href="#步骤-10-原理图">¶</a>步骤 10 : 原理图</h4>
<p>以获取对象的方式来进行比较</p>
<p><strong>传统的方式：</strong><br>
通过new 关键字主动创建一个对象<br>
<strong>IOC方式</strong><br>
对象的生命周期由Spring来管理，直接从Spring那里去获取一个对象。 IOC是<strong>反转控制</strong> (Inversion Of Control)的缩写，就像控制权从本来在自己手里，交给了Spring。</p>
<p>打个比喻：<br>
**传统方式：**相当于你自己去菜市场new 了一只鸡，不过是生鸡，要自己拔毛，去内脏，再上花椒，酱油，烤制，经过各种工序之后，才可以食用。<br>
**用 IOC：**相当于去馆子(Spring)点了一只鸡，交到你手上的时候，已经五味俱全，你就只管吃就行了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1876.png" alt></p>
<h4 id="步骤-11-练习-v2"><a class="header-anchor" href="#步骤-11-练习-v2">¶</a>步骤 11 : 练习</h4>
<p>使用IOC的方式，获取一个Product对象</p>
<h3 id="2、注入对象"><a class="header-anchor" href="#2、注入对象">¶</a>2、注入对象</h3>
<p>在上例中，对Category的name属性注入了&quot;category 1&quot;字符串<br>
在本例中 ，对Product对象，注入一个Category对象</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v52"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v52">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v52"><a class="header-anchor" href="#步骤-2-模仿和排错-v52">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-Product-java"><a class="header-anchor" href="#步骤-3-Product-java">¶</a>步骤 3 : Product.java</h4>
<p>Product类中有对Category对象的setter getter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Category category;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-applicationContext-xml"><a class="header-anchor" href="#步骤-4-applicationContext-xml">¶</a>步骤 4 : applicationContext.xml</h4>
<p>在创建Product的时候注入一个Category对象<br>
注意，这里要使用ref来注入另一个对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"category 1"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"p"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"product1"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"category"</span> <span class="attr">ref</span>=<span class="string">"c"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-TestSpring"><a class="header-anchor" href="#步骤-5-TestSpring">¶</a>步骤 5 : TestSpring</h4>
<p>通过Spring拿到的Product对象已经被注入了Category对象了</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/217.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line"> </span><br><span class="line">        Product p = (Product) context.getBean(<span class="string">"p"</span>);</span><br><span class="line"> </span><br><span class="line">        System.out.println(p.getName());</span><br><span class="line">        System.out.println(p.getCategory().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、注解方式-IOC-DI"><a class="header-anchor" href="#3、注解方式-IOC-DI">¶</a>3、注解方式 IOC/DI</h3>
<p>在本知识点中，将演示如何使用注解的方式完成[注入对象]中的效果</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v53"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v53">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v53"><a class="header-anchor" href="#步骤-2-模仿和排错-v53">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-修改applicationContext-xml"><a class="header-anchor" href="#步骤-3-修改applicationContext-xml">¶</a>步骤 3 : 修改applicationContext.xml</h4>
<ol>
<li>在15行添加</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>表示告诉Spring要用注解的方式进行配置</p>
<ol start="2">
<li>注入对象的21行注释掉，这个行为在后面将使用注解来完成</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"category 1"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"p"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Product"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"product1"</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;property name="category" ref="c" /&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-Autowired"><a class="header-anchor" href="#步骤-4-Autowired">¶</a>步骤 4 : @Autowired</h4>
<p>在Product.java的category属性前加上@Autowired注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> Category category;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Category category;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-运行测试"><a class="header-anchor" href="#步骤-5-运行测试">¶</a>步骤 5 : 运行测试</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4077.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        Product p = (Product) context.getBean(<span class="string">"p"</span>);</span><br><span class="line">        System.out.println(p.getName());</span><br><span class="line">        System.out.println(p.getCategory().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-Autowired的位置"><a class="header-anchor" href="#步骤-6-Autowired的位置">¶</a>步骤 6 : @Autowired的位置</h4>
<p>除了前面的 [在属性前加上@Autowired] 这种方式外，也可以在setCategory方法前加上@Autowired，这样来达到相同的效果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span></span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4078.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> Category category;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-Resource"><a class="header-anchor" href="#步骤-7-Resource">¶</a>步骤 7 : @Resource</h4>
<p>除了@Autowired之外，@Resource也是常用的手段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span>(name=<span class="string">"c"</span>)</span><br><span class="line"><span class="keyword">private</span> Category category;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4079.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Resource</span>(name=<span class="string">"c"</span>)</span><br><span class="line">    <span class="keyword">private</span> Category category;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-对Bean的注解"><a class="header-anchor" href="#步骤-8-对Bean的注解">¶</a>步骤 8 : 对Bean的注解</h4>
<p>上述例子是对<strong>注入对象行为</strong>的注解，那么bean对象本身，比如Category,Product可不可以移出applicationContext.xml配置文件，也通过注解进行呢？<br>
接下来就讲解如何对Bean进行注解配置</p>
<h4 id="步骤-9-applicationContext-xml"><a class="header-anchor" href="#步骤-9-applicationContext-xml">¶</a>步骤 9 : applicationContext.xml</h4>
<p>修改applicationContext.xml，什么都去掉，只新增：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>其作用是告诉Spring，bean都放在com.how2java.pojo这个包下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-Component"><a class="header-anchor" href="#步骤-10-Component">¶</a>步骤 10 : @Component</h4>
<p>为Product类加上@Component注解，即表明此类是bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"p"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br></pre></td></tr></table></figure>
<p>为Category 类加上@Component注解，即表明此类是bean</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(<span class="string">"c"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br></pre></td></tr></table></figure>
<p>另外，因为配置从applicationContext.xml中移出来了，所以属性初始化放在属性声明上进行了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String name=<span class="string">"product 1"</span>;</span><br><span class="line"><span class="keyword">private</span> String name=<span class="string">"category 1"</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Component</span>(<span class="string">"p"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name=<span class="string">"product 1"</span>;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Category category;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Component</span>(<span class="string">"c"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name=<span class="string">"category 1"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-运行测试"><a class="header-anchor" href="#步骤-11-运行测试">¶</a>步骤 11 : 运行测试</h4>
<p>运行TestSpring，可以发现运行结果是一样的</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4083.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        Product p = (Product) context.getBean(<span class="string">"p"</span>);</span><br><span class="line">        System.out.println(p.getName());</span><br><span class="line">        System.out.println(p.getCategory().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、AOP-面向切面编程"><a class="header-anchor" href="#4、AOP-面向切面编程">¶</a>4、AOP 面向切面编程</h3>
<p>AOP 即 Aspect Oriented Program 面向切面编程<br>
首先，在面向切面编程的思想里面，把功能分为<strong>核心业务功能</strong>，和<strong>周边功能</strong>。<br>
所谓的核心业务，比如登陆，增加数据，删除数据都叫核心业务<br>
所谓的周边功能，比如性能统计，日志，事务管理等等</p>
<p>周边功能在Spring的面向切面编程AOP思想里，即被定义为<strong>切面</strong></p>
<p>在面向切面编程AOP的思想里面，核心业务功能和切面功能分别<strong>独立进行开发</strong><br>
然后把切面功能和核心业务功能 <strong>“编织”</strong> 在一起，这就叫AOP</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v54"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v54">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v54"><a class="header-anchor" href="#步骤-2-模仿和排错-v54">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-jar包-v2"><a class="header-anchor" href="#步骤-3-jar包-v2">¶</a>步骤 3 : jar包</h4>
<p>为了支持AOP，需要用到一些额外的JAR包。 这些额外的JAR包放在右上角的可运行项目，解压出来的lib目录下。<br>
至于多了哪些，记不太清楚了。。。。 都导入吧。。。。</p>
<h4 id="步骤-4-思路图"><a class="header-anchor" href="#步骤-4-思路图">¶</a>步骤 4 : 思路图</h4>
<ol>
<li>
<p>功能分两大类，辅助功能和核心业务功能</p>
</li>
<li>
<p>辅助功能和核心业务功能<strong>彼此独立</strong>进行开发</p>
</li>
<li>
<p>比如登陆功能，即便是没有性能统计和日志输出，也可以正常运行</p>
</li>
<li>
<p>如果有需要，就把&quot;日志输出&quot; 功能和 “登陆” 功能 <strong>编织</strong>在一起，这样登陆的时候，就可以看到日志输出了</p>
</li>
<li>
<p>辅助功能，又叫做<strong>切面</strong>，这种能够<strong>选择性的，低耦合的</strong>把切面和核心业务功能结合在一起的编程思想，就叫做切面编程</p>
</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1878.png" alt></p>
<h4 id="步骤-5-准备业务类-ProductService"><a class="header-anchor" href="#步骤-5-准备业务类-ProductService">¶</a>步骤 5 : 准备业务类 ProductService</h4>
<p>ProductService</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomeService</span><span class="params">()</span></span>&#123;</span><br><span class="line">         </span><br><span class="line">        System.out.println(<span class="string">"doSomeService"</span>);</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-TestSpring"><a class="header-anchor" href="#步骤-6-TestSpring">¶</a>步骤 6 : TestSpring</h4>
<p>在引入切面之前，调用该业务类</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1863.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        ProductService s = (ProductService) context.getBean(<span class="string">"s"</span>);</span><br><span class="line">        s.doSomeService();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-准备日志切面-LoggerAspect"><a class="header-anchor" href="#步骤-7-准备日志切面-LoggerAspect">¶</a>步骤 7 : 准备日志切面 LoggerAspect</h4>
<p>该日志切面的功能是 在调用核心功能之前和之后分别打印日志，切面就是原理图中讲的那些辅助功能。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object object = joinPoint.proceed();</span><br></pre></td></tr></table></figure>
<p>就是将来与某个核心功能编织之后，用于执行核心功能的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggerAspect</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">log</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"start log:"</span> + joinPoint.getSignature().getName());</span><br><span class="line">        Object object = joinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">"end log:"</span> + joinPoint.getSignature().getName());</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-applicationContext-xml-v2"><a class="header-anchor" href="#步骤-8-applicationContext-xml-v2">¶</a>步骤 8 : applicationContext.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"s"</span> <span class="attr">class</span>=<span class="string">"com.how2java.service.ProductService"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>声明业务对象</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"loggerAspect"</span> <span class="attr">class</span>=<span class="string">"com.how2java.aspect.LoggerAspect"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>声明日志切面</p>
<p>结合[思路图]</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"loggerCutpoint"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">expression</span>=</span></span><br><span class="line"><span class="tag">"<span class="attr">execution</span>(* <span class="attr">com.how2java.service.ProductService.</span>*(<span class="attr">..</span>)) "/&gt;</span></span><br></pre></td></tr></table></figure>
<p>指定右边的核心业务功能</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">	<span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">id</span>=<span class="string">"logAspect"</span> <span class="attr">ref</span>=<span class="string">"loggerAspect"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">pointcut-ref</span>=<span class="string">"loggerCutpoint"</span> <span class="attr">method</span>=<span class="string">"log"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>指定左边的辅助功能<br>
然后通过aop:config把业务对象与辅助功能编织在一起。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.how2java.service.ProductService.*(..))</span><br></pre></td></tr></table></figure>
<p>这表示对满足如下条件的方法调用，进行切面操作：<br>
***** 返回任意类型<br>
<strong>com.how2java.service.ProductService.*</strong> 包名以 com.how2java.service.ProductService 开头的类的任意方法<br>
<strong>(…)</strong> 参数是任意数量和类型</p>
<h4 id="步骤-9-TestSpring-v2"><a class="header-anchor" href="#步骤-9-TestSpring-v2">¶</a>步骤 9 : TestSpring</h4>
<p>TestSpring 代码没有发生任何变化，通过配置的方式，把切面和核心业务类编制在了一起。</p>
<p>运行测试，可以发现在编织之后，业务方法运行之前和之后分别会打印日志</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/221.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        ProductService s = (ProductService) context.getBean(<span class="string">"s"</span>);</span><br><span class="line">        s.doSomeService();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-练习-性能统计切面"><a class="header-anchor" href="#步骤-10-练习-性能统计切面">¶</a>步骤 10 : 练习-性能统计切面</h4>
<p>参考上述的日志切面，做一个性能统计切面，并编织在业务方法上面。</p>
<p>**注；**在业务方法方法中，做一些JDBC访问，以增加耗时</p>
<h3 id="5、注解方式-AOP"><a class="header-anchor" href="#5、注解方式-AOP">¶</a>5、注解方式 AOP</h3>
<p>本章节把[XML方式配置AOP] 改造为注解方式</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v55"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v55">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v55"><a class="header-anchor" href="#步骤-2-模仿和排错-v55">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-注解配置业务类"><a class="header-anchor" href="#步骤-3-注解配置业务类">¶</a>步骤 3 : 注解配置业务类</h4>
<p>使用@Component(“s”) 注解ProductService 类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Component</span>(<span class="string">"s"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomeService</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doSomeService"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-注解配置切面"><a class="header-anchor" href="#步骤-4-注解配置切面">¶</a>步骤 4 : 注解配置切面</h4>
<p>@Aspect 注解表示这是一个切面<br>
@Component 表示这是一个bean,由Spring进行管理<br>
@Around(value = “execution(* com.how2java.service.ProductService.*(…))”) 表示对com.how2java.service.ProductService 这个类中的所有方法进行切面操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggerAspect</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Around</span>(value = <span class="string">"execution(* com.how2java.service.ProductService.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">log</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"start log:"</span> + joinPoint.getSignature().getName());</span><br><span class="line">        Object object = joinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">"end log:"</span> + joinPoint.getSignature().getName());</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-applicationContext-xml"><a class="header-anchor" href="#步骤-5-applicationContext-xml">¶</a>步骤 5 : applicationContext.xml</h4>
<p>去掉原有信息，添加如下3行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.aspect"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>扫描包com.how2java.aspect和com.how2java.service，定位业务类和切面类</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>找到被注解了的切面类，进行切面配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.aspect"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span> </span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-运行测试"><a class="header-anchor" href="#步骤-6-运行测试">¶</a>步骤 6 : 运行测试</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4087.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        ProductService s = (ProductService) context.getBean(<span class="string">"s"</span>);</span><br><span class="line">        s.doSomeService();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6、注解方式测试"><a class="header-anchor" href="#6、注解方式测试">¶</a>6、注解方式测试</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v56"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v56">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v56"><a class="header-anchor" href="#步骤-2-模仿和排错-v56">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v23"><a class="header-anchor" href="#步骤-3-效果-v23">¶</a>步骤 3 : 效果</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4487.png" alt></p>
<h4 id="步骤-4-jar-v3"><a class="header-anchor" href="#步骤-4-jar-v3">¶</a>步骤 4 : jar</h4>
<p>注解方式用到了junit,所以需要在右上角下载:<br>
junit-4.12.jar和hamcrest-all-1.3.jar</p>
<h4 id="步骤-5-导入到当前项目中"><a class="header-anchor" href="#步骤-5-导入到当前项目中">¶</a>步骤 5 : 导入到当前项目中</h4>
<p>把jar包导入到项目中，导包办法：右键 project-&gt;properties-&gt;java build path-&gt;libaries-&gt;add external jars</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4491.png" alt></p>
<h4 id="步骤-6-TestSpring-v2"><a class="header-anchor" href="#步骤-6-TestSpring-v2">¶</a>步骤 6 : TestSpring</h4>
<p>修改TestSpring, 并运行</p>
<ol>
<li>
<p>@RunWith(SpringJUnit4ClassRunner.class)<br>
表示这是一个Spring的测试类</p>
</li>
<li>
<p>@ContextConfiguration(“classpath:applicationContext.xml”)<br>
定位Spring的配置文件</p>
</li>
<li>
<p>@Autowired<br>
给这个测试类装配Category对象</p>
</li>
<li>
<p>@Test<br>
测试逻辑，打印c对象的名称</p>
</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4489.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">@ContextConfiguration("classpath:applicationContext.xml")</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    Category c;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(c.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7、SPRING-MVC"><a class="header-anchor" href="#7、SPRING-MVC">¶</a>7、SPRING MVC</h3>
<p>springmvc 的内容很多，请点击进入 [完整的springmvc教材]</p>
<h3 id="8、SPRINGBOOT"><a class="header-anchor" href="#8、SPRINGBOOT">¶</a>8、SPRINGBOOT</h3>
<p>springboot 的内容很多，请点击进入 [SPRINGBOOT 系列教程]</p>
<h1 id="肆、STRUTS-HIBERNATE"><a class="header-anchor" href="#肆、STRUTS-HIBERNATE">¶</a>肆、STRUTS+HIBERNATE</h1>
<h2 id="一、教程-v2"><a class="header-anchor" href="#一、教程-v2">¶</a>一、教程</h2>
<h3 id="1、简介"><a class="header-anchor" href="#1、简介">¶</a>1、简介</h3>
<p>整合struts和hibernate的基本思路是将MVC中M层交给hibernate处理<br>
在eclipse中创建struts_hibernate项目<br>
本项目以Product的增删改查为例，整合Struts+Hibernate</p>
<p>整合步骤分 [hibernate部分]和[struts部分]</p>
<h4 id="步骤-1-思路图"><a class="header-anchor" href="#步骤-1-思路图">¶</a>步骤 1 : 思路图</h4>
<p>基本思路就是把MVC中的Model模型部分使用hibernate来做</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1879.png" alt></p>
<h3 id="2、HIBERANTE-部分"><a class="header-anchor" href="#2、HIBERANTE-部分">¶</a>2、HIBERANTE 部分</h3>
<h4 id="步骤-1-Hibernate准备工作"><a class="header-anchor" href="#步骤-1-Hibernate准备工作">¶</a>步骤 1 : Hibernate准备工作</h4>
<p>这部分准备Hibernate方面的事情</p>
<h4 id="步骤-2-创建数据库how2java"><a class="header-anchor" href="#步骤-2-创建数据库how2java">¶</a>步骤 2 : 创建数据库how2java</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database  how2java</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-pojo"><a class="header-anchor" href="#步骤-3-pojo">¶</a>步骤 3 : pojo</h4>
<p>Product有id,name,price3个字段</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-Product-hbm-xml-v2"><a class="header-anchor" href="#步骤-4-Product-hbm-xml-v2">¶</a>步骤 4 : Product.hbm.xml</h4>
<p>映射Product类对应product_表</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-hibernate-cfg-xml"><a class="header-anchor" href="#步骤-5-hibernate-cfg-xml">¶</a>步骤 5 : hibernate.cfg.xml</h4>
<p>hibernate基本配置，指定数据库，账号，密码，方言等等</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8'?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">       <span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Database connection settings --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/how2java?characterEncoding=GBK<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"connection.password"</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SQL dialect --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.hbm.xml"</span> /&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-dao"><a class="header-anchor" href="#步骤-6-dao">¶</a>步骤 6 : dao</h4>
<p>为ProductDAO准备增，删，修改，查询，获取方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDAO</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Product p)</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; result = <span class="keyword">new</span> ArrayList();</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure()</span><br><span class="line">                .buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        s.save(p);</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        Product result = <span class="keyword">null</span>;</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure()</span><br><span class="line">                .buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line"> </span><br><span class="line">        result = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, <span class="title">id</span>)</span>;</span><br><span class="line"> </span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; result = <span class="keyword">new</span> ArrayList();</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure()</span><br><span class="line">                .buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        Product p = (Product) s.get(Product<span class="class">.<span class="keyword">class</span>, <span class="title">id</span>)</span>;</span><br><span class="line"> </span><br><span class="line">        s.delete(p);</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Product p)</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; result = <span class="keyword">new</span> ArrayList();</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure()</span><br><span class="line">                .buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line">        s.beginTransaction();</span><br><span class="line"> </span><br><span class="line">        s.update(p);</span><br><span class="line"> </span><br><span class="line">        s.getTransaction().commit();</span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">listProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; result = <span class="keyword">new</span> ArrayList();</span><br><span class="line"> </span><br><span class="line">        SessionFactory sf = <span class="keyword">new</span> Configuration().configure()</span><br><span class="line">                .buildSessionFactory();</span><br><span class="line">        Session s = sf.openSession();</span><br><span class="line"> </span><br><span class="line">        Query q = s.createQuery(<span class="string">"from Product p"</span>);</span><br><span class="line"> </span><br><span class="line">        result = q.list();</span><br><span class="line"> </span><br><span class="line">        s.close();</span><br><span class="line">        sf.close();</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、STRUTS-部分"><a class="header-anchor" href="#3、STRUTS-部分">¶</a>3、STRUTS 部分</h3>
<p>struts部分做的工作比较多</p>
<ol>
<li>web.xml</li>
<li>struts.xml</li>
<li>action</li>
<li>jsp</li>
</ol>
<h4 id="步骤-1-先运行，看到效果，再学习-v57"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v57">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts_hibernate/</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5445.png" alt></p>
<h4 id="步骤-2-模仿和排错-v57"><a class="header-anchor" href="#步骤-2-模仿和排错-v57">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-配置web-xml"><a class="header-anchor" href="#步骤-3-配置web-xml">¶</a>步骤 3 : 配置web.xml</h4>
<p>配置struts专用过滤器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">            org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>FORWARD<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-struts-xml"><a class="header-anchor" href="#步骤-4-struts-xml">¶</a>步骤 4 : struts.xml</h4>
<p>分别为增加，删除，获取，修改，查询配置Action<br>
为了便于理解，这里没有使用通配符，可以查看struts章节的通配符匹配简化配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>listProduct<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"deleteProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"delete"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>listProduct<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"editProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"edit"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"edit"</span>&gt;</span>/product/edit.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"updateProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"update"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>listProduct<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"listProduct"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">method</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"listJsp"</span>&gt;</span>/product/list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-Action"><a class="header-anchor" href="#步骤-5-Action">¶</a>步骤 5 : Action</h4>
<p>分别为增加，删除，修改，查询，获取准备对应的方法.<br>
声明实例化ProductDAO pdao = new ProductDAO();以便于在每一个方法中调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    ProductDAO pdao = <span class="keyword">new</span> ProductDAO();</span><br><span class="line">    Product product;</span><br><span class="line">    List&lt;Product&gt; products;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        pdao.add(product);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">edit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        product =pdao.get(product.getId());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"edit"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        pdao.delete(product.getId());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        pdao.update(product);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        products = pdao.listProduct();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listJsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-list-jsp-v3"><a class="header-anchor" href="#步骤-6-list-jsp-v3">¶</a>步骤 6 : list.jsp</h4>
<p>在web目录下，新建一个product目录，接着在product目录下创建list.jsp文件</p>
<p>list.jsp同时提供增加和显示功能<br>
以及删除和修改的超链</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;html&gt;</span><br><span class="line"> </span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;table align=<span class="string">"center"</span> border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span> width=<span class="string">"500px"</span>&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;price&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;edit&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;delete&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;s:iterator value=<span class="string">"products"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;p.price&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href="editProduct?product.id=$&#123;p.id&#125;"&gt;edit&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;a href="deleteProduct?product.id=$&#123;p.id&#125;"&gt;delete&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/s:iterator&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line"> </span><br><span class="line">&lt;br/&gt;</span><br><span class="line"> </span><br><span class="line">&lt;form action=<span class="string">"addProduct"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;table align=<span class="string">"center"</span> border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line"> &lt;tr&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        name:</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> name=<span class="string">"product.name"</span> value=<span class="string">""</span>&gt;</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line"> &lt;/tr&gt;</span><br><span class="line"> &lt;tr&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        price:</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> name=<span class="string">"product.price"</span> value=<span class="string">"0"</span>&gt;</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line"> &lt;/tr&gt;</span><br><span class="line"> &lt;tr&gt;</span><br><span class="line">    &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">"submit"</span> value=<span class="string">"submit"</span>&gt;</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line"> &lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/form&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-edit-jsp"><a class="header-anchor" href="#步骤-7-edit-jsp">¶</a>步骤 7 : edit.jsp</h4>
<p>在product目录下创建edit.jsp文件，用于编辑</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;html&gt;</span><br><span class="line"> </span><br><span class="line">&lt;body&gt;</span><br><span class="line"> </span><br><span class="line">&lt;form action=<span class="string">"updateProduct"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;table align=<span class="string">"center"</span> border=<span class="string">"1"</span> cellspacing=<span class="string">"0"</span>&gt;</span><br><span class="line"> &lt;tr&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        name:</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> name=<span class="string">"product.name"</span> value=<span class="string">"$&#123;product.name&#125;"</span>&gt;</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line"> &lt;/tr&gt;</span><br><span class="line"> &lt;tr&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        price:</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line">    &lt;td&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> name=<span class="string">"product.price"</span> value=<span class="string">"$&#123;product.price&#125;"</span>&gt;</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line"> &lt;/tr&gt;</span><br><span class="line"> &lt;tr&gt;</span><br><span class="line">    &lt;td colspan=<span class="string">"2"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"product.id"</span> value=<span class="string">"$&#123;product.id&#125;"</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">"submit"</span> value=<span class="string">"submit"</span>&gt;</span><br><span class="line">    &lt;/td&gt;</span><br><span class="line"> &lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/form&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-index-jsp"><a class="header-anchor" href="#步骤-8-index-jsp">¶</a>步骤 8 : index.jsp</h4>
<p>在WebContent目录下创建一个index.jsp，用于跳转到查询product页面</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:forward page=<span class="string">"listProduct"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-测试"><a class="header-anchor" href="#步骤-9-测试">¶</a>步骤 9 : 测试</h4>
<p>测试访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts_hibernate/</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/209.png" alt></p>
<h3 id="4、完整项目下载"><a class="header-anchor" href="#4、完整项目下载">¶</a>4、完整项目下载</h3>
<p>Struts+Hibernate完整项目下载<br>
演示项目步骤</p>
<ol>
<li>创建数据库how2java</li>
<li>部署到tomcat</li>
<li>访问 <a href="http://127.0.0.1:8080/struts_hibernate/" target="_blank" rel="noopener">http://127.0.0.1:8080/struts_hibernate/</a></li>
</ol>
<h4 id="步骤-1-先运行，看到效果，再学习-v58"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v58">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v58"><a class="header-anchor" href="#步骤-2-模仿和排错-v58">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-查询和增加界面"><a class="header-anchor" href="#步骤-3-查询和增加界面">¶</a>步骤 3 : 查询和增加界面</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1866.png" alt></p>
<h4 id="步骤-4-编辑页面"><a class="header-anchor" href="#步骤-4-编辑页面">¶</a>步骤 4 : 编辑页面</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1867.png" alt></p>
<h3 id="5、完整项目下载2"><a class="header-anchor" href="#5、完整项目下载2">¶</a>5、完整项目下载2</h3>
<p>上一个完整项目下载是针对product的一套增删改查，这个是同时有product和category的一套<br>
演示项目步骤</p>
<ol>
<li>
<p>创建数据库how2java</p>
</li>
<li>
<p>部署到tomcat</p>
</li>
<li>
<p>访问 <a href="http://localhost:8080/struts_hibernate/listCategory" target="_blank" rel="noopener">http://localhost:8080/struts_hibernate/listCategory</a></p>
</li>
</ol>
<h4 id="步骤-1-先运行，看到效果，再学习-v59"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v59">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/struts_hibernate/listCategory</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5447.png" alt></p>
<h4 id="步骤-2-模仿和排错-v59"><a class="header-anchor" href="#步骤-2-模仿和排错-v59">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-分类的管理"><a class="header-anchor" href="#步骤-3-分类的管理">¶</a>步骤 3 : 分类的管理</h4>
<p>分类的增删改查一套</p>
<p>不仅如此，还能通过连接&quot;products&quot; 查看 “该分类” 下的商品</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1864.png" alt></p>
<h4 id="步骤-4-产品的管理"><a class="header-anchor" href="#步骤-4-产品的管理">¶</a>步骤 4 : 产品的管理</h4>
<p>增加产品的时候，选择指定的分类</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1865.png" alt></p>
<h1 id="伍、SPRING-HIBERNATE"><a class="header-anchor" href="#伍、SPRING-HIBERNATE">¶</a>伍、SPRING+HIBERNATE</h1>
<h2 id="一、教程-v3"><a class="header-anchor" href="#一、教程-v3">¶</a>一、教程</h2>
<h3 id="1、整合步骤"><a class="header-anchor" href="#1、整合步骤">¶</a>1、整合步骤</h3>
<p>整合思路是，使DAO继承HibernateTemplate这个类<br>
HibernateTemplate这个类提供了setSessionFactory()方法用于注入SessionFactory<br>
通过spring获取DAO的时候，注入SessionFactory.</p>
<h4 id="步骤-1-pojo"><a class="header-anchor" href="#步骤-1-pojo">¶</a>步骤 1 : pojo</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-hbm"><a class="header-anchor" href="#步骤-2-hbm">¶</a>步骤 2 : hbm</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-DAO"><a class="header-anchor" href="#步骤-3-DAO">¶</a>步骤 3 : DAO</h4>
<p>DAO继承HibernateTemplete，而HibernateTemplete类里有一个setSessionFactory用于接收sessionFactory的注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate3.HibernateTemplate;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryDAO</span> <span class="keyword">extends</span> <span class="title">HibernateTemplate</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-applicationContext-xml-v2"><a class="header-anchor" href="#步骤-4-applicationContext-xml-v2">¶</a>步骤 4 : applicationContext.xml</h4>
<p>创建dao的时候，会注入sessionfactory<br>
创建sessionFactory的时候会注入数据源ds</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"yyy"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"dao"</span> <span class="attr">class</span>=<span class="string">"com.how2java.dao.CategoryDAO"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Category.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">                hibernate.show_sql=true</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试查询"><a class="header-anchor" href="#步骤-5-测试查询">¶</a>步骤 5 : 测试查询</h4>
<p>因为CategoryDAO 继承了HibernateTemplate,所以可以直接使用<br>
find来查询所有的Category</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/226.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        CategoryDAO dao = (CategoryDAO) context.getBean(<span class="string">"dao"</span>);</span><br><span class="line">        List&lt;Category&gt; cs= dao.find(<span class="string">"from Category c"</span>);</span><br><span class="line">        System.out.println(cs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试增-删-改"><a class="header-anchor" href="#步骤-6-测试增-删-改">¶</a>步骤 6 : 测试增 删 改</h4>
<p>因为CategoryDAO 继承了HibernateTemplate,所以可以直接使用</p>
<ol>
<li>save 增加</li>
<li>get 获取</li>
<li>update 修改</li>
<li>delete 删除<br>
代码比较 复制代码</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        CategoryDAO dao = (CategoryDAO) context.getBean(<span class="string">"dao"</span>);</span><br><span class="line">        Category c = <span class="keyword">new</span> Category();</span><br><span class="line">        c.setName(<span class="string">"category yyy"</span>);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//增加</span></span><br><span class="line">        dao.save(c);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//获取</span></span><br><span class="line">        Category c2 = dao.get(Category<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//修改</span></span><br><span class="line">        c2.setName(<span class="string">"category zzz"</span>);</span><br><span class="line">        dao.update(c2);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">//删除</span></span><br><span class="line">        dao.delete(c2);</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>自动建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">貌似在spring的applicationContext文件里把</span><br><span class="line"></span><br><span class="line">&lt;property name&#x3D;&quot;hibernateProperties&quot;&gt;</span><br><span class="line">			&lt;value&gt;</span><br><span class="line">				hibernate.dialect&#x3D;org.hibernate.dialect.MySQLDialect</span><br><span class="line">				hibernate.show_sql&#x3D;true</span><br><span class="line">				hbm2ddl.auto&#x3D;update</span><br><span class="line">   			&lt;&#x2F;value&gt;</span><br><span class="line">		&lt;&#x2F;property&gt;</span><br><span class="line"></span><br><span class="line">hbm2ddl.auto改成hibernate.hbm2ddl.auto就能自动建表了，应该是spring没识别出hbm2ddl.auto</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">有些prop节点的key带有“hibernate”做前缀，有些没有带“ibernate”，而且不同数据库的不同版本对于“&lt;prop key&#x3D;&quot;hbm2ddl.auto&quot;&gt;update&lt;&#x2F;prop&gt;”节点是否需要“hibernate”做前缀也有不同的要求，因此如果发现Hibernate某项属性值失效，可在对应属性前补充上“hibernate”字符作为前缀即可。</span><br><span class="line"></span><br><span class="line">例如，如果发现Spring整合Hibernate之后没有在加载配置时自动创建数据库架构，解决方法是：可以在&lt;prop key&#x3D;&quot;hbm2ddl.auto&quot;&gt;update&lt;&#x2F;prop&gt;节点的key中补充上“hibernate”字符作为前缀即可，如：</span><br><span class="line"></span><br><span class="line">&lt;prop key&#x3D;&quot;hibernate.hbm2ddl.auto&quot;&gt;update&lt;&#x2F;prop&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2、分页"><a class="header-anchor" href="#2、分页">¶</a>2、分页</h3>
<p>Spring和Hibernate整合是借助HibernateTemplate进行的.<br>
分页查询比起直接使用hibernate有所区别<br>
主要会用到DetachedCriteria进行</p>
<h4 id="步骤-1-使用DetachedCriteria进行分页查询"><a class="header-anchor" href="#步骤-1-使用DetachedCriteria进行分页查询">¶</a>步骤 1 : 使用DetachedCriteria进行分页查询</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.DetachedCriteria;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        CategoryDAO dao = (CategoryDAO) context.getBean(<span class="string">"dao"</span>);</span><br><span class="line">         </span><br><span class="line">        DetachedCriteria dc = DetachedCriteria.forClass(Category<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="keyword">int</span> start =<span class="number">5</span>;<span class="comment">//从多少开始查询</span></span><br><span class="line">        <span class="keyword">int</span> count =<span class="number">10</span>;<span class="comment">//每页显示数量</span></span><br><span class="line">        List&lt;Category&gt; cs= dao.findByCriteria(dc,start,count);</span><br><span class="line">        System.out.println(cs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、查询总数"><a class="header-anchor" href="#3、查询总数">¶</a>3、查询总数</h3>
<p>使用HibernateTemplate查询总数</p>
<h4 id="步骤-1-查询总数"><a class="header-anchor" href="#步骤-1-查询总数">¶</a>步骤 1 : 查询总数</h4>
<p>通过find方法执行select(*)，接着会返回一个List里面第一个元素即总数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.CategoryDAO;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        CategoryDAO dao = (CategoryDAO) context.getBean(<span class="string">"dao"</span>);</span><br><span class="line">         </span><br><span class="line">        List&lt;Long&gt; l =dao.find(<span class="string">"select count(*) from Category c"</span>);</span><br><span class="line">        <span class="keyword">long</span> total = l.get(<span class="number">0</span>);</span><br><span class="line">        System.out.println(total);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、条件查询"><a class="header-anchor" href="#4、条件查询">¶</a>4、条件查询</h3>
<p>使用HibernateTemplate进行模糊查询<br>
其思路和直接使用hibernate有所区别</p>
<h4 id="步骤-1-模糊查询"><a class="header-anchor" href="#步骤-1-模糊查询">¶</a>步骤 1 : 模糊查询</h4>
<p>分别使用Hql和Criteria进行模糊查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.DetachedCriteria;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.criterion.Restrictions;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        CategoryDAO dao = (CategoryDAO) context.getBean(<span class="string">"dao"</span>);</span><br><span class="line">          </span><br><span class="line">        List&lt;Category&gt; cs =dao.find(<span class="string">"from Category c where c.name like ?"</span>, <span class="string">"%c%"</span>);</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        DetachedCriteria dc = DetachedCriteria.forClass(Category<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        dc.add(Restrictions.like(<span class="string">"name"</span>, <span class="string">"%分类%"</span>));</span><br><span class="line">        cs =dao.findByCriteria(dc);</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">          </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、使用C3P0连接池"><a class="header-anchor" href="#5、使用C3P0连接池">¶</a>5、使用C3P0连接池</h3>
<p>配置applicationContext.xml,使得其支持c3p0数据库连接池</p>
<h4 id="步骤-1-applicationContext-xml"><a class="header-anchor" href="#步骤-1-applicationContext-xml">¶</a>步骤 1 : applicationContext.xml</h4>
<p>调整applicationContext.xml以使得其支持c3p0数据库连接池<br>
主要是修改数据源database</p>
<ol>
<li>database class<br>
从 org.springframework.jdbc.datasource.DriverManagerDataSource<br>
改为 com.mchange.v2.c3p0.ComboPooledDataSource</li>
<li>driverClassName 改为 driverClass</li>
<li>url 改为 jdbcUrl</li>
<li>username 改为 user</li>
<li>增加c3p0相关配置</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"yyy"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"dao"</span> <span class="attr">class</span>=<span class="string">"com.how2java.dao.CategoryDAO"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Category.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">                hibernate.show_sql=true</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">value</span>=<span class="string">"jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!--连接池中保留的最小连接数。--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minPoolSize"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--连接池中保留的最大连接数。Default: 15 --&gt;</span> </span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxPoolSize"</span> <span class="attr">value</span>=<span class="string">"100"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--最大空闲时间,1800秒内未使用则连接被丢弃。若为0则永不丢弃。Default: 0 --&gt;</span> </span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdleTime"</span> <span class="attr">value</span>=<span class="string">"1800"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--当连接池中的连接耗尽的时候c3p0一次同时获取的连接数。Default: 3 --&gt;</span> </span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"acquireIncrement"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--最大的Statements条数 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxStatements"</span> <span class="attr">value</span>=<span class="string">"1000"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--初始化10条连接 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"initialPoolSize"</span> <span class="attr">value</span>=<span class="string">"10"</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--定义在从数据库获取新连接失败后重复尝试的次数。Default: 30 --&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"acquireRetryAttempts"</span> <span class="attr">value</span>=<span class="string">"30"</span> /&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!--每隔60秒发一次心跳信号到数据库，以保持连接的活性 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"idleConnectionTestPeriod"</span> <span class="attr">value</span>=<span class="string">"60"</span> /&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="6、连接ORACLE"><a class="header-anchor" href="#6、连接ORACLE">¶</a>6、连接ORACLE</h3>
<p>在整合步骤的基础上，把本来连接Mysql改为连接oracle</p>
<h4 id="步骤-1-hbm"><a class="header-anchor" href="#步骤-1-hbm">¶</a>步骤 1 : hbm</h4>
<p>设置自增长id为sequence</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Category"</span> <span class="attr">table</span>=<span class="string">"bigsword.category_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span>        </span><br><span class="line">                <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"sequence"</span>&gt;</span>bigsword.category_sequence<span class="tag">&lt;/<span class="name">param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-applicationContext-xml"><a class="header-anchor" href="#步骤-2-applicationContext-xml">¶</a>步骤 2 : applicationContext.xml</h4>
<p>设置连接oracle的<br>
驱动<br>
url<br>
方言<br>
账号密码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"c"</span> <span class="attr">class</span>=<span class="string">"com.how2java.pojo.Category"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"yyy"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"dao"</span> <span class="attr">class</span>=<span class="string">"com.how2java.dao.CategoryDAO"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Category.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.OracleDialect</span><br><span class="line">                hibernate.show_sql=true</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"oracle.jdbc.driver.OracleDriver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:oracle:thin:@localhost:1521:XE"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"bigsword"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"bigsword"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>  </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-sql-语句"><a class="header-anchor" href="#步骤-3-sql-语句">¶</a>步骤 3 : sql 语句</h4>
<p>首先用bigsword账号登录<br>
创建sequence<br>
创建table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> bigsword.category_sequence</span><br><span class="line"> </span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> bigsword.category_(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">number</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar2</span>(<span class="number">30</span>)</span><br><span class="line"> </span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-TestSpring"><a class="header-anchor" href="#步骤-4-TestSpring">¶</a>步骤 4 : TestSpring</h4>
<p>运行测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line">                <span class="keyword">new</span> String[] &#123; <span class="string">"applicationContext.xml"</span> &#125;);</span><br><span class="line">        CategoryDAO dao = (CategoryDAO) context.getBean(<span class="string">"dao"</span>);</span><br><span class="line">        Category c =<span class="keyword">new</span> Category();</span><br><span class="line">        c.setName(<span class="string">"category 1"</span>);</span><br><span class="line">        dao.save(c);</span><br><span class="line">         </span><br><span class="line">        List&lt;Category&gt; cs= dao.find(<span class="string">"from Category c"</span>);</span><br><span class="line">        System.out.println(cs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="陆、SPRING-STRUTS"><a class="header-anchor" href="#陆、SPRING-STRUTS">¶</a>陆、SPRING+STRUTS</h1>
<h2 id="一、教程-v4"><a class="header-anchor" href="#一、教程-v4">¶</a>一、教程</h2>
<h3 id="1、整合步骤-v2"><a class="header-anchor" href="#1、整合步骤-v2">¶</a>1、整合步骤</h3>
<p>整合Struts和Spring的基本思路是将Action生命周期由原本的Struts进行管理，交由Spring进行管理</p>
<p>相当于李思思以前要自己接客，现在改成先由老鸨去招揽，回头再交给李师师进行具体的业务<strong>操</strong>作</p>
<p>以 struts模块的[iterator标签]为基础，进行整合</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v60"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v60">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>测试地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts_spring/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5848.png" alt></p>
<h4 id="步骤-2-模仿和排错-v60"><a class="header-anchor" href="#步骤-2-模仿和排错-v60">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-struts-xml-v2"><a class="header-anchor" href="#步骤-3-struts-xml-v2">¶</a>步骤 3 : struts.xml</h4>
<p>在struts.xml中指定objectFactory对象工厂为spring<br>
即action的创建交由spring进行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.objectFactory"</span> <span class="attr">value</span>=<span class="string">"spring"</span>/&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"showProduct"</span> <span class="attr">class</span>=<span class="string">"productActionBean"</span> <span class="attr">method</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"addProduct"</span> <span class="attr">class</span>=<span class="string">"productActionBean"</span> <span class="attr">method</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"show"</span>&gt;</span>show.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span>   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"listProduct"</span> <span class="attr">class</span>=<span class="string">"productActionBean"</span> <span class="attr">method</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span>list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-applicationContext-xml-v3"><a class="header-anchor" href="#步骤-4-applicationContext-xml-v3">¶</a>步骤 4 : applicationContext.xml</h4>
<p>在WEB-INF目录下，创建文件applicationContext.xml<br>
配置productActionBean<br>
注：不要放在src下面，一定要放在WEB-INF目录下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productActionBean"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-配置web-xml"><a class="header-anchor" href="#步骤-5-配置web-xml">¶</a>步骤 5 : 配置web.xml</h4>
<p>指定Context监听器，该监听器在tomcat启动的时候就会执行，用于扫描WEB-INF/lib目录下是否有 struts2-spring-plugin-2.2.3.1.jar</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">            org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>FORWARD<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-struts2-spring-plugin-2-2-3-1-jar"><a class="header-anchor" href="#步骤-6-struts2-spring-plugin-2-2-3-1-jar">¶</a>步骤 6 : struts2-spring-plugin-2.2.3.1.jar</h4>
<p>用于整合struts和spring的插件jar<br>
本例的完整项目下载中已包含此jar</p>
<h4 id="步骤-7-测试-v8"><a class="header-anchor" href="#步骤-7-测试-v8">¶</a>步骤 7 : 测试</h4>
<p>此时struts所使用的ProductAction已是由spring所创建</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/struts_spring/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/231.png" alt></p>
<h1 id="柒、SSH"><a class="header-anchor" href="#柒、SSH">¶</a>柒、SSH</h1>
<h2 id="一、教程-v5"><a class="header-anchor" href="#一、教程-v5">¶</a>一、教程</h2>
<h3 id="1、整合步骤-v3"><a class="header-anchor" href="#1、整合步骤-v3">¶</a>1、整合步骤</h3>
<p>本例演示从0开始逐一整合SSH的步骤，要学习本知识，需要具备[Spring], [Struts], [Hibernate]的基础，如果没有这些基础，请把基础掌握之后再学习，不要跳跃学习，最后坑的是自己</p>
<p>本例演示从struts,spring,hibernate逐一配置的步骤，完整的可运行实例可在右边下载</p>
<p><strong>必读：</strong> 基于框架的程序要成功运行，对于JAR包的版本，配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致框架程序运行失败。 如果你是第一次学习本框架，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-创建数据库"><a class="header-anchor" href="#步骤-1-创建数据库">¶</a>步骤 1 : 创建数据库</h4>
<p>首先准备数据库 how2java<br>
如果没有安装数据库，请参考 [安装mysql-server]</p>
<p><strong>注：</strong> 新安装的数据库账号密码是root:admin, 后续的配置里，也是用的这个账号密码。如果密码不是这个，本知识点右上角的可运行项目跑不起来，所以尽量修改密码为admin, 修改密码办法：[修改root密码]</p>
<h4 id="步骤-2-创建表"><a class="header-anchor" href="#步骤-2-创建表">¶</a>步骤 2 : 创建表</h4>
<p>准备表product_， 有3个字段，分别是<br>
主键id(自增长)<br>
字符串格式的name<br>
浮点数格式的price</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">  </span><br><span class="line">CREATE TABLE product_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  name varchar(30) ,</span><br><span class="line">  price float ,</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) DEFAULT CHARSET&#x3D;UTF8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-准备数据"><a class="header-anchor" href="#步骤-3-准备数据">¶</a>步骤 3 : 准备数据</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">delete from product_;</span><br><span class="line">INSERT INTO product_ VALUES (null,&#39;产品a&#39;,88.88);</span><br><span class="line">INSERT INTO product_ VALUES (null,&#39;产品b&#39;,88.88);</span><br><span class="line">INSERT INTO product_ VALUES (null,&#39;产品c&#39;,88.88);</span><br><span class="line">INSERT INTO product_ VALUES (null,&#39;产品x&#39;,88.88);</span><br><span class="line">INSERT INTO product_ VALUES (null,&#39;产品y&#39;,88.88);</span><br><span class="line">INSERT INTO product_ VALUES (null,&#39;产品z&#39;,88.88);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-先运行，再学习"><a class="header-anchor" href="#步骤-4-先运行，再学习">¶</a>步骤 4 : 先运行，再学习</h4>
<p>SSH整合需要做不少步骤，任何一步部做漏了，做错了，都有可能失败，这样会影响学习的信心，并且误以为本教程是走不通的。</p>
<p>所以先下载右上角的可运行项目 ssh.rar，解压后导入到eclipse中，启动Tomcat，观察是否正常运行。确定可以运行，确定教程是可以跑得起来的，再学习下面的内容。</p>
<p>导入到Eclipse中并运行的办法请参考：[导入动态Web项目到Eclipse中]</p>
<p>部署成功自后，测试地址，应该看到如图所示的效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4534.png" alt></p>
<h4 id="步骤-5-新建项目"><a class="header-anchor" href="#步骤-5-新建项目">¶</a>步骤 5 : 新建项目</h4>
<p>在eclipse中新建项目ssh，使用dynamic web project的方式。 不熟悉这种方式的同学，请参考 [使用Dynamic Web Project的方式开发J2EE应用]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4531.png" alt></p>
<h4 id="步骤-6-导入jar"><a class="header-anchor" href="#步骤-6-导入jar">¶</a>步骤 6 : 导入jar</h4>
<p>下载右上角的lib.rar, 解压后复制到 e:/project/ssh/WebContent/WEB-INF/lib目录下</p>
<h4 id="步骤-7-pojo-v2"><a class="header-anchor" href="#步骤-7-pojo-v2">¶</a>步骤 7 : pojo</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-hbm"><a class="header-anchor" href="#步骤-8-hbm">¶</a>步骤 8 : hbm</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"Product"</span> <span class="attr">table</span>=<span class="string">"product_"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-DAO"><a class="header-anchor" href="#步骤-9-DAO">¶</a>步骤 9 : DAO</h4>
<p>DAO部分由接口ProductDAO 和其实现类ProductDAOImpl 构成<br>
<strong>ProductDAO</strong> 接口声明了方法list()、add(Product p)。<br>
<strong>ProductDAOImpl</strong> 类继承了Hibernatetemplete，并实现接口ProductDAO。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductDAO</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Product p)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.dao.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate3.HibernateTemplate;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDAOImpl</span> <span class="keyword">extends</span> <span class="title">HibernateTemplate</span> <span class="keyword">implements</span> <span class="title">ProductDAO</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> find(<span class="string">"from Product"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Product p)</span> </span>&#123;</span><br><span class="line">        save(p);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-Service"><a class="header-anchor" href="#步骤-10-Service">¶</a>步骤 10 : Service</h4>
<p>Service部分由接口ProductService 和其实现类ProductServiceImpl 构成<br>
<strong>ProductService</strong> 接口声明了方法list()。<br>
<strong>ProductServiceImpl</strong> 实现接口ProductService,并接受productDAO的注入。<br>
list方法就是业务方法，productDAO查找所有的数据，如果是空的，就往数据库里插入5条数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate3.HibernateTemplate;</span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line">    ProductDAO productDAO;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; products= productDAO.list();</span><br><span class="line">        <span class="keyword">if</span>(products.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                Product p = <span class="keyword">new</span> Product();</span><br><span class="line">                p.setName(<span class="string">"product "</span> + i);</span><br><span class="line">                productDAO.add(p);</span><br><span class="line">                products.add(p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProductDAO <span class="title">getProductDAO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> productDAO;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProductDAO</span><span class="params">(ProductDAO productDAO)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productDAO = productDAO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-ProductAction"><a class="header-anchor" href="#步骤-11-ProductAction">¶</a>步骤 11 : ProductAction</h4>
<p>ProductAction提供对ProductService的注入，借助SSH的整合，ProductAction就充当非常单纯的控制层的角色：</p>
<ol>
<li>取得数据</li>
<li>跳转到页面 “listJsp”</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    ProductService productService;</span><br><span class="line">    List&lt;Product&gt; products;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        products = productService.list();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listJsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProductService <span class="title">getProductService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> productService;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProductService</span><span class="params">(ProductService productService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productService = productService;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-struts-xml"><a class="header-anchor" href="#步骤-12-struts-xml">¶</a>步骤 12 : struts.xml</h4>
<p>指定objectFactory 为spring，把action的生命周期管理交给spring进行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.objectFactory"</span> <span class="attr">value</span>=<span class="string">"spring"</span>/&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"listProduct"</span> <span class="attr">class</span>=<span class="string">"productActionBean"</span> <span class="attr">method</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"listJsp"</span>&gt;</span>list.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-applicationContext-xml"><a class="header-anchor" href="#步骤-13-applicationContext-xml">¶</a>步骤 13 : applicationContext.xml</h4>
<p>applicationContext.xml应该放在WEB-INF目录下<br>
提供action的管理，并且在创建action的时候，注入dao</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productActionBean"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"productService"</span> <span class="attr">ref</span>=<span class="string">"productServiceImpl"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productServiceImpl"</span> <span class="attr">class</span>=<span class="string">"com.how2java.service.impl.ProductServiceImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"productDAO"</span> <span class="attr">ref</span>=<span class="string">"productDAOImpl"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productDAOImpl"</span> <span class="attr">class</span>=<span class="string">"com.how2java.dao.impl.ProductDAOImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Product.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemaUpdate"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">                 </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">                hibernate.show_sql=true</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>      </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-14-配置web-xml"><a class="header-anchor" href="#步骤-14-配置web-xml">¶</a>步骤 14 : 配置web.xml</h4>
<p>web.xml 增加Context监听器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">            org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>FORWARD<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dispatcher</span>&gt;</span>REQUEST<span class="tag">&lt;/<span class="name">dispatcher</span>&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-15-list-jsp"><a class="header-anchor" href="#步骤-15-list-jsp">¶</a>步骤 15 : list.jsp</h4>
<p>用于显示products的jsp</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> %&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%<span class="meta">@page</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">                 </span><br><span class="line">&lt;s:iterator value=<span class="string">"products"</span> <span class="keyword">var</span>=<span class="string">"p"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.id&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;p.name&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/s:iterator&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-16-访问http-127-0-0-1-listProduct"><a class="header-anchor" href="#步骤-16-访问http-127-0-0-1-listProduct">¶</a>步骤 16 : 访问http://127.0.0.1/listProduct</h4>
<p>部署在Tomcat中，重启tomcat，然后访问地址，观察效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p>部署办法请参考 [通过Eclipse启动Tomcat-Run On Server]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/240.png" alt></p>
<h4 id="步骤-17-可运行项目"><a class="header-anchor" href="#步骤-17-可运行项目">¶</a>步骤 17 : 可运行项目</h4>
<p>在右上角有本知识点对应的可运行项目下载 ,实在自己搞不出来，就下载解压出来比较一下</p>
<h4 id="步骤-18-思路图"><a class="header-anchor" href="#步骤-18-思路图">¶</a>步骤 18 : 思路图</h4>
<ol>
<li>访问路径/listProduct</li>
<li>web.xml中的过滤器会将请求交由struts进行处理</li>
<li>struts根据listProduct创建对应的productActionBean<br>
<strong>此时productActionBean不再由Struts自己创建，而是由Spring创建</strong></li>
<li>spring根据applicationContext.xml创建productActionBean对应的对象ProductAction</li>
<li>Spring 创建ProductAction的时候 注入Service</li>
<li>创建Service的时候注入DAO</li>
<li>Struts 调用ProductAction的list方法</li>
<li>在list方法中调用注入好的dao，访问数据库，查询结果</li>
<li>跳转到list.jsp显示数据</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1881.png" alt></p>
<h4 id="步骤-19-练习"><a class="header-anchor" href="#步骤-19-练习">¶</a>步骤 19 : 练习</h4>
<p>基于这个例子，使用 SSH做一套产品的 增 删 改 查</p>
<h3 id="2、IDEA-v2"><a class="header-anchor" href="#2、IDEA-v2">¶</a>2、IDEA</h3>
<p>此教程使用Eclipse下的Web Dynamic Web Project风格创建，可是有部分同学更倾向于使用idea来启动web项目，不过在idea导入eclipse的Dynamic Web Project风格项目的时候由常常走不通，为此专门制作了：[如何使用IDEA导入并启动Eclipse下的的 Dynamic Web Project]，协助学习曲线更平滑些。</p>
<h3 id="3、单例"><a class="header-anchor" href="#3、单例">¶</a>3、单例</h3>
<p>一旦Struts的 Action交由Spring进行管理之后，默认情况下，Action是单例的。 这会带来一系列的问题。</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v61"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v61">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v61"><a class="header-anchor" href="#步骤-2-模仿和排错-v61">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-单例的Action"><a class="header-anchor" href="#步骤-3-单例的Action">¶</a>步骤 3 : 单例的Action</h4>
<p>在list中加一句话，打印当前Action对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>
<p>然后不停刷新</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p>就可以看到，每次打印的对象，都是同一个对象，这表明Spring管理的bean是单例模式的。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/3105.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    ProductDAO pdao;</span><br><span class="line">    List&lt;Product&gt; products;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">this</span>);</span><br><span class="line">        products = pdao.find(<span class="string">"from Product p"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listJsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProductDAO <span class="title">getPdao</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pdao;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPdao</span><span class="params">(ProductDAO pdao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.pdao = pdao;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-非单例模式"><a class="header-anchor" href="#步骤-4-非单例模式">¶</a>步骤 4 : 非单例模式</h4>
<p>为productActionBean增加一个属性<strong>scope=“prototype”</strong> ，用于告知Spring，这个对象的管理，使用非单例模式<br>
重启tomcat,不停的访问</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p>可以观察到，每次访问都是不同的ProductAction对象了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/3106.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productActionBean"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"pdao"</span> <span class="attr">ref</span>=<span class="string">"pdao"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"pdao"</span> <span class="attr">class</span>=<span class="string">"com.how2java.dao.ProductDAO"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Product.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">                hibernate.show_sql=false</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>      </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="4、自动生成表结构"><a class="header-anchor" href="#4、自动生成表结构">¶</a>4、自动生成表结构</h3>
<h4 id="步骤-1-自动生成表结构"><a class="header-anchor" href="#步骤-1-自动生成表结构">¶</a>步骤 1 : 自动生成表结构</h4>
<p>在applicationContext.xml的sessionFactory中配置了有</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">        hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">        hibernate.show_sql=false</span><br><span class="line">        hbm2ddl.auto=update</span><br><span class="line">    <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中<strong>hbm2ddl.auto=update</strong>就表示是自动更新表结构，不需要手段创建的变更。</p>
<h4 id="步骤-2-自动生成表结构-失效的处理"><a class="header-anchor" href="#步骤-2-自动生成表结构-失效的处理">¶</a>步骤 2 : 自动生成表结构 失效的处理</h4>
<p>但是有的时候，会失效，不能够自动生成表结构。<br>
需要在sessionfactory中加这么一句：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemaUpdate"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>即可使用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/pojo/Admin.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemaUpdate"</span>&gt;</span> </span><br><span class="line">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span>         </span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">           hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">           hibernate.show_sql=false</span><br><span class="line">           hbm2ddl.auto=update</span><br><span class="line">       <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="5、使用XML方式配置事务管理"><a class="header-anchor" href="#5、使用XML方式配置事务管理">¶</a>5、使用XML方式配置事务管理</h3>
<h4 id="步骤-1-删除Product表所有数据"><a class="header-anchor" href="#步骤-1-删除Product表所有数据">¶</a>步骤 1 : 删除Product表所有数据</h4>
<p>为了观察事务现象，需要对数据做一些准备，首先把product_ 表里的数据都删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from product_</span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-先运行，看到效果，再测试"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再测试">¶</a>步骤 2 : 先运行，看到效果，再测试</h4>
<p>访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p>会看到如图所示的异常（这是故意造成的）。<br>
接着执行sql语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from product_</span><br></pre></td></tr></table></figure>
<p>会发现表里没有数据，即表明相关操作在事务里，当发生异常后，数据并没有被提交</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5883.png" alt></p>
<h4 id="步骤-3-事务概念"><a class="header-anchor" href="#步骤-3-事务概念">¶</a>步骤 3 : 事务概念</h4>
<p>事务概念，表现在4个方面：<br>
原子性(Atomicity)，一致性(Consistency)，隔离性(Isolation)，持续性/永久性(Durability)<br>
大家接触的最直接的是原子性，即要么都成功，要么都失败。</p>
<p>本知识点，在[整合步骤]的基础上进行，当数据库中没有产品的时候，会新创建5个产品。那么所谓的原子性就是，要么5个产品都创建成功，要么一个也别创建。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Product&gt; products= productDAO.list();</span><br><span class="line"><span class="keyword">if</span>(products.isEmpty())&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line">        p.setName(<span class="string">"product "</span> + i);</span><br><span class="line">        productDAO.add(p);</span><br><span class="line">        products.add(p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-故意制造异常，观察无事务管理的结果"><a class="header-anchor" href="#步骤-4-故意制造异常，观察无事务管理的结果">¶</a>步骤 4 : 故意制造异常，观察无事务管理的结果</h4>
<p>在默认情况下是没有进行事务管理的，所以故意把代码修改，制造错误：<br>
当i==2的时候，抛出一个运行时异常，这样，就只创建了2条，而不是本来计划5条数据。<br>
修改后，清空product_表，重启tomcat，运行</p>
<ol>
<li>第一次运行会抛出异常</li>
<li>第二次运行，因为已经有数据了，所以不会抛异常，但是只会看到2条数据。</li>
</ol>
<p>这就是没有事务管理的后果，<strong>只有部分数据增加</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4136.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate3.HibernateTemplate;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    ProductDAO productDAO;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; products= productDAO.list();</span><br><span class="line">        <span class="keyword">if</span>(products.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">2</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException();</span><br><span class="line">                Product p = <span class="keyword">new</span> Product();</span><br><span class="line">                p.setName(<span class="string">"product "</span> + i);</span><br><span class="line">                productDAO.add(p);</span><br><span class="line">                products.add(p);</span><br><span class="line">                 </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProductDAO <span class="title">getProductDAO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> productDAO;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProductDAO</span><span class="params">(ProductDAO productDAO)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productDAO = productDAO;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-配置事务管理"><a class="header-anchor" href="#步骤-5-配置事务管理">¶</a>步骤 5 : 配置事务管理</h4>
<p>SSH的配置事务管理是<strong>非侵入式</strong>的，所谓的非侵入式，就是指不需要修改一行java代码，只需要进行applicationContext.xml的配置，即可达到事务管理的效果。</p>
<ol>
<li>增加一个专门进行事务管理的bean</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txadvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span>  </span><br><span class="line">         	<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"del*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"edit*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"list*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里面的add*,del*等等，表示对于这些名词开头的方法，进行事务管理。</p>
<ol start="2">
<li>配置切面</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"serviceMethod"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.how2java.service.*.*(..))"</span>/&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">pointcut-ref</span>=<span class="string">"serviceMethod"</span> <span class="attr">advice-ref</span>=<span class="string">"txadvice"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里使用了[AOP切面编程]的配置手段，让前面配置的事务管理bean,去和业务方法编织在一起。<br>
哪些业务方法呢？</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(* com.how2java.service.*.*(..))</span><br></pre></td></tr></table></figure>
<p>***** 返回任意类型<br>
<strong>com.how2java.service.*</strong> 包名以com.how2java.service 开头的类的任意方法<br>
<strong>(…)</strong> 任意的参数类型<br>
这样就达到了对ProductServiceImpl的list()方法，进行事务管理的效果</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productActionBean"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"productService"</span> <span class="attr">ref</span>=<span class="string">"productServiceImpl"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productServiceImpl"</span> <span class="attr">class</span>=<span class="string">"com.how2java.service.impl.ProductServiceImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"productDAO"</span> <span class="attr">ref</span>=<span class="string">"productDAOImpl"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productDAOImpl"</span> <span class="attr">class</span>=<span class="string">"com.how2java.dao.impl.ProductDAOImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Product.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemaUpdate"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">                 </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">                hibernate.show_sql=true</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- 配置事务管理器（声明式的事务） --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.HibernateTransactionManager"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txadvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"del*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"edit*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"list*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span> </span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"serviceMethod"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.how2java.service.*.*(..))"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">pointcut-ref</span>=<span class="string">"serviceMethod"</span> <span class="attr">advice-ref</span>=<span class="string">"txadvice"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-观察有事务管理的结果"><a class="header-anchor" href="#步骤-6-观察有事务管理的结果">¶</a>步骤 6 : 观察有事务管理的结果</h4>
<p>同样的，先删除掉product_里的所有数据，然后访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p>就会观察到，无论访问多少次，都会抛出异常，并且数据库里的数据，一直都为空。<br>
为什么呢？作为一个事务里的方法，当i==2的时候，抛出异常，这个事务就回滚了，在i==0,i==1的时候插入到数据库里的两条数据，也就回滚了。<br>
从而达到了，要么<strong>一次性插入5条</strong>数据，要么<strong>一条也别插入</strong>的效果。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4138.png" alt></p>
<h4 id="步骤-7-Spring事务类型详解"><a class="header-anchor" href="#步骤-7-Spring事务类型详解">¶</a>步骤 7 : Spring事务类型详解</h4>
<p>在[配置事务管理]中有这么一行配置信息：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个REQUIRED，就是Spring事务类型，除了这种，还有其他好几种，都列罗在下：<br>
REQUIRED–支持当前事务，如果当前没有事务，就新建一个事务。这是最常见的选择。<br>
SUPPORTS–支持当前事务，如果当前没有事务，就以非事务方式执行。<br>
MANDATORY–支持当前事务，如果当前没有事务，就抛出异常。<br>
REQUIRES_NEW–新建事务，如果当前存在事务，把当前事务挂起。<br>
NOT_SUPPORTED–以非事务方式执行操作，如果当前存在事务，就把当前事务挂起。<br>
NEVER–以非事务方式执行，如果当前存在事务，则抛出异常。<br>
NESTED–如果当前存在事务，则在嵌套事务内执行。如果当前没有事务，则进行与REQUIRED类似的操作。</p>
<p>最常见的就第一种REQUIRED，其他的，我也没怎么用过 -_-~</p>
<h4 id="步骤-8-MYSQL-表的类型必须是INNODB才支持事务"><a class="header-anchor" href="#步骤-8-MYSQL-表的类型必须是INNODB才支持事务">¶</a>步骤 8 : MYSQL 表的类型必须是INNODB才支持事务</h4>
<p>在Mysql中，只有当表的类型是INNODB的时候，才支持事务，所以需要把表的类型设置为INNODB,否则无法观察到事务.</p>
<p>修改表的类型为INNODB的SQL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table product_ ENGINE  &#x3D; innodb;</span><br></pre></td></tr></table></figure>
<p>查看表的类型的SQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show table status from how2java;</span><br></pre></td></tr></table></figure>
<p>不过有个前提，就是当前的MYSQL服务器本身要支持INNODB,如果不支持，请看 [开启MYSQL INNODB的办法]</p>
<h3 id="6、使用注解方式配置事务管理"><a class="header-anchor" href="#6、使用注解方式配置事务管理">¶</a>6、使用注解方式配置事务管理</h3>
<h4 id="步骤-1-修改applicationContext-xml"><a class="header-anchor" href="#步骤-1-修改applicationContext-xml">¶</a>步骤 1 : 修改applicationContext.xml</h4>
<p>在SSH 通过XML [配置事务管理] 的基础上，修改applicationContext.xml文件.</p>
<ol>
<li>去掉&lt;tx:advice和 &lt;aop:config 配置</li>
<li>保留&lt;bean id=“transactionManager” …&gt;</li>
<li>添加&lt;tx:annotation-driven transaction-manager=“transactionManager”/&gt; 用于进行注解扫描</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productActionBean"</span> <span class="attr">class</span>=<span class="string">"com.how2java.action.ProductAction"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"productService"</span> <span class="attr">ref</span>=<span class="string">"productServiceImpl"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productServiceImpl"</span> <span class="attr">class</span>=<span class="string">"com.how2java.service.impl.ProductServiceImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"productDAO"</span> <span class="attr">ref</span>=<span class="string">"productDAOImpl"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"productDAOImpl"</span> <span class="attr">class</span>=<span class="string">"com.how2java.dao.impl.ProductDAOImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Product.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemaUpdate"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">                 </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">                hibernate.show_sql=true</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- 配置事务管理器（声明式的事务） --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.HibernateTransactionManager"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-为ProductServiceImpl-添加注解"><a class="header-anchor" href="#步骤-2-为ProductServiceImpl-添加注解">¶</a>步骤 2 : 为ProductServiceImpl 添加注解</h4>
<p>在ProductServiceImpl 的list方法前加一句：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span>(propagation=Propagation.REQUIRED,rollbackForClassName=<span class="string">"Exception"</span>)</span><br></pre></td></tr></table></figure>
<p>表示这个方法要进行事务管理。<br>
没了~</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    ProductDAO productDAO;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Transactional</span>(propagation=Propagation.REQUIRED,rollbackForClassName=<span class="string">"Exception"</span>)</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; products= productDAO.list();</span><br><span class="line">        <span class="keyword">if</span>(products.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">2</span>)</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException();</span><br><span class="line">                Product p = <span class="keyword">new</span> Product();</span><br><span class="line">                p.setName(<span class="string">"product "</span> + i);</span><br><span class="line">                productDAO.add(p);</span><br><span class="line">                products.add(p);</span><br><span class="line">                 </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProductDAO <span class="title">getProductDAO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> productDAO;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProductDAO</span><span class="params">(ProductDAO productDAO)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productDAO = productDAO;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-测试"><a class="header-anchor" href="#步骤-3-测试">¶</a>步骤 3 : 测试</h4>
<p>删除product_表中数据，重启tomcat,访问页面：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p>即可观察到不断地抛出异常，不会插入数据。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../java/Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4142.png" alt></p>
<h4 id="步骤-4-MYSQL-表的类型必须是INNODB才支持事务"><a class="header-anchor" href="#步骤-4-MYSQL-表的类型必须是INNODB才支持事务">¶</a>步骤 4 : MYSQL 表的类型必须是INNODB才支持事务</h4>
<p>在Mysql中，只有当表的类型是INNODB的时候，才支持事务，所以需要把表的类型设置为INNODB,否则无法观察到事务.</p>
<p>修改表的类型为INNODB的SQL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table product_ ENGINE  &#x3D; innodb;</span><br></pre></td></tr></table></figure>
<p>查看表的类型的SQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show table status from how2java;</span><br></pre></td></tr></table></figure>
<p>不过有个前提，就是当前的MYSQL服务器本身要支持INNODB,如果不支持，请看 [开启MYSQL INNODB的办法]</p>
<h3 id="7、整合-注解方式"><a class="header-anchor" href="#7、整合-注解方式">¶</a>7、整合-注解方式</h3>
<p>以注解的方式，来进行SSH整合配置</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v62"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v62">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-模仿和排错-v62"><a class="header-anchor" href="#步骤-2-模仿和排错-v62">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前面的教程-v2"><a class="header-anchor" href="#步骤-3-基于前面的教程-v2">¶</a>步骤 3 : 基于前面的教程</h4>
<p>本章节延续上面的[SSH 事务管理注解方式]继续，这样的好处是目前的状态，除了事务以外，其他都是XML配置方式。 大家就可以看到如何从XML配置方式转换为注解方式，并最后达到一样的效果。<br>
对比起来学习，更加容易理解</p>
<h4 id="步骤-4-jar-v4"><a class="header-anchor" href="#步骤-4-jar-v4">¶</a>步骤 4 : jar</h4>
<ol>
<li>
<p>为了使struts支持注解，需要用到struts2-convention-plugin-x.x.x.jar 这个jar包，在前面的教程中是没有使用的，所以这里需要从右侧下载</p>
</li>
<li>
<p>从右上角下载好了之后，放在WEB-INF/lib 下</p>
</li>
<li>
<p>不仅如此，还要在项目导入jar，以使得eclipse能够编译通过</p>
</li>
</ol>
<h4 id="步骤-5-修改applicationContext-xml"><a class="header-anchor" href="#步骤-5-修改applicationContext-xml">¶</a>步骤 5 : 修改applicationContext.xml</h4>
<ol>
<li>增加注解配置，组建扫描，以及移动事务管理的配置到前面</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>注释掉 action,service,dao</li>
<li>替换SessionFactory类</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.orm.hibernate3.LocalSessionFactoryBean</span><br></pre></td></tr></table></figure>
<p>为</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean</span><br></pre></td></tr></table></figure>
<p>以支持注解方式</p>
<ol start="4">
<li>去掉</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappingResources"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">value</span>&gt;</span>com/how2java/pojo/Product.hbm.xml<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>增加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">value</span>&gt;</span>com.how2java.*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>参考： [Spring 注解方式]</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context     </span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">&lt;!--     &lt;bean name="productActionBean" class="com.how2java.action.ProductAction"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;property name="productService" ref="productServiceImpl" /&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;/bean&gt; --&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="comment">&lt;!--     &lt;bean name="productServiceImpl" class="com.how2java.service.impl.ProductServiceImpl"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;property name="productDAO" ref="productDAOImpl" /&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;/bean&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;bean name="productDAOImpl" class="com.how2java.dao.impl.ProductDAOImpl"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;property name="sessionFactory" ref="sf" /&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;/bean&gt; --&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sf"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="comment">&lt;!--         &lt;property name="mappingResources"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--             &lt;list&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                 &lt;value&gt;com/how2java/pojo/Product.hbm.xml&lt;/value&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--             &lt;/list&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;/property&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 注解扫描 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.how2java.*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemaUpdate"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">                 </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernateProperties"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                hibernate.dialect=org.hibernate.dialect.MySQLDialect</span><br><span class="line">                hibernate.show_sql=true</span><br><span class="line">                hbm2ddl.auto=update</span><br><span class="line">            <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span>   </span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"ds"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- 配置事务管理器（声明式的事务） --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.hibernate3.HibernateTransactionManager"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sf"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-修改struts-xml"><a class="header-anchor" href="#步骤-6-修改struts-xml">¶</a>步骤 6 : 修改struts.xml</h4>
<p>注释掉action配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://struts.apache.org/dtds/struts-2.0.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.i18n.encoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.objectFactory"</span> <span class="attr">value</span>=<span class="string">"spring"</span>/&gt;</span></span><br><span class="line">   </span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="comment">&lt;!--   &lt;action name="listProduct" class="productActionBean" method="list"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;result name="listJsp"&gt;list.jsp&lt;/result&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--   &lt;/action&gt; --&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-为ProductAction添加注解"><a class="header-anchor" href="#步骤-7-为ProductAction添加注解">¶</a>步骤 7 : 为ProductAction添加注解</h4>
<ol>
<li>配置Namespace，ParentPackage，Results</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Namespace</span>(<span class="string">"/"</span>)</span><br><span class="line"><span class="meta">@ParentPackage</span>(<span class="string">"struts-default"</span>)</span><br><span class="line"><span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(name=<span class="string">"listJsp"</span>, location=<span class="string">"/list.jsp"</span>)&#125;)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>使用@Autowired自动装配productService</li>
<li>在list()方法前加注解 @Action(“listProduct”)，以映射路径</li>
</ol>
<p>参考：[Struts 注解方式]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.action;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Action;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Namespace;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.ParentPackage;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.struts2.convention.annotation.Results;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Namespace</span>(<span class="string">"/"</span>)</span><br><span class="line"><span class="meta">@ParentPackage</span>(<span class="string">"struts-default"</span>)</span><br><span class="line"><span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(name=<span class="string">"listJsp"</span>, location=<span class="string">"/list.jsp"</span>)&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    ProductService productService;</span><br><span class="line">    List&lt;Product&gt; products;</span><br><span class="line">    <span class="meta">@Action</span>(<span class="string">"listProduct"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        products = productService.list();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listJsp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProductService <span class="title">getProductService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> productService;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProductService</span><span class="params">(ProductService productService)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productService = productService;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-为ProductServiceImpl-添加注解"><a class="header-anchor" href="#步骤-8-为ProductServiceImpl-添加注解">¶</a>步骤 8 : 为ProductServiceImpl 添加注解</h4>
<ol>
<li>使用@Service 为 ProductServiceImpl添加注解</li>
<li>使用@Autowired自动装配productDAO</li>
<li>注释掉故意抛出异常部分<br>
//	if(i==2)<br>
//	throw new RuntimeException();</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.ProductService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductServiceImpl</span> <span class="keyword">implements</span> <span class="title">ProductService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    ProductDAO productDAO;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Transactional</span>(propagation=Propagation.REQUIRED,rollbackForClassName=<span class="string">"Exception"</span>)</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Product&gt; products= productDAO.list();</span><br><span class="line">        <span class="keyword">if</span>(products.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line"> </span><br><span class="line">                Product p = <span class="keyword">new</span> Product();</span><br><span class="line">                p.setName(<span class="string">"product "</span> + i);</span><br><span class="line">                productDAO.add(p);</span><br><span class="line">                products.add(p);</span><br><span class="line">                 </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProductDAO <span class="title">getProductDAO</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> productDAO;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProductDAO</span><span class="params">(ProductDAO productDAO)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.productDAO = productDAO;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-为ProductDAOImpl-添加注解"><a class="header-anchor" href="#步骤-9-为ProductDAOImpl-添加注解">¶</a>步骤 9 : 为ProductDAOImpl 添加注解</h4>
<ol>
<li>使用Repository 为ProductDAOImpl 添加注解</li>
<li>重写setSessionFactory方法，并使用@Resource(name=“sf”)对其注解，以接受sessionFactory注入( 在 applicationContext.xml中sessionFactory所取得id是sf)<br>
为什么要重写？<br>
虽然ProductDAOImpl 继承了HibernateTemplate ，有setSessionFactory方法，但是HibernateTemplate 中的setSessionFactory方法，并没有被注解，所以就不会被注入sf, 因此需要在这里重写这个方法。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.dao.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate3.HibernateTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.dao.ProductDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Repository</span>(<span class="string">"productDAO"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDAOImpl</span> <span class="keyword">extends</span> <span class="title">HibernateTemplate</span> <span class="keyword">implements</span> <span class="title">ProductDAO</span></span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span>(name=<span class="string">"sf"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSessionFactory</span><span class="params">(SessionFactory sessionFactory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setSessionFactory(sessionFactory);</span><br><span class="line">    &#125;;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> find(<span class="string">"from Product"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Product p)</span> </span>&#123;</span><br><span class="line">        save(p);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-为Product添加注解"><a class="header-anchor" href="#步骤-10-为Product添加注解">¶</a>步骤 10 : 为Product添加注解</h4>
<ol>
<li>使用@Entity 为 Product 添加注解</li>
<li>@Table 指定对应表名</li>
<li>@id 表明主键</li>
<li>@GeneratedValue(strategy = GenerationType.IDENTITY) 使用自增长策略</li>
<li>@Column 指明属性对应的数据库中的字段名</li>
</ol>
<p>参考： [Hibernate 注解方式]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"product_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">float</span> price;</span><br><span class="line">      </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"price"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-重启测试"><a class="header-anchor" href="#步骤-11-重启测试">¶</a>步骤 11 : 重启测试</h4>
<p>重启后，访问地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4151.png" alt></p>
<h3 id="8、整合-增删改查-CRUD一套"><a class="header-anchor" href="#8、整合-增删改查-CRUD一套">¶</a>8、整合-增删改查 CRUD一套</h3>
<p>SSH的CRUD需要的步骤比较繁琐，无法在一个知识点讲清楚，所以。。。直接给出了我做好的CRUD 可运行项目</p>
<h4 id="步骤-1-下载右上角的可运行项目"><a class="header-anchor" href="#步骤-1-下载右上角的可运行项目">¶</a>步骤 1 : 下载右上角的可运行项目</h4>
<p>下载右上角的可运行项目，部署成功后，访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssh/listProduct</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5845.png" alt></p>
<h1 id="捌、SPRING-MVC"><a class="header-anchor" href="#捌、SPRING-MVC">¶</a>捌、SPRING MVC</h1>
<h2 id="一、教程-v6"><a class="header-anchor" href="#一、教程-v6">¶</a>一、教程</h2>
<h3 id="1、Hello-Spring-MVC"><a class="header-anchor" href="#1、Hello-Spring-MVC">¶</a>1、Hello Spring MVC</h3>
<p><strong>必读：</strong> 基于框架的程序要成功运行，对于JAR包的版本，配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致框架程序运行失败。 如果你是第一次学习本框架，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v63"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v63">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>Spring MVC需要做不少步骤，任何一步做漏了，做错了，都有可能失败，这样会影响学习的信心，并且误以为本教程是走不通的。</p>
<p>所以先下载右上角的可运行项目 springmvc.rar，解压后导入到eclipse中，启动Tomcat，观察是否正常运行。确定可以运行，确定教程是可以跑得起来的，再学习下面的内容。</p>
<p>导入到Eclipse中并运行的办法请参考：[导入动态Web项目到Eclipse中]</p>
<p>部署成功之后，测试地址，应该看到如图所示的效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/index</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 这是动态项目格式，不支持[独立Tomcat方式部署]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1899.png" alt></p>
<h4 id="步骤-2-模仿和排错-v63"><a class="header-anchor" href="#步骤-2-模仿和排错-v63">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-创建项目springmvc"><a class="header-anchor" href="#步骤-3-创建项目springmvc">¶</a>步骤 3 : 创建项目springmvc</h4>
<p>在eclipse中新建项目springmvc，使用dynamic web project的方式。 不熟悉这种方式的同学，请参考 [使用Dynamic Web Project的方式开发J2EE应用]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1899.png" alt></p>
<h4 id="步骤-4-导入jar包-v2"><a class="header-anchor" href="#步骤-4-导入jar包-v2">¶</a>步骤 4 : 导入jar包</h4>
<p>下载右上角的lib.rar, 解压后复制到 e:/project/springmvc/WebContent/WEB-INF/lib目录下</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1890.png" alt></p>
<h4 id="步骤-5-web-xml"><a class="header-anchor" href="#步骤-5-web-xml">¶</a>步骤 5 : web.xml</h4>
<p>在WEB-INF目录下创建 web.xml</p>
<p>配置Spring MVC的入口 <strong>DispatcherServlet</strong>，把所有的请求都提交到该Servlet</p>
<p>注意：&lt;servlet-name&gt;<strong>springmvc</strong>&lt;/servlet-name&gt;</p>
<p><strong>springmvc</strong>这个名字在下一步会用到</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">"2.4"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee</span></span></span><br><span class="line"><span class="tag"><span class="string">http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">            org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">        <span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-创建springmvc-servlet-xml"><a class="header-anchor" href="#步骤-6-创建springmvc-servlet-xml">¶</a>步骤 6 : 创建springmvc-servlet.xml</h4>
<p>在WEB-INF目录下创建 springmvc-servlet.xml<br>
springmvc-servlet.xml 与上一步中的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>springmvc</strong>对应</p>
<p>这是Spring MVC的 映射配置文件<br>
表示访问路径**/index**会交给id=indexController的bean处理<br>
id=indexController的bean配置为类：<strong>IndexController</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">beans</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//SPRING//DTD BEAN//EN"</span> <span class="meta-string">"http://www.springframework.org/dtd/spring-beans.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"simpleUrlHandlerMapping"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappings"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/index"</span>&gt;</span>indexController<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"indexController"</span> <span class="attr">class</span>=<span class="string">"controller.IndexController"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-控制类-IndexController"><a class="header-anchor" href="#步骤-7-控制类-IndexController">¶</a>步骤 7 : 控制类 IndexController</h4>
<p>控制类 IndexController实现接口Controller ，提供方法handleRequest处理请求</p>
<p>SpringMVC通过 ModelAndView 对象把模型和视图结合在一起</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index.jsp"</span>);</span><br><span class="line">mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello Spring MVC"</span>);</span><br></pre></td></tr></table></figure>
<p>表示视图是index.jsp<br>
模型数据是 message，内容是 “Hello Spring MVC”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.Controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index.jsp"</span>);</span><br><span class="line">        mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello Spring MVC"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-准备index-jsp"><a class="header-anchor" href="#步骤-8-准备index-jsp">¶</a>步骤 8 : 准备index.jsp</h4>
<p>在WebContent目录下创建index.jsp</p>
<p>index.jsp很简单，通过[EL表达式]显示message的内容</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1894.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;h1&gt;$&#123;message&#125;&lt;/h1&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-部署在tomcat中，重启测试"><a class="header-anchor" href="#步骤-9-部署在tomcat中，重启测试">¶</a>步骤 9 : 部署在tomcat中，重启测试</h4>
<p>部署在Tomcat中，重启tomcat，然后访问地址，观察效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/index</span></span><br></pre></td></tr></table></figure>
<p>部署办法请参考 [通过Eclipse启动Tomcat-Run On Server]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1896.png" alt></p>
<h4 id="步骤-10-原理图-v2"><a class="header-anchor" href="#步骤-10-原理图-v2">¶</a>步骤 10 : 原理图</h4>
<ol>
<li>用户访问 /index</li>
<li>根据web.xml中的配置 所有的访问都会经过DispatcherServlet</li>
<li>根据 根据配置文件springmvc-servlet.xml ，访问路径/index<br>
会进入IndexController类</li>
<li>在IndexController中指定跳转到页面index.jsp，并传递message数据</li>
<li>在index.jsp中显示message信息</li>
</ol>
<p>​	<img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1897.png" alt></p>
<h4 id="步骤-11-完整的项目下载"><a class="header-anchor" href="#步骤-11-完整的项目下载">¶</a>步骤 11 : 完整的项目下载</h4>
<p>一般说来，根据步骤一步一步的做过来，就可以运行看到结果了。<br>
如果实在看不到结果，多半是因为中间某个步骤不够仔细，大小写错误，多了个下划线等等细微的错误。</p>
<p>如果是这样，还可以在右侧下载完整的项目保证一定可以走通</p>
<h4 id="步骤-12-练习"><a class="header-anchor" href="#步骤-12-练习">¶</a>步骤 12 : 练习</h4>
<p>本例实现了访问路径/index，服务端跳转到index.jsp的效果</p>
<p>练习：访问路径/hello 服务端跳转到hello.jsp</p>
<h3 id="2、视图定位"><a class="header-anchor" href="#2、视图定位">¶</a>2、视图定位</h3>
<p>如果代码写成这样，就表示跳转到页面 index.jsp<br>
new ModelAndView(“<strong>index.jsp</strong>”);</p>
<p>所谓的视图定位，指的是代码还是写成这样，但是会跳转到 /WEB-INF/page/index.jsp<br>
new ModelAndView(“<strong>index</strong>”);</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v64"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v64">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v64"><a class="header-anchor" href="#步骤-2-模仿和排错-v64">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v24"><a class="header-anchor" href="#步骤-3-效果-v24">¶</a>步骤 3 : 效果</h4>
<p>虽然效果和在[Hello Spring MVC]中的效果是一样的，但是视图的配置方式发生了变化</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1905.png" alt></p>
<h4 id="步骤-4-修改springmvc-servlet-xml"><a class="header-anchor" href="#步骤-4-修改springmvc-servlet-xml">¶</a>步骤 4 : 修改springmvc-servlet.xml</h4>
<p>修改springmvc-servlet.xml，增加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"viewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/page/"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其作用是把视图约定在 <strong>/WEB-INF/page/*.jsp</strong> 这个位置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">beans</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//SPRING//DTD BEAN//EN"</span> <span class="meta-string">"http://www.springframework.org/dtd/spring-beans.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"viewResolver"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/page/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"simpleUrlHandlerMapping"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappings"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/index"</span>&gt;</span>indexController<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"indexController"</span> <span class="attr">class</span>=<span class="string">"controller.IndexController"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-修改IndexController"><a class="header-anchor" href="#步骤-5-修改IndexController">¶</a>步骤 5 : 修改IndexController</h4>
<p>把IndexController类的这一行代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index.jsp"</span>);</span><br></pre></td></tr></table></figure>
<p>修改为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index"</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.Controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index"</span>);</span><br><span class="line">        mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello Spring MVC"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-移动index-jsp"><a class="header-anchor" href="#步骤-6-移动index-jsp">¶</a>步骤 6 : 移动index.jsp</h4>
<p>在WEB-INF下新建目录page<br>
把index.jsp移动到 WEB-INF/page 目录下</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1903.png" alt></p>
<h4 id="步骤-7-测试-v9"><a class="header-anchor" href="#步骤-7-测试-v9">¶</a>步骤 7 : 测试</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/index</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1904.png" alt></p>
<h3 id="3、注解方式进行配置页面跳转"><a class="header-anchor" href="#3、注解方式进行配置页面跳转">¶</a>3、注解方式进行配置页面跳转</h3>
<p>前面的例子，都是使用配置的方式进行跳转的配置，本例讲解如何使用注解的方式进行跳转的配置</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v65"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v65">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v65"><a class="header-anchor" href="#步骤-2-模仿和排错-v65">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v25"><a class="header-anchor" href="#步骤-3-效果-v25">¶</a>步骤 3 : 效果</h4>
<p>虽然效果和[Hello Spring MVC]中的一样，但是开发过程已经换成了<strong>注解方式</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1906.png" alt></p>
<h4 id="步骤-4-修改IndexController"><a class="header-anchor" href="#步骤-4-修改IndexController">¶</a>步骤 4 : 修改IndexController</h4>
<p>在类前面加上**@Controller** 表示该类是一个控制器<br>
在方法handleRequest 前面加上 <strong>@RequestMapping(&quot;/index&quot;)</strong> 表示路径/index会映射到该方法上<br>
<strong>注意</strong>：<strong>不再</strong>让IndexController实现Controller接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index"</span>);</span><br><span class="line">        mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello Spring MVC"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-修改springmvc-servlet-xml"><a class="header-anchor" href="#步骤-5-修改springmvc-servlet-xml">¶</a>步骤 5 : 修改springmvc-servlet.xml</h4>
<p>去掉映射相关的配置，因为已经使用<strong>注解方式</strong>了</p>
<p>增加</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"controller"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>表示从包controller下扫描有**@Controller**注解的类</p>
<p>最好直接复制这段配置代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context        </span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"irViewResolver"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/page/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;bean id="simpleUrlHandlerMapping" --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;property name="mappings"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--             &lt;props&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                 &lt;prop key="/index"&gt;indexController&lt;/prop&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--             &lt;/props&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;/property&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;/bean&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;bean id="indexController" class="controller.IndexController"&gt;&lt;/bean&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v6"><a class="header-anchor" href="#步骤-6-测试-v6">¶</a>步骤 6 : 测试</h4>
<p>打开页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/index</span></span><br></pre></td></tr></table></figure>
<p>看到的效果和通过配置是一样的</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1909.png" alt></p>
<h4 id="步骤-7-练习"><a class="header-anchor" href="#步骤-7-练习">¶</a>步骤 7 : 练习</h4>
<p>把/hello 跳转到 /hello.jsp 的配置，改为注解来实现</p>
<h3 id="4、接受表单数据"><a class="header-anchor" href="#4、接受表单数据">¶</a>4、接受表单数据</h3>
<p>浏览器提交数据是非常常见的场景，本例演示用户提交产品名称和价格到Spring MVC Spring MVC如何接受数据</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v66"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v66">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>访问页面提交数据</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-2-模仿和排错-v66"><a class="header-anchor" href="#步骤-2-模仿和排错-v66">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v26"><a class="header-anchor" href="#步骤-3-效果-v26">¶</a>步骤 3 : 效果</h4>
<p>这是通过页面增加产品名称和价格后，Spring MVC接受到参数，并显示出来</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1917.png" alt></p>
<h4 id="步骤-4-pojo"><a class="header-anchor" href="#步骤-4-pojo">¶</a>步骤 4 : pojo</h4>
<p>实体类Product</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-addProduct-jsp"><a class="header-anchor" href="#步骤-5-addProduct-jsp">¶</a>步骤 5 : addProduct.jsp</h4>
<p>在<strong>web目录下</strong> （不是在WEB-INF下）增加商品的页面addProduct.jsp<br>
<strong>注意</strong>：产品名称input的name要使用<strong>name</strong>，<strong>而不是</strong> <a href="http://product.name" target="_blank" rel="noopener">product.name</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;form action=<span class="string">"addProduct"</span>&gt;</span><br><span class="line"> </span><br><span class="line">    产品名称 ：&lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span> value=<span class="string">""</span>&gt;&lt;br /&gt;</span><br><span class="line">    产品价格： &lt;input type=<span class="string">"text"</span> name=<span class="string">"price"</span> value=<span class="string">""</span>&gt;&lt;br /&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> value=<span class="string">"增加商品"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-ProductController"><a class="header-anchor" href="#步骤-6-ProductController">¶</a>步骤 6 : ProductController</h4>
<p>控制器ProductController，准备一个add方法映射/addProduct路径</p>
<p>为add方法准备一个Product 参数，用于接收注入</p>
<p>最后跳转到showProduct页面显示用户提交的数据</p>
<p><strong>注：</strong> [addProduct.jsp] 提交的name和price会自动注入到参数 product里<br>
<strong>注：</strong> 参数product会默认被当做值加入到ModelAndView 中，相当于：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mav.addObject(<span class="string">"product"</span>,product);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ModelAttribute;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductController</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/addProduct"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">add</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"showProduct"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-showProduct-jsp"><a class="header-anchor" href="#步骤-7-showProduct-jsp">¶</a>步骤 7 : showProduct.jsp</h4>
<p>在<strong>WEB-INF/page</strong> 目录下创建 showProduct.jsp<br>
用 EL 表达式显示用户提交的名称和价格</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">产品名称： $&#123;product.name&#125;&lt;br&gt;</span><br><span class="line">产品价格： $&#123;product.price&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试-v3"><a class="header-anchor" href="#步骤-8-测试-v3">¶</a>步骤 8 : 测试</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>提交数据，显示结果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1915.png" alt></p>
<h4 id="步骤-9-练习-v3"><a class="header-anchor" href="#步骤-9-练习-v3">¶</a>步骤 9 : 练习</h4>
<p>参考本例的addProduct，做一个addCategory</p>
<h3 id="5、客户端跳转-v2"><a class="header-anchor" href="#5、客户端跳转-v2">¶</a>5、客户端跳转</h3>
<p>在前面的例子中，无论是/index跳转到index.jsp 还是/addProduct 跳转到showProduct.jsp，都是[服务端跳转]。</p>
<p>本例讲解如何进行[客户端跳转]</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v67"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v67">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v67"><a class="header-anchor" href="#步骤-2-模仿和排错-v67">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v27"><a class="header-anchor" href="#步骤-3-效果-v27">¶</a>步骤 3 : 效果</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/jump</span></span><br></pre></td></tr></table></figure>
<p>结果客户端跳转到了<br>
<strong>127.0.0.1:8080/springmvc/index</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1920.png" alt></p>
<h4 id="步骤-4-修改IndexController-v2"><a class="header-anchor" href="#步骤-4-修改IndexController-v2">¶</a>步骤 4 : 修改IndexController</h4>
<p>首先映射/jump到jump()方法<br>
在jump()中编写如下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/index"</span>);</span><br></pre></td></tr></table></figure>
<p><strong>redirect:/index</strong><br>
即表示客户端跳转的意思</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index"</span>);</span><br><span class="line">        mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello Spring MVC"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/jump"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">jump</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/index"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;  </span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试-v5"><a class="header-anchor" href="#步骤-5-测试-v5">¶</a>步骤 5 : 测试</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/jump</span></span><br></pre></td></tr></table></figure>
<p>结果客户端跳转到了<br>
<strong>127.0.0.1:8080/springmvc/index</strong></p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1919.png" alt></p>
<h4 id="步骤-6"><a class="header-anchor" href="#步骤-6">¶</a>步骤 6 :</h4>
<p>通过访问路径/hello 跳转到/index</p>
<h3 id="6、如何使用SESSION"><a class="header-anchor" href="#6、如何使用SESSION">¶</a>6、如何使用SESSION</h3>
<p>Session在用户登录，一些特殊场合在页面间传递数据的时候会经常用到</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v68"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v68">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v68"><a class="header-anchor" href="#步骤-2-模仿和排错-v68">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v28"><a class="header-anchor" href="#步骤-3-效果-v28">¶</a>步骤 3 : 效果</h4>
<p>访问路径/check，可以不停刷新session中记录的访问次数</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1922.png" alt></p>
<h4 id="步骤-4-修改IndexController-v3"><a class="header-anchor" href="#步骤-4-修改IndexController-v3">¶</a>步骤 4 : 修改IndexController</h4>
<p>映射 /check 到方法check()<br>
为方法check()提供<strong>参数HttpSession session</strong>，这样就可以在方法体中使用session了<br>
接下来的逻辑就是每次访问为session中的count+1.<br>
最后跳转到check.jsp页面</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"index"</span>);</span><br><span class="line">        mav.addObject(<span class="string">"message"</span>, <span class="string">"Hello Spring MVC"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/jump"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">jump</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/index"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/check"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">check</span><span class="params">(HttpSession session)</span> </span>&#123;</span><br><span class="line">        Integer i = (Integer) session.getAttribute(<span class="string">"count"</span>);</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="keyword">null</span>)</span><br><span class="line">            i = <span class="number">0</span>;</span><br><span class="line">        i++;</span><br><span class="line">        session.setAttribute(<span class="string">"count"</span>, i);</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"check"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-check-jsp"><a class="header-anchor" href="#步骤-5-check-jsp">¶</a>步骤 5 : check.jsp</h4>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">session中记录的访问次数：$&#123;count&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v7"><a class="header-anchor" href="#步骤-6-测试-v7">¶</a>步骤 6 : 测试</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/check</span></span><br></pre></td></tr></table></figure>
<p>每次访问，次数都+1</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1925.png" alt></p>
<h4 id="步骤-7-练习-v2"><a class="header-anchor" href="#步骤-7-练习-v2">¶</a>步骤 7 : 练习</h4>
<p>配置一个路径 /clear</p>
<p>访问该路径后，清空session中的count. 并且客户端跳转到/check</p>
<h3 id="7、中文问题"><a class="header-anchor" href="#7、中文问题">¶</a>7、中文问题</h3>
<p>在Spring MVC中处理中文问题和[Filter处理中文问题]是一样的手段</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v69"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v69">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v69"><a class="header-anchor" href="#步骤-2-模仿和排错-v69">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v29"><a class="header-anchor" href="#步骤-3-效果-v29">¶</a>步骤 3 : 效果</h4>
<p>访问地址提交中文</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1927.png" alt></p>
<h4 id="步骤-4-Filter"><a class="header-anchor" href="#步骤-4-Filter">¶</a>步骤 4 : Filter</h4>
<p>修改web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">"2.4"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee</span></span></span><br><span class="line"><span class="tag"><span class="string">http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">            org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">        <span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-addProduct-jsp-v2"><a class="header-anchor" href="#步骤-5-addProduct-jsp-v2">¶</a>步骤 5 : addProduct.jsp</h4>
<p>为form 设置method=“post”</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;form action=<span class="string">"addProduct"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line"> </span><br><span class="line">    产品名称 ：&lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span> value=<span class="string">""</span>&gt;&lt;br /&gt;</span><br><span class="line">    产品价格： &lt;input type=<span class="string">"text"</span> name=<span class="string">"price"</span> value=<span class="string">""</span>&gt;&lt;br /&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> value=<span class="string">"增加商品"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v8"><a class="header-anchor" href="#步骤-6-测试-v8">¶</a>步骤 6 : 测试</h4>
<p>重启tomcat,访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/addProduct.jsp</span></span><br></pre></td></tr></table></figure>
<p>提交数据</p>
<p><strong>注：</strong> SpringMVC会自动检测类发生的变化，但是web.xml做的改动还是必须重启tomcat才可以看到效果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1930.png" alt></p>
<h3 id="8、上传文件"><a class="header-anchor" href="#8、上传文件">¶</a>8、上传文件</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v70"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v70">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v70"><a class="header-anchor" href="#步骤-2-模仿和排错-v70">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-效果-v30"><a class="header-anchor" href="#步骤-3-效果-v30">¶</a>步骤 3 : 效果</h4>
<p>访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/upload.jsp</span></span><br></pre></td></tr></table></figure>
<p>这个通过springmvc上传图片，并显示的效果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1931.png" alt></p>
<h4 id="步骤-4-配置web-xml允许访问-jpg"><a class="header-anchor" href="#步骤-4-配置web-xml允许访问-jpg">¶</a>步骤 4 : 配置web.xml允许访问*.jpg</h4>
<p>在web.xml中新增加一段</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.jpg<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>表示允许访问*.jpg。</p>
<p>为什么要加这一段呢？ 因为配置springmvc的servlet的时候，使用的路径是**&quot;/&quot;**，导致静态资源在默认情况下不能访问，所以要加上这一段，允许访问jpg。 <strong>并且必须加在springmvc的servlet之前</strong></p>
<p>如果你配置spring-mvc使用的路径是/*.do，就不会有这个问题了。<br>
<strong>注：</strong> 这里仅仅是允许访问jpg,如果你要显示png,gif那么需要额外进行配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">"2.4"</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee</span></span></span><br><span class="line"><span class="tag"><span class="string">http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>default<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.jpg<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">            org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">        <span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-配置springmvc-servlet-xml"><a class="header-anchor" href="#步骤-5-配置springmvc-servlet-xml">¶</a>步骤 5 : 配置springmvc-servlet.xml</h4>
<p>新增加一段配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>开放对上传功能的支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context        </span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"irViewResolver"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/page/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-upload-jsp-上传页面"><a class="header-anchor" href="#步骤-6-upload-jsp-上传页面">¶</a>步骤 6 : upload.jsp 上传页面</h4>
<p>上传页面，需要注意的是form 的两个属性必须提供<br>
method=“post” 和 enctype=“multipart/form-data” 缺一不可<br>
上传组件 增加一个属性 <strong>accept=“image/*”</strong> 表示只能选择图片进行上传<br>
留意 &lt;input type=“file” name=“<strong>image</strong>” accept=“image/*” /&gt; 这个image，后面会用到这个<strong>image</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;form action=<span class="string">"uploadImage"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">  选择图片:&lt;input type=<span class="string">"file"</span> name=<span class="string">"image"</span> accept=<span class="string">"image/*"</span> /&gt; &lt;br&gt;</span><br><span class="line">  &lt;input type=<span class="string">"submit"</span> value=<span class="string">"上传"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-准备UploadedImageFile"><a class="header-anchor" href="#步骤-7-准备UploadedImageFile">¶</a>步骤 7 : 准备UploadedImageFile</h4>
<p>在UploadedImageFile中封装MultipartFile类型的字段 image ，用于接受页面的注入</p>
<p>这里的字段 image必须和上传页面upload.jsp中的image<br>
&lt;input type=“file” name=“<strong>image</strong>” accept=“image/*” /&gt;<br>
保持一致</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadedImageFile</span> </span>&#123;</span><br><span class="line">    MultipartFile image;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> MultipartFile <span class="title">getImage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> image;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setImage</span><span class="params">(MultipartFile image)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.image = image;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-UploadController-上传控制器"><a class="header-anchor" href="#步骤-8-UploadController-上传控制器">¶</a>步骤 8 : UploadController 上传控制器</h4>
<p>新建类UploadController 作为上传控制器<br>
准备方法upload 映射上传路径/uploadImage</p>
<ol>
<li>方法的第二个参数UploadedImageFile 中已经注入好了 image</li>
<li>通过 RandomStringUtils.randomAlphanumeric(10);获取一个随机文件名。 因为用户可能上传相同文件名的文件，为了不覆盖原来的文件，通过随机文件名的办法来规避</li>
<li>根据request.getServletContext().getRealPath 获取到web目录下的image目录，用于存放上传后的文件。</li>
<li>调用file.getImage().transferTo(newFile); 复制文件</li>
<li>把生成的随机文件名提交给视图，用于后续的显示</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.xwork.RandomStringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> pojo.UploadedImageFile;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/uploadImage"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">upload</span><span class="params">(HttpServletRequest request, UploadedImageFile file)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IllegalStateException, IOException </span>&#123;</span><br><span class="line">        String name = RandomStringUtils.randomAlphanumeric(<span class="number">10</span>);</span><br><span class="line">        String newFileName = name + <span class="string">".jpg"</span>;</span><br><span class="line">        File newFile = <span class="keyword">new</span> File(request.getServletContext().getRealPath(<span class="string">"/image"</span>), newFileName);</span><br><span class="line">        newFile.getParentFile().mkdirs();</span><br><span class="line">        file.getImage().transferTo(newFile);</span><br><span class="line"> </span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"showUploadedFile"</span>);</span><br><span class="line">        mav.addObject(<span class="string">"imageName"</span>, newFileName);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-showUploadedFile-jsp-显示图片的页面"><a class="header-anchor" href="#步骤-9-showUploadedFile-jsp-显示图片的页面">¶</a>步骤 9 : showUploadedFile.jsp 显示图片的页面</h4>
<p>在WEB-INF/page 下新建文件showUploadedFile 显示上传的图片</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;img src=<span class="string">"image/$&#123;imageName&#125;"</span>/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-测试"><a class="header-anchor" href="#步骤-10-测试">¶</a>步骤 10 : 测试</h4>
<p>访问页面</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/upload.jsp</span></span><br></pre></td></tr></table></figure>
<p>选择jpg文件进行上传</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/1937.png" alt></p>
<h4 id="步骤-11-练习-v3"><a class="header-anchor" href="#步骤-11-练习-v3">¶</a>步骤 11 : 练习</h4>
<p>修改配置，以支持动态图片gif</p>
<h3 id="9、拦截器"><a class="header-anchor" href="#9、拦截器">¶</a>9、拦截器</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v71"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v71">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v71"><a class="header-anchor" href="#步骤-2-模仿和排错-v71">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前面的知识点"><a class="header-anchor" href="#步骤-3-基于前面的知识点">¶</a>步骤 3 : 基于前面的知识点</h4>
<p>本知识点基于 [视图定位] 进行</p>
<h4 id="步骤-4-效果"><a class="header-anchor" href="#步骤-4-效果">¶</a>步骤 4 : 效果</h4>
<p>访问地址之后，看到如图所示的拦截器打印的效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/index</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4543.png" alt></p>
<h4 id="步骤-5-拦截器类：IndexInterceptor"><a class="header-anchor" href="#步骤-5-拦截器类：IndexInterceptor">¶</a>步骤 5 : 拦截器类：IndexInterceptor</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> interceptor;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.handler.HandlerInterceptorAdapter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexInterceptor</span> <span class="keyword">extends</span> <span class="title">HandlerInterceptorAdapter</span> </span>&#123; </span><br><span class="line"> </span><br><span class="line">     <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 在业务处理器处理请求之前被调用 </span></span><br><span class="line"><span class="comment">     * 如果返回false </span></span><br><span class="line"><span class="comment">     *     从当前的拦截器往回执行所有拦截器的afterCompletion(),再退出拦截器链</span></span><br><span class="line"><span class="comment">     * 如果返回true </span></span><br><span class="line"><span class="comment">     *    执行下一个拦截器,直到所有的拦截器都执行完毕 </span></span><br><span class="line"><span class="comment">     *    再执行被拦截的Controller </span></span><br><span class="line"><span class="comment">     *    然后进入拦截器链, </span></span><br><span class="line"><span class="comment">     *    从最后一个拦截器往回执行所有的postHandle() </span></span><br><span class="line"><span class="comment">     *    接着再从最后一个拦截器往回执行所有的afterCompletion() </span></span><br><span class="line"><span class="comment">     */</span>   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request,   </span></span></span><br><span class="line"><span class="function"><span class="params">            HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">         </span><br><span class="line">        System.out.println(<span class="string">"preHandle(), 在访问Controller之前被调用"</span>); </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">         </span><br><span class="line">    &#125; </span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在业务处理器处理请求执行完成后,生成视图之前执行的动作   </span></span><br><span class="line"><span class="comment">     * 可在modelAndView中加入数据，比如当前时间</span></span><br><span class="line"><span class="comment">     */</span> </span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request,   </span></span></span><br><span class="line"><span class="function"><span class="params">            HttpServletResponse response, Object handler,   </span></span></span><br><span class="line"><span class="function"><span class="params">            ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line">        System.out.println(<span class="string">"postHandle(), 在访问Controller之后，访问视图之前被调用,这里可以注入一个时间到modelAndView中，用于后续视图显示"</span>);</span><br><span class="line">        modelAndView.addObject(<span class="string">"date"</span>,<span class="string">"由拦截器生成的时间:"</span> + <span class="keyword">new</span> Date());</span><br><span class="line">    &#125; </span><br><span class="line"> </span><br><span class="line">    <span class="comment">/** </span></span><br><span class="line"><span class="comment">     * 在DispatcherServlet完全处理完请求后被调用,可用于清理资源等  </span></span><br><span class="line"><span class="comment">     *  </span></span><br><span class="line"><span class="comment">     * 当有拦截器抛出异常时,会从当前拦截器往回执行所有的拦截器的afterCompletion() </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request,   </span></span></span><br><span class="line"><span class="function"><span class="params">            HttpServletResponse response, Object handler, Exception ex)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> Exception </span>&#123; </span><br><span class="line">           </span><br><span class="line">        System.out.println(<span class="string">"afterCompletion(), 在访问视图之后被调用"</span>); </span><br><span class="line">    &#125; </span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-配置拦截器"><a class="header-anchor" href="#步骤-6-配置拦截器">¶</a>步骤 6 : 配置拦截器</h4>
<p>修改springmvc-servlet.xml以对/index路径进行拦截</p>
<p>如果要拦截其他路径：<br>
/** 拦截所有<br>
/category/** 拦截/category路径下的所有</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd </span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context </span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context/spring-context-3.0.xsd </span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc </span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"viewResolver"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/page/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"simpleUrlHandlerMapping"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappings"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/index"</span>&gt;</span>indexController<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"indexController"</span> <span class="attr">class</span>=<span class="string">"controller.IndexController"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span>   </span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span>   </span><br><span class="line">            <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/index"</span>/&gt;</span> </span><br><span class="line">            <span class="comment">&lt;!-- 定义在mvc:interceptor下面的表示是对特定的请求才进行拦截的 --&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"interceptor.IndexInterceptor"</span>/&gt;</span>     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span> </span><br><span class="line">        <span class="comment">&lt;!-- 当设置多个拦截器时，先按顺序调用preHandle方法，然后逆序调用每个拦截器的postHandle和afterCompletion方法 --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">         </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-修改-index-jsp"><a class="header-anchor" href="#步骤-7-修改-index-jsp">¶</a>步骤 7 : 修改 index.jsp</h4>
<p>打印拦截器放进去的日期</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;h1&gt;$&#123;message&#125;&lt;/h1&gt;</span><br><span class="line"> </span><br><span class="line">&lt;p&gt;$&#123;date&#125;&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试-v4"><a class="header-anchor" href="#步骤-8-测试-v4">¶</a>步骤 8 : 测试</h4>
<p>访问地址之后，看到如图所示的拦截器打印的效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/springmvc/index</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4542.png" alt></p>
<h1 id="玖、MYBATIS"><a class="header-anchor" href="#玖、MYBATIS">¶</a>玖、MYBATIS</h1>
<h2 id="一、基础-v3"><a class="header-anchor" href="#一、基础-v3">¶</a>一、基础</h2>
<h3 id="1、入门教程"><a class="header-anchor" href="#1、入门教程">¶</a>1、入门教程</h3>
<p>平时我们都用JDBC访问数据库，除了需要自己写SQL之外，还必须操作Connection, Statement, ResultSet 这些其实只是手段的辅助类。 不仅如此，访问不同的表，还会写很多雷同的代码，显得繁琐和枯燥。</p>
<p>那么用了Mybatis之后，只需要自己提供SQL语句，其他的工作，诸如建立连接，Statement， JDBC相关异常处理等等都交给Mybatis去做了，那些重复性的工作Mybatis也给做掉了，我们只需要关注在增删改查等操作层面上，而把技术细节都封装在了我们看不见的地方。</p>
<p><strong>必读：</strong> 基于框架的程序要成功运行，对于JAR包的版本，配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致框架程序运行失败。 如果你是第一次学习本框架，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-学习之前先看效果-v2"><a class="header-anchor" href="#步骤-1-学习之前先看效果-v2">¶</a>步骤 1 : 学习之前先看效果</h4>
<p>这两条数据就是通过mybatis从数据库中查询出来的</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4195.png" alt></p>
<h4 id="步骤-2-创建数据库-v2"><a class="header-anchor" href="#步骤-2-创建数据库-v2">¶</a>步骤 2 : 创建数据库</h4>
<p>首先创建数据库 how2java<br>
如果没有安装数据库，请参考 [安装mysql-server]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database how2java</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-创建表-v2"><a class="header-anchor" href="#步骤-3-创建表-v2">¶</a>步骤 3 : 创建表</h4>
<p>接着创建表category_</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE how2java;</span><br><span class="line"> </span><br><span class="line">CREATE TABLE category_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  name varchar(32) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) ENGINE&#x3D;MyISAM AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-导入数据"><a class="header-anchor" href="#步骤-4-导入数据">¶</a>步骤 4 : 导入数据</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">USE how2java;</span><br><span class="line">INSERT INTO category_ VALUES (null,&#39;category1&#39;);</span><br><span class="line">INSERT INTO category_ VALUES (null,&#39;category2&#39;);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-先运行，看到效果，再学习"><a class="header-anchor" href="#步骤-5-先运行，看到效果，再学习">¶</a>步骤 5 : 先运行，看到效果，再学习</h4>
<p>先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-6-模仿和排错"><a class="header-anchor" href="#步骤-6-模仿和排错">¶</a>步骤 6 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-7-创建项目"><a class="header-anchor" href="#步骤-7-创建项目">¶</a>步骤 7 : 创建项目</h4>
<p>通过ecipse创建java project: <strong>mybatis</strong><br>
项目目录<strong>必须是</strong> <strong>e:\project\mybatis</strong><br>
因为后续的学习都是基于这个位置，以及在右上方下载的可运行项目中的jar包依赖位置也是这里，所以请务必使用这个项目目录，有助于在使用本教程的过程中提高相当的学习效率。<br>
用其他项目位置反而会带来不必要的困扰</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4199.png" alt></p>
<h4 id="步骤-8-导入jar包"><a class="header-anchor" href="#步骤-8-导入jar包">¶</a>步骤 8 : 导入jar包</h4>
<p>本项目用到了两个jar包，在右上角的lib.rar中下载。<br>
下载解压后，在项目目录e:/project/mybatis下新建目录lib,并复制过来<br>
然后通过ecipse在mybatis的项目上导入这两个jar包</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4200.png" alt></p>
<h4 id="步骤-9-创建实体类"><a class="header-anchor" href="#步骤-9-创建实体类">¶</a>步骤 9 : 创建实体类</h4>
<p>准备实体类Category，用于映射表category_</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-配置文件mybatis-config-xml"><a class="header-anchor" href="#步骤-10-配置文件mybatis-config-xml">¶</a>步骤 10 : 配置文件mybatis-config.xml</h4>
<p>在src目录下创建mybatis的主配置文件<strong>mybatis-config.xml</strong> (相当于hibernate.cfg.xml，如果没有hibernate基础请忽略本句)。<br>
其作用主要是提供连接数据库用的驱动，数据库名称，编码方式，账号密码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>以及别名，自动扫描com.how2java.pojo下的类型，使得在后续[配置文件Category.xml]中使用resultType的时候，可以直接使用Category,而不必写全com.how2java.pojo.Category</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>映射Category.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-配置文件Category-xml"><a class="header-anchor" href="#步骤-11-配置文件Category-xml">¶</a>步骤 11 : 配置文件Category.xml</h4>
<p>在包com.how2java.pojo下，新建文件<strong>Category.xml</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">namespace=<span class="string">"com.how2java.pojo"</span></span><br></pre></td></tr></table></figure>
<p>表示命名空间是com.how2java.pojo，在后续调用sql语句的时候，会用到它<br>
里面定义了一条sql语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from   category_</span><br></pre></td></tr></table></figure>
<p>这条sql语句用id: <strong>listCategory</strong> 进行标示以供后续代码调用。<strong>resultType=“Category”</strong> 表示返回的数据和Category关联起来，这里本应该使用的是 com.how2java.pojo.Category, 但是因为上一步配置了别名，所以直接使用Category就行了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-测试类TestMybatis"><a class="header-anchor" href="#步骤-12-测试类TestMybatis">¶</a>步骤 12 : 测试类TestMybatis</h4>
<p>运行并观察到如图所示的结果。<br>
根据[配置文件mybatis-config.xml]得到sqlSessionFactory 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br></pre></td></tr></table></figure>
<p>然后再根据sqlSessionFactory 得到session</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session=sqlSessionFactory.openSession();</span><br></pre></td></tr></table></figure>
<p>最后通过session的selectList方法，调用sql语句listCategory。listCategory这个就是在[配置文件Category.xml]中那条sql语句设置的id。<br>
执行完毕之后，得到一个Category集合，遍历即可看到数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line"><span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">	System.out.println(c.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> session.selectList(“listCategory”); 也可以写成 session.selectList(“com.how2java.pojo.listCategory”); 效果一样。 但是我嫌弃其臃肿，不愿采用这种方式</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4204.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session=sqlSessionFactory.openSession();</span><br><span class="line">         </span><br><span class="line">        List&lt;Category&gt; cs=session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-基本原理图"><a class="header-anchor" href="#步骤-13-基本原理图">¶</a>步骤 13 : 基本原理图</h4>
<ol>
<li>应用程序找Mybatis要数据</li>
<li>mybatis从数据库中找来数据<br>
2.1 通过mybatis-config.xml 定位哪个数据库<br>
2.2 通过Category.xml执行对应的select语句<br>
2.3 基于Category.xml把返回的数据库记录封装在Category对象中<br>
2.4 把多个Category对象装在一个Category集合中</li>
<li>返回一个Category集合</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/" alt><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4205.png" alt="4205"></p>
<h4 id="步骤-14-可运行的项目"><a class="header-anchor" href="#步骤-14-可运行的项目">¶</a>步骤 14 : 可运行的项目</h4>
<p>如果老是搞不出来，就使用右上角的已经配置好的可运行项目搞一把。 然后比对自己哪一部分不一样，定位问题所在。</p>
<h4 id="步骤-15-练习"><a class="header-anchor" href="#步骤-15-练习">¶</a>步骤 15 : 练习</h4>
<p>参考Category，做一个Product类的mybatis查询。 Product类有三个属性：<br>
int id<br>
String name<br>
float price</p>
<h3 id="2、CRUD"><a class="header-anchor" href="#2、CRUD">¶</a>2、CRUD</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v72"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v72">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v72"><a class="header-anchor" href="#步骤-2-模仿和排错-v72">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-在前一步的基础上进行"><a class="header-anchor" href="#步骤-3-在前一步的基础上进行">¶</a>步骤 3 : 在前一步的基础上进行</h4>
<p>这一个知识点讲解通过Mybatis进行CRUD一套操作，建立在上一个知识点[Mybatis 入门教程]的基础上进行。</p>
<h4 id="步骤-4-配置文件Category-xml"><a class="header-anchor" href="#步骤-4-配置文件Category-xml">¶</a>步骤 4 : 配置文件Category.xml</h4>
<p>首先一次性修改配置文件Category.xml，提供CRUD对应的sql语句。<br>
每个SQL如何使用在后续对应操作里一一讲解。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-增加"><a class="header-anchor" href="#步骤-5-增加">¶</a>步骤 5 : 增加</h4>
<p>运行之后，如图所示可以看到 通过Mybatis查询出来的数据里有<strong>新增加的Category</strong></p>
<p>通过session.insert调用addCategory对应的SQL语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Category c = <span class="keyword">new</span> Category();</span><br><span class="line">c.setName(<span class="string">"新增加的Category"</span>);</span><br><span class="line">session.insert(<span class="string">"addCategory"</span>,c);</span><br></pre></td></tr></table></figure>
<p>addCategory对应的插入sql语句，#{name}会自动获取c对象的name属性值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id&#x3D;&quot;addCategory&quot; parameterType&#x3D;&quot;Category&quot; &gt;</span><br><span class="line">    insert into category_ ( name ) values (#&#123;name&#125;)    </span><br><span class="line">&lt;&#x2F;insert&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4214.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Category c = <span class="keyword">new</span> Category();</span><br><span class="line">        c.setName(<span class="string">"新增加的Category"</span>);</span><br><span class="line">        session.insert(<span class="string">"addCategory"</span>,c);</span><br><span class="line">         </span><br><span class="line">        listAll(session);</span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">    insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-删除"><a class="header-anchor" href="#步骤-6-删除">¶</a>步骤 6 : 删除</h4>
<p>删除id=6的对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Category c = <span class="keyword">new</span> Category();</span><br><span class="line">c.setId(<span class="number">6</span>);</span><br><span class="line">session.delete(<span class="string">"deleteCategory"</span>,c);</span><br></pre></td></tr></table></figure>
<p>deleteCategory对应删除的sql语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">    delete from category_ where id= #&#123;id&#125;   </span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Category c = <span class="keyword">new</span> Category();</span><br><span class="line">        c.setId(<span class="number">6</span>);</span><br><span class="line">        session.delete(<span class="string">"deleteCategory"</span>,c);</span><br><span class="line">         </span><br><span class="line">        listAll(session);</span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">    delete from category_ where id= #&#123;id&#125;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-获取"><a class="header-anchor" href="#步骤-7-获取">¶</a>步骤 7 : 获取</h4>
<p>通过session.selectOne获取id=3的记录</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Category c= session.selectOne(<span class="string">"getCategory"</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>getCategory对应的sql语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id&#x3D;&quot;getCategory&quot; parameterType&#x3D;&quot;_int&quot; resultType&#x3D;&quot;Category&quot;&gt;</span><br><span class="line">    select * from   category_  where id&#x3D; #&#123;id&#125;    </span><br><span class="line">&lt;&#x2F;select&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Category c= session.selectOne(<span class="string">"getCategory"</span>,<span class="number">3</span>);</span><br><span class="line">         </span><br><span class="line">        System.out.println(c.getName());</span><br><span class="line">         </span><br><span class="line"><span class="comment">//      listAll(session);</span></span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">    select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-修改"><a class="header-anchor" href="#步骤-8-修改">¶</a>步骤 8 : 修改</h4>
<p>通过session.update进行修改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.update(<span class="string">"updateCategory"</span>,c);</span><br></pre></td></tr></table></figure>
<p>updateCategory对应的sql语句：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">    update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;    </span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Category c= session.selectOne(<span class="string">"getCategory"</span>,<span class="number">3</span>);</span><br><span class="line">        c.setName(<span class="string">"修改了的Category名稱"</span>);</span><br><span class="line">        session.update(<span class="string">"updateCategory"</span>,c);</span><br><span class="line">         </span><br><span class="line">        listAll(session);</span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">    update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-查询所有"><a class="header-anchor" href="#步骤-9-查询所有">¶</a>步骤 9 : 查询所有</h4>
<p>session.selectList执行查询语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br></pre></td></tr></table></figure>
<p>listCategory对应的sql语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">    select * from   category_      </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        listAll(session);</span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">"listCategory"</span> resultType=<span class="string">"Category"</span>&gt;</span><br><span class="line">    select * from   category_     </span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<h3 id="3、多条件查询和模糊查询实例"><a class="header-anchor" href="#3、多条件查询和模糊查询实例">¶</a>3、多条件查询和模糊查询实例</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v73"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v73">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v73"><a class="header-anchor" href="#步骤-2-模仿和排错-v73">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-在前一步的基础上进行-v2"><a class="header-anchor" href="#步骤-3-在前一步的基础上进行-v2">¶</a>步骤 3 : 在前一步的基础上进行</h4>
<p>这一个知识点建立在[Mybatis 入门教程]的基础上进行。</p>
<h4 id="步骤-4-模糊查询"><a class="header-anchor" href="#步骤-4-模糊查询">¶</a>步骤 4 : 模糊查询</h4>
<ol>
<li>修改Category.xml，提供listCategoryByName查询语句</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="function">from   category_  where name like <span class="title">concat</span><span class="params">(<span class="string">'%'</span>,#&#123;<span class="number">0</span>&#125;,<span class="string">'%'</span>)</span></span></span><br></pre></td></tr></table></figure>
<p><strong>concat(’%’,#{0},’%’)</strong> 这是mysql的写法<br>
如果是oracle，写法是</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from   category_  where name like '%'||#&#123;0&#125;||'%'</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>运行测试</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategoryByName"</span>,<span class="string">"cat"</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4221.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategoryByName"</span>  <span class="attr">parameterType</span>=<span class="string">"string"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where name like concat('%',#&#123;0&#125;,'%')</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategoryByName"</span>,<span class="string">"cat"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-多条件查询"><a class="header-anchor" href="#步骤-5-多条件查询">¶</a>步骤 5 : 多条件查询</h4>
<p>结合前面的模糊查询，多一个id&gt;多少的条件</p>
<ol>
<li>Category.xml 准备sql语句</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">"listCategoryByIdAndName"</span>  parameterType=<span class="string">"map"</span> resultType=<span class="string">"Category"</span>&gt;</span><br><span class="line">    select * from   category_  where id&gt; #&#123;id&#125;  and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>测试代码<br>
因为是多个参数，而selectList方法又只接受一个参数对象，所以需要把多个参数放在Map里，然后把这个Map对象作为参数传递进去</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">params.put(<span class="string">"id"</span>, <span class="number">3</span>);</span><br><span class="line">params.put(<span class="string">"name"</span>, <span class="string">"cat"</span>);</span><br><span class="line">List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategoryByIdAndName"</span>,params);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4222.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategoryByName"</span>  <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where name like concat('%',#&#123;0&#125;,'%')</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategoryByIdAndName"</span>  <span class="attr">parameterType</span>=<span class="string">"map"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id&gt; #&#123;id&#125;  and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        params.put(<span class="string">"id"</span>, <span class="number">3</span>);</span><br><span class="line">        params.put(<span class="string">"name"</span>, <span class="string">"cat"</span>);</span><br><span class="line">         </span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategoryByIdAndName"</span>,params);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、一对多"><a class="header-anchor" href="#4、一对多">¶</a>4、一对多</h3>
<h4 id="步骤-1-分类和产品的一对多关系"><a class="header-anchor" href="#步骤-1-分类和产品的一对多关系">¶</a>步骤 1 : 分类和产品的一对多关系</h4>
<p>在本知识点做分类和产品的一对多关系，建立在上[Mybatis 入门教程]的基础上进行。</p>
<p>一个分类对应多个产品</p>
<h4 id="步骤-2-表结构"><a class="header-anchor" href="#步骤-2-表结构">¶</a>步骤 2 : 表结构</h4>
<p>分类表不变化，新增加产品表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">create table product_(</span><br><span class="line">id int NOT NULL AUTO_INCREMENT,</span><br><span class="line">name varchar(30)  DEFAULT NULL,</span><br><span class="line">price float  DEFAULT 0,</span><br><span class="line">cid int ,</span><br><span class="line">PRIMARY KEY (id)</span><br><span class="line">)AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-准备数据-v2"><a class="header-anchor" href="#步骤-3-准备数据-v2">¶</a>步骤 3 : 准备数据</h4>
<p>清空category_ 和 product_ 表<br>
新增2条分类数据，id分别是1,2<br>
新增6条产品数据，分别关联上述2条分类数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">delete from category_;</span><br><span class="line">INSERT INTO category_ VALUES (1,&#39;category1&#39;);</span><br><span class="line">INSERT INTO category_ VALUES (2,&#39;category2&#39;);</span><br><span class="line">delete from product_;</span><br><span class="line">INSERT INTO product_ VALUES (1,&#39;product a&#39;, 88.88, 1);</span><br><span class="line">INSERT INTO product_ VALUES (2,&#39;product b&#39;, 88.88, 1);</span><br><span class="line">INSERT INTO product_ VALUES (3,&#39;product c&#39;, 88.88, 1);</span><br><span class="line">INSERT INTO product_ VALUES (4,&#39;product x&#39;, 88.88, 2);</span><br><span class="line">INSERT INTO product_ VALUES (5,&#39;product y&#39;, 88.88, 2);</span><br><span class="line">INSERT INTO product_ VALUES (6,&#39;product z&#39;, 88.88, 2);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-先运行，看到效果，再学习"><a class="header-anchor" href="#步骤-4-先运行，看到效果，再学习">¶</a>步骤 4 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-5-模仿和排错"><a class="header-anchor" href="#步骤-5-模仿和排错">¶</a>步骤 5 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-6-效果"><a class="header-anchor" href="#步骤-6-效果">¶</a>步骤 6 : 效果</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4233.png" alt></p>
<h4 id="步骤-7-Product实体类"><a class="header-anchor" href="#步骤-7-Product实体类">¶</a>步骤 7 : Product实体类</h4>
<p>普通的一个pojo</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Product [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">", price="</span> + price + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-修改Category实体类"><a class="header-anchor" href="#步骤-8-修改Category实体类">¶</a>步骤 8 : 修改Category实体类</h4>
<p>修改Category实体类，提供products的集合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    List&lt;Product&gt; products;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Category [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-暂时无需-Product-xml"><a class="header-anchor" href="#步骤-9-暂时无需-Product-xml">¶</a>步骤 9 : 暂时无需 Product.xml</h4>
<p>本例演示通过分类对产品的一对多，暂时无需 Product.xml</p>
<h4 id="步骤-10-修改Category-xml"><a class="header-anchor" href="#步骤-10-修改Category-xml">¶</a>步骤 10 : 修改Category.xml</h4>
<p>通过left join关联查询，对Category和Product表进行关联查询。<br>
与前面学习的有所区别，这里不是用的resultType, 而是resultMap，通过resultMap把数据取出来放在<strong>对应的</strong> 对象属性里<br>
<strong>注</strong>： Category的id 字段 和Product的id字段同名，Mybatis不知道谁是谁的，所以需要通过取别名cid,pid来区分。<br>
name字段同理。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Category"</span> <span class="attr">id</span>=<span class="string">"categoryBean"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cname"</span> <span class="attr">property</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">     </span><br><span class="line">            <span class="comment">&lt;!-- 一对多的关系 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- property: 指的是集合属性的值, ofType：指的是集合中元素的类型 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"products"</span> <span class="attr">ofType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">        <span class="comment">&lt;!-- 关联查询分类和产品表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultMap</span>=<span class="string">"categoryBean"</span>&gt;</span></span><br><span class="line">            select c.*, p.*, c.id 'cid', p.id 'pid', c.name 'cname', p.name 'pname' from category_ c left join product_ p on c.id = p.cid</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-测试运行TestMybatis"><a class="header-anchor" href="#步骤-11-测试运行TestMybatis">¶</a>步骤 11 : 测试运行TestMybatis</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4234.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c);</span><br><span class="line">            List&lt;Product&gt; ps = c.getProducts();</span><br><span class="line">            <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">                System.out.println(<span class="string">"\t"</span>+p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、多对一"><a class="header-anchor" href="#5、多对一">¶</a>5、多对一</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v74"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v74">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v74"><a class="header-anchor" href="#步骤-2-模仿和排错-v74">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-多对一关系"><a class="header-anchor" href="#步骤-3-多对一关系">¶</a>步骤 3 : 多对一关系</h4>
<p>本知识点建立在[一对多]的基础上讲解多对一关系</p>
<h4 id="步骤-4-学习之前先看效果"><a class="header-anchor" href="#步骤-4-学习之前先看效果">¶</a>步骤 4 : 学习之前先看效果</h4>
<p>这是多对一查询效果，查询出所有的产品，同时对于每个产品，还能看到其所对应的分类</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4237.png" alt></p>
<h4 id="步骤-5-修改Product-java"><a class="header-anchor" href="#步骤-5-修改Product-java">¶</a>步骤 5 : 修改Product.java</h4>
<p>为Product增加category属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    <span class="keyword">private</span> Category category;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCategory</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.category = category;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Product [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">", price="</span> + price + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-Product-xml"><a class="header-anchor" href="#步骤-6-Product-xml">¶</a>步骤 6 : Product.xml</h4>
<p>提供Product.xml，通过listProduct配置关联查询的sql语句。<br>
然后通过resultMap ，进行字段和属性的对应。<br>
使用association 进行多对一关系关联，指定表字段名称与对象属性名称的一一对应关系<br>
<strong>注：</strong> Category的id 字段 和Product的id字段同名，Mybatis不知道谁是谁的，所以需要通过取别名cid,pid来区分。<br>
name字段同理。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Product"</span> <span class="attr">id</span>=<span class="string">"productBean"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">     </span><br><span class="line">            <span class="comment">&lt;!-- 多对一的关系 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- property: 指的是属性名称, javaType：指的是属性的类型 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"category"</span> <span class="attr">javaType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">        <span class="comment">&lt;!-- 根据id查询Product, 关联将Orders查询出来 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultMap</span>=<span class="string">"productBean"</span>&gt;</span></span><br><span class="line">            select c.*, p.*, c.id 'cid', p.id 'pid', c.name 'cname', p.name 'pname' from category_ c left join product_ p on c.id = p.cid</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-mybatis-config-xml"><a class="header-anchor" href="#步骤-7-mybatis-config-xml">¶</a>步骤 7 : mybatis-config.xml</h4>
<p>在mybatis-config.xml中增加对于Product.xml的映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-TestMybatis"><a class="header-anchor" href="#步骤-8-TestMybatis">¶</a>步骤 8 : TestMybatis</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4241.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        List&lt;Product&gt; ps = session.selectList(<span class="string">"listProduct"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p+<span class="string">" 对应的分类是 \t "</span>+ p.getCategory());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-可运行的项目"><a class="header-anchor" href="#步骤-9-可运行的项目">¶</a>步骤 9 : 可运行的项目</h4>
<p>在右上角有本知识点对应的可运行项目下载</p>
<h4 id="步骤-10-练习-修改多对一关系"><a class="header-anchor" href="#步骤-10-练习-修改多对一关系">¶</a>步骤 10 : 练习-修改多对一关系</h4>
<p>眼下的多对一关系是<br>
product(id=5) 对应 category(id=2)<br>
结合[CRUD] ，通过Mybatis，做到 product(id=5) 对应category(id=1</p>
<h3 id="6、多对多"><a class="header-anchor" href="#6、多对多">¶</a>6、多对多</h3>
<h4 id="步骤-1-定义多对多关系"><a class="header-anchor" href="#步骤-1-定义多对多关系">¶</a>步骤 1 : 定义多对多关系</h4>
<p>本知识点是基于[多对一]的基础上进行。<br>
在学习之前首先要理清楚多对多的关系，这里以订单Order和产品Product为例：<br>
一张订单里 可以包含多种产品<br>
一种产品 可以出现在多张订单里<br>
这就是多对多关系<br>
为了维系多对多关系，必须要一个中间表。 在这里我们使用订单项(OrderItem)表来作为中间表</p>
<p>本知识点讲解如何<strong>查询多对多关系</strong>，<strong>建立多对多关系</strong>，<strong>删除多对多关系</strong>。</p>
<h4 id="步骤-2-表结构-v2"><a class="header-anchor" href="#步骤-2-表结构-v2">¶</a>步骤 2 : 表结构</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">create table order_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  code varchar(32) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) ENGINE&#x3D;MyISAM AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8;</span><br><span class="line"> </span><br><span class="line">create table order_item_(</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT, </span><br><span class="line">  oid int ,</span><br><span class="line">  pid int ,</span><br><span class="line">  number int ,</span><br><span class="line">  PRIMARY KEY(id)</span><br><span class="line">)AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-导入数据"><a class="header-anchor" href="#步骤-3-导入数据">¶</a>步骤 3 : 导入数据</h4>
<p>在[一对多关系中准备的数据]里已经有Product数据里，这里就只准备订单数据和订单项数据：</p>
<ol>
<li>插入两个订单</li>
<li>插入6条订单项数据，建立如下关系<br>
2.1 订单1对应产品 1，2，3<br>
2.2 订单2对应产品 2，3，4</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO order_ VALUES (1,&#39;code000A&#39;);</span><br><span class="line">INSERT INTO order_ VALUES (2,&#39;code000B&#39;);</span><br><span class="line"> </span><br><span class="line">INSERT INTO order_item_ VALUES (null, 1, 1, 100);</span><br><span class="line">INSERT INTO order_item_ VALUES (null, 1, 2, 100);</span><br><span class="line">INSERT INTO order_item_ VALUES (null, 1, 3, 100);</span><br><span class="line">INSERT INTO order_item_ VALUES (null, 2, 2, 100);</span><br><span class="line">INSERT INTO order_item_ VALUES (null, 2, 3, 100);</span><br><span class="line">INSERT INTO order_item_ VALUES (null, 2, 4, 100);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-先运行，看到效果，再学习-v2"><a class="header-anchor" href="#步骤-4-先运行，看到效果，再学习-v2">¶</a>步骤 4 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-5-模仿和排错-v2"><a class="header-anchor" href="#步骤-5-模仿和排错-v2">¶</a>步骤 5 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-6-实体类"><a class="header-anchor" href="#步骤-6-实体类">¶</a>步骤 6 : 实体类</h4>
<p>实体类Order和OrderItem</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderItem</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> number;</span><br><span class="line">    <span class="keyword">private</span> Order order;</span><br><span class="line">    <span class="keyword">private</span> Product product;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> number;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNumber</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Order <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> order;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrder</span><span class="params">(Order order)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">getProduct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProduct</span><span class="params">(Product product)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.product = product;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String code;</span><br><span class="line">     </span><br><span class="line">    List&lt;OrderItem&gt; orderItems;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(String code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title">getOrderItems</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderItems;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOrderItems</span><span class="params">(List&lt;OrderItem&gt; orderItems)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.orderItems = orderItems;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-映射文件"><a class="header-anchor" href="#步骤-7-映射文件">¶</a>步骤 7 : 映射文件</h4>
<p>关于映射文件的sql语句说明在后续测试的时候会讲解</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">//Order.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Order"</span> <span class="attr">id</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"code"</span> <span class="attr">property</span>=<span class="string">"code"</span> /&gt;</span></span><br><span class="line">             </span><br><span class="line">            <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"orderItems"</span> <span class="attr">ofType</span>=<span class="string">"OrderItem"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oiid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"product"</span> <span class="attr">javaType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">association</span>&gt;</span>               </span><br><span class="line">            <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listOrder"</span> <span class="attr">resultMap</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">            select o.*,p.*,oi.*, o.id 'oid', p.id 'pid', oi.id 'oiid', p.name 'pname'</span><br><span class="line">                from order_ o</span><br><span class="line">                left join order_item_ oi    on o.id =oi.oid</span><br><span class="line">                left join product_ p on p.id = oi.pid</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getOrder"</span> <span class="attr">resultMap</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">            select o.*,p.*,oi.*, o.id 'oid', p.id 'pid', oi.id 'oiid', p.name 'pname'</span><br><span class="line">                from order_ o</span><br><span class="line">                left join order_item_ oi on o.id =oi.oid</span><br><span class="line">                left join product_ p on p.id = oi.pid</span><br><span class="line">            where o.id = #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//Product.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Product"</span> <span class="attr">id</span>=<span class="string">"productBean"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span> /&gt;</span></span><br><span class="line">     </span><br><span class="line">            <span class="comment">&lt;!-- 多对一的关系 --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- property: 指的是属性名称, javaType：指的是属性的类型 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"category"</span> <span class="attr">javaType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"cid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"cname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultMap</span>=<span class="string">"productBean"</span>&gt;</span></span><br><span class="line">            select c.*, p.*, c.id 'cid', p.id 'pid', c.name 'cname', p.name 'pname'</span><br><span class="line">                from category_ c</span><br><span class="line">                left join product_ p on c.id = p.cid</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>   </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getProduct"</span> <span class="attr">resultMap</span>=<span class="string">"productBean"</span>&gt;</span></span><br><span class="line">            select c.*, p.*, c.id 'cid', p.id 'pid', c.name 'cname', p.name 'pname'</span><br><span class="line">                from category_ c</span><br><span class="line">                left join product_ p on c.id = p.cid</span><br><span class="line">            where p.id = #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//OrderItem.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addOrderItem"</span> <span class="attr">parameterType</span>=<span class="string">"OrderItem"</span>&gt;</span></span><br><span class="line">            insert into order_item_</span><br><span class="line">                values(null,#&#123;order.id&#125;,#&#123;product.id&#125;,#&#123;number&#125;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span>   </span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"deleteOrderItem"</span> <span class="attr">parameterType</span>=<span class="string">"OrderItem"</span>&gt;</span></span><br><span class="line">            delete from order_item_</span><br><span class="line">                where oid = #&#123;order.id&#125; and pid = #&#123;product.id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-修改mybatis-config-xml"><a class="header-anchor" href="#步骤-8-修改mybatis-config-xml">¶</a>步骤 8 : 修改mybatis-config.xml</h4>
<p>添加对于Order.xml和OrderItem的映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Product.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Order.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/OrderItem.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-查询操作"><a class="header-anchor" href="#步骤-9-查询操作">¶</a>步骤 9 : 查询操作</h4>
<p>如图所示，查询出所有的订单，然后遍历每个订单下的多条订单项，以及订单项对应的产品名称，价格，购买数量</p>
<p>通过Order.xml的listOrder对应的sql语句进行查询：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listOrder"</span> <span class="attr">resultMap</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">	select o.*,p.*,oi.*, o.id 'oid', p.id 'pid', oi.id 'oiid', p.name 'pname' </span><br><span class="line">		from order_ o </span><br><span class="line">		left join order_item_ oi	on o.id =oi.oid </span><br><span class="line">		left join product_ p on p.id = oi.pid </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>联合order_, order_item_, product_ 三张表进行查询</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Order"</span> <span class="attr">id</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"code"</span> <span class="attr">property</span>=<span class="string">"code"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"orderItems"</span> <span class="attr">ofType</span>=<span class="string">"OrderItem"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oiid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"product"</span> <span class="attr">javaType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">association</span>&gt;</span>				</span><br><span class="line">	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>查询结果 id和code字段放在Order对象里， 然后通过一对多的&lt;collection&gt;标签把oiid和number放在OrderItem对象里，最后把pid,pname,price放进Product对象里。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4252.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Order;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        listOrder(session);</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listOrder</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Order&gt; os = session.selectList(<span class="string">"listOrder"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Order o : os) &#123;</span><br><span class="line">            System.out.println(o.getCode());</span><br><span class="line">            List&lt;OrderItem&gt; ois= o.getOrderItems();</span><br><span class="line">            <span class="keyword">for</span> (OrderItem oi : ois) &#123;</span><br><span class="line">                System.out.format(<span class="string">"\t%s\t%f\t%d%n"</span>, oi.getProduct().getName(),oi.getProduct().getPrice(),oi.getNumber());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-建立关系"><a class="header-anchor" href="#步骤-10-建立关系">¶</a>步骤 10 : 建立关系</h4>
<p>如图所示，建立了让订单000A和产品z建立了关系<br>
首先通过id分别获取Order对象和Product对象，然后创建一个新的OrderItem对象，接着设置Order，设置Product，设置数量，最后调用&quot;addOrderItem&quot; 对应的sql语句插入数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Order o1 = session.selectOne(<span class="string">"getOrder"</span>, <span class="number">1</span>);</span><br><span class="line">Product p6 = session.selectOne(<span class="string">"getProduct"</span>, <span class="number">6</span>);</span><br><span class="line">OrderItem oi = <span class="keyword">new</span> OrderItem();</span><br><span class="line">oi.setProduct(p6);</span><br><span class="line">oi.setOrder(o1);</span><br><span class="line">oi.setNumber(<span class="number">200</span>);</span><br><span class="line">session.insert(<span class="string">"addOrderItem"</span>, oi);</span><br></pre></td></tr></table></figure>
<p>addOrderItem调用insert into 语句插入一条OrderItem记录</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addOrderItem"</span> <span class="attr">parameterType</span>=<span class="string">"OrderItem"</span>&gt;</span></span><br><span class="line">	insert into order_item_ </span><br><span class="line">		values(null,#&#123;order.id&#125;,#&#123;product.id&#125;,#&#123;number&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4253.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Order;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        addOrderItem(session);</span><br><span class="line">        listOrder(session);</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addOrderItem</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        Order o1 = session.selectOne(<span class="string">"getOrder"</span>, <span class="number">1</span>);</span><br><span class="line">        Product p6 = session.selectOne(<span class="string">"getProduct"</span>, <span class="number">6</span>);</span><br><span class="line">        OrderItem oi = <span class="keyword">new</span> OrderItem();</span><br><span class="line">        oi.setProduct(p6);</span><br><span class="line">        oi.setOrder(o1);</span><br><span class="line">        oi.setNumber(<span class="number">200</span>);</span><br><span class="line"> </span><br><span class="line">        session.insert(<span class="string">"addOrderItem"</span>, oi);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listOrder</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Order&gt; os = session.selectList(<span class="string">"listOrder"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Order o : os) &#123;</span><br><span class="line">            System.out.println(o.getCode());</span><br><span class="line">            List&lt;OrderItem&gt; ois = o.getOrderItems();</span><br><span class="line">            <span class="keyword">for</span> (OrderItem oi : ois) &#123;</span><br><span class="line">                System.out.format(<span class="string">"\t%s\t%f\t%d%n"</span>, oi.getProduct().getName(), oi.getProduct().getPrice(),</span><br><span class="line">                        oi.getNumber());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-删除关系"><a class="header-anchor" href="#步骤-11-删除关系">¶</a>步骤 11 : 删除关系</h4>
<p>如图所示，删除了订单00A和产品z的关系，再次查询，就看不到产品z了。<br>
删除关系的时候，通过订单id(1)和产品id(6)进行删除。<br>
其实所谓的删除关系，就是删除掉OrderItem记录。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4254.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Order;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        deleteOrderItem(session);</span><br><span class="line"><span class="comment">//        addOrderItem(session);</span></span><br><span class="line">        listOrder(session);</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteOrderItem</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        Order o1 = session.selectOne(<span class="string">"getOrder"</span>,<span class="number">1</span>);</span><br><span class="line">        Product p6 = session.selectOne(<span class="string">"getProduct"</span>,<span class="number">6</span>);</span><br><span class="line">        OrderItem oi = <span class="keyword">new</span> OrderItem();</span><br><span class="line">        oi.setProduct(p6);</span><br><span class="line">        oi.setOrder(o1);</span><br><span class="line">        session.delete(<span class="string">"deleteOrderItem"</span>, oi);     </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addOrderItem</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        Order o1 = session.selectOne(<span class="string">"getOrder"</span>,<span class="number">1</span>);</span><br><span class="line">        Product p6 = session.selectOne(<span class="string">"getProduct"</span>,<span class="number">6</span>);</span><br><span class="line">        OrderItem oi = <span class="keyword">new</span> OrderItem();</span><br><span class="line">        oi.setProduct(p6);</span><br><span class="line">        oi.setOrder(o1);</span><br><span class="line">        oi.setNumber(<span class="number">200</span>);</span><br><span class="line">         </span><br><span class="line">        session.insert(<span class="string">"addOrderItem"</span>, oi);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listOrder</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        List&lt;Order&gt; os = session.selectList(<span class="string">"listOrder"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Order o : os) &#123;</span><br><span class="line">            System.out.println(o.getCode());</span><br><span class="line">            List&lt;OrderItem&gt; ois= o.getOrderItems();</span><br><span class="line">            <span class="keyword">for</span> (OrderItem oi : ois) &#123;</span><br><span class="line">                System.out.format(<span class="string">"\t%s\t%f\t%d%n"</span>, oi.getProduct().getName(),oi.getProduct().getPrice(),oi.getNumber());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-修改关系"><a class="header-anchor" href="#步骤-12-修改关系">¶</a>步骤 12 : 修改关系</h4>
<p>多对多不存在修改关系的做法，就是删除旧的，然后新增一条即达到修改的效果。</p>
<h4 id="步骤-13-可运行的项目"><a class="header-anchor" href="#步骤-13-可运行的项目">¶</a>步骤 13 : 可运行的项目</h4>
<p>在右上角有本知识点对应的可运行项目下载</p>
<h4 id="步骤-14-练习-删除订单时，删除对应的订单项"><a class="header-anchor" href="#步骤-14-练习-删除订单时，删除对应的订单项">¶</a>步骤 14 : 练习-删除订单时，删除对应的订单项</h4>
<p>比如删除订单A，那么就应该删除订单A在订单项里所对应的数据。</p>
<p>提示，通过Mybatis执行多条sql语句需要增加一个参数：allowMultiQueries</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8<span class="symbol">&amp;amp;</span>allowMultiQueries=true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Order;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line"><span class="comment">//        deleteOrderItem(session);</span></span><br><span class="line"><span class="comment">//        addOrderItem(session);</span></span><br><span class="line"><span class="comment">//        </span></span><br><span class="line"><span class="comment">//        deleteOrder(session);</span></span><br><span class="line">        listOrder(session);</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteOrder</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> id = <span class="number">1</span>;</span><br><span class="line">		</span><br><span class="line">		session.delete(<span class="string">"deleteOrder"</span>,id);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">deleteOrderItem</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">		Order o1 = session.selectOne(<span class="string">"getOrder"</span>,<span class="number">1</span>);</span><br><span class="line">        Product p6 = session.selectOne(<span class="string">"getProduct"</span>,<span class="number">6</span>);</span><br><span class="line">        OrderItem oi = <span class="keyword">new</span> OrderItem();</span><br><span class="line">        oi.setProduct(p6);</span><br><span class="line">        oi.setOrder(o1);</span><br><span class="line">        session.delete(<span class="string">"deleteOrderItem"</span>, oi);		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addOrderItem</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">		Order o1 = session.selectOne(<span class="string">"getOrder"</span>,<span class="number">1</span>);</span><br><span class="line">        Product p6 = session.selectOne(<span class="string">"getProduct"</span>,<span class="number">6</span>);</span><br><span class="line">        OrderItem oi = <span class="keyword">new</span> OrderItem();</span><br><span class="line">        oi.setProduct(p6);</span><br><span class="line">        oi.setOrder(o1);</span><br><span class="line">        oi.setNumber(<span class="number">200</span>);</span><br><span class="line">        </span><br><span class="line">        session.insert(<span class="string">"addOrderItem"</span>, oi);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listOrder</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">		List&lt;Order&gt; os = session.selectList(<span class="string">"listOrder"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Order o : os) &#123;</span><br><span class="line">			System.out.println(o.getCode());</span><br><span class="line">			List&lt;OrderItem&gt; ois= o.getOrderItems();</span><br><span class="line">			<span class="keyword">for</span> (OrderItem oi : ois) &#123;</span><br><span class="line">				System.out.format(<span class="string">"\t%s\t%f\t%d%n"</span>, oi.getProduct().getName(),oi.getProduct().getPrice(),oi.getNumber());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">	<span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Order"</span> <span class="attr">id</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"code"</span> <span class="attr">property</span>=<span class="string">"code"</span> /&gt;</span></span><br><span class="line">			</span><br><span class="line">			<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"orderItems"</span> <span class="attr">ofType</span>=<span class="string">"OrderItem"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"oiid"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"number"</span> <span class="attr">property</span>=<span class="string">"number"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"product"</span> <span class="attr">javaType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"pid"</span> <span class="attr">property</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"pname"</span> <span class="attr">property</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"price"</span> <span class="attr">property</span>=<span class="string">"price"</span>/&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">association</span>&gt;</span>				</span><br><span class="line">			<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">				</span><br><span class="line">		<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listOrder"</span> <span class="attr">resultMap</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">			select o.*,p.*,oi.*, o.id 'oid', p.id 'pid', oi.id 'oiid', p.name 'pname' </span><br><span class="line">				from order_ o </span><br><span class="line">				left join order_item_ oi	on o.id =oi.oid </span><br><span class="line">				left join product_ p on p.id = oi.pid </span><br><span class="line">		<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteOrder"</span> &gt;</span></span><br><span class="line">			delete from order_item_ where oid = #&#123;id&#125;;</span><br><span class="line">		    delete from order_ where id= #&#123;id&#125;;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">delete</span>&gt;</span>	</span><br><span class="line">		    </span><br><span class="line">		<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getOrder"</span> <span class="attr">resultMap</span>=<span class="string">"orderBean"</span>&gt;</span></span><br><span class="line">			select o.*,p.*,oi.*, o.id 'oid', p.id 'pid', oi.id 'oiid', p.name 'pname' </span><br><span class="line">				from order_ o </span><br><span class="line">				left join order_item_ oi on o.id =oi.oid </span><br><span class="line">				left join product_ p on p.id = oi.pid </span><br><span class="line">			where o.id = #&#123;id&#125; </span><br><span class="line">		<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="二、动态SQL"><a class="header-anchor" href="#二、动态SQL">¶</a>二、动态SQL</h2>
<h3 id="1、IF-标签例子"><a class="header-anchor" href="#1、IF-标签例子">¶</a>1、IF 标签例子</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v75"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v75">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v75"><a class="header-anchor" href="#步骤-2-模仿和排错-v75">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前面的教程上进行"><a class="header-anchor" href="#步骤-3-基于前面的教程上进行">¶</a>步骤 3 : 基于前面的教程上进行</h4>
<p>这个知识点要对Product做不少的查询操作，所以基于 [多对一] 的基础上进行，因为在这个系列教程中，到那一步，才用到了Product这个类。</p>
<h4 id="步骤-4-执行不同的条件限定，需要准备两条sql语句"><a class="header-anchor" href="#步骤-4-执行不同的条件限定，需要准备两条sql语句">¶</a>步骤 4 : 执行不同的条件限定，需要准备两条sql语句</h4>
<p>假设需要对Product执行两条sql语句，一个是查询所有，一个是根据名称模糊查询。<br>
那么按照现在的方式，必须提供两条sql语句：listProduct和listProductByName<br>
然后在调用的时候，分别调用它们来执行。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4266.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//Product.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">            select * from product_         </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProductByName"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">            select * from product_  where name like concat('%',#&#123;name&#125;,'%')        </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">"查询所有的"</span>);</span><br><span class="line">        List&lt;Product&gt; ps = session.selectList(<span class="string">"listProduct"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        System.out.println(<span class="string">"模糊查询"</span>);</span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        params.put(<span class="string">"name"</span>,<span class="string">"a"</span>);</span><br><span class="line">        List&lt;Product&gt; ps2 = session.selectList(<span class="string">"listProductByName"</span>,params);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps2) &#123;</span><br><span class="line">            System.out.println(p);</span><br><span class="line">        &#125;      </span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-if标签"><a class="header-anchor" href="#步骤-5-if标签">¶</a>步骤 5 : if标签</h4>
<p>如果Product的字段比较多的话，为了应付各个字段的查询，那么就需要写多条sql语句，这样就变得难以维护。<br>
这个时候，就可以使用Mybatis 动态SQL里的if标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">	select * from product_</span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">		where name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span>		 	</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果没有传参数name,那么就查询所有，如果有name参数，那么就进行模糊查询。<br>
这样只需要定义一条sql语句即可应付多种情况了，在测试的时候，也只需要调用这么一条sql语句listProduct 即可。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4267.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//Product.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">            select * from product_</span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">                where name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span>        </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">"查询所有的"</span>);</span><br><span class="line">        List&lt;Product&gt; ps = session.selectList(<span class="string">"listProduct"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        System.out.println(<span class="string">"模糊查询"</span>);</span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        params.put(<span class="string">"name"</span>,<span class="string">"a"</span>);</span><br><span class="line">        List&lt;Product&gt; ps2 = session.selectList(<span class="string">"listProduct"</span>,params);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps2) &#123;</span><br><span class="line">            System.out.println(p);</span><br><span class="line">        &#125;      </span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-可运行项目下载"><a class="header-anchor" href="#步骤-6-可运行项目下载">¶</a>步骤 6 : 可运行项目下载</h4>
<p>在右上角有本知识点对应的可运行项目下载</p>
<h3 id="2、WHERE-SET-TRIM-标签例子"><a class="header-anchor" href="#2、WHERE-SET-TRIM-标签例子">¶</a>2、WHERE SET TRIM 标签例子</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v76"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v76">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v76"><a class="header-anchor" href="#步骤-2-模仿和排错-v76">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于上一个知识点进行"><a class="header-anchor" href="#步骤-3-基于上一个知识点进行">¶</a>步骤 3 : 基于上一个知识点进行</h4>
<p>基于上一个知识点[if 标签]进行</p>
<h4 id="步骤-4-多条件的矛盾"><a class="header-anchor" href="#步骤-4-多条件的矛盾">¶</a>步骤 4 : 多条件的矛盾</h4>
<p>如果要进行多条件判断，就会写成这样：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">	select * from product_</span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">		where name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span>		 	</span><br><span class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price!=0"</span>&gt;</span></span><br><span class="line">		and price &gt; #&#123;price&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span>		 	</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这么写的问题是：当没有name参数，却有price参数的时候，执行的sql语句就会是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from product_ and price &gt; 10.</span><br></pre></td></tr></table></figure>
<p>这样执行就会报错</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4270.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">        select * from product_</span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">            where name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span>        </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price!=0"</span>&gt;</span></span><br><span class="line">            and price &gt; #&#123;price&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">"多条件查询"</span>);</span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        params.put(<span class="string">"name"</span>,<span class="string">"a"</span>);</span><br><span class="line">        params.put(<span class="string">"price"</span>,<span class="string">"10"</span>);</span><br><span class="line">        List&lt;Product&gt; ps2 = session.selectList(<span class="string">"listProduct"</span>,params);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps2) &#123;</span><br><span class="line">            System.out.println(p);</span><br><span class="line">        &#125;      </span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-where标签"><a class="header-anchor" href="#步骤-5-where标签">¶</a>步骤 5 : where标签</h4>
<p>这个问题可以通过&lt;where&gt;标签来解决，如代码所示</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">	select * from product_</span><br><span class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">			and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span>		 	</span><br><span class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price!=null and price!=0"</span>&gt;</span></span><br><span class="line">			and price &gt; #&#123;price&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span>	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span>	 	</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&lt;where&gt;标签会进行自动判断<br>
如果任何条件都不成立，那么就在sql语句里就不会出现where关键字<br>
如果有任何条件成立，会自动去掉多出来的 and 或者 or。</p>
<p>所以在测试代码里</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Map<span class="tag">&lt;<span class="name">String,Object</span>&gt;</span> params = new HashMap<span class="tag">&lt;&gt;</span>(); </span><br><span class="line">//params.put("name","a");</span><br><span class="line">params.put("price","10");</span><br></pre></td></tr></table></figure>
<p>这个参数map，无论是否提供值否都可以正常执行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//Product.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">        select * from product_</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">                and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span>        </span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price!=null and price!=0"</span>&gt;</span></span><br><span class="line">                and price &gt; #&#123;price&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span>     </span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        System.out.println(<span class="string">"多条件查询"</span>);</span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="comment">//        params.put("name","a");</span></span><br><span class="line">        params.put(<span class="string">"price"</span>,<span class="string">"10"</span>);</span><br><span class="line">        List&lt;Product&gt; ps2 = session.selectList(<span class="string">"listProduct"</span>,params);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps2) &#123;</span><br><span class="line">            System.out.println(p);</span><br><span class="line">        &#125;      </span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-set标签"><a class="header-anchor" href="#步骤-6-set标签">¶</a>步骤 6 : set标签</h4>
<p>与[where标签]类似的，在update语句里也会碰到多个字段相关的问题。 在这种情况下，就可以使用set标签：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span>name=#&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price != null"</span>&gt;</span>price=#&#123;price&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其效果与where标签类似，有数据的时候才进行设置。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4274.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">//Product.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">        select * from product_</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">                and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span>        </span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price!=null and price!=0"</span>&gt;</span></span><br><span class="line">                and price &gt; #&#123;price&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span>     </span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateProduct"</span> <span class="attr">parameterType</span>=<span class="string">"Product"</span> &gt;</span></span><br><span class="line">        update product_</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span>name=#&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price != null"</span>&gt;</span>price=#&#123;price&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">              </span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">         where id=#&#123;id&#125;   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Product p = <span class="keyword">new</span> Product();</span><br><span class="line">        p.setId(<span class="number">6</span>);</span><br><span class="line">        p.setName(<span class="string">"product zz"</span>);</span><br><span class="line">        p.setPrice(<span class="number">99.99f</span>);</span><br><span class="line">        session.update(<span class="string">"updateProduct"</span>,p);</span><br><span class="line">         </span><br><span class="line">        listAll(session);</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="comment">//        params.put("name","a");</span></span><br><span class="line"><span class="comment">//        params.put("price","10");</span></span><br><span class="line">        List&lt;Product&gt; ps2 = session.selectList(<span class="string">"listProduct"</span>,params);</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps2) &#123;</span><br><span class="line">            System.out.println(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-trim标签"><a class="header-anchor" href="#步骤-7-trim标签">¶</a>步骤 7 : trim标签</h4>
<p>trim 用来定制想要的功能，比如where标签就可以用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"WHERE"</span> <span class="attr">prefixOverrides</span>=<span class="string">"AND |OR "</span>&gt;</span></span><br><span class="line">  ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>来替换</p>
<p>set标签就可以用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"SET"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>来替换<br>
运行[set标签]中的代码，其效果是一样的。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">        select * from product_</span><br><span class="line">        <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"WHERE"</span> <span class="attr">prefixOverrides</span>=<span class="string">"AND |OR "</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name!=null"</span>&gt;</span></span><br><span class="line">                and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span>        </span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price!=null and price!=0"</span>&gt;</span></span><br><span class="line">                and price &gt; #&#123;price&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">trim</span>&gt;</span>      </span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateProduct"</span> <span class="attr">parameterType</span>=<span class="string">"Product"</span> &gt;</span></span><br><span class="line">        update product_</span><br><span class="line">        <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"SET"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span>name=#&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"price != null"</span>&gt;</span>price=#&#123;price&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">              </span><br><span class="line">        <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">         where id=#&#123;id&#125;   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-可运行项目下载"><a class="header-anchor" href="#步骤-8-可运行项目下载">¶</a>步骤 8 : 可运行项目下载</h4>
<p>在右上角有本知识点对应的可运行项目下载</p>
<h3 id="3、CHOOSE-WHEN-OTHERWISE-标签例子"><a class="header-anchor" href="#3、CHOOSE-WHEN-OTHERWISE-标签例子">¶</a>3、CHOOSE WHEN OTHERWISE 标签例子</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v77"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v77">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v77"><a class="header-anchor" href="#步骤-2-模仿和排错-v77">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-if-else"><a class="header-anchor" href="#步骤-3-if-else">¶</a>步骤 3 : if else</h4>
<p>Mybatis里面没有else标签，但是可以使用when otherwise标签来达到这样的效果。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">	  SELECT * FROM product_ </span><br><span class="line">	  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">	  	<span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">		  <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span></span><br><span class="line">		    and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">		  <span class="tag">&lt;/<span class="name">when</span>&gt;</span>			  </span><br><span class="line">		  <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"price !=null and price != 0"</span>&gt;</span></span><br><span class="line">		    and price &gt; #&#123;price&#125;</span><br><span class="line">		  <span class="tag">&lt;/<span class="name">when</span>&gt;</span>			  		</span><br><span class="line">	  	  <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">	  	  	and id &gt;1</span><br><span class="line">	  	  <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">	  	<span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其作用是： 提供了任何条件，就进行条件查询，否则就使用id&gt;1这个条件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//Product.xml</span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">              SELECT * FROM product_</span><br><span class="line">              <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span></span><br><span class="line">                    and name like concat('%',#&#123;name&#125;,'%')</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">when</span>&gt;</span>          </span><br><span class="line">                  <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"price !=null and price != 0"</span>&gt;</span></span><br><span class="line">                    and price &gt; #&#123;price&#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">when</span>&gt;</span>                </span><br><span class="line">                  <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                    and id &gt;1</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="comment">//      params.put("name","a");</span></span><br><span class="line"><span class="comment">//      params.put("price","10");</span></span><br><span class="line">      List&lt;Product&gt; ps = session.selectList(<span class="string">"listProduct"</span>,params);</span><br><span class="line">      <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">          System.out.println(p);</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、FOREACH-标签例子"><a class="header-anchor" href="#4、FOREACH-标签例子">¶</a>4、FOREACH 标签例子</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v78"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v78">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v78"><a class="header-anchor" href="#步骤-2-模仿和排错-v78">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-foreach标签"><a class="header-anchor" href="#步骤-3-foreach标签">¶</a>步骤 3 : foreach标签</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM product_ </span><br><span class="line">	WHERE ID in</span><br><span class="line">		<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">collection</span>=<span class="string">"list"</span></span></span><br><span class="line"><span class="tag">   			<span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">     		             #&#123;item&#125;</span><br><span class="line">		<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>foreach标签通常用于in 这样的语法里，参考 [Oracle的in语法] 。<br>
如例，如图查询出id等于1,3,5的数据出来。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4279.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">          SELECT * FROM product_</span><br><span class="line">            WHERE ID in</span><br><span class="line">                <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">collection</span>=<span class="string">"list"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">                    #&#123;item&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        List&lt;Integer&gt; ids = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        ids.add(<span class="number">1</span>);</span><br><span class="line">        ids.add(<span class="number">3</span>);</span><br><span class="line">        ids.add(<span class="number">5</span>);</span><br><span class="line">         </span><br><span class="line">      List&lt;Product&gt; ps = session.selectList(<span class="string">"listProduct"</span>,ids);</span><br><span class="line">      <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">          System.out.println(p);</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5、BIND-标签例子"><a class="header-anchor" href="#5、BIND-标签例子">¶</a>5、BIND 标签例子</h4>
<h4 id="步骤-1-先运行，看到效果，再学习-v79"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v79">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v79"><a class="header-anchor" href="#步骤-2-模仿和排错-v79">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-bind标签"><a class="header-anchor" href="#步骤-3-bind标签">¶</a>步骤 3 : bind标签</h4>
<p>bind标签就像是再做一次字符串拼接，方便后续使用<br>
如本例，在[模糊查询]的基础上，把模糊查询改为bind标签。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 本来的模糊查询方式 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;select id="listProduct" resultType="Product"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--             select * from   product_  where name like concat('%',#&#123;0&#125;,'%') --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;/select&gt; --&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listProduct"</span> <span class="attr">resultType</span>=<span class="string">"Product"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">"likename"</span> <span class="attr">value</span>=<span class="string">"'%' + name + '%'"</span> /&gt;</span></span><br><span class="line">            select * from   product_  where name like #&#123;likename&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Map&lt;String, String&gt; params =<span class="keyword">new</span> HashMap();</span><br><span class="line">        params.put(<span class="string">"name"</span>, <span class="string">"product"</span>);</span><br><span class="line">         </span><br><span class="line">          List&lt;Product&gt; ps = session.selectList(<span class="string">"listProduct"</span>,params);</span><br><span class="line">          <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">              System.out.println(p);</span><br><span class="line">          &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="三、注解"><a class="header-anchor" href="#三、注解">¶</a>三、注解</h2>
<h3 id="1、通过注解方式实现增删改查-CRUD"><a class="header-anchor" href="#1、通过注解方式实现增删改查-CRUD">¶</a>1、通过注解方式实现增删改查 CRUD</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v80"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v80">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v80"><a class="header-anchor" href="#步骤-2-模仿和排错-v80">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-把XML方式的CRUD修改为注解方式"><a class="header-anchor" href="#步骤-3-把XML方式的CRUD修改为注解方式">¶</a>步骤 3 : 把XML方式的CRUD修改为注解方式</h4>
<p>本知识点把 [XML方式的CRUD] 修改为注解方式</p>
<h4 id="步骤-4-Mapper接口"><a class="header-anchor" href="#步骤-4-Mapper接口">¶</a>步骤 4 : Mapper接口</h4>
<p>新增加接口CategoryMapper ，并在接口中声明的方法上，加上注解<br>
对比[配置文件Category.xml]，其实就是把SQL语句从XML挪到了注解上来</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">" insert into category_ ( name ) values (#&#123;name&#125;) "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">" delete from category_ where id= #&#123;id&#125; "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ where id= #&#123;id&#125; "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">      </span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"update category_ set name=#&#123;name&#125; where id=#&#123;id&#125; "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;  </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-mybatis-config-xml"><a class="header-anchor" href="#步骤-5-mybatis-config-xml">¶</a>步骤 5 : mybatis-config.xml</h4>
<p>在第22行，增加对CategoryMapper映射，原来的Category.xml 是否保留随意</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试类"><a class="header-anchor" href="#步骤-6-测试类">¶</a>步骤 6 : 测试类</h4>
<p>进行CRUD的经典操作，来测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//        add(mapper);</span></span><br><span class="line"><span class="comment">//        delete(mapper);</span></span><br><span class="line"><span class="comment">//        get(mapper);</span></span><br><span class="line"><span class="comment">//        update(mapper);</span></span><br><span class="line">        listAll(mapper);</span><br><span class="line">              </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        Category c= mapper.get(<span class="number">8</span>);</span><br><span class="line">        c.setName(<span class="string">"修改了的Category名稱"</span>);</span><br><span class="line">        mapper.update(c);</span><br><span class="line">        listAll(mapper);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        Category c= mapper.get(<span class="number">8</span>);</span><br><span class="line">        System.out.println(c.getName());</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        mapper.delete(<span class="number">2</span>);</span><br><span class="line">        listAll(mapper);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        Category c = <span class="keyword">new</span> Category();</span><br><span class="line">        c.setName(<span class="string">"新增加的Category"</span>);</span><br><span class="line">        mapper.add(c);</span><br><span class="line">        listAll(mapper);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2、使用注解实现一对多"><a class="header-anchor" href="#2、使用注解实现一对多">¶</a>2、使用注解实现一对多</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v81"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v81">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v81"><a class="header-anchor" href="#步骤-2-模仿和排错-v81">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于XML方式的一对多进行"><a class="header-anchor" href="#步骤-3-基于XML方式的一对多进行">¶</a>步骤 3 : 基于XML方式的一对多进行</h4>
<p>本知识点在[XML方式的一对多]的基础上，进行修改，以实现注解方式的一对多</p>
<h4 id="步骤-4-效果-v2"><a class="header-anchor" href="#步骤-4-效果-v2">¶</a>步骤 4 : 效果</h4>
<p>如图所示，可以看到一对多查询结果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4321.png" alt></p>
<h4 id="步骤-5-CategoryMapper"><a class="header-anchor" href="#步骤-5-CategoryMapper">¶</a>步骤 5 : CategoryMapper</h4>
<p>新增加CategoryMapper接口，查询所有Category<br>
@Select注解获取Category类本身</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">" select * from category_ "</span>)</span><br></pre></td></tr></table></figure>
<p>@Results 通过@Result和@Many中调用ProductMapper.listByCategory()方法相结合，来获取一对多关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(property = <span class="string">"products"</span>, javaType = List<span class="class">.<span class="keyword">class</span>, <span class="title">column</span> </span>= <span class="string">"id"</span>,  </span><br><span class="line">          many = <span class="meta">@Many</span>(select = <span class="string">"com.how2java.mapper.ProductMapper.listByCategory"</span>))&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Many;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ "</span>)</span><br><span class="line">    <span class="meta">@Results</span>(&#123; </span><br><span class="line">                <span class="meta">@Result</span>(property = <span class="string">"id"</span>, column = <span class="string">"id"</span>),</span><br><span class="line">                <span class="meta">@Result</span>(property = <span class="string">"products"</span>, javaType = List<span class="class">.<span class="keyword">class</span>, <span class="title">column</span> </span>= <span class="string">"id"</span>, many = <span class="meta">@Many</span>(select = <span class="string">"com.how2java.mapper.ProductMapper.listByCategory"</span>) )</span><br><span class="line">            &#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-ProductMapper"><a class="header-anchor" href="#步骤-6-ProductMapper">¶</a>步骤 6 : ProductMapper</h4>
<p>新增接口ProductMapper<br>
注解@Select用于根据分类id获取产品集合<br>
@Select(&quot; select * from product_ where cid = #{cid}&quot;)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from product_ where cid = #&#123;cid&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">listByCategory</span><span class="params">(<span class="keyword">int</span> cid)</span></span>;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-mybatis-config-xml-v2"><a class="header-anchor" href="#步骤-7-mybatis-config-xml-v2">¶</a>步骤 7 : mybatis-config.xml</h4>
<p>添加ProductMapper和CategoryMapper的映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.ProductMapper"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试-v5"><a class="header-anchor" href="#步骤-8-测试-v5">¶</a>步骤 8 : 测试</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4319.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"> </span><br><span class="line">        listAll(mapper);</span><br><span class="line">              </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">            List&lt;Product&gt; ps = c.getProducts();</span><br><span class="line">            <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">                System.out.println(<span class="string">"\t"</span>+p.getName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、多对一"><a class="header-anchor" href="#3、多对一">¶</a>3、多对一</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v82"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v82">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v82"><a class="header-anchor" href="#步骤-2-模仿和排错-v82">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于XML方式的多对一进行"><a class="header-anchor" href="#步骤-3-基于XML方式的多对一进行">¶</a>步骤 3 : 基于XML方式的多对一进行</h4>
<p>本知识点在[XML方式的多对一]的基础上，进行修改，以实现注解方式的一对多</p>
<h4 id="步骤-4-多对一效果"><a class="header-anchor" href="#步骤-4-多对一效果">¶</a>步骤 4 : 多对一效果</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4323.png" alt></p>
<h4 id="步骤-5-CategoryMapper-v2"><a class="header-anchor" href="#步骤-5-CategoryMapper-v2">¶</a>步骤 5 : CategoryMapper</h4>
<p>新增CategoryMapper接口，提供get方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ where id = #&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-ProductMapper-v2"><a class="header-anchor" href="#步骤-6-ProductMapper-v2">¶</a>步骤 6 : ProductMapper</h4>
<p>新增ProductMapper接口，提供list方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.One;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from product_ "</span>)</span><br><span class="line">    <span class="meta">@Results</span>(&#123; </span><br><span class="line">        <span class="meta">@Result</span>(property=<span class="string">"category"</span>,column=<span class="string">"cid"</span>,one=<span class="meta">@One</span>(select=<span class="string">"com.how2java.mapper.CategoryMapper.get"</span>)) </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-mybatis-config-xml-v3"><a class="header-anchor" href="#步骤-7-mybatis-config-xml-v3">¶</a>步骤 7 : mybatis-config.xml</h4>
<p>在22，23行增加对CategoryMapper和ProductMapper的映射</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.ProductMapper"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试类"><a class="header-anchor" href="#步骤-8-测试类">¶</a>步骤 8 : 测试类</h4>
<p>运行测试类，看到如图所示效果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4327.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.ProductMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        ProductMapper mapper = session.getMapper(ProductMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"> </span><br><span class="line">        List&lt;Product&gt; ps= mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">            System.out.println(p + <span class="string">"\t对应的分类是:\t"</span> + p.getCategory().getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、注解方式的多对多查询"><a class="header-anchor" href="#4、注解方式的多对多查询">¶</a>4、注解方式的多对多查询</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v83"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v83">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v83"><a class="header-anchor" href="#步骤-2-模仿和排错-v83">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于XML方式的多对多进行"><a class="header-anchor" href="#步骤-3-基于XML方式的多对多进行">¶</a>步骤 3 : 基于XML方式的多对多进行</h4>
<p>本知识点在[基于XML方式的多对多]的基础上，改造成为注解的方式</p>
<h4 id="步骤-4-效果-v3"><a class="header-anchor" href="#步骤-4-效果-v3">¶</a>步骤 4 : 效果</h4>
<p>如图所示，运行测试遍历所有的订单，再通过一对多和多对一，间接地多对多遍历出产品。<br>
得到和[基于XML方式的多对多]一样的效果。</p>
<h4 id="步骤-5-ProductMapper"><a class="header-anchor" href="#步骤-5-ProductMapper">¶</a>步骤 5 : ProductMapper</h4>
<p>新增一个ProductMapper接口，提供 get方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ProductMapper</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from product_ where id = #&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-OrderItemMapper"><a class="header-anchor" href="#步骤-6-OrderItemMapper">¶</a>步骤 6 : OrderItemMapper</h4>
<p>新增OrderItemMapper，提供listByOrder方法。<br>
这里会与Product建立多对一关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.One;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.OrderItem;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderItemMapper</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from order_item_ where oid = #&#123;oid&#125;"</span>)</span><br><span class="line">    <span class="meta">@Results</span>(&#123; </span><br><span class="line">        <span class="meta">@Result</span>(property=<span class="string">"product"</span>,column=<span class="string">"pid"</span>,one=<span class="meta">@One</span>(select=<span class="string">"com.how2java.mapper.ProductMapper.get"</span>)) </span><br><span class="line">    &#125;) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;OrderItem&gt; <span class="title">listByOrder</span><span class="params">(<span class="keyword">int</span> oid)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-OrderMapper"><a class="header-anchor" href="#步骤-7-OrderMapper">¶</a>步骤 7 : OrderMapper</h4>
<p>新增OrderMapper，提供list方法，这里会与OrderItem建立一对多关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Many;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Order;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from order_"</span>)</span><br><span class="line">     <span class="meta">@Results</span>(&#123;</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"id"</span>, column = <span class="string">"id"</span>),</span><br><span class="line">            <span class="meta">@Result</span>(property = <span class="string">"orderItems"</span>, javaType = List<span class="class">.<span class="keyword">class</span>, <span class="title">column</span> </span>= <span class="string">"id"</span>, </span><br><span class="line">                    many = <span class="meta">@Many</span>(select = <span class="string">"com.how2java.mapper.OrderItemMapper.listByOrder"</span>))</span><br><span class="line">            &#125;)      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Order&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-修改mybatis-config-xml-v2"><a class="header-anchor" href="#步骤-8-修改mybatis-config-xml-v2">¶</a>步骤 8 : 修改mybatis-config.xml</h4>
<p>在25-27行，新增Mapper类的映射</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">PUBLIC <span class="string">"-//mybatis.org//DTD Config 3.0//EN"</span></span><br><span class="line"><span class="string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;typeAliases&gt;</span><br><span class="line">      &lt;<span class="keyword">package</span> name=<span class="string">"com.how2java.pojo"</span>/&gt;</span><br><span class="line">    &lt;/typeAliases&gt;</span><br><span class="line">    &lt;environments <span class="keyword">default</span>=<span class="string">"development"</span>&gt;</span><br><span class="line">        &lt;environment id=<span class="string">"development"</span>&gt;</span><br><span class="line">            &lt;transactionManager type=<span class="string">"JDBC"</span>/&gt;</span><br><span class="line">            &lt;dataSource type=<span class="string">"POOLED"</span>&gt;</span><br><span class="line">            &lt;property name=<span class="string">"driver"</span> value=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span><br><span class="line">            &lt;property name=<span class="string">"url"</span> value=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span><br><span class="line">            &lt;property name=<span class="string">"username"</span> value=<span class="string">"root"</span>/&gt;</span><br><span class="line">            &lt;property name=<span class="string">"password"</span> value=<span class="string">"admin"</span>/&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">        &lt;mapper resource=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span><br><span class="line">        &lt;mapper resource=<span class="string">"com/how2java/pojo/Product.xml"</span>/&gt;</span><br><span class="line">        &lt;mapper resource=<span class="string">"com/how2java/pojo/Order.xml"</span>/&gt;</span><br><span class="line">        &lt;mapper resource=<span class="string">"com/how2java/pojo/OrderItem.xml"</span>/&gt;</span><br><span class="line">        &lt;mapper <span class="class"><span class="keyword">class</span></span>=<span class="string">"com.how2java.mapper.OrderItemMapper"</span>/&gt;</span><br><span class="line">        &lt;mapper <span class="class"><span class="keyword">class</span></span>=<span class="string">"com.how2java.mapper.OrderMapper"</span>/&gt;</span><br><span class="line">        &lt;mapper <span class="class"><span class="keyword">class</span></span>=<span class="string">"com.how2java.mapper.ProductMapper"</span>/&gt;</span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-查询测试"><a class="header-anchor" href="#步骤-9-查询测试">¶</a>步骤 9 : 查询测试</h4>
<p>如图所示，运行测试遍历所有的订单，再通过一对多和多对一，间接地多对多遍历出产品。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4337.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.OrderMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Order;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">  </span><br><span class="line">        listOrder(session);</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listOrder</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        OrderMapper mapper =session.getMapper(OrderMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        List&lt;Order&gt; os = mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Order o : os) &#123;</span><br><span class="line">            System.out.println(o.getCode());</span><br><span class="line">            List&lt;OrderItem&gt; ois= o.getOrderItems();</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">null</span>!=ois)&#123;</span><br><span class="line">                <span class="keyword">for</span> (OrderItem oi : ois) &#123;</span><br><span class="line">                    System.out.format(<span class="string">"\t%s\t%f\t%d%n"</span>, oi.getProduct().getName(),oi.getProduct().getPrice(),oi.getNumber());</span><br><span class="line">                &#125;              </span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、注解方式的动态SQL语句"><a class="header-anchor" href="#5、注解方式的动态SQL语句">¶</a>5、注解方式的动态SQL语句</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v84"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v84">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v84"><a class="header-anchor" href="#步骤-2-模仿和排错-v84">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于手写SQL语句的注解CRUD"><a class="header-anchor" href="#步骤-3-基于手写SQL语句的注解CRUD">¶</a>步骤 3 : 基于手写SQL语句的注解CRUD</h4>
<p>把[手写SQL语句的注解CRUD]，修改为动态SQL语句方式。</p>
<h4 id="步骤-4-CategoryDynaSqlProvider"><a class="header-anchor" href="#步骤-4-CategoryDynaSqlProvider">¶</a>步骤 4 : CategoryDynaSqlProvider</h4>
<p>新增CategoryDynaSqlProvider，提供CRUD对应的SQL语句。<br>
这里的SQL语句使用<strong>SQL类</strong>的方式构建，在[ 关于SQL类]中有更加详细的讲解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.jdbc.SQL;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryDynaSqlProvider</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">new</span> SQL()</span><br><span class="line">                 .SELECT(<span class="string">"*"</span>)</span><br><span class="line">                 .FROM(<span class="string">"category_"</span>)</span><br><span class="line">                 .toString();</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</span><br><span class="line">                .SELECT(<span class="string">"*"</span>)</span><br><span class="line">                .FROM(<span class="string">"category_"</span>)</span><br><span class="line">                .WHERE(<span class="string">"id=#&#123;id&#125;"</span>)</span><br><span class="line">                .toString();</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</span><br><span class="line">                .INSERT_INTO(<span class="string">"category_"</span>)</span><br><span class="line">                .VALUES(<span class="string">"name"</span>, <span class="string">"#&#123;name&#125;"</span>)</span><br><span class="line">                .toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</span><br><span class="line">                .UPDATE(<span class="string">"category_"</span>)</span><br><span class="line">                .SET(<span class="string">"name=#&#123;name&#125;"</span>)</span><br><span class="line">                .WHERE(<span class="string">"id=#&#123;id&#125;"</span>)</span><br><span class="line">                .toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</span><br><span class="line">                .DELETE_FROM(<span class="string">"category_"</span>)</span><br><span class="line">                .WHERE(<span class="string">"id=#&#123;id&#125;"</span>)</span><br><span class="line">                .toString();</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-修改CategoryMapper"><a class="header-anchor" href="#步骤-5-修改CategoryMapper">¶</a>步骤 5 : 修改CategoryMapper</h4>
<p>把本来是[手写SQL的CategoryMapper接口]，修改为注解引用CategoryDynaSqlProvider类的方式<br>
比如增加，本来是手写SQL语句的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Insert</span>(<span class="string">" insert into category_ ( name ) values (#&#123;name&#125;) "</span>)  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>;</span><br></pre></td></tr></table></figure>
<p>修改为了注解@InsertProvider配合CategoryDynaSqlProvider的add方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@InsertProvider</span>(type=CategoryDynaSqlProvider<span class="class">.<span class="keyword">class</span>,<span class="title">method</span></span>=<span class="string">"add"</span>)  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.DeleteProvider;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.InsertProvider;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.SelectProvider;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.UpdateProvider;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.CategoryDynaSqlProvider;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@InsertProvider</span>(type=CategoryDynaSqlProvider<span class="class">.<span class="keyword">class</span>,<span class="title">method</span></span>=<span class="string">"add"</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@DeleteProvider</span>(type=CategoryDynaSqlProvider<span class="class">.<span class="keyword">class</span>,<span class="title">method</span></span>=<span class="string">"delete"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@SelectProvider</span>(type=CategoryDynaSqlProvider<span class="class">.<span class="keyword">class</span>,<span class="title">method</span></span>=<span class="string">"get"</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">      </span><br><span class="line">    <span class="meta">@UpdateProvider</span>(type=CategoryDynaSqlProvider<span class="class">.<span class="keyword">class</span>,<span class="title">method</span></span>=<span class="string">"update"</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;  </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@SelectProvider</span>(type=CategoryDynaSqlProvider<span class="class">.<span class="keyword">class</span>,<span class="title">method</span></span>=<span class="string">"list"</span>)     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-查询测试"><a class="header-anchor" href="#步骤-6-查询测试">¶</a>步骤 6 : 查询测试</h4>
<p>用同样的测试类，进行CRUD测试。注意，id值需要根据实际情况调整</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//        add(mapper);</span></span><br><span class="line"><span class="comment">//        delete(mapper);</span></span><br><span class="line"><span class="comment">//        get(mapper);</span></span><br><span class="line"><span class="comment">//        update(mapper);</span></span><br><span class="line">        listAll(mapper);</span><br><span class="line">              </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        Category c= mapper.get(<span class="number">14</span>);</span><br><span class="line">        c.setName(<span class="string">"修改了的Category名稱"</span>);</span><br><span class="line">        mapper.update(c);</span><br><span class="line">        listAll(mapper);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        Category c= mapper.get(<span class="number">14</span>);</span><br><span class="line">        System.out.println(c.getName());</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        mapper.delete(<span class="number">13</span>);</span><br><span class="line">        listAll(mapper);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        Category c = <span class="keyword">new</span> Category();</span><br><span class="line">        c.setName(<span class="string">"新增加的Category"</span>);</span><br><span class="line">        mapper.add(c);</span><br><span class="line">        listAll(mapper);</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-关于SQL类"><a class="header-anchor" href="#步骤-7-关于SQL类">¶</a>步骤 7 : 关于SQL类</h4>
<p>SQL类是用于进行动态SQL生成的，如下代码是一个相对复杂的SQL类的使用举例，以后需要用到的时候，再来参考。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">selectPersonSql</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> SQL() &#123;&#123;</span><br><span class="line">    SELECT(<span class="string">"P.ID, P.USERNAME, P.PASSWORD, P.FULL_NAME"</span>);</span><br><span class="line">    SELECT(<span class="string">"P.LAST_NAME, P.CREATED_ON, P.UPDATED_ON"</span>);</span><br><span class="line">    FROM(<span class="string">"PERSON P"</span>);</span><br><span class="line">    FROM(<span class="string">"ACCOUNT A"</span>);</span><br><span class="line">    INNER_JOIN(<span class="string">"DEPARTMENT D on D.ID = P.DEPARTMENT_ID"</span>);</span><br><span class="line">    INNER_JOIN(<span class="string">"COMPANY C on D.COMPANY_ID = C.ID"</span>);</span><br><span class="line">    WHERE(<span class="string">"P.ID = A.ID"</span>);</span><br><span class="line">    WHERE(<span class="string">"P.FIRST_NAME like ?"</span>);</span><br><span class="line">    OR();</span><br><span class="line">    WHERE(<span class="string">"P.LAST_NAME like ?"</span>);</span><br><span class="line">    GROUP_BY(<span class="string">"P.ID"</span>);</span><br><span class="line">    HAVING(<span class="string">"P.LAST_NAME like ?"</span>);</span><br><span class="line">    OR();</span><br><span class="line">    HAVING(<span class="string">"P.FIRST_NAME like ?"</span>);</span><br><span class="line">    ORDER_BY(<span class="string">"P.ID"</span>);</span><br><span class="line">    ORDER_BY(<span class="string">"P.FULL_NAME"</span>);</span><br><span class="line">  &#125;&#125;.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>参考一下 注释部分老师的代码用作对照。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductDynaSqlProvider</span> </span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()&#123;</span><br><span class="line">            &#123;</span><br><span class="line">                SELECT(<span class="string">"*"</span>);</span><br><span class="line">                FROM(<span class="string">"product_"</span>);</span><br><span class="line">                 </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.toString();</span><br><span class="line"><span class="comment">//              .SELECT("*")</span></span><br><span class="line"><span class="comment">//              .FROM("product_")</span></span><br><span class="line"><span class="comment">//              .toString();</span></span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//设置模糊查询，当map为空时，返回所有数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listByParameter</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()&#123;</span><br><span class="line">            &#123;</span><br><span class="line">                SELECT(<span class="string">"*"</span>);</span><br><span class="line">                FROM(<span class="string">"product_"</span>);</span><br><span class="line">                <span class="keyword">if</span>(!map.isEmpty())&#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">null</span>!=map.get(<span class="string">"name"</span>)) &#123;</span><br><span class="line">                         </span><br><span class="line">                        WHERE(<span class="string">"name like "</span>+map.get(<span class="string">"name"</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">null</span>!=map.get(<span class="string">"price"</span>)) &#123;</span><br><span class="line">                        WHERE(<span class="string">"price&gt;"</span>+map.get(<span class="string">"price"</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.toString();</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()&#123;</span><br><span class="line">            &#123;</span><br><span class="line">                SELECT(<span class="string">"*"</span>);</span><br><span class="line">                FROM(<span class="string">"product_"</span>);</span><br><span class="line">                WHERE(<span class="string">"id=#&#123;id&#125;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.toString();</span><br><span class="line"><span class="comment">//              .SELECT("*")</span></span><br><span class="line"><span class="comment">//              .FROM("product_")</span></span><br><span class="line"><span class="comment">//              .WHERE("id=#&#123;id&#125;")</span></span><br><span class="line"><span class="comment">//              .toString();</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()&#123;</span><br><span class="line">            &#123;</span><br><span class="line">                INSERT_INTO(<span class="string">"product_"</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">null</span>!=<span class="string">"#&#123;name"</span>)</span><br><span class="line">                    VALUES(<span class="string">"name"</span>, <span class="string">"#&#123;name&#125;"</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">null</span>!=<span class="string">"#&#123;price&#125;"</span>)</span><br><span class="line">                    VALUES(<span class="string">"price"</span>, <span class="string">"#&#123;price&#125;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.toString();</span><br><span class="line"><span class="comment">//              .INSERT_INTO("product_")</span></span><br><span class="line"><span class="comment">//              .VALUES("name", "#&#123;name&#125;")</span></span><br><span class="line"><span class="comment">//              .VALUES("price", "#&#123;price&#125;")</span></span><br><span class="line"><span class="comment">//              .toString();</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()&#123;</span><br><span class="line">            &#123;</span><br><span class="line">                UPDATE(<span class="string">"product_"</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">null</span>!=<span class="string">"#&#123;name&#125;"</span>)</span><br><span class="line">                    SET(<span class="string">"name=#&#123;name&#125;"</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">null</span>!=<span class="string">"#&#123;price&#125;"</span>)</span><br><span class="line">                    SET(<span class="string">"price=#&#123;price&#125;"</span>);</span><br><span class="line">                WHERE(<span class="string">"id=#&#123;id&#125;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;.toString();</span><br><span class="line"><span class="comment">//              .UPDATE("product_")</span></span><br><span class="line"><span class="comment">//              .SET("name=#&#123;name&#125;","price=#&#123;price&#125;")</span></span><br><span class="line"><span class="comment">//              .WHERE("id=#&#123;id&#125;")</span></span><br><span class="line"><span class="comment">//              .toString();</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQL()</span><br><span class="line">                .DELETE_FROM(<span class="string">"product_"</span>)</span><br><span class="line">                .WHERE(<span class="string">"id=#&#123;id&#125;"</span>)</span><br><span class="line">                .toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="四、相关概念"><a class="header-anchor" href="#四、相关概念">¶</a>四、相关概念</h2>
<h3 id="1、开启LOG4J显示执行的SQL语句"><a class="header-anchor" href="#1、开启LOG4J显示执行的SQL语句">¶</a>1、开启LOG4J显示执行的SQL语句</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v85"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v85">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v85"><a class="header-anchor" href="#步骤-2-模仿和排错-v85">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-开启日志"><a class="header-anchor" href="#步骤-3-开启日志">¶</a>步骤 3 : 开启日志</h4>
<p>有时候需要打印日志，知道mybatis执行了什么样的SQL语句，以便进行调试。这时，就需要开启日志，而mybatis自身是没有带日志的，使用的都是第三方日志，这里讲解如何开启log4j日志功能。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4348.png" alt></p>
<h4 id="步骤-4-jar-v5"><a class="header-anchor" href="#步骤-4-jar-v5">¶</a>步骤 4 : jar</h4>
<p>为了开启log4j，需要使用对应的jar包，请在右上角下载，并保存在e:\project\mybatis\lib目录下</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4349.png" alt></p>
<h4 id="步骤-5-导入到项目"><a class="header-anchor" href="#步骤-5-导入到项目">¶</a>步骤 5 : 导入到项目</h4>
<p>把log4j的jar包导入到当前项目。</p>
<p>导包步骤： 右键project-&gt;property-&gt;java build path-&gt;libaries-&gt;add external jars</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4350.png" alt></p>
<h4 id="步骤-6-log4j-properties"><a class="header-anchor" href="#步骤-6-log4j-properties">¶</a>步骤 6 : log4j.properties</h4>
<p>在src目录下，新建文件log4j.properties，其作用是输出<strong>com.how2java</strong>包下参与Mybatis的类的SQL语句输出<br>
如果包名不一样，请根据自己的项目情况调整</p>
<p>对log4j不熟悉的同学，请参考 [log4j教程]</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Global logging configuration</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">ERROR, stdout</span></span><br><span class="line"><span class="comment"># MyBatis logging configuration...</span></span><br><span class="line"><span class="meta">log4j.logger.com.how2java</span>=<span class="string">TRACE</span></span><br><span class="line"><span class="comment"># Console output...</span></span><br><span class="line"><span class="meta">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%5p [%t] - %m%n</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-运行测试-v2"><a class="header-anchor" href="#步骤-7-运行测试-v2">¶</a>步骤 7 : 运行测试</h4>
<p>运行前面教程的测试类TestMybatis，可以看到如图所示的SQL语句输出。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4352.png" alt></p>
<h3 id="2、事务管理"><a class="header-anchor" href="#2、事务管理">¶</a>2、事务管理</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v86"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v86">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v86"><a class="header-anchor" href="#步骤-2-模仿和排错-v86">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-JDBC方式"><a class="header-anchor" href="#步骤-3-JDBC方式">¶</a>步骤 3 : JDBC方式</h4>
<p>确保12行是</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>另一个值是MANAGED，是交由容器管理，如weblogic等，不在本知识点讨论。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-测试代码"><a class="header-anchor" href="#步骤-4-测试代码">¶</a>步骤 4 : 测试代码</h4>
<p>38行的代码提交事务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">session.commit();</span><br></pre></td></tr></table></figure>
<p>插入第二个数据会因为长度超过32，而导致无法插入到数据库。<br>
因为在同一个事务里，所以第一个数据，也无法插入成功。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4362.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.transaction.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.transaction.TransactionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.transaction.jdbc.JdbcTransactionFactory;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, SQLException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  </span><br><span class="line">        Category c1 = <span class="keyword">new</span> Category();</span><br><span class="line">        c1.setName(<span class="string">"长度够短的名称"</span>);</span><br><span class="line">        mapper.add(c1);</span><br><span class="line">         </span><br><span class="line">        Category c2 = <span class="keyword">new</span> Category();</span><br><span class="line">        c2.setName(<span class="string">"超过最大长度30的名称超过最大长度30的名称超过最大长度30的名称超过最大长度30的名称超过最大长度30的名称超过最大长度30的名称"</span>);</span><br><span class="line">        mapper.add(c2);       </span><br><span class="line"> </span><br><span class="line">        listAll(mapper);</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(CategoryMapper mapper)</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-MYSQL-表的类型必须是INNODB"><a class="header-anchor" href="#步骤-5-MYSQL-表的类型必须是INNODB">¶</a>步骤 5 : MYSQL 表的类型必须是INNODB</h4>
<p>在Mysql中，只有当表的类型是INNODB的时候，才支持事务，所以需要把表category_的类型设置为INNODB,否则无法观察到事务.</p>
<p>修改表的类型为INNODB的SQL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table category_ ENGINE  &#x3D; innodb;</span><br></pre></td></tr></table></figure>
<p>查看表的类型的SQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show table status from how2java;</span><br></pre></td></tr></table></figure>
<p>不过有个前提，就是当前的MYSQL服务器本身要支持INNODB,如果不支持，请看 [开启MYSQL INNODB的办法]</p>
<h3 id="3、延迟加载"><a class="header-anchor" href="#3、延迟加载">¶</a>3、延迟加载</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v87"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v87">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v87"><a class="header-anchor" href="#步骤-2-模仿和排错-v87">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于注解方式的一对多"><a class="header-anchor" href="#步骤-3-基于注解方式的一对多">¶</a>步骤 3 : 基于注解方式的一对多</h4>
<p>基于[注解方式的一对多] 来学习延迟加载的配置办法</p>
<h4 id="步骤-4-加上日志"><a class="header-anchor" href="#步骤-4-加上日志">¶</a>步骤 4 : 加上日志</h4>
<p>为了观察到延迟加载前后，SQL语句的变化，加上[日志]</p>
<h4 id="步骤-5-只查询分类，不获取产品"><a class="header-anchor" href="#步骤-5-只查询分类，不获取产品">¶</a>步骤 5 : 只查询分类，不获取产品</h4>
<p>把27,28,29注释掉，只获取分类，不获取产品，执行后发现，获取产品的SQL语句也执行了</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4367.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"> </span><br><span class="line">        List&lt;Category&gt; cs = mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line"><span class="comment">//          List&lt;Product&gt; ps = c.getProducts();</span></span><br><span class="line"><span class="comment">//          for (Product p : ps) &#123;</span></span><br><span class="line"><span class="comment">//              System.out.println("\t"+p.getName());</span></span><br><span class="line"><span class="comment">//          &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">              </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-加上延迟加载的配置"><a class="header-anchor" href="#步骤-6-加上延迟加载的配置">¶</a>步骤 6 : 加上延迟加载的配置</h4>
<p>修改mybatis-config.xml，在6-11行添加延迟加载的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span> </span><br><span class="line">         <span class="comment">&lt;!-- 打开延迟加载的开关 --&gt;</span> </span><br><span class="line">         <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span> </span><br><span class="line">         <span class="comment">&lt;!-- 将积极加载改为消息加载即按需加载 --&gt;</span> </span><br><span class="line">         <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.ProductMapper"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-只查询分类，不获取产品"><a class="header-anchor" href="#步骤-7-只查询分类，不获取产品">¶</a>步骤 7 : 只查询分类，不获取产品</h4>
<p>执行同样的操作，可以观察到，只查询了category_表的数据，没有查询product_表的数据</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4369.png" alt></p>
<h4 id="步骤-8-只有在查询产品的时候，才会看到SQL语句"><a class="header-anchor" href="#步骤-8-只有在查询产品的时候，才会看到SQL语句">¶</a>步骤 8 : 只有在查询产品的时候，才会看到SQL语句</h4>
<p>修改代码，获取分类对应的产品集合，这个时候，才会去对product_表进行查询。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4370.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Product;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"> </span><br><span class="line">        List&lt;Category&gt; cs = mapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">            List&lt;Product&gt; ps = c.getProducts();</span><br><span class="line">            <span class="keyword">for</span> (Product p : ps) &#123;</span><br><span class="line">                System.out.println(<span class="string">"\t"</span>+p.getName());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">              </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4、分页"><a class="header-anchor" href="#4、分页">¶</a>4、分页</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v88"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v88">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v88"><a class="header-anchor" href="#步骤-2-模仿和排错-v88">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-增加100条catgory数据"><a class="header-anchor" href="#步骤-3-增加100条catgory数据">¶</a>步骤 3 : 增加100条catgory数据</h4>
<p>为了观察分页查询的效果，把分类表里的数据都删除掉，然后新增100个数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            session.delete(<span class="string">"deleteCategory"</span>, c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            Category c = <span class="keyword">new</span> Category();</span><br><span class="line">            c.setName(<span class="string">"category name "</span> + i);</span><br><span class="line">            session.insert(<span class="string">"addCategory"</span>, c);</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Category&gt; cs2 = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs2) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-修改Category-xml"><a class="header-anchor" href="#步骤-4-修改Category-xml">¶</a>步骤 4 : 修改Category.xml</h4>
<p>新增limit</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_</span><br><span class="line">                <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"start!=null and count!=null"</span>&gt;</span></span><br><span class="line">                    limit #&#123;start&#125;,#&#123;count&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试-v6"><a class="header-anchor" href="#步骤-5-测试-v6">¶</a>步骤 5 : 测试</h4>
<p>用注解方式再做一遍<br>
<strong>注：</strong> start是指从第0个开始，如果是第二页，那么就是第5个开始。<br>
<strong>注：</strong> count参数是指每页有5条数据</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4374.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Many;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">listByPage</span><span class="params">(@Param(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Param</span><span class="params">(<span class="string">"count"</span>)</span><span class="keyword">int</span> count)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line"><span class="comment">//        xmlWay(session);   </span></span><br><span class="line">        annotationWay(session);</span><br><span class="line">         </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">xmlWay</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; params = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        params.put(<span class="string">"start"</span>, <span class="number">0</span>);</span><br><span class="line">        params.put(<span class="string">"count"</span>, <span class="number">5</span>);</span><br><span class="line">        List&lt;Category&gt;  cs =session.selectList(<span class="string">"listCategory"</span>, params);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">annotationWay</span><span class="params">(SqlSession session)</span> </span>&#123;</span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">         </span><br><span class="line">        List&lt;Category&gt;  cs =mapper.listByPage(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-注解方式"><a class="header-anchor" href="#步骤-6-注解方式">¶</a>步骤 6 : 注解方式</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Many;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ "</span>)</span><br><span class="line">    <span class="meta">@Results</span>(&#123;<span class="meta">@Result</span>(property = <span class="string">"products"</span>, javaType = List<span class="class">.<span class="keyword">class</span>, <span class="title">column</span> </span>= <span class="string">"id"</span>, </span><br><span class="line">          many = <span class="meta">@Many</span>(select = <span class="string">"com.how2java.mapper.ProductMapper.listByCategory"</span>))&#125;)      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ limit #&#123;start&#125;,#&#123;count&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">listByPage</span><span class="params">(@Param(<span class="string">"start"</span>)</span> <span class="keyword">int</span> start, @<span class="title">Param</span><span class="params">(<span class="string">"count"</span>)</span><span class="keyword">int</span> count)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">         </span><br><span class="line">        List&lt;Category&gt;  cs =mapper.listByPage(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c);</span><br><span class="line">        &#125;</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、PageHelper"><a class="header-anchor" href="#5、PageHelper">¶</a>5、PageHelper</h3>
<h4 id="步骤-1-PageHelper介绍"><a class="header-anchor" href="#步骤-1-PageHelper介绍">¶</a>步骤 1 : PageHelper介绍</h4>
<p>PageHelper是一款犀利的Mybatis分页插件，使用了这个插件之后，分页开发起来更加简单容易。<br>
本知识点讲解如何使用该插件，更多详细介绍请点击查看：[PageHelper官方]</p>
<h4 id="步骤-2-先运行，看到效果，再学习"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-3-模仿和排错"><a class="header-anchor" href="#步骤-3-模仿和排错">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-jar包"><a class="header-anchor" href="#步骤-4-jar包">¶</a>步骤 4 : jar包</h4>
<p>因为是第三方插件，所以需要额外的jar包，都在右上角提供了下载：pagehelper-5.1.0-beta2.jar，jsqlparser-1.0.jar</p>
<h4 id="步骤-5-数据设置为100条"><a class="header-anchor" href="#步骤-5-数据设置为100条">¶</a>步骤 5 : 数据设置为100条</h4>
<p>为了观察分页查询的效果，把分类表里的数据都删除掉，然后新增100个数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            session.delete(<span class="string">"deleteCategory"</span>, c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            Category c = <span class="keyword">new</span> Category();</span><br><span class="line">            c.setName(<span class="string">"category name "</span> + i);</span><br><span class="line">            session.insert(<span class="string">"addCategory"</span>, c);</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Category&gt; cs2 = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs2) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-配置插件"><a class="header-anchor" href="#步骤-6-配置插件">¶</a>步骤 6 : 配置插件</h4>
<p>在mybatis-config.xml中，添加15-19行的代码，表示开启PageHelper插件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span> </span><br><span class="line">            <span class="comment">&lt;!-- 打开延迟加载的开关 --&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span> </span><br><span class="line">            <span class="comment">&lt;!-- 将积极加载改为消息加载即按需加载 --&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">settings</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span>     </span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.ProductMapper"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-Category-xml"><a class="header-anchor" href="#步骤-7-Category-xml">¶</a>步骤 7 : Category.xml</h4>
<p>24-26行的limit注释掉，因为分页相关工作，会由PageHelper去做掉，不需要自己去写了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_</span><br><span class="line"><span class="comment">&lt;!--                 &lt;if test="start!=null and count!=null"&gt; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                     limit #&#123;start&#125;,#&#123;count&#125; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--                 &lt;/if&gt; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-分页查询"><a class="header-anchor" href="#步骤-8-分页查询">¶</a>步骤 8 : 分页查询</h4>
<p>查询很有意思，只需要在执行查询所有的调用之前，执行一条语句即可：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.offsetPage(<span class="number">0</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>这就表示查出第一页的数据，每页5条</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5855.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">      </span><br><span class="line">        PageHelper.offsetPage(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line"> </span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-获取总数"><a class="header-anchor" href="#步骤-9-获取总数">¶</a>步骤 9 : 获取总数</h4>
<p>通过第31行的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PageInfo page= <span class="keyword">new</span> PageInfo&lt;&gt;(cs);</span><br></pre></td></tr></table></figure>
<p>就可以获取分页信息，包括总数以及其他的</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5856.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">      </span><br><span class="line">        PageHelper.offsetPage(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line"> </span><br><span class="line">        List&lt;Category&gt; cs = session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        PageInfo pageInfo = <span class="keyword">new</span> PageInfo&lt;&gt;(cs);</span><br><span class="line">        System.out.println(<span class="string">"总数："</span>+pageInfo.getTotal());</span><br><span class="line">        System.out.println(pageInfo);</span><br><span class="line"> </span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6、一级缓存"><a class="header-anchor" href="#6、一级缓存">¶</a>6、一级缓存</h3>
<p>Mybatis的一级缓存在session上，只要通过session查过的数据，都会放在session上，下一次再查询相同id的数据，都直接冲缓存中取出来，而不用到数据库里去取了。</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v89"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v89">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v89"><a class="header-anchor" href="#步骤-2-模仿和排错-v89">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-在一个Session里查相同id的数据"><a class="header-anchor" href="#步骤-3-在一个Session里查相同id的数据">¶</a>步骤 3 : 在一个Session里查相同id的数据</h4>
<p>如图所示，在session1中查询两次id=1的Category对象。<br>
第一次会去数据库中取数据，但是第二次就不会访问数据库了，而是直接从session中取出来。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4377.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session1 = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Category c1 = session1.selectOne(<span class="string">"getCategory"</span>, <span class="number">1</span>);</span><br><span class="line">        System.out.println(c1);</span><br><span class="line">        Category c2 = session1.selectOne(<span class="string">"getCategory"</span>, <span class="number">1</span>);</span><br><span class="line">        System.out.println(c2);</span><br><span class="line"> </span><br><span class="line">        session1.commit();</span><br><span class="line">        session1.close();</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-在不同Session里查相同id的数据"><a class="header-anchor" href="#步骤-4-在不同Session里查相同id的数据">¶</a>步骤 4 : 在不同Session里查相同id的数据</h4>
<p>这一次，另外打开一个session,取同样id的数据，就会发现需要执行sql语句，证实了一级缓存是在session里的。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4378.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session1 = sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        Category c1 = session1.selectOne(<span class="string">"getCategory"</span>, <span class="number">1</span>);</span><br><span class="line">        System.out.println(c1);</span><br><span class="line">        Category c2 = session1.selectOne(<span class="string">"getCategory"</span>, <span class="number">1</span>);</span><br><span class="line">        System.out.println(c2);</span><br><span class="line"> </span><br><span class="line">        session1.commit();</span><br><span class="line">        session1.close();</span><br><span class="line">         </span><br><span class="line">        SqlSession session2 = sqlSessionFactory.openSession();</span><br><span class="line">        Category c3 = session2.selectOne(<span class="string">"getCategory"</span>, <span class="number">1</span>);</span><br><span class="line">        System.out.println(c3);    </span><br><span class="line">        session2.commit();</span><br><span class="line">        session2.close();</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7、二级缓存"><a class="header-anchor" href="#7、二级缓存">¶</a>7、二级缓存</h3>
<p>Mybatis二级缓存是SessionFactory，如果两次查询基于同一个SessionFactory，那么就从二级缓存中取数据，而不用到数据库里去取了。</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v90"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v90">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v90"><a class="header-anchor" href="#步骤-2-模仿和排错-v90">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前一个知识点"><a class="header-anchor" href="#步骤-3-基于前一个知识点">¶</a>步骤 3 : 基于前一个知识点</h4>
<p>对[一级缓存]知识点进行改造，以支持二级缓存</p>
<h4 id="步骤-4-观察无二级缓存"><a class="header-anchor" href="#步骤-4-观察无二级缓存">¶</a>步骤 4 : 观察无二级缓存</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4458.png" alt></p>
<h4 id="步骤-5-启动二级缓存"><a class="header-anchor" href="#步骤-5-启动二级缓存">¶</a>步骤 5 : 启动二级缓存</h4>
<p>11行新增一个段配置，以支持二级缓存</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">PUBLIC <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span> </span><br><span class="line">            <span class="comment">&lt;!-- 打开延迟加载的开关 --&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span> </span><br><span class="line">            <span class="comment">&lt;!-- 将积极加载改为消息加载即按需加载 --&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">settings</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.how2java.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/how2java/pojo/Category.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.how2java.mapper.ProductMapper"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-在Category-xml中增加-cache"><a class="header-anchor" href="#步骤-6-在Category-xml中增加-cache">¶</a>步骤 6 : 在Category.xml中增加 &lt;cache/&gt;</h4>
<p>第7行新增&lt;cache/&gt;以启动对Category对象的二级缓存</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.pojo"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">cache</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCategory"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateCategory"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"listCategory"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_</span><br><span class="line">                <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"start!=null and count!=null"</span>&gt;</span></span><br><span class="line">                    limit #&#123;start&#125;,#&#123;count&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-序列化Category"><a class="header-anchor" href="#步骤-7-序列化Category">¶</a>步骤 7 : 序列化Category</h4>
<p>让Category 实现序列化接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    List&lt;Product&gt; products;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Product&gt; <span class="title">getProducts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProducts</span><span class="params">(List&lt;Product&gt; products)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.products = products;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Category [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-运行测试"><a class="header-anchor" href="#步骤-8-运行测试">¶</a>步骤 8 : 运行测试</h4>
<p>再次运行TestMybatis，如图所示，在同一个SessionFactory下查询id=1的数据，只有第一次需要执行sql语句，以后都是从缓存中取出</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4462.png" alt></p>
<h3 id="8、单纯的MYBATIS整合C3P0数据库连接池"><a class="header-anchor" href="#8、单纯的MYBATIS整合C3P0数据库连接池">¶</a>8、单纯的MYBATIS整合C3P0数据库连接池</h3>
<p>本知识点演示单纯的Mybatis整合C3P0数据库连接池，不是SSM的那种整合方式</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v91"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v91">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v91"><a class="header-anchor" href="#步骤-2-模仿和排错-v91">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-下载JAR包"><a class="header-anchor" href="#步骤-3-下载JAR包">¶</a>步骤 3 : 下载JAR包</h4>
<p>右上角下载c3p0的jar包</p>
<h4 id="步骤-4-导入项目"><a class="header-anchor" href="#步骤-4-导入项目">¶</a>步骤 4 : 导入项目</h4>
<p>把jar包导入到项目中，导包办法：右键 project-&gt;properties-&gt;java build path-&gt;libaries-&gt;add external jars</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4465.png" alt></p>
<h4 id="步骤-5-新建类C3P0DataSourceFactory"><a class="header-anchor" href="#步骤-5-新建类C3P0DataSourceFactory">¶</a>步骤 5 : 新建类C3P0DataSourceFactory</h4>
<p>Mybatis使用C3P0有点怪怪的，需要自己写个类继承UnpooledDataSourceFactory，然后指定dataSource 为ComboPooledDataSource。<br>
这个ComboPooledDataSource就是c3p0的数据源。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.mybatis.c3p0;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.datasource.unpooled.UnpooledDataSourceFactory;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C3P0DataSourceFactory</span> <span class="keyword">extends</span> <span class="title">UnpooledDataSourceFactory</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">C3P0DataSourceFactory</span><span class="params">()</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">           <span class="keyword">this</span>.dataSource =<span class="keyword">new</span> ComboPooledDataSource();</span><br><span class="line">     </span><br><span class="line">        &#125;</span><br><span class="line">     </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-配置-mybatis-config-xml"><a class="header-anchor" href="#步骤-6-配置-mybatis-config-xml">¶</a>步骤 6 : 配置 mybatis-config.xml</h4>
<p>注释掉type=&quot;POOLED&quot;的数据源，换成type=&quot;org.mybatis.c3p0.C3P0DataSourceFactory&quot;的数据源<br>
这样就使用c3p0了。<br>
因为代码插件的bug，有一些关键字符不能正常显示，请直接使用右上角的mybatis-config.xml，保证顺利运行。</p>
<h4 id="步骤-7-测试-v10"><a class="header-anchor" href="#步骤-7-测试-v10">¶</a>步骤 7 : 测试</h4>
<p>随便运行前面知识点的任意测试类即可。<br>
作为数据库连接池，无法在小规模访问里看到其效果，需要高并发才能体现出其效果，这里的测试代码只能表示正常运行，无法体现其优越性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session = sqlSessionFactory.openSession();</span><br><span class="line">        List&lt;Category&gt; cs =session.selectList(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        session.close();</span><br><span class="line">         </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="9、查询总数"><a class="header-anchor" href="#9、查询总数">¶</a>9、查询总数</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v92"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v92">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v92"><a class="header-anchor" href="#步骤-2-模仿和排错-v92">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-新增加方法"><a class="header-anchor" href="#步骤-3-新增加方法">¶</a>步骤 3 : 新增加方法</h4>
<p>统计总数没什么特别的，就是一条普通的查询SQL语句</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">" select count(*) from category_ "</span>)  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">" insert into category_ ( name ) values (#&#123;name&#125;) "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">" delete from category_ where id= #&#123;id&#125; "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ where id= #&#123;id&#125; "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">      </span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"update category_ set name=#&#123;name&#125; where id=#&#123;id&#125; "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;  </span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select * from category_ "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">" select count(*) from category_ "</span>) </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span></span>; </span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-测试-v2"><a class="header-anchor" href="#步骤-4-测试-v2">¶</a>步骤 4 : 测试</h4>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4472.png" alt></p>
<h3 id="10、GENERATOR-用法"><a class="header-anchor" href="#10、GENERATOR-用法">¶</a>10、GENERATOR 用法</h3>
<h4 id="步骤-1-简介"><a class="header-anchor" href="#步骤-1-简介">¶</a>步骤 1 : 简介</h4>
<p>Mybatis Generator是一个用于Mybatis逆向工程的工具。<br>
前面学习的方式都是先有pojo, mapper, xml, 然后再创建表。</p>
<p>用逆向工程的方式，首先保证<strong>数据库里有表</strong>，然后通过Mybatis Generator生成pojo, mapper和xml。</p>
<p>可以节约大家的时间，提高开发效率，降低出错几率</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v2"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v2">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p>运行 TestMybatisGenerator类，就可以观察到pojo,mapper和xml都生成了，然后再运行 [TestMybatis] 进行查询测试。</p>
<p>如图所示，运行TestMybatisGenerator之后，刷新项目可以看到自动生成的相关文件</p>
<p><strong>注：</strong> CategoryExample 这个是用于多条件查询的，在[TestMybatis]中有演示</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5874.png" alt></p>
<h4 id="步骤-3-模仿和排错-v2"><a class="header-anchor" href="#步骤-3-模仿和排错-v2">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点"><a class="header-anchor" href="#步骤-4-基于前面的知识点">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>基于[Mybatis 入门] 这个知识点进行</p>
<h4 id="步骤-5-jar"><a class="header-anchor" href="#步骤-5-jar">¶</a>步骤 5 : jar</h4>
<p>需要额外的Mybatis Generator jar包（mybatis-generator-core-1.3.5.jar），在右上角下载，下载后放在lib目录下，并导入项目</p>
<p>导包办法：右键 project-&gt;properties-&gt;java build path-&gt;libaries-&gt;add external jars</p>
<h4 id="步骤-6-配置文件"><a class="header-anchor" href="#步骤-6-配置文件">¶</a>步骤 6 : 配置文件</h4>
<p>在src目录下创建generatorConfig.xml</p>
<p>这个配置文件有如下作用</p>
<ol>
<li>指定 mysql jdbcjar 包的位置,这里用的位置是 e:/project/mybatis/lib/mysql-connector-java-5.0.8-bin.jar</li>
<li>设置数据库链接账号密码</li>
<li>指定pojo,mapper,xml分别生成的包名</li>
<li>指定表名以及表名对应的类名<br>
4.1 使用自增长键：</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"my.isgen.usekeys"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatedKey</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">sqlStatement</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>**注1：**如果IDE(eclipse或者idea) 项目里导入了jar包，那就不需要么第一步那样配置jar包的绝对路径了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">  <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</span></span></span><br><span class="line"><span class="meta">  <span class="meta-string">"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--数据库驱动--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        如果IDE(eclipse或者idea) 项目里导入了jar包，那么就不需要配置了jar包的绝对路径了</span></span><br><span class="line"><span class="comment">         &lt;classPathEntry    location="e:/project/mybatis/lib/mysql-connector-java-5.0.8-bin.jar"/&gt;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"DB2Tables"</span>    <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressDate"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressAllComments"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--数据库链接地址账号密码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"com.mysql.jdbc.Driver"</span> <span class="attr">connectionURL</span>=<span class="string">"jdbc:mysql://localhost/how2java"</span> <span class="attr">userId</span>=<span class="string">"root"</span> <span class="attr">password</span>=<span class="string">"admin"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成Model类存放位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.how2java.pojo"</span> <span class="attr">targetProject</span>=<span class="string">"src"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成映射文件存放位置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"com.how2java.pojo"</span> <span class="attr">targetProject</span>=<span class="string">"src"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成Dao类存放位置--&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span> <span class="attr">targetPackage</span>=<span class="string">"com.how2java.mapper"</span> <span class="attr">targetProject</span>=<span class="string">"src"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--生成对应表及类名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"category_"</span> <span class="attr">domainObjectName</span>=<span class="string">"Category"</span> <span class="attr">enableCountByExample</span>=<span class="string">"false"</span> <span class="attr">enableUpdateByExample</span>=<span class="string">"false"</span> <span class="attr">enableDeleteByExample</span>=<span class="string">"false"</span> <span class="attr">enableSelectByExample</span>=<span class="string">"true"</span> <span class="attr">selectByExampleQueryId</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"my.isgen.usekeys"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">generatedKey</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">sqlStatement</span>=<span class="string">"JDBC"</span>/&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--         &lt;table tableName="product_" domainObjectName="Product" enableCountByExample="false" enableUpdateByExample="false" enableDeleteByExample="false" enableSelectByExample="false" selectByExampleQueryId="false"&gt;&lt;/table&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-TestMybatisGenerator"><a class="header-anchor" href="#步骤-7-TestMybatisGenerator">¶</a>步骤 7 : TestMybatisGenerator</h4>
<p>运行成功之后，就会在对应位置生成pojo,xml,和mapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.api.MyBatisGenerator;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.config.xml.ConfigurationParser;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.generator.internal.DefaultShellCallback;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatisGenerator</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</span><br><span class="line">        InputStream is= TestMybatisGenerator.class.getClassLoader().getResource("generatorConfig.xml").openStream();</span><br><span class="line">        ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</span><br><span class="line">        Configuration config = cp.parseConfiguration(is);</span><br><span class="line">        is.close();</span><br><span class="line">        DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</span><br><span class="line">        MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</span><br><span class="line">        myBatisGenerator.generate(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(<span class="string">"生成代码成功，刷新项目，查看文件,然后执行TestMybatis.java"</span>);</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-TestMybatis-v2"><a class="header-anchor" href="#步骤-8-TestMybatis-v2">¶</a>步骤 8 : TestMybatis</h4>
<p>运行TestMybatis，执行自动生成的mapper，借助CategoryExample 进行模糊查询名称里出现了9的分类</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5879.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//import com.how2java.mapper.CategoryMapper;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//import com.how2java.pojo.Category;</span></span><br><span class="line"><span class="comment">//import com.how2java.pojo.CategoryExample;</span></span><br><span class="line"><span class="comment">//import com.how2java.mapper.CategoryMapper;</span></span><br><span class="line"><span class="comment">//import com.how2java.pojo.CategoryExample;</span></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.CategoryExample;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatis</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"先运行TestMybatisGenerator创建mapper,pojo,xml 等文件，然后取消import里被注释的，以及接下来的注释，并执行代码"</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">//</span></span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">        SqlSession session=sqlSessionFactory.openSession();</span><br><span class="line"> </span><br><span class="line">        CategoryExample example = <span class="keyword">new</span> CategoryExample();</span><br><span class="line">        example.createCriteria().andNameLike(<span class="string">"%9%"</span>);</span><br><span class="line">        CategoryMapper mapper = session.getMapper(CategoryMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        List&lt;Category&gt; cs= mapper.selectByExample(example);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-局限性"><a class="header-anchor" href="#步骤-9-局限性">¶</a>步骤 9 : 局限性</h4>
<p>多对一，一对多需要自己手写，这个工具目前(20170828版本1.3.5)不提供</p>
<h1 id="拾、SPRING-MYBATIS"><a class="header-anchor" href="#拾、SPRING-MYBATIS">¶</a>拾、SPRING+MYBATIS</h1>
<h2 id="一、教程-v7"><a class="header-anchor" href="#一、教程-v7">¶</a>一、教程</h2>
<h3 id="1、整合SPRING与MYBATIS，一步步详解"><a class="header-anchor" href="#1、整合SPRING与MYBATIS，一步步详解">¶</a>1、整合SPRING与MYBATIS，一步步详解</h3>
<p>本教程是为了后续学习[SSM]，使学习曲线更加平滑而准备的。 用于演示Spring和Mybatis如何整合在一起</p>
<h4 id="步骤-1-基于Mybatis的课程"><a class="header-anchor" href="#步骤-1-基于Mybatis的课程">¶</a>步骤 1 : 基于Mybatis的课程</h4>
<p>本教程基于[Mybatis的课程]进行, 所以在开始之前希望你建库，表结构，Mybatis的常用用法都已经熟练了。</p>
<h4 id="步骤-2-pojo"><a class="header-anchor" href="#步骤-2-pojo">¶</a>步骤 2 : pojo</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Category [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-Mapper"><a class="header-anchor" href="#步骤-3-Mapper">¶</a>步骤 3 : Mapper</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;  </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span></span>; </span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-Category-xml"><a class="header-anchor" href="#步骤-4-Category-xml">¶</a>步骤 4 : Category.xml</h4>
<p>Category.xml需要和上一个CategoryMapper类放在同一个包下，并且namespace必须写CategoryMapper</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4495.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"add"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"delete"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"get"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"list"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-applicationContext-xml-v2"><a class="header-anchor" href="#步骤-5-applicationContext-xml-v2">¶</a>步骤 5 : applicationContext.xml</h4>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>配置连接数据库的驱动，URL，账号和密码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>扫描XML配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>扫描Mapper类</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.mapper"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试-v9"><a class="header-anchor" href="#步骤-6-测试-v9">¶</a>步骤 6 : 测试</h4>
<p>使用[Spring注解方式测试]，拿到注入的CategoryMapper对象，当调用add方法的时候，会自动去找Category.xml里id=&quot;add&quot;的sql语句。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">@ContextConfiguration("classpath:applicationContext.xml")</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Category category = <span class="keyword">new</span> Category();</span><br><span class="line">        category.setName(<span class="string">"new Category"</span>);</span><br><span class="line">        categoryMapper.add(category);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(categoryMapper);</span><br><span class="line">        List&lt;Category&gt; cs=categoryMapper.list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-可运行项目"><a class="header-anchor" href="#步骤-7-可运行项目">¶</a>步骤 7 : 可运行项目</h4>
<p>在右上角有本知识点对应的可运行项目下载 ,实在自己搞不出来，就下载解压出来比较一下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Spring + Mybatis</span><br><span class="line"></span><br><span class="line">1、建好数据库</span><br><span class="line">2、准备pojo类，用来对应数据库里的表</span><br><span class="line">3、准备Mapper接口，在别的地方相当于Dao</span><br><span class="line">4、在Mapper接口的包下准备xml文件配置，通过namespace字段绑定Mapper（Dao）。这个字段非常牛叉，我们完全不用去写Mapper接口中的实现类了，mybatis会根据sql语句的对应id去自动绑定Mapper接口中同名方法</span><br><span class="line">5、在src目录下准备applicationContext.xml，里面的内容结合Spring和Mybatis的配置。主要做了这么几个工作：①告诉Spring我们要用注解的方式来实现对象注入（@Autowired@Resource）②连接数据库③交给Spring来管理SqlSession④扫描Mapper自动实现SqlSession.getMapper()</span><br></pre></td></tr></table></figure>
<h1 id="拾壹、SSM"><a class="header-anchor" href="#拾壹、SSM">¶</a>拾壹、SSM</h1>
<h2 id="一、教程-v8"><a class="header-anchor" href="#一、教程-v8">¶</a>一、教程</h2>
<h3 id="1、SPRING-SPING-MVC-MYBATIS-三大框架整合详细步骤"><a class="header-anchor" href="#1、SPRING-SPING-MVC-MYBATIS-三大框架整合详细步骤">¶</a>1、SPRING+SPING MVC + MYBATIS 三大框架整合详细步骤</h3>
<p>本例演示从0开始逐一整合SSM的步骤，要学习本知识，需要具备[Spring], [SpringMVC], [Mybatis]的基础，如果没有这些基础，请把基础掌握之后再学习，不要跳跃学习，欲速则不达。</p>
<p><strong>必读：</strong> 基于框架的程序要成功运行，对于JAR包的版本，配置文件的正确性有着苛刻的要求，任何一个地方出错了，都会导致框架程序运行失败。 如果你是第一次学习本框架，<strong>务必严格按照教程的指导，完全模仿操作</strong>，直到成功看到运行效果。 第一次成功之后，信心，思路都会有较好的铺垫，然后再根据自己的疑惑，在“成功”的代码上做原本想做的改动和调整，这样可以大大节约学习的时间，提高效率，<strong>切勿一来就擅自改动</strong>，给自己的学习制造障碍</p>
<h4 id="步骤-1-IDEA"><a class="header-anchor" href="#步骤-1-IDEA">¶</a>步骤 1 : IDEA</h4>
<p>本教程是使用Eclipse制作的，如果是用IDEA，请跳转到 [IDEA 如何创建SSM项目]。 但是跳转过去后的教程，没有当前对每个类，配置文件，JSP的讲解有那么详细，所以最好使用Eclipse把当前的教程撸一遍，理解之后，再使用IDEA教程</p>
<h4 id="步骤-2-数据库"><a class="header-anchor" href="#步骤-2-数据库">¶</a>步骤 2 : 数据库</h4>
<p>首先准备数据库 how2java<br>
如果没有安装数据库，请参考 [安装mysql-server]</p>
<p><strong>注：</strong> 新安装的数据库账号密码是root:admin, 后续的配置里，也是用的这个账号密码。如果密码不是这个，本知识点右上角的可运行项目跑不起来，所以尽量修改密码为admin, 修改密码办法：[修改root密码]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database how2java;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-创建表-v3"><a class="header-anchor" href="#步骤-3-创建表-v3">¶</a>步骤 3 : 创建表</h4>
<p>接着准备表Category只有2个字段id和name</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">  </span><br><span class="line">CREATE TABLE category_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  name varchar(30) ,</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) DEFAULT CHARSET&#x3D;UTF8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-准备数据"><a class="header-anchor" href="#步骤-4-准备数据">¶</a>步骤 4 : 准备数据</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">   </span><br><span class="line">insert into category_ values(null,&quot;category1&quot;);</span><br><span class="line">insert into category_ values(null,&quot;category2&quot;);</span><br><span class="line">insert into category_ values(null,&quot;category3&quot;);</span><br><span class="line">insert into category_ values(null,&quot;category4&quot;);</span><br><span class="line">insert into category_ values(null,&quot;category5&quot;);</span><br><span class="line"> </span><br><span class="line">select * from category_</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-JDK版本"><a class="header-anchor" href="#步骤-5-JDK版本">¶</a>步骤 5 : JDK版本</h4>
<p>本教程是通过JDK8编译的，如果您机器上运行环境是低版本JDK，将无法识别其中的类，否则会出现如图所示的错误。<br>
请使用JDK8 ，请参考 [检测JDK版本，以及下载与配置]</p>
<p>请勿使用JDK9 或者更高版本，有兼容性风险</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4604.png" alt></p>
<h4 id="步骤-6-先运行，再学习"><a class="header-anchor" href="#步骤-6-先运行，再学习">¶</a>步骤 6 : 先运行，再学习</h4>
<p>SSM整合需要做不少步骤，任何一步部做漏了，做错了，都有可能失败，这样会影响学习的信心，并且误以为本教程是走不通的。</p>
<p>所以先下载右上角的可运行项目 ssm.rar，解压后导入到eclipse中，启动Tomcat，观察是否正常运行。确定可以运行，确定教程是可以跑得起来的，再学习下面的内容。</p>
<p>导入到Eclipse中并运行的办法请参考：[导入动态Web项目到Eclipse中]</p>
<p>部署成功之后，测试地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/listCategory</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4503.png" alt></p>
<h4 id="步骤-7-新建项目"><a class="header-anchor" href="#步骤-7-新建项目">¶</a>步骤 7 : 新建项目</h4>
<p>在eclipse中新建项目ssm，使用dynamic web project的方式。 不熟悉这种方式的同学，请参考 [使用Dynamic Web Project的方式开发J2EE应用]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4504.png" alt></p>
<h4 id="步骤-8-导入jar包-v2"><a class="header-anchor" href="#步骤-8-导入jar包-v2">¶</a>步骤 8 : 导入jar包</h4>
<p>下载右上角的lib.rar, 解压后复制到 e:/project/ssm/WebContent/WEB-INF/lib目录下</p>
<h4 id="步骤-9-pojo"><a class="header-anchor" href="#步骤-9-pojo">¶</a>步骤 9 : pojo</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Category [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-CategoryMapper"><a class="header-anchor" href="#步骤-10-CategoryMapper">¶</a>步骤 10 : CategoryMapper</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;  </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span></span>; </span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-Category-xml"><a class="header-anchor" href="#步骤-11-Category-xml">¶</a>步骤 11 : Category.xml</h4>
<p>Category.xml需要和[CategoryMapper]放在同一个包下面，并且namespace必须写[CategoryMapper]的完整类名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"add"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"delete"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"get"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"list"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-CategoryService"><a class="header-anchor" href="#步骤-12-CategoryService">¶</a>步骤 12 : CategoryService</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-CategoryServiceImpl"><a class="header-anchor" href="#步骤-13-CategoryServiceImpl">¶</a>步骤 13 : CategoryServiceImpl</h4>
<p>CategoryServiceImpl被注解@Service标示为一个Service<br>
并且装配了categoryMapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span>  <span class="keyword">implements</span> <span class="title">CategoryService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryMapper categoryMapper;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryMapper.list();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-14-CategoryController"><a class="header-anchor" href="#步骤-14-CategoryController">¶</a>步骤 14 : CategoryController</h4>
<p>CategoryController被@Controller标示为了控制器<br>
自动装配了categoryService<br>
通过@RequestMapping映射访问路径/listCategory路径到方法listCategory()。<br>
在listCategory()方法中，通过categoryService获取后，然后存放在&quot;cs&quot;这个key上。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 告诉spring mvc这是一个控制器类</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryService categoryService;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"listCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">listCategory</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        List&lt;Category&gt; cs= categoryService.list();</span><br><span class="line">         </span><br><span class="line">        <span class="comment">// 放入转发参数</span></span><br><span class="line">        mav.addObject(<span class="string">"cs"</span>, cs);</span><br><span class="line">        <span class="comment">// 放入jsp路径</span></span><br><span class="line">        mav.setViewName(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-15-web-xml"><a class="header-anchor" href="#步骤-15-web-xml">¶</a>步骤 15 : web.xml</h4>
<p>在WEB-INF目录下新增加web.xml，这个web.xml有两个作用：</p>
<ol>
<li>
<p>通过ContextLoaderListener在web app启动的时候，获取contextConfigLocation配置文件的文件名applicationContext.xml，并进行Spring相关初始化工作</p>
</li>
<li>
<p>有任何访问，都被DispatcherServlet所拦截，这就是Spring MVC那套工作机制了。</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:web</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span> <span class="attr">version</span>=<span class="string">"2.5"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- spring的配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- spring mvc核心：分发servlet --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>mvc-dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- spring mvc的配置文件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>mvc-dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-16-applicationContext-xml"><a class="header-anchor" href="#步骤-16-applicationContext-xml">¶</a>步骤 16 : applicationContext.xml</h4>
<p>在src目录下新建applicationContext.xml文件，这是Spring的配置文件，其作用</p>
<ol>
<li>通过注解，将Service的生命周期纳入Spring的管理</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>配置数据源</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>扫描存放SQL语句的Category.xml</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>扫描Mapper，并将其生命周期纳入Spring的管理</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">     </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.mapper"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-17-springMVC-xml"><a class="header-anchor" href="#步骤-17-springMVC-xml">¶</a>步骤 17 : springMVC.xml</h4>
<p>在src目录下新建springMVC.xml</p>
<ol>
<li>扫描Controller,并将其生命周期纳入Spring管理</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.controller"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>注解驱动，以使得访问路径与方法的匹配可以通过注解配置</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>静态页面，如html,css,js,images可以访问</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>视图定位到/WEB/INF/jsp 这个目录下</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"viewClass"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">value</span>=<span class="string">"org.springframework.web.servlet.view.JstlView"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.controller"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- 视图定位 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"viewClass"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">value</span>=<span class="string">"org.springframework.web.servlet.view.JstlView"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-18-listCategory-jsp"><a class="header-anchor" href="#步骤-18-listCategory-jsp">¶</a>步骤 18 : listCategory.jsp</h4>
<p>在WEB-INF下创建jsp目录，并创建文件listCategory.jsp。<br>
在这个jsp文件中，通过forEach标签，遍历[CategoryController]传递过来的集合数据。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">               </span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-19-部署在tomcat中，重启测试"><a class="header-anchor" href="#步骤-19-部署在tomcat中，重启测试">¶</a>步骤 19 : 部署在tomcat中，重启测试</h4>
<p>部署在Tomcat中，重启tomcat，然后访问地址，观察效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/listCategory</span></span><br></pre></td></tr></table></figure>
<p>部署办法请参考 [通过Eclipse启动Tomcat-Run On Server]</p>
<h4 id="步骤-20-思路图"><a class="header-anchor" href="#步骤-20-思路图">¶</a>步骤 20 : 思路图</h4>
<ol>
<li>首先浏览器上访问路径 /listCategory</li>
<li>tomcat根据web.xml上的配置信息，拦截到了/listCategory，并将其交由DispatcherServlet处理。</li>
<li>DispatcherServlet 根据springMVC的配置，将这次请求交由CategoryController类进行处理，所以需要进行这个类的实例化</li>
<li>在实例化CategoryController的时候，注入CategoryServiceImpl。 (自动装配实现了CategoryService接口的的实例，只有CategoryServiceImpl实现了CategoryService接口，所以就会注入CategoryServiceImpl)</li>
<li>在实例化CategoryServiceImpl的时候，又注入CategoryMapper</li>
<li>根据ApplicationContext.xml中的配置信息，将CategoryMapper和Category.xml关联起来了。</li>
<li>这样拿到了实例化好了的CategoryController,并调用 list 方法</li>
<li>在list方法中，访问CategoryService,并获取数据，并把数据放在&quot;cs&quot;上，接着服务端跳转到listCategory.jsp去</li>
<li>最后在listCategory.jsp 中显示数据</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4518.png" alt></p>
<h4 id="步骤-21-删掉，从头开始，这次全部自己做"><a class="header-anchor" href="#步骤-21-删掉，从头开始，这次全部自己做">¶</a>步骤 21 : 删掉，从头开始，这次全部自己做</h4>
<p>如果是使用的右上角下载的运行项目执行的，那么这个时候，就该把这个项目删掉，然后从头到尾自己做一遍，把这个知识变成自己的东西。</p>
<h3 id="2、分页示例"><a class="header-anchor" href="#2、分页示例">¶</a>2、分页示例</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v93"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v93">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v93"><a class="header-anchor" href="#步骤-2-模仿和排错-v93">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前面的知识点-v2"><a class="header-anchor" href="#步骤-3-基于前面的知识点-v2">¶</a>步骤 3 : 基于前面的知识点</h4>
<p>本知识点基于[SSM整合]进行</p>
<h4 id="步骤-4-本知识点效果"><a class="header-anchor" href="#步骤-4-本知识点效果">¶</a>步骤 4 : 本知识点效果</h4>
<p>访问页面看到如图所示效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/listCategory</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4555.png" alt></p>
<h4 id="步骤-5-分页类：Page"><a class="header-anchor" href="#步骤-5-分页类：Page">¶</a>步骤 5 : 分页类：Page</h4>
<p>Page类用于存放分页信息：<br>
start: 开始位置<br>
count: 每页的个数<br>
last: 最后一页的位置<br>
caculateLast()方法: 通过总数total和每页的个数计算出最后一页的位置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.util;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Page</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> start=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> start;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStart</span><span class="params">(<span class="keyword">int</span> start)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.start = start;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCount</span><span class="params">(<span class="keyword">int</span> count)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.count = count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> last;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLast</span><span class="params">(<span class="keyword">int</span> last)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.last = last;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">caculateLast</span><span class="params">(<span class="keyword">int</span> total)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 假设总数是50，是能够被5整除的，那么最后一页的开始就是45</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> == total % count)</span><br><span class="line">            last = total - count;</span><br><span class="line">        <span class="comment">// 假设总数是51，不能够被5整除的，那么最后一页的开始就是50</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            last = total - total % count;      </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-Category-xml"><a class="header-anchor" href="#步骤-6-Category-xml">¶</a>步骤 6 : Category.xml</h4>
<p>修改list，根据当有分页信息的时候，进行分页查询<br>
增加total sql语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"add"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"delete"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"get"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"list"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_     </span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"start!=null and count!=null"</span>&gt;</span></span><br><span class="line">                    limit #&#123;start&#125;,#&#123;count&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"total"</span> <span class="attr">resultType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">            select count(*) from   category_     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>            </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-CategoryMapper"><a class="header-anchor" href="#步骤-7-CategoryMapper">¶</a>步骤 7 : CategoryMapper</h4>
<p>增加total方法用于调用[Category.xml]( 中total对应的sql语句<br>
增加 list(Page page)，根据分页来查询数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;  </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">(Page page)</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">total</span><span class="params">()</span></span>; </span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-CategoryService"><a class="header-anchor" href="#步骤-8-CategoryService">¶</a>步骤 8 : CategoryService</h4>
<p>增加total用于获取所有<br>
增加 list(Page page)，根据分页来查询数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">total</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">list</span><span class="params">(Page page)</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-CategoryServiceImpl"><a class="header-anchor" href="#步骤-9-CategoryServiceImpl">¶</a>步骤 9 : CategoryServiceImpl</h4>
<p>实现total()和list(Page page) 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span>  <span class="keyword">implements</span> <span class="title">CategoryService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryMapper categoryMapper;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryMapper.list();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">(Page page)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> categoryMapper.list(page);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">total</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryMapper.total();</span><br><span class="line">    &#125;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-CategoryController"><a class="header-anchor" href="#步骤-10-CategoryController">¶</a>步骤 10 : CategoryController</h4>
<p>修改listCategory，接受分页信息的注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">listCategory(Page page)</span><br></pre></td></tr></table></figure>
<p>根据分页对象，进行查询获取对象集合cs</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Category&gt; cs= categoryService.list(page);</span><br></pre></td></tr></table></figure>
<p>根据总数，计算出最后一页的信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> total = categoryService.total();</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 告诉spring mvc这是一个控制器类</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryService categoryService;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"listCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">listCategory</span><span class="params">(Page page)</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        List&lt;Category&gt; cs= categoryService.list(page);</span><br><span class="line">        <span class="keyword">int</span> total = categoryService.total();</span><br><span class="line">         </span><br><span class="line">        page.caculateLast(total);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">// 放入转发参数</span></span><br><span class="line">        mav.addObject(<span class="string">"cs"</span>, cs);</span><br><span class="line">        <span class="comment">// 放入jsp路径</span></span><br><span class="line">        mav.setViewName(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-listCategory-jsp"><a class="header-anchor" href="#步骤-11-listCategory-jsp">¶</a>步骤 11 : listCategory.jsp</h4>
<p>修改listCategory.jsp，分别提供首页，上一页，下一页，末页等连接</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">  </span><br><span class="line"> &lt;div style=<span class="string">"width:500px;margin:0px auto;text-align:center"</span>&gt;</span><br><span class="line">    &lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;div style=<span class="string">"text-align:center"</span>&gt;</span><br><span class="line">        &lt;a href="?start=0"&gt;首  页&lt;/a&gt;</span><br><span class="line">        &lt;a href="?start=$&#123;page.start-page.count&#125;"&gt;上一页&lt;/a&gt;</span><br><span class="line">        &lt;a href="?start=$&#123;page.start+page.count&#125;"&gt;下一页&lt;/a&gt;</span><br><span class="line">        &lt;a href="?start=$&#123;page.last&#125;"&gt;末  页&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> &lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-增加100个对象，用于测试"><a class="header-anchor" href="#步骤-12-增加100个对象，用于测试">¶</a>步骤 12 : 增加100个对象，用于测试</h4>
<p>修改MybatisTest 类，新增100个对象，用于分页测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">@ContextConfiguration("classpath:applicationContext.xml")</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//  @Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            Category category = <span class="keyword">new</span> Category();</span><br><span class="line">            category.setName(<span class="string">"new Category"</span>);</span><br><span class="line">            categoryMapper.add(category);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTotal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> total = categoryMapper.total();</span><br><span class="line">        System.out.println(total);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Page p = <span class="keyword">new</span> Page();</span><br><span class="line">        p.setStart(<span class="number">2</span>);</span><br><span class="line">        p.setCount(<span class="number">3</span>);</span><br><span class="line">        List&lt;Category&gt; cs=categoryMapper.list(p);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-测试"><a class="header-anchor" href="#步骤-13-测试">¶</a>步骤 13 : 测试</h4>
<p>访问页面看到如图所示效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/listCategory</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4553.png" alt></p>
<h3 id="3、PAGEHELPER"><a class="header-anchor" href="#3、PAGEHELPER">¶</a>3、PAGEHELPER</h3>
<h4 id="步骤-1-基于前面的知识点"><a class="header-anchor" href="#步骤-1-基于前面的知识点">¶</a>步骤 1 : 基于前面的知识点</h4>
<p>本知识点基于[SSM 分页进行]，[SSM 分页进行]是采用手动SQL方式进行，本知识点将采用PageHelper插件进行。<br>
参考： [PageHelper和Mybatis整合教程]</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v3"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v3">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-3-模仿和排错-v3"><a class="header-anchor" href="#步骤-3-模仿和排错-v3">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-效果-v4"><a class="header-anchor" href="#步骤-4-效果-v4">¶</a>步骤 4 : 效果</h4>
<p>访问页面看到如图所示效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/listCategory</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5862.png" alt></p>
<h4 id="步骤-5-jar包"><a class="header-anchor" href="#步骤-5-jar包">¶</a>步骤 5 : jar包</h4>
<p>因为是第三方插件，所以需要额外的jar包，都在右上角提供了下载：pagehelper-5.1.0-beta2.jar，jsqlparser-1.0.jar<br>
下载后放在WEB-INF/lib下</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5863.png" alt></p>
<h4 id="步骤-6-修改applicationContext-xml"><a class="header-anchor" href="#步骤-6-修改applicationContext-xml">¶</a>步骤 6 : 修改applicationContext.xml</h4>
<p>增加38-48的PageHelper插件配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">     </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"plugins"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.github.pagehelper.PageInterceptor"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"properties"</span>&gt;</span></span><br><span class="line">                  <span class="comment">&lt;!--使用下面的方式配置参数，一行配置一个 --&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">property</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.mapper"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-CategoryService"><a class="header-anchor" href="#步骤-7-CategoryService">¶</a>步骤 7 : CategoryService</h4>
<p>CategoryService去掉total方法和list(Page) 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-CategoryServiceImpl"><a class="header-anchor" href="#步骤-8-CategoryServiceImpl">¶</a>步骤 8 : CategoryServiceImpl</h4>
<p>CategoryServiceImpl去掉total方法和list(Page) 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span>  <span class="keyword">implements</span> <span class="title">CategoryService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryMapper categoryMapper;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryMapper.list();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-CategoryMapper"><a class="header-anchor" href="#步骤-9-CategoryMapper">¶</a>步骤 9 : CategoryMapper</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Category category)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>; </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;  </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-Category-xml"><a class="header-anchor" href="#步骤-10-Category-xml">¶</a>步骤 10 : Category.xml</h4>
<p>Category.xml去掉total对应的sql语句，list也去掉limit</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.mapper.CategoryMapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"add"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            insert into category_ ( name ) values (#&#123;name&#125;)   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"delete"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            delete from category_ where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"get"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_  where id= #&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update"</span> <span class="attr">parameterType</span>=<span class="string">"Category"</span> &gt;</span></span><br><span class="line">            update category_ set name=#&#123;name&#125; where id=#&#123;id&#125;   </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"list"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from   category_     </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-CategoryController"><a class="header-anchor" href="#步骤-11-CategoryController">¶</a>步骤 11 : CategoryController</h4>
<p>CategoryController在调用categoryService.list(); 之前，执行：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.offsetPage(page.getStart(),<span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>并通过int total = (int) new PageInfo&lt;&gt;(cs).getTotal();获取总数。<br>
其他都不变</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.support.PagedListHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 告诉spring mvc这是一个控制器类</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryService categoryService;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"listCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">listCategory</span><span class="params">(Page page)</span></span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        PageHelper.offsetPage(page.getStart(),<span class="number">5</span>);</span><br><span class="line">        List&lt;Category&gt; cs= categoryService.list();</span><br><span class="line">        <span class="keyword">int</span> total = (<span class="keyword">int</span>) <span class="keyword">new</span> PageInfo&lt;&gt;(cs).getTotal();</span><br><span class="line">         </span><br><span class="line">        page.caculateLast(total);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">// 放入转发参数</span></span><br><span class="line">        mav.addObject(<span class="string">"cs"</span>, cs);</span><br><span class="line">        <span class="comment">// 放入jsp路径</span></span><br><span class="line">        mav.setViewName(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-MybatisTest"><a class="header-anchor" href="#步骤-12-MybatisTest">¶</a>步骤 12 : MybatisTest</h4>
<p>MybatisTest 类注释掉用旧方式分页的代码，其实全部都注释掉了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">@ContextConfiguration("classpath:applicationContext.xml")</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//    @Autowired</span></span><br><span class="line"><span class="comment">//    private CategoryMapper categoryMapper;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">////  @Test</span></span><br><span class="line"><span class="comment">//    public void testAdd() &#123;</span></span><br><span class="line"><span class="comment">//        for (int i = 0; i &lt; 100; i++) &#123;</span></span><br><span class="line"><span class="comment">//            Category category = new Category();</span></span><br><span class="line"><span class="comment">//            category.setName("new Category");</span></span><br><span class="line"><span class="comment">//            categoryMapper.add(category);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//    </span></span><br><span class="line"><span class="comment">//    @Test</span></span><br><span class="line"><span class="comment">//    public void testTotal() &#123;</span></span><br><span class="line"><span class="comment">//        int total = categoryMapper.total();</span></span><br><span class="line"><span class="comment">//        System.out.println(total);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    @Test</span></span><br><span class="line"><span class="comment">//    public void testList() &#123;</span></span><br><span class="line"><span class="comment">//        Page p = new Page();</span></span><br><span class="line"><span class="comment">//        p.setStart(2);</span></span><br><span class="line"><span class="comment">//        p.setCount(3);</span></span><br><span class="line"><span class="comment">//        List&lt;Category&gt; cs=categoryMapper.list(p);</span></span><br><span class="line"><span class="comment">//        for (Category c : cs) &#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(c.getName());</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-重启tomcat-测试"><a class="header-anchor" href="#步骤-13-重启tomcat-测试">¶</a>步骤 13 : 重启tomcat,测试</h4>
<p>重启tomcat,访问地址:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/ssm/listCategory?start=5</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5870.png" alt></p>
<h3 id="4、在SSM中使用C3P0连接池"><a class="header-anchor" href="#4、在SSM中使用C3P0连接池">¶</a>4、在SSM中使用C3P0连接池</h3>
<p>本知识点讲解如何在SSM中配置数据库连接池。 连接池的效果要大量测试才能够看得出效果，本知识点主要是为了将来如果你要修改成连接池的时候，复制粘贴方便~</p>
<h4 id="步骤-1-先运行，看到效果，再学习-v94"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v94">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v94"><a class="header-anchor" href="#步骤-2-模仿和排错-v94">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于分页进行"><a class="header-anchor" href="#步骤-3-基于分页进行">¶</a>步骤 3 : 基于分页进行</h4>
<p>本知识点，基于[分页]进行。</p>
<h4 id="步骤-4-修改applicationContext-xml"><a class="header-anchor" href="#步骤-4-修改applicationContext-xml">¶</a>步骤 4 : 修改applicationContext.xml</h4>
<p>注释掉52-66行的原有datasource，新增Druid连接池</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.alibaba.druid.pool.DruidDataSource"</span> <span class="attr">init-method</span>=<span class="string">"init"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 基本属性 url、user、password --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"admin"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 配置初始化大小、最小、最大 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"initialSize"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minIdle"</span> <span class="attr">value</span>=<span class="string">"3"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 配置获取连接等待超时的时间 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxWait"</span> <span class="attr">value</span>=<span class="string">"60000"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"timeBetweenEvictionRunsMillis"</span> <span class="attr">value</span>=<span class="string">"60000"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 配置一个连接在池中最小生存的时间，单位是毫秒 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"minEvictableIdleTimeMillis"</span> <span class="attr">value</span>=<span class="string">"300000"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validationQuery"</span> <span class="attr">value</span>=<span class="string">"SELECT 1"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testWhileIdle"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnBorrow"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testOnReturn"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- 打开PSCache，并且指定每个连接上PSCache的大小 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"poolPreparedStatements"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxPoolPreparedStatementPerConnectionSize"</span> <span class="attr">value</span>=<span class="string">"20"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="comment">&lt;!--     &lt;bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;property name="driverClassName"&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--           &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;/property&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;property name="url"&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--           &lt;value&gt;jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8&lt;/value&gt;   --&gt;</span></span><br><span class="line">      </span><br><span class="line"><span class="comment">&lt;!--       &lt;/property&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;property name="username"&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--           &lt;value&gt;root&lt;/value&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;/property&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;property name="password"&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--           &lt;value&gt;admin&lt;/value&gt;   --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;/property&gt;      --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--     &lt;/bean&gt;    --&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.mapper"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-测试-v7"><a class="header-anchor" href="#步骤-5-测试-v7">¶</a>步骤 5 : 测试</h4>
<p>访问页面看到如图所示效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/listCategory</span></span><br></pre></td></tr></table></figure>
<p>连接池要大量测试才能够看得出效果，这个测试仅仅表示可以像以前一样正常工作。</p>
<p>本知识点主要是为了将来如果你要修改成c3p0的时候，复制粘贴方便~</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4559.png" alt></p>
<h3 id="5、做增删改查-CRUD一套"><a class="header-anchor" href="#5、做增删改查-CRUD一套">¶</a>5、做增删改查 CRUD一套</h3>
<p>SSM的CRUD需要的步骤比较繁琐，无法在一个知识点讲清楚，所以。。。直接给出了我做好的CRUD 可运行项目</p>
<p>其实步骤跟[SSM查询整合步骤]一样，只是传参数的方式有区别而已。 关于传参在[Spring MVC传参中]有讲，这里我就直接做出来，你们直接下载看做好的就行了。</p>
<p>最好先参考[SSM查询整合步骤]，自己把CRUD做一遍，做的过程中碰到了问题，再来看我是怎么解决的，这样收获就比较好。</p>
<h4 id="步骤-1-测试地址"><a class="header-anchor" href="#步骤-1-测试地址">¶</a>步骤 1 : 测试地址</h4>
<p>部署右上角的可运行项目，测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/listCategory</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5843.png" alt></p>
<h4 id="步骤-2-练习-基于分类的产品CRUD"><a class="header-anchor" href="#步骤-2-练习-基于分类的产品CRUD">¶</a>步骤 2 : 练习-基于分类的产品CRUD</h4>
<p>本知识点是单纯的分类的CRUD,那么接下来做一个练习，是基于分类的产品CURD。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/5846.png" alt></p>
<h3 id="6、进行注解式和XML配置式事务管理"><a class="header-anchor" href="#6、进行注解式和XML配置式事务管理">¶</a>6、进行注解式和XML配置式事务管理</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v95"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v95">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<p><strong>效果：</strong> 运行MybatisTest故意制造错误，会观察到被事务管理的方法：addTwo，因为某一条sql语句失败了，另一个sql语句也没有成功生效(要么都成功，要么都失败)</p>
<h4 id="步骤-2-模仿和排错-v95"><a class="header-anchor" href="#步骤-2-模仿和排错-v95">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-本知识点效果"><a class="header-anchor" href="#步骤-3-本知识点效果">¶</a>步骤 3 : 本知识点效果</h4>
<p>本知识点将演示，使用事务之前和使用事务之后的效果区别，以及分别使用注解和XML方式在SSM中配置事务。</p>
<p>本知识点基于[SSM整合]的基础上进行</p>
<h4 id="步骤-4-MYSQL-表的类型必须是INNODB才支持事务-v2"><a class="header-anchor" href="#步骤-4-MYSQL-表的类型必须是INNODB才支持事务-v2">¶</a>步骤 4 : MYSQL 表的类型必须是INNODB才支持事务</h4>
<p>在Mysql中，只有当表的类型是INNODB的时候，才支持事务，所以需要把表的类型设置为INNODB,否则无法观察到事务.</p>
<p>修改表的类型为INNODB的SQL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table category_ ENGINE  &#x3D; innodb;</span><br></pre></td></tr></table></figure>
<p>查看表的类型的SQL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show table status from how2java;</span><br></pre></td></tr></table></figure>
<p>不过有个前提，就是当前的MYSQL服务器本身要支持INNODB,如果不支持，请看 [开启MYSQL INNODB的办法]</p>
<h4 id="步骤-5-导入JAR包"><a class="header-anchor" href="#步骤-5-导入JAR包">¶</a>步骤 5 : 导入JAR包</h4>
<p>做事务管理需要额外的jar才行，所以先在右上角下载aspectjweaver.jar,<br>
把jar包导入到项目中，导包办法：右键 project-&gt;properties-&gt;java build path-&gt;libaries-&gt;add external jars</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4582.png" alt></p>
<h4 id="步骤-6-CategoryService"><a class="header-anchor" href="#步骤-6-CategoryService">¶</a>步骤 6 : CategoryService</h4>
<p>为接口CategoryService增加addTwo和deleteAll方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addTwo</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteAll</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-CategoryServiceImpl"><a class="header-anchor" href="#步骤-7-CategoryServiceImpl">¶</a>步骤 7 : CategoryServiceImpl</h4>
<p>在CategoryServiceImpl中实现deleteAll和addTwo方法。<br>
分别做如下事情：</p>
<ol>
<li>删除所有Category</li>
<li>增加2个Category对象，第一个可以正常增加，第二个因为名字太长，加入会失败。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span>  <span class="keyword">implements</span> <span class="title">CategoryService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryMapper categoryMapper;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryMapper.list();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">             </span><br><span class="line">            categoryMapper.delete(c.getId());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         </span><br><span class="line">        Category c1 = <span class="keyword">new</span> Category();</span><br><span class="line">        c1.setName(<span class="string">"短的名字"</span>);</span><br><span class="line">        categoryMapper.add(c1);</span><br><span class="line">         </span><br><span class="line">        Category c2 = <span class="keyword">new</span> Category();</span><br><span class="line">        c2.setName(<span class="string">"名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,"</span>);</span><br><span class="line">        categoryMapper.add(c2);</span><br><span class="line">    &#125;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-修改测试类，观察效果"><a class="header-anchor" href="#步骤-8-修改测试类，观察效果">¶</a>步骤 8 : 修改测试类，观察效果</h4>
<p>修改测试类MybatisTest ：注入CategoryService 对象，并调用deleteAll和addTwo方法，运行后在数据库中发现只有只有一条数据插入成功了，说明addTwo方法不是事务管理的。 如果是事务管理的，那么就应该都成功，或者都失败。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4575.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RunWith</span>(SpringJUnit4ClassRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line">@ContextConfiguration("classpath:applicationContext.xml")</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisTest</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAddTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        categoryService.deleteAll();</span><br><span class="line">        categoryService.addTwo();</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-进行事务配置"><a class="header-anchor" href="#步骤-9-进行事务配置">¶</a>步骤 9 : 进行事务配置</h4>
<p>修改applicationContext.xml，添加事务管理器和事务注解扫描器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">     </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.mapper"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-使用注解方式"><a class="header-anchor" href="#步骤-10-使用注解方式">¶</a>步骤 10 : 使用注解方式</h4>
<p>为addTwo方法加上事务注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span>  <span class="keyword">implements</span> <span class="title">CategoryService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryMapper categoryMapper;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">list</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryMapper.list();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = list();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">             </span><br><span class="line">            categoryMapper.delete(c.getId());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span>(propagation=Propagation.REQUIRED,rollbackForClassName=<span class="string">"Exception"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         </span><br><span class="line">        Category c1 = <span class="keyword">new</span> Category();</span><br><span class="line">        c1.setName(<span class="string">"短的名字"</span>);</span><br><span class="line">        categoryMapper.add(c1);</span><br><span class="line">         </span><br><span class="line">        Category c2 = <span class="keyword">new</span> Category();</span><br><span class="line">        c2.setName(<span class="string">"名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,名字长对应字段放不下,"</span>);</span><br><span class="line">        categoryMapper.add(c2);</span><br><span class="line">    &#125;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-运行测试类，观察效果"><a class="header-anchor" href="#步骤-11-运行测试类，观察效果">¶</a>步骤 11 : 运行测试类，观察效果</h4>
<p>运行测试类MybatisTest发现数据库里是空的。因为第二个数据插入不进去，所以第一个数据的插入也回滚了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4578.png" alt></p>
<h4 id="步骤-12-使用XML配置方式"><a class="header-anchor" href="#步骤-12-使用XML配置方式">¶</a>步骤 12 : 使用XML配置方式</h4>
<p>修改applicationContext，以支持AOP方式</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">     http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.service"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/how2java?characterEncoding=UTF-8<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">     </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSession"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeAliasesPackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.pojo"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath:com/how2java/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.how2java.mapper"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="comment">&lt;!--     &lt;tx:annotation-driven transaction-manager="transactionManager"/&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txadvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"add*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"del*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"edit*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"list*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span> <span class="attr">rollback-for</span>=<span class="string">"Exception"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span> </span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"serviceMethod"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.how2java.service.*.*(..))"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">pointcut-ref</span>=<span class="string">"serviceMethod"</span> <span class="attr">advice-ref</span>=<span class="string">"txadvice"</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span>      </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-运行测试类，观察效果"><a class="header-anchor" href="#步骤-13-运行测试类，观察效果">¶</a>步骤 13 : 运行测试类，观察效果</h4>
<p>运行MybatisTest可以看到一样的事务效果，即都没有插入成功</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/4580.png" alt></p>
<h4 id="步骤-14-为什么不启动Web应用进行测试？"><a class="header-anchor" href="#步骤-14-为什么不启动Web应用进行测试？">¶</a>步骤 14 : 为什么不启动Web应用进行测试？</h4>
<p>为什么不启动Web应用进行测试？ 而是要用一个MybatisTest这种方式？</p>
<p>因为根据前面的教材，都是基于一个实体类做管理的ssm应用，不方便重现事务出问题的现象。</p>
<p>通过本教材的方式，也是修改Service以提供事务管理的支持，其效果也是能够运用在web应用的。</p>
<h3 id="7、框架做前后端分离"><a class="header-anchor" href="#7、框架做前后端分离">¶</a>7、框架做前后端分离</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v96"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v96">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。</p>
<h4 id="步骤-2-模仿和排错-v96"><a class="header-anchor" href="#步骤-2-模仿和排错-v96">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-本知识点效果-v2"><a class="header-anchor" href="#步骤-3-本知识点效果-v2">¶</a>步骤 3 : 本知识点效果</h4>
<p>本知识点效果有三个，分别是以json方式：提交，获取单个和获取多个<br>
提交</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/ssm/submit.html</span></span><br></pre></td></tr></table></figure>
<p>获取单个</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/ssm/getOne.html</span></span><br></pre></td></tr></table></figure>
<p>获取多个</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/ssm/getMany.html</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-jquery-min-js"><a class="header-anchor" href="#步骤-4-jquery-min-js">¶</a>步骤 4 : jquery.min.js</h4>
<p>因为要使用jquery进行提交和解析json格式数据，所以需要在把右上角的jquery.mini.js复制到WebContent目录下先</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6682.png" alt></p>
<h4 id="步骤-5-json中文问题"><a class="header-anchor" href="#步骤-5-json中文问题">¶</a>步骤 5 : json中文问题</h4>
<p>虽然在[spring mvc 中文问题]里已经提供了过滤器进行ssm的中文处理，但是json处理还要加点额外的内容。<br>
把原本的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改为如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"supportedMediaTypes"</span> <span class="attr">value</span>=<span class="string">"text/plain;charset=UTF-8"</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span>    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span> <span class="attr">xmlns:jdbc</span>=<span class="string">"http://www.springframework.org/schema/jdbc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.how2java.controller"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span> &gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mvc:message-converters</span> <span class="attr">register-defaults</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"supportedMediaTypes"</span> <span class="attr">value</span>=<span class="string">"text/plain;charset=UTF-8"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"viewClass"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">value</span>=<span class="string">"org.springframework.web.servlet.view.JstlView"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-CategoryController"><a class="header-anchor" href="#步骤-6-CategoryController">¶</a>步骤 6 : CategoryController</h4>
<p>控制器里提供3个方法，分别用来处理json 提交，json获取单个对象，json获取多个对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.controller;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 告诉spring mvc这是一个控制器类</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/submitCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">submitCategory</span><span class="params">(@RequestBody Category category)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"SSM接受到浏览器提交的json，并转换为Category对象:"</span>+category);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/getOneCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getOneCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         Category c = <span class="keyword">new</span> Category();</span><br><span class="line">         c.setId(<span class="number">100</span>);</span><br><span class="line">         c.setName(<span class="string">"第100个分类"</span>);</span><br><span class="line">         JSONObject json= <span class="keyword">new</span> JSONObject();</span><br><span class="line">         json.put(<span class="string">"category"</span>, JSONObject.toJSON(c));</span><br><span class="line">         <span class="keyword">return</span> json.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/getManyCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getManyCategory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            Category c = <span class="keyword">new</span> Category();</span><br><span class="line">            c.setId(i);</span><br><span class="line">            c.setName(<span class="string">"分类名称:"</span>+i);</span><br><span class="line">            cs.add(c);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> JSONObject.toJSON(cs).toString();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-submit-html"><a class="header-anchor" href="#步骤-7-submit-html">¶</a>步骤 7 : submit.html</h4>
<p>提交成功后，在tomcat控制台查看使用json方式提交的数据</p>
<p><strong>注：</strong> 不要在eclipse自带的浏览器里面点击，自带的浏览器有bug，有时候不能识别jquery, 会导致点击没有反应。 使用独立的浏览器，比如chrome,firefox点击测试</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6684.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式提交数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> &gt;</span> </span><br><span class="line">       id：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span> </span><br><span class="line">       名称：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"category xxx"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> id=<span class="built_in">document</span>.getElementById(<span class="string">'id'</span>).value; </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> name=<span class="built_in">document</span>.getElementById(<span class="string">'name'</span>).value; </span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> category=&#123;<span class="string">"name"</span>:name,<span class="string">"id"</span>:id&#125;; </span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> jsonData = <span class="built_in">JSON</span>.stringify(category);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> page=<span class="string">"submitCategory"</span>; </span></span><br><span class="line">         </span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">                type:<span class="string">"post"</span>,</span></span><br><span class="line">               url: page,</span><br><span class="line">               data:jsonData,</span><br><span class="line"><span class="actionscript">               dataType:<span class="string">"json"</span>,</span></span><br><span class="line"><span class="actionscript">               contentType : <span class="string">"application/json;charset=UTF-8"</span>,</span></span><br><span class="line"><span class="actionscript">               success: <span class="function"><span class="keyword">function</span><span class="params">(result)</span></span>&#123;</span></span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"><span class="actionscript">           alert(<span class="string">"提交成功，请在Tomcat控制台查看服务端接收到的数据"</span>);</span></span><br><span class="line"> </span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-getOne-html"><a class="header-anchor" href="#步骤-8-getOne-html">¶</a>步骤 8 : getOne.html</h4>
<p>点击按钮，获取json数据</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/6686.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式获取数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"通过AJAX获取一个Hero对象---"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> url=<span class="string">"getOneCategory"</span>; </span></span><br><span class="line"><span class="javascript">        $.post(</span></span><br><span class="line">                url,</span><br><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                     <span class="keyword">var</span> json=<span class="built_in">JSON</span>.parse(data); </span></span><br><span class="line"><span class="actionscript">                     <span class="keyword">var</span> name =json.category.name; </span></span><br><span class="line"><span class="actionscript">                     <span class="keyword">var</span> id = json.category.id;</span></span><br><span class="line"><span class="javascript">                     $(<span class="string">"#messageDiv"</span>).html(<span class="string">"分类id："</span>+ id + <span class="string">"&lt;br&gt;分类名称:"</span> +name );</span></span><br><span class="line">                       </span><br><span class="line">         &#125;);  </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-getMany-html"><a class="header-anchor" href="#步骤-9-getMany-html">¶</a>步骤 9 : getMany.html</h4>
<p>点击按钮，获取多个json数据</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式获取数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"通过AJAX获取多个Hero对象111"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">        </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> url=<span class="string">"getManyCategory"</span>; </span></span><br><span class="line"><span class="javascript">        $.post(</span></span><br><span class="line">                url,</span><br><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">var</span> categorys = $.parseJSON(data);</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(categorys.length);</span></span><br><span class="line"> </span><br><span class="line">                     for(i in categorys)&#123;</span><br><span class="line"><span class="javascript">                         <span class="keyword">var</span> old = $(<span class="string">"#messageDiv"</span>).html();</span></span><br><span class="line"><span class="actionscript">                         <span class="keyword">var</span> category = categorys[i];</span></span><br><span class="line"><span class="javascript">                         $(<span class="string">"#messageDiv"</span>).html(old + <span class="string">"&lt;br&gt;"</span>+category.id+<span class="string">"   -----   "</span>+category.name); </span></span><br><span class="line">                     &#125;</span><br><span class="line">         &#125;);  </span><br><span class="line">    &#125;); </span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="8、MAVEN-风格"><a class="header-anchor" href="#8、MAVEN-风格">¶</a>8、MAVEN 风格</h3>
<p>SSM模块的知识点都是基于Eclpise的动态Web项目风格进行的。 在有的开发环境下，会使用Maven风格来做SSM项目开发。<br>
为此，专门基于Eclipse和IDEA这两种不同的集成开发环境做了4个知识点来帮助大家建立Maven项目的风格：</p>
<p>[使用Eclipse创建一个Maven风格的SSM项目]<br>
[使用Eclipse导入一个Maven风格的SSM项目]<br>
[使用IDEA创建一个Maven风格的SSM项目]<br>
[使用IDEA导入一个Maven风格的SSM项目]</p>
<p><strong>注：</strong> 学习Maven风格的项目，应该先把 [Maven 教程] 学习了再来，欲速则不达，不要急于求成。<br>
<strong>注：</strong> 学习IDEA Maven风格的项目，应该先把 [IDEA 教程]学习了再来，欲速则不达，不要急于求成。</p>
<h3 id="9、RESTFUL-风格的SSM项目"><a class="header-anchor" href="#9、RESTFUL-风格的SSM项目">¶</a>9、RESTFUL 风格的SSM项目</h3>
<h4 id="步骤-1-Restful-风格是什么"><a class="header-anchor" href="#步骤-1-Restful-风格是什么">¶</a>步骤 1 : Restful 风格是什么</h4>
<p>大家在做Web开发的过程中，method常用的值是get和post. 可事实上，method值还可以是put和delete等等其他值。<br>
既然method值如此丰富，那么就可以考虑使用同一个url，但是<strong>约定</strong>不同的method来实施不同的业务，这就是Restful的基本考虑。<br>
CRUD是最常见的操作，在使用Restful 风格之前，通常的增加做法是这样的：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/addCategory?name=xxx</span><br></pre></td></tr></table></figure>
<p>可是使用了Restful风格之后，增加就变成了：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/categories</span><br></pre></td></tr></table></figure>
<p>CRUD如下表所示，URL就都使用一样的 <strong>“/categories”</strong>，区别只是在于method不同，服务器根据method的不同来判断浏览器期望做的业务行为</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">传统风格</th>
<th style="text-align:center">Restful风格</th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">url</td>
<td style="text-align:center">method</td>
<td style="text-align:center">url</td>
<td style="text-align:center">method</td>
</tr>
<tr>
<td style="text-align:center">增加</td>
<td style="text-align:center">/addCategory?name=xxx</td>
<td style="text-align:center">POST</td>
<td style="text-align:center">/categories</td>
<td style="text-align:center">POST</td>
</tr>
<tr>
<td style="text-align:center">删除</td>
<td style="text-align:center">/deleteCategory?id=123</td>
<td style="text-align:center">GET</td>
<td style="text-align:center">/categories/123</td>
<td style="text-align:center">DELETE</td>
</tr>
<tr>
<td style="text-align:center">修改</td>
<td style="text-align:center">/updateCategory?id=123&amp;name=yyy</td>
<td style="text-align:center">POST</td>
<td style="text-align:center">/categories/123</td>
<td style="text-align:center">PUT</td>
</tr>
<tr>
<td style="text-align:center">获取</td>
<td style="text-align:center">/getCategory?id=123</td>
<td style="text-align:center">GET</td>
<td style="text-align:center">/categories/123</td>
<td style="text-align:center">GET</td>
</tr>
<tr>
<td style="text-align:center">查询</td>
<td style="text-align:center">/listCategory</td>
<td style="text-align:center">GET</td>
<td style="text-align:center">/categories</td>
<td style="text-align:center">GET</td>
</tr>
</tbody>
</table>
<h4 id="步骤-2-先运行，看到效果，再学习-v4"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v4">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>右上角准备了一个可以运行的restful风格的crud，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
启动后，测试地址是：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/ssm/categories</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 这个restful风格的curd，是在[传统风格的crud的基础上修改了]，所以最好先熟悉之后，再学习该知识点。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7111.png" alt></p>
<h4 id="步骤-3-web-xml"><a class="header-anchor" href="#步骤-3-web-xml">¶</a>步骤 3 : web.xml</h4>
<p>SpringMVC 只能处理post和get,为了还原对put和delete的处理，web.xml里面要加如下过滤器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:web</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span> <span class="attr">version</span>=<span class="string">"2.5"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- spring的配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span>    </span><br><span class="line">         </span><br><span class="line">    <span class="comment">&lt;!-- spring mvc核心：分发servlet --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>mvc-dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- spring mvc的配置文件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>mvc-dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-listCategory-jsp"><a class="header-anchor" href="#步骤-4-listCategory-jsp">¶</a>步骤 4 : listCategory.jsp</h4>
<p>listCategory.jsp 做了如下修改</p>
<ol>
<li>增加<br>
action修改为&quot;categories&quot;</li>
<li>删除<br>
2.1 url修改为categories/id<br>
2.2 点击超链后，会使用form提交，并且提交_method的值为delete, 这样在 springmvc得到后，就会以 method=delete 处理了。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(function()&#123;                     </span><br><span class="line">  $(<span class="string">".delete"</span>).click(function()&#123;</span><br><span class="line">   <span class="keyword">var</span> href=$(<span class="keyword">this</span>).attr(<span class="string">"href"</span>);</span><br><span class="line">   $(<span class="string">"#formdelete"</span>).attr(<span class="string">"action"</span>,href).submit();</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>
<p>获取<br>
3.1 url修改为了/categories/id</p>
</li>
<li>
<p>在最开始增加了jquery.min.js的引入</p>
</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type="text/javascript" src="js/jquery.min.js"&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">  </span><br><span class="line"> &lt;script type="text/javascript" src="js/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line">  </span><br><span class="line">    &lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">       <span class="comment">/*将post method 改变为delete*/</span></span><br><span class="line">      $(function()&#123;                    </span><br><span class="line">           $(<span class="string">".delete"</span>).click(function()&#123;</span><br><span class="line">               <span class="keyword">var</span> href=$(<span class="keyword">this</span>).attr(<span class="string">"href"</span>);</span><br><span class="line">               $(<span class="string">"#formdelete"</span>).attr(<span class="string">"action"</span>,href).submit();</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">           &#125;)</span><br><span class="line">       &#125;)</span><br><span class="line">   &lt;/script&gt;</span><br><span class="line">    </span><br><span class="line"> &lt;div style=<span class="string">"width:500px;margin:0px auto;text-align:center"</span>&gt;</span><br><span class="line">    &lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;编辑&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;删除&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a href="categories/$&#123;c.id&#125;"&gt;编辑&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a class="delete" href="categories/$&#123;c.id&#125;"&gt;删除&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;div style=<span class="string">"text-align:center"</span>&gt;</span><br><span class="line">        &lt;a href="?start=0"&gt;首  页&lt;/a&gt;</span><br><span class="line">        &lt;a href="?start=$&#123;page.start-page.count&#125;"&gt;上一页&lt;/a&gt;</span><br><span class="line">        &lt;a href="?start=$&#123;page.start+page.count&#125;"&gt;下一页&lt;/a&gt;</span><br><span class="line">        &lt;a href="?start=$&#123;page.last&#125;"&gt;末  页&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;div style=<span class="string">"text-align:center;margin-top:40px"</span>&gt;</span><br><span class="line">        &lt;form method=<span class="string">"POST"</span> action=<span class="string">"categories"</span>&gt;</span><br><span class="line">                分类名称： &lt;input name=<span class="string">"name"</span> value=<span class="string">""</span> type=<span class="string">"text"</span>&gt; &lt;br&gt;&lt;br&gt;</span><br><span class="line">                &lt;input type=<span class="string">"submit"</span> value=<span class="string">"增加分类"</span>&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/div&gt;   </span><br><span class="line"> &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;form id=<span class="string">"formdelete"</span> action=<span class="string">""</span> method=<span class="string">"POST"</span> &gt;</span><br><span class="line">       &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"DELETE"</span>&gt;</span><br><span class="line">   &lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-editCategory-jsp"><a class="header-anchor" href="#步骤-5-editCategory-jsp">¶</a>步骤 5 : editCategory.jsp</h4>
<p>action修改为了 categories/id<br>
<strong>注意</strong>：form 下增加 filed, 虽然这个form的method是post, 但是springmvc看到这个_method的值是put后，会把其修改为put.</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"PUT"</span>&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span> <span class="keyword">import</span>=<span class="string">"java.util.*"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">  </span><br><span class="line"> &lt;div style=<span class="string">"width:500px;margin:0px auto;text-align:center"</span>&gt;</span><br><span class="line">    &lt;div style=<span class="string">"text-align:center;margin-top:40px"</span>&gt;</span><br><span class="line">        &lt;form method=<span class="string">"post"</span> action=<span class="string">"../categories/$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">            &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"PUT"</span>&gt;</span><br><span class="line">            分类名称： &lt;input name=<span class="string">"name"</span> value=<span class="string">"$&#123;c.name&#125;"</span> type=<span class="string">"text"</span>&gt; &lt;br&gt;&lt;br&gt;</span><br><span class="line">            &lt;input type=<span class="string">"submit"</span> value=<span class="string">"修改分类"</span>&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;/div&gt;   </span><br><span class="line"> &lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-CategoryController-v2"><a class="header-anchor" href="#步骤-6-CategoryController-v2">¶</a>步骤 6 : CategoryController</h4>
<p>CRUD的RequestMapping都修改为了/categories,只是method各不相同。<br>
其他的。。。没变化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.service.CategoryService;</span><br><span class="line"><span class="keyword">import</span> com.how2java.util.Page;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 告诉spring mvc这是一个控制器类</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    CategoryService categoryService;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/categories"</span>,method=RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">listCategory</span><span class="params">(Page page)</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        List&lt;Category&gt; cs= categoryService.list(page);</span><br><span class="line">        <span class="keyword">int</span> total = categoryService.total();</span><br><span class="line">         </span><br><span class="line">        page.caculateLast(total);</span><br><span class="line">         </span><br><span class="line">        <span class="comment">// 放入转发参数</span></span><br><span class="line">        mav.addObject(<span class="string">"cs"</span>, cs);</span><br><span class="line">        <span class="comment">// 放入jsp路径</span></span><br><span class="line">        mav.setViewName(<span class="string">"listCategory"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/categories"</span>,method=RequestMethod.POST)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">addCategory</span><span class="params">(Category category)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"category.getName():"</span>+category.getName());</span><br><span class="line">        categoryService.add(category);</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/categories"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;  </span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/categories/&#123;id&#125;"</span>,method=RequestMethod.DELETE)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">deleteCategory</span><span class="params">(Category category)</span></span>&#123;</span><br><span class="line">        categoryService.delete(category);</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/categories"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/categories/&#123;id&#125;"</span>,method=RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editCategory</span><span class="params">(Category category)</span></span>&#123;</span><br><span class="line">        Category c= categoryService.get(category.getId());</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"editCategory"</span>);</span><br><span class="line">        mav.addObject(<span class="string">"c"</span>, c);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/categories/&#123;id&#125;"</span>,method=RequestMethod.PUT)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">updateCategory</span><span class="params">(Category category)</span></span>&#123;</span><br><span class="line">        categoryService.update(category);</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"redirect:/categories"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;  </span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="拾贰、SPRINGBOOT"><a class="header-anchor" href="#拾贰、SPRINGBOOT">¶</a>拾贰、SPRINGBOOT</h1>
<h2 id="一、基础-v4"><a class="header-anchor" href="#一、基础-v4">¶</a>一、基础</h2>
<h3 id="1、SPRINGBOOT入门（在ECLIPSE中创建跑得起来的SPRINGBOOT项目，非STS插件方式）"><a class="header-anchor" href="#1、SPRINGBOOT入门（在ECLIPSE中创建跑得起来的SPRINGBOOT项目，非STS插件方式）">¶</a>1、SPRINGBOOT入门（在ECLIPSE中创建跑得起来的SPRINGBOOT项目，非STS插件方式）</h3>
<p>在学习SSM(H)的过程中，需要做大量的配置工作，其实很多配置行为本身只是手段，并不是目的。 基于这个考虑，把该简化的简化，该省略的省略，开发人员只用关心提供业务功能就行了，这就是 SpringBoot。</p>
<p>换言之，SpringBoot可以简单地看成简化了的、按照约定开发的SSM(H)。 开发速度大大提升。 可是呢，最好还是有 SSM(H)的基础，否则其中用到了Spring MVC,Mybatis,Hibernate的地方，或觉得摸不着头脑。</p>
<p><strong>注：</strong> 括弧里的(H)表示Hibernate.</p>
<h4 id="步骤-1-关于环境版本"><a class="header-anchor" href="#步骤-1-关于环境版本">¶</a>步骤 1 : 关于环境版本</h4>
<p>尽量使用JDK8 32版本，低于8肯定不行，高于8会出薛定谔BUG，尽量使用8，请下载JDK8： [下载以及配置JDK环境]</p>
<p>Eclipse 也尽量使用站长提供的，规避环境原因导致的问题：[Eclipse]</p>
<p><strong>注：</strong> JDK8 64位版本与当前项目提供的 jar 包不兼容，请使用 站长提供的32位的。</p>
<h4 id="步骤-2-关于-SpringBoot-版本"><a class="header-anchor" href="#步骤-2-关于-SpringBoot-版本">¶</a>步骤 2 : 关于 SpringBoot 版本</h4>
<p>本系列教程用的是 1.5.9.RELEASE， 现在已经有更新的 Springboot 2.x 版本了。<br>
他们之间的用法大同小异，但是仍然有一些区别。</p>
<p>希望同学们先在 1.5.9.RELEASE 的基础上学习、掌握、熟练之后，如果还有兴趣，再自行切换到 2.x 版本上。<br>
这里要强调的是，如果现在就切换成 2.x 版本了，并且运行站长当前 springboot 系列教材里的代码，会出现难以预料的错误，最后是给自己学习制造了障碍。<br>
所以站长扯着嗓子破音连喊3句： <strong>不要随意修改版本号！不要随意修改版本号！不要随意修改版本号！</strong></p>
<h4 id="步骤-3-关于IDE"><a class="header-anchor" href="#步骤-3-关于IDE">¶</a>步骤 3 : 关于IDE</h4>
<p>目前主流的开发工具是Eclipse和IDEA，所以分开讲，当前知识点用Eclipse,下一个知识点用IDEA。</p>
<h4 id="步骤-4-关于STS插件"><a class="header-anchor" href="#步骤-4-关于STS插件">¶</a>步骤 4 : 关于STS插件</h4>
<p>Eclipse 提供了一个专门开发 SpringBoot 的插件叫做 Spring Tool Suite. 这个插件的安装是使用国外的源，安装很卡，起码几十分钟去了。<br>
而SpringBoot 应用，本质上是一个Java 程序，其采用的风格是 maven 风格，所以又是一个 Maven 项目，接下来我们就按照 maven 项目的方式创建就行了。 不要被花里胡哨的插件掩盖了其本质。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7116.png" alt></p>
<h4 id="步骤-5-先运行，看到效果，再学习-v2"><a class="header-anchor" href="#步骤-5-先运行，看到效果，再学习-v2">¶</a>步骤 5 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
这是一个 maven 项目， Eclipse 导入 maven 项目的办法，请参考如下步骤：[在 Eclipse 中导入 maven 项目]<br>
然后运行类： <strong>com.how2java.springboot.Application</strong> 的主方法<br>
接着访问地址:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p>就可以看到如图所示效果。<br>
<strong>注：</strong> 这个maven项目用到很多jar包，如果嫌jar包下载缓慢，可以使用我正在使用的库:[站长使用的 maven 仓库]，就是有点大~</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7117.png" alt></p>
<h4 id="步骤-6-模仿和排错-v2"><a class="header-anchor" href="#步骤-6-模仿和排错-v2">¶</a>步骤 6 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-7-关于-Tomcat"><a class="header-anchor" href="#步骤-7-关于-Tomcat">¶</a>步骤 7 : 关于 Tomcat</h4>
<p>[先运行，看到效果，再学习] 跑成功的同学，可能有一点会觉得很奇怪。 这明明跑动起来的是一个 web 程序，为什么启动方式不是启动 tomcat？ 而是启动的一个 Java 类的 主方法？<br>
这是因为这个 <strong>com.how2java.springboot.Application</strong> 类的主方法就把 tomcat 嵌入进去了，不需要手动启动 tomcat 了呢。</p>
<h4 id="步骤-8-创建项目"><a class="header-anchor" href="#步骤-8-创建项目">¶</a>步骤 8 : 创建项目</h4>
<p>接下来就开始从0开始创建这个项目了。<br>
首先新建个 maven 项目<br>
菜单 -&gt; File -&gt; New -&gt; Other -&gt; Maven -&gt; Maven -&gt; Maven Project -&gt; New Maven Project<br>
勾上这个 Create a simple project (skip archetype selection), 看吧，Springboot就是个简单的maven 项目</p>
<p><strong>注：</strong> 创建项目之前，要把 [先运行，看到效果，再学习] 步骤里启动的程序退掉先，否则会出问题。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7119.png" alt></p>
<h4 id="步骤-9-输入项目参数"><a class="header-anchor" href="#步骤-9-输入项目参数">¶</a>步骤 9 : 输入项目参数</h4>
<p>接着在参数里输入红色框框这些数值</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7120.png" alt></p>
<h4 id="步骤-10-pom-xml"><a class="header-anchor" href="#步骤-10-pom-xml">¶</a>步骤 10 : pom.xml</h4>
<p>用以下pom.xml里面的内容覆盖掉项目里的pom.xml。</p>
<p>覆盖后，右键点击项目-&gt;Maven-&gt;Update Project 更新一下项目。</p>
<p>这个pom.xml就指定了当前项目需要用到的jar包。<br>
<strong>注：</strong> 这个maven项目用到很多jar包，如果嫌jar包下载缓慢，可以使用我正在使用的库:[站长使用的 maven 仓库]，就是有点大~</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7121.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-Application-java"><a class="header-anchor" href="#步骤-11-Application-java">¶</a>步骤 11 : Application.java</h4>
<p>创建 Application.java，其注解 @SpringBootApplication 表示这是一个SpringBoot应用，运行其主方法就会启动tomcat,默认端口是8080</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Application<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-HelloController-java"><a class="header-anchor" href="#步骤-12-HelloController-java">¶</a>步骤 12 : HelloController.java</h4>
<p>接着创建控制器类HelloController， 这个类就是Spring MVC里的一个普通的控制器。<br>
@RestController 是spring4里的新注解，是@ResponseBody和@Controller的缩写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello Spring Boot!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-运行并测试"><a class="header-anchor" href="#步骤-13-运行并测试">¶</a>步骤 13 : 运行并测试</h4>
<p>接下来就运行[Application.java]， 然后访问地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p>就能看到测试效果了</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7124.png" alt></p>
<h3 id="2、在IDEA中创建跑得起来的SPRINGBOOT项目"><a class="header-anchor" href="#2、在IDEA中创建跑得起来的SPRINGBOOT项目">¶</a>2、在IDEA中创建跑得起来的SPRINGBOOT项目</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v97"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v97">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。 。<br>
这是一个 maven 项目， IDEA 导入 maven 项目的办法，请参考如下步骤：[idea 导入 maven 风格项目]<br>
然后运行类： <strong>com.how2java.springboot.SpringbootApplication</strong> 的主方法<br>
接着访问地址:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p>就可以看到如图所示效果。<br>
<strong>注：</strong> 这个maven项目用到很多jar包，如果嫌jar包下载缓慢，可以使用我正在使用的库:[站长使用的 maven 仓库]，就是有点大~</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7126.png" alt></p>
<h4 id="步骤-2-模仿和排错-v97"><a class="header-anchor" href="#步骤-2-模仿和排错-v97">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-关于-SpringBoot-版本"><a class="header-anchor" href="#步骤-3-关于-SpringBoot-版本">¶</a>步骤 3 : 关于 SpringBoot 版本</h4>
<p>本系列教程用的是 1.5.9.RELEASE， 现在已经有更新的 Springboot 2.x 版本了。<br>
他们之间的用法大同小异，但是仍然有一些区别。</p>
<p>希望同学们先在 1.5.9.RELEASE 的基础上学习、掌握、熟练之后，如果还有兴趣，再自行切换到 2.x 版本上。<br>
这里要强调的是，如果现在就切换成 2.x 版本了，并且运行站长当前 springboot 系列教材里的代码，会出现难以预料的错误，最后是给自己学习制造了障碍。<br>
所以站长扯着嗓子破音连喊3句： <strong>不要随意修改版本号！不要随意修改版本号！不要随意修改版本号！</strong></p>
<h4 id="步骤-4-关于-Tomcat"><a class="header-anchor" href="#步骤-4-关于-Tomcat">¶</a>步骤 4 : 关于 Tomcat</h4>
<p>[先运行，看到效果，再学习] 跑成功的同学，可能有一点会觉得很奇怪。 这明明跑动起来的是一个 web 程序，为什么启动方式不是启动 tomcat？ 而是启动的一个 Java 类的 主方法？<br>
这是因为这个 <strong>com.how2java.springboot.SpringbootApplication</strong> 类的主方法就把 tomcat 嵌入进去了，不需要手动启动 tomcat 了呢。</p>
<h4 id="步骤-5-关于插件"><a class="header-anchor" href="#步骤-5-关于插件">¶</a>步骤 5 : 关于插件</h4>
<p>首先，在IDEA中开发Springboot应用和Eclipse里面一样，本质上都是一个maven 项目。 但是呢，IDEA 本身自带对SpringBoot支持的插件，不像Eclipse那样，要用插件还需要从第三方安装， 而且很缓慢 (国外插件源)。 所以本知识点就使用IDEA自带的 SpringBoot插件来开发了。</p>
<h4 id="步骤-6-创建项目"><a class="header-anchor" href="#步骤-6-创建项目">¶</a>步骤 6 : 创建项目</h4>
<p>菜单 -&gt; New -&gt; Project -&gt; Spring Initializr 然后点 Next</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7127.png" alt></p>
<h4 id="步骤-7-项目参数"><a class="header-anchor" href="#步骤-7-项目参数">¶</a>步骤 7 : 项目参数</h4>
<p>输入如图所示的两个地方的参数，其他参数不用修改，然后Next</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7128.png" alt></p>
<h4 id="步骤-8-选择Web-模块"><a class="header-anchor" href="#步骤-8-选择Web-模块">¶</a>步骤 8 : 选择Web 模块</h4>
<p>接着左边选择 Web, 右边只勾选 Web 即可，然后点击Next</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7129.png" alt></p>
<h4 id="步骤-9-指定项目的路径"><a class="header-anchor" href="#步骤-9-指定项目的路径">¶</a>步骤 9 : 指定项目的路径</h4>
<p>指定项目路径为 <strong>e:\project\springboot</strong> (其他位置也可以)。<br>
如此这般之后，项目就创建成功了，就可以看到项目结构了。</p>
<p><strong>注：</strong> 这个maven项目用到很多jar包，如果嫌jar包下载缓慢，可以使用我正在使用的库:[站长使用的 maven 仓库]，就是有点大~</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7130.png" alt></p>
<h4 id="步骤-10-SpringbootApplication-java"><a class="header-anchor" href="#步骤-10-SpringbootApplication-java">¶</a>步骤 10 : SpringbootApplication.java</h4>
<p>项目创建好之后，就自带一个SpringbootApplication, 其被@SpringBootApplication 所标记，表示这个是一个Springboot 应用</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7131.png" alt></p>
<h4 id="步骤-11-HelloController-java"><a class="header-anchor" href="#步骤-11-HelloController-java">¶</a>步骤 11 : HelloController.java</h4>
<p>新建包 <strong><a href="http://com.how2java.springboot.web" target="_blank" rel="noopener">com.how2java.springboot.web</a></strong>， 然后在其下新建类HelloController.<br>
这个类就是Spring MVC里的一个普通的控制器。<br>
@RestController 是spring4里的新注解，是@ResponseBody和@Controller的缩写。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello Spring Boot!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-运行并测试"><a class="header-anchor" href="#步骤-12-运行并测试">¶</a>步骤 12 : 运行并测试</h4>
<p>接下来就运行 [SpringbootApplication.java]， 然后访问地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p>就能看到测试效果了</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7133.png" alt></p>
<h3 id="3、用-JAR的方式运行SPRINGBOOT项目"><a class="header-anchor" href="#3、用-JAR的方式运行SPRINGBOOT项目">¶</a>3、用 JAR的方式运行SPRINGBOOT项目</h3>
<h4 id="步骤-1-部署方式"><a class="header-anchor" href="#步骤-1-部署方式">¶</a>步骤 1 : 部署方式</h4>
<p>Springboot 和我们之前学习的web 应用程序不一样，其本质上是一个 Java 应用程序，那么又如何部署呢？<br>
通常来说，Springboot 部署会采用两种方式：全部打包成一个jar，或者打包成一个war。<br>
本知识点讲解jar的方式。</p>
<h4 id="步骤-2-可运行项目"><a class="header-anchor" href="#步骤-2-可运行项目">¶</a>步骤 2 : 可运行项目</h4>
<p>开发过程在前面的知识点讲解过了，这里就不表了，首先在右上角下载可运行项目。<br>
下载后解压，比如解压到如图所示目录</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">C:\Users\X7TI\Downloads\springboot</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/" alt><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7136.png" alt="7136"></p>
<h4 id="步骤-3-打包成jar"><a class="header-anchor" href="#步骤-3-打包成jar">¶</a>步骤 3 : 打包成jar</h4>
<p>切换到</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd C:\Users\X7TI\Downloads\springboot</span><br><span class="line">mvn install</span><br></pre></td></tr></table></figure>
<p>这会导致在C:\Users\X7TI\Downloads\springboot 目录下生成一个jar文件</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7137.png" alt></p>
<h4 id="步骤-4-运行该jar"><a class="header-anchor" href="#步骤-4-运行该jar">¶</a>步骤 4 : 运行该jar</h4>
<p>接着输入命令：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar target/springboot-0.0.1-SNAPSHOT.jar</span><br></pre></td></tr></table></figure>
<p>就启动这个jar了<br>
通过这种方式，把此jar上传到服务器并运行，就可达到部署的效果了</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7138.png" alt></p>
<h3 id="4、用WAR的方式部署SPRINGBOOT项目"><a class="header-anchor" href="#4、用WAR的方式部署SPRINGBOOT项目">¶</a>4、用WAR的方式部署SPRINGBOOT项目</h3>
<h4 id="步骤-1-部署方式-v2"><a class="header-anchor" href="#步骤-1-部署方式-v2">¶</a>步骤 1 : 部署方式</h4>
<p>Springboot 和我们之前学习的web 应用程序不一样，其本质上是一个 Java 应用程序，那么又如何部署呢？<br>
通常来说，Springboot 部署会采用两种方式：全部打包成一个jar，或者打包成一个war。<br>
本知识点讲解 <strong>war</strong> 的方式。</p>
<h4 id="步骤-2-可运行项目-v2"><a class="header-anchor" href="#步骤-2-可运行项目-v2">¶</a>步骤 2 : 可运行项目</h4>
<p>开发过程在前面的知识点讲解过了，这里就不表了，首先在右上角下载可运行项目。<br>
下载后解压，比如解压到如图所示目录</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7140.png" alt></p>
<h4 id="步骤-3-Application"><a class="header-anchor" href="#步骤-3-Application">¶</a>步骤 3 : Application</h4>
<p>Application 修改为如下代码<br>
新加@ServletComponentScan注解，并且继承SpringBootServletInitializer 。<br>
为什么要这么改？ 这是规定。。。。 要搞成war ，反正就得这么改~</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.builder.SpringApplicationBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.ServletComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.support.SpringBootServletInitializer;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ServletComponentScan</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">SpringBootServletInitializer</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> SpringApplicationBuilder <span class="title">configure</span><span class="params">(SpringApplicationBuilder application)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> application.sources(Application<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Application<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-pom-xml"><a class="header-anchor" href="#步骤-4-pom-xml">¶</a>步骤 4 : pom.xml</h4>
<p>pom.xml修改为如下代码，主要两个改动<br>
新加打包成war的声明：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>spring-boot-starter-tomcat修改为 provided方式，以避免和独立 tomcat 容器的冲突.<br>
表示provided 只在编译和测试的时候使用，打包的时候就没它了。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span>           </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-创建war包"><a class="header-anchor" href="#步骤-5-创建war包">¶</a>步骤 5 : 创建war包</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd C:\Users\X7TI\Downloads\springboot</span><br><span class="line">mvn clean <span class="keyword">package</span></span><br></pre></td></tr></table></figure>
<p>这样就在 target 目录下 生成了一个 springboot-0.0.1-SNAPSHOT.war 文件</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7143.png" alt></p>
<h4 id="步骤-6-重命名-war-包，然后部署"><a class="header-anchor" href="#步骤-6-重命名-war-包，然后部署">¶</a>步骤 6 : 重命名 war 包，然后部署</h4>
<p>如果用 springboot-0.0.1-SNAPSHOT.war 这个文件名部署，那么访问的时候就要在路径上加上springboot-0.0.1-SNAPSHOT。 所以把这个文件重命名为 ROOT.war<br>
然后把它放进tomcat 的webapps目录下。</p>
<p>**注：**没有tomcat的同学可以在右上角下载。<br>
<strong>注：</strong> ROOT.war　并不是指访问的时候要使用 /ROOT/hello ,而是直接使用/hello 进行访问，ROOT表示根路径。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7144.png" alt></p>
<h4 id="步骤-7-启动并测试"><a class="header-anchor" href="#步骤-7-启动并测试">¶</a>步骤 7 : 启动并测试</h4>
<p>运行tomcat下的 bin目录里的startup.bat, 然后就可以启动了. 启动后访问如下地址测试：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7145.png" alt></p>
<h3 id="5、如何在SPRINGBOOT中使用JSP"><a class="header-anchor" href="#5、如何在SPRINGBOOT中使用JSP">¶</a>5、如何在SPRINGBOOT中使用JSP</h3>
<h4 id="步骤-1-视图支持"><a class="header-anchor" href="#步骤-1-视图支持">¶</a>步骤 1 : 视图支持</h4>
<p>Springboot的默认视图支持是Thymeleaf，但是Thymeleaf 后面才讲，目前我们暂时不熟悉，我们熟悉的还是jsp。 所以本知识点讲解如何让Springboot支持 jsp。</p>
<p>相关：[Thymeleaf 教程]</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v5"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v5">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
测试地址是：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7147.png" alt></p>
<h4 id="步骤-3-模仿和排错-v4"><a class="header-anchor" href="#步骤-3-模仿和排错-v4">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v2"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v2">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>本知识点在[入门-Eclipse]的基础上进行修改</p>
<h4 id="步骤-5-pom-xml"><a class="header-anchor" href="#步骤-5-pom-xml">¶</a>步骤 5 : pom.xml</h4>
<p>增加对JSP支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-application-properties"><a class="header-anchor" href="#步骤-6-application-properties">¶</a>步骤 6 : application.properties</h4>
<p>在src/main/resources 目录下增加 application.properties文件，用于视图重定向jsp文件的位置</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7150.png" alt></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-HelloController"><a class="header-anchor" href="#步骤-7-HelloController">¶</a>步骤 7 : HelloController</h4>
<p>修改HelloController，把本来的@RestController 改为@Controller。<br>
这时返回&quot;hello&quot;就不再是字符串，而是根据[application.properties] 中的视图重定向，到/WEB-INF/jsp目录下去寻找hello.jsp文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(Model m)</span> </span>&#123;</span><br><span class="line">        m.addAttribute(<span class="string">"now"</span>, DateFormat.getDateTimeInstance().format(<span class="keyword">new</span> Date()));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-hello-jsp"><a class="header-anchor" href="#步骤-8-hello-jsp">¶</a>步骤 8 : hello.jsp</h4>
<p>在main目录下，新建-&gt; webapp/WEB-INF/jsp 目录。<br>
随后新建hello.jsp 文件，在其中使用EL 表达式显示放在[HelloController]的model中的当前时间。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7152.png" alt></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">Hi JSP. 现在时间是  $&#123;now&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-启动测试"><a class="header-anchor" href="#步骤-9-启动测试">¶</a>步骤 9 : 启动测试</h4>
<p>测试地址是：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7153.png" alt></p>
<h3 id="6、如何让SPRINGBOOT自动重启"><a class="header-anchor" href="#6、如何让SPRINGBOOT自动重启">¶</a>6、如何让SPRINGBOOT自动重启</h3>
<h4 id="步骤-1-必须重启"><a class="header-anchor" href="#步骤-1-必须重启">¶</a>步骤 1 : 必须重启</h4>
<p>目前的Springboot，当发生了任何修改之后，必须关闭后再启动Application类才能够生效，显得略微麻烦。 Springboot提供了热部署的方式，当发现任何类发生了改变，马上通过JVM类加载的方式，加载最新的类到虚拟机中。 这样就不需要重新启动也能看到修改后的效果了</p>
<h4 id="步骤-2-pom-xml"><a class="header-anchor" href="#步骤-2-pom-xml">¶</a>步骤 2 : pom.xml</h4>
<p>做法很简单，在pom.xml中新增加一个依赖和一个插件就行了。<br>
依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>插件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-重启测试"><a class="header-anchor" href="#步骤-3-重启测试">¶</a>步骤 3 : 重启测试</h4>
<p>重新启动Application，然后随便修改一下HelloController, 就会如图所示观察到控制台的自动重启现象</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7156.png" alt></p>
<h3 id="7、SPRINGBOOT-错误异常处理统一办法"><a class="header-anchor" href="#7、SPRINGBOOT-错误异常处理统一办法">¶</a>7、SPRINGBOOT 错误异常处理统一办法</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v98"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v98">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p>如图所示，使用统一的界面显示异常<br>
<strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7157.png" alt></p>
<h4 id="步骤-2-模仿和排错-v98"><a class="header-anchor" href="#步骤-2-模仿和排错-v98">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-HelloController"><a class="header-anchor" href="#步骤-3-HelloController">¶</a>步骤 3 : HelloController</h4>
<p>修改HelloController，使得访问/hello一定会产生异常: some exception</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.text.DateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        m.addAttribute(<span class="string">"now"</span>, DateFormat.getDateTimeInstance().format(<span class="keyword">new</span> Date()));</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"some exception"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-GlobalExceptionHandler"><a class="header-anchor" href="#步骤-4-GlobalExceptionHandler">¶</a>步骤 4 : GlobalExceptionHandler</h4>
<p>新增加一个类GlobalExceptionHandler，用于捕捉Exception异常以及其子类。<br>
捕捉到之后，把异常信息，发出异常的地址放进ModelAndView里，然后跳转到 errorPage.jsp</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.exception;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(value = Exception<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">ModelAndView</span> <span class="title">defaultErrorHandler</span>(<span class="title">HttpServletRequest</span> <span class="title">req</span>, <span class="title">Exception</span> <span class="title">e</span>) <span class="title">throws</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mav.addObject(<span class="string">"exception"</span>, e);</span><br><span class="line">        mav.addObject(<span class="string">"url"</span>, req.getRequestURL());</span><br><span class="line">        mav.setViewName(<span class="string">"errorPage"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-errorPage-jsp"><a class="header-anchor" href="#步骤-5-errorPage-jsp">¶</a>步骤 5 : errorPage.jsp</h4>
<p>errorPage.jsp 格式化一下，稍微好看点显示这些异常信息</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div style=<span class="string">"width:500px;border:1px solid lightgray;margin:200px auto;padding:80px"</span>&gt;</span><br><span class="line"> </span><br><span class="line">系统 出现了异常，异常原因是：</span><br><span class="line">    $&#123;exception&#125;</span><br><span class="line">    &lt;br&gt;&lt;br&gt;</span><br><span class="line">    出现异常的地址是：</span><br><span class="line">    $&#123;url&#125;</span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-重启测试"><a class="header-anchor" href="#步骤-6-重启测试">¶</a>步骤 6 : 重启测试</h4>
<p>按理说会自动重启，因为配置了[热部署]</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7161.png" alt></p>
<h3 id="8、SPRINGBOOT设置端口和上下文路径"><a class="header-anchor" href="#8、SPRINGBOOT设置端口和上下文路径">¶</a>8、SPRINGBOOT设置端口和上下文路径</h3>
<h4 id="步骤-1-端口和上下文路径"><a class="header-anchor" href="#步骤-1-端口和上下文路径">¶</a>步骤 1 : 端口和上下文路径</h4>
<p>如图所示，可以通过修改application.properties，修改访问的端口号和上下文路径</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7162.png" alt></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">server.port</span>=<span class="string">8888</span></span><br><span class="line"><span class="meta">server.context-path</span>=<span class="string">/test</span></span><br></pre></td></tr></table></figure>
<h3 id="9、SPRINGBOOT-如何进行多配置切换"><a class="header-anchor" href="#9、SPRINGBOOT-如何进行多配置切换">¶</a>9、SPRINGBOOT 如何进行多配置切换</h3>
<h4 id="步骤-1-切换需求"><a class="header-anchor" href="#步骤-1-切换需求">¶</a>步骤 1 : 切换需求</h4>
<p>有时候在本地测试是使用8080端口，可是上线使用的又是80端口。 此时就可以通过多配置文件实现多配置支持与灵活切换</p>
<h4 id="步骤-2-多配置文件"><a class="header-anchor" href="#步骤-2-多配置文件">¶</a>步骤 2 : 多配置文件</h4>
<p>3个配置文件：<br>
核心配置文件：application.properties<br>
开发环境用的配置文件：application-dev.properties<br>
生产环境用的配置文件：application-pro.properties<br>
这样就可以通过application.properties里的spring.profiles.active 灵活地来切换使用哪个环境了</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">pro</span></span><br></pre></td></tr></table></figure>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">8080</span></span><br><span class="line"><span class="meta">server.context-path</span>=<span class="string">/test</span></span><br></pre></td></tr></table></figure>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">server.port</span>=<span class="string">80</span></span><br><span class="line"><span class="meta">server.context-path</span>=<span class="string">/</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-部署"><a class="header-anchor" href="#步骤-3-部署">¶</a>步骤 3 : 部署</h4>
<p>不仅可以通过修改application.properties文件进行切换，还可以在部署环境下，指定不同的参数来确保生产环境总是使用的希望的那套配置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd C:\Users\X7TI\Downloads\springboot</span><br><span class="line">mvn install</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar target/springboot-<span class="number">0.0</span><span class="number">.1</span>-SNAPSHOT.jar --spring.profiles.active=pro</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar target/springboot-<span class="number">0.0</span><span class="number">.1</span>-SNAPSHOT.jar --spring.profiles.active=dev</span><br></pre></td></tr></table></figure>
<p>这样就可以保证在开发环境总是用的8080端口，而到了生产环境总是用的80端口，免去了每次上线还要修改端口号的麻烦。<br>
参考：[ 创建可运行Springboot jar包教程]</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7165.png" alt></p>
<h3 id="10、SPRINGBOOT中用YML方式进行配置"><a class="header-anchor" href="#10、SPRINGBOOT中用YML方式进行配置">¶</a>10、SPRINGBOOT中用YML方式进行配置</h3>
<h4 id="步骤-1-yml-格式"><a class="header-anchor" href="#步骤-1-yml-格式">¶</a>步骤 1 : yml 格式</h4>
<p>现在大家发现，在springboot里还是要用到配置文件的。 除了使用.properties外，springboot还支持 yml格式。<br>
个人觉得yml格式的可读性和…properties比起来差不多，有时候还没有不如properties 看起来那么规整。<br>
但是考虑到很多springboot项目会使用yml格式，还是简单讲讲，主要目的还是为了读懂其他人的项目。</p>
<h4 id="步骤-2-同样内容，不同写法"><a class="header-anchor" href="#步骤-2-同样内容，不同写法">¶</a>步骤 2 : 同样内容，不同写法</h4>
<p>如图所示，左边是application.properties的写法，右边是application.yml的写法，他们达到的效果是相同</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7167.png" alt></p>
<h4 id="步骤-3-application-yml"><a class="header-anchor" href="#步骤-3-application-yml">¶</a>步骤 3 : application.yml</h4>
<p>在application.yml 文件书写注意：</p>
<ol>
<li>不同“等级” 用冒号隔开</li>
<li>次等级的前面是空格，不能使用制表符(tab)</li>
<li>冒号之后如果有值，那么冒号和值之间至少有一个空格，不能紧贴着</li>
</ol>
<p>在这样的配置下，访问的路径如图所示是：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8888/test/hello</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7168.png" alt></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">    <span class="attr">mvc:</span></span><br><span class="line">        <span class="attr">view:</span></span><br><span class="line">            <span class="attr">prefix:</span> <span class="string">/WEB-INF/jsp/</span></span><br><span class="line">            <span class="attr">suffix:</span> <span class="string">.jsp</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">8888</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/test</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-排斥性"><a class="header-anchor" href="#步骤-4-排斥性">¶</a>步骤 4 : 排斥性</h4>
<p>要么用application.properties 要么用 application.yml，不要都用，不要折磨Springboot和自己</p>
<h3 id="11、通过-ECLIPSE-导入-SPRINGBOOT-项目"><a class="header-anchor" href="#11、通过-ECLIPSE-导入-SPRINGBOOT-项目">¶</a>11、通过 ECLIPSE 导入 SPRINGBOOT 项目</h3>
<h4 id="步骤-1-现成项目"><a class="header-anchor" href="#步骤-1-现成项目">¶</a>步骤 1 : 现成项目</h4>
<p>有时候会拿到别人现成的 springboot 项目，而不是从头自己做一个。 这个时候，就需要用导入的方式来 import 这么一个项目了。<br>
本教程讲解如何用 eclipse 来导入。</p>
<h4 id="步骤-2-下载"><a class="header-anchor" href="#步骤-2-下载">¶</a>步骤 2 : 下载</h4>
<p>首先下载右上角的 springboot.rar，这是一个非常简单的 springboot 项目。</p>
<h4 id="步骤-3-导入"><a class="header-anchor" href="#步骤-3-导入">¶</a>步骤 3 : 导入</h4>
<p>Eclipse 导入Springboot 项目办法：</p>
<ol>
<li>菜单-&gt;File-&gt;Import-&gt;Maven-&gt;Existing Maven Projects</li>
<li>如图粘贴右上角springboot.rar 解压出来之后的目录，这个时候点一下 Refresh，下面就会跳出 pom.xml 文件</li>
<li>点 Finish</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8657.png" alt></p>
<h4 id="步骤-4-等待"><a class="header-anchor" href="#步骤-4-等待">¶</a>步骤 4 : 等待</h4>
<p>因为是 maven 项目，所以在本地库没有 springboot 相关 jar 的前提下， eclipse 就会去进行下载。一旦下载完成，就会展现为 如图所示的maven 风格的项目结构。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8658.png" alt></p>
<h4 id="步骤-5-启动"><a class="header-anchor" href="#步骤-5-启动">¶</a>步骤 5 : 启动</h4>
<p>运行启动类 Application，然后访问地址:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p>看到效果，就表示启动成功了。<br>
当然了，不同的springboot项目的启动类是不一样的，不见得都是访问这个地址。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8659.png" alt></p>
<h3 id="12、如何通过-IDEA-导入一个-SPRINGBOOT-项目"><a class="header-anchor" href="#12、如何通过-IDEA-导入一个-SPRINGBOOT-项目">¶</a>12、如何通过 IDEA 导入一个 SPRINGBOOT 项目</h3>
<h4 id="步骤-1-现成项目-v2"><a class="header-anchor" href="#步骤-1-现成项目-v2">¶</a>步骤 1 : 现成项目</h4>
<p>有时候会拿到别人现成的 springboot 项目，而不是从头自己做一个。 这个时候，就需要用导入的方式来 import 这么一个项目了。<br>
本教程讲解如何用 idea 来导入。</p>
<h4 id="步骤-2-下载-v2"><a class="header-anchor" href="#步骤-2-下载-v2">¶</a>步骤 2 : 下载</h4>
<p>首先下载右上角的 springboot.rar，这是一个非常简单的 springboot 项目。</p>
<h4 id="步骤-3-导入-v2"><a class="header-anchor" href="#步骤-3-导入-v2">¶</a>步骤 3 : 导入</h4>
<p>IDEA 导入Springboot 项目办法：</p>
<ol>
<li>菜单-&gt;File-&gt;New-&gt;Project From Existing Sources</li>
<li>如图粘贴右上角springboot.rar 解压出来之后的目录,并选中 pom.xml</li>
<li>点击OK，然后后面就一路 Next 就行了</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8662.png" alt></p>
<h4 id="步骤-4-等待-v2"><a class="header-anchor" href="#步骤-4-等待-v2">¶</a>步骤 4 : 等待</h4>
<p>因为是 maven 项目，所以在本地库没有 springboot 相关 jar 的前提下， idea 就会去进行下载。一旦下载完成，就会展现为 如图所示的maven 风格的项目结构。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8663.png" alt></p>
<h4 id="步骤-5-启动-v2"><a class="header-anchor" href="#步骤-5-启动-v2">¶</a>步骤 5 : 启动</h4>
<p>运行启动类 Application，然后访问地址:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/hello</span></span><br></pre></td></tr></table></figure>
<p>看到效果，就表示启动成功了。<br>
当然了，不同的springboot项目的启动类是不一样的，不见得都是访问这个地址。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8664.png" alt></p>
<h2 id="二、持久层支持"><a class="header-anchor" href="#二、持久层支持">¶</a>二、持久层支持</h2>
<h3 id="1、SPRINGBOOT中如何运用JPA-简单例子"><a class="header-anchor" href="#1、SPRINGBOOT中如何运用JPA-简单例子">¶</a>1、SPRINGBOOT中如何运用JPA,简单例子</h3>
<h4 id="步骤-1-JPA概念"><a class="header-anchor" href="#步骤-1-JPA概念">¶</a>步骤 1 : JPA概念</h4>
<p>JPA(Java Persistence API)是Sun官方提出的Java持久化规范，用来方便大家操作数据库。<br>
真正干活的可能是Hibernate,TopLink等等实现了JPA规范的不同厂商,默认是Hibernate。<br>
本知识演示如何在Springboot中快捷方便地使用JPA。</p>
<h4 id="步骤-2-创建数据库-v3"><a class="header-anchor" href="#步骤-2-创建数据库-v3">¶</a>步骤 2 : 创建数据库</h4>
<p>创建数据库，名称是 how2java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database how2java;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-创建表-v4"><a class="header-anchor" href="#步骤-3-创建表-v4">¶</a>步骤 3 : 创建表</h4>
<p>创建个分类表，字段很简单，就id和name</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">CREATE TABLE category_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  name varchar(30),</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) DEFAULT CHARSET&#x3D;UTF8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-准备数据-v2"><a class="header-anchor" href="#步骤-4-准备数据-v2">¶</a>步骤 4 : 准备数据</h4>
<p>插入4条数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into category_ values(null,&#39;category 1&#39;);</span><br><span class="line">insert into category_ values(null,&#39;category 2&#39;);</span><br><span class="line">insert into category_ values(null,&#39;category 3&#39;);</span><br><span class="line">insert into category_ values(null,&#39;category 4&#39;);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-先运行，看到效果，再学习-v3"><a class="header-anchor" href="#步骤-5-先运行，看到效果，再学习-v3">¶</a>步骤 5 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7170.png" alt></p>
<h4 id="步骤-6-模仿和排错-v3"><a class="header-anchor" href="#步骤-6-模仿和排错-v3">¶</a>步骤 6 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-7-基于前面的知识点"><a class="header-anchor" href="#步骤-7-基于前面的知识点">¶</a>步骤 7 : 基于前面的知识点</h4>
<p>本知识点基于[错误处理]开发，所以最好要把前面的内容学习了哦，不然有些内容恐怕看不懂呢</p>
<h4 id="步骤-8-application-properties"><a class="header-anchor" href="#步骤-8-application-properties">¶</a>步骤 8 : application.properties</h4>
<p>新增数据库链接必须的参数</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.jpa.properties.hibernate.hbm2ddl.auto</span>=<span class="string">update</span></span><br></pre></td></tr></table></figure>
<p>表示会自动更新表结构，所以[创建表] 这一步其实是可以不需要的~</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.jpa.properties.hibernate.hbm2ddl.auto</span>=<span class="string">update</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-pom-xml"><a class="header-anchor" href="#步骤-9-pom-xml">¶</a>步骤 9 : pom.xml</h4>
<p>增加对mysql和jpa的支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mysql--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&lt;!-- jpa--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- mysql--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- jpa--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-Category"><a class="header-anchor" href="#步骤-10-Category">¶</a>步骤 10 : Category</h4>
<p>增加一个包：com.how2java.springboot.pojo，然后创建实体类Category。<br>
@Entity 注解表示这是个实体类<br>
@Table(name = “category_”) 表示这个类对应的表名是 category_ ，注意有下划线哦<br>
@Id 表明主键<br>
@GeneratedValue(strategy = GenerationType.IDENTITY) 表明自增长方式<br>
@Column(name = “id”) 表明对应的数据库字段名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"category_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-CategoryDAO"><a class="header-anchor" href="#步骤-11-CategoryDAO">¶</a>步骤 11 : CategoryDAO</h4>
<p>增加一个包：com.how2java.springboot.dao，然后创建dao接口CategoryDAO，继承了JpaRepository，并且提供泛型&lt;Category,Integer&gt; 表示这个是针对Category类的DAO,Integer表示主键是Integer类型。<br>
JpaRepository 这个父接口，就提供了CRUD, 分页等等一系列的查询了，直接拿来用，都不需要二次开发的了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryDAO</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Category</span>,<span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-CategoryController"><a class="header-anchor" href="#步骤-12-CategoryController">¶</a>步骤 12 : CategoryController</h4>
<p>增加一个包：<a href="http://com.how2java.springboot.web" target="_blank" rel="noopener">com.how2java.springboot.web</a>，然后创建CategoryController 类。</p>
<ol>
<li>接受listCategory映射</li>
<li>然后获取所有的分类数据</li>
<li>接着放入Model中</li>
<li>跳转到listCategory.jsp中</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryDAO categoryDAO;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs=categoryDAO.findAll();</span><br><span class="line">         </span><br><span class="line">        m.addAttribute(<span class="string">"cs"</span>, cs);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-listCategory-jsp"><a class="header-anchor" href="#步骤-13-listCategory-jsp">¶</a>步骤 13 : listCategory.jsp</h4>
<p>用jstl遍历从[CategoryController] 传递过来的集合：cs.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">   </span><br><span class="line">&lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                </span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-14-重启测试"><a class="header-anchor" href="#步骤-14-重启测试">¶</a>步骤 14 : 重启测试</h4>
<p>因为在pom.xml中增加了jar包的依赖，所以仅仅通过Springboot本身的热部署是无法起作用的，得手动重启一下。<br>
然后访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p>观察到如图所示的效果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7181.png" alt></p>
<h4 id="步骤-15-更多关于JPA"><a class="header-anchor" href="#步骤-15-更多关于JPA">¶</a>步骤 15 : 更多关于JPA</h4>
<p>后面有一个[JPA的CRUD和分页]，可以学习到更多的关于JPA的知识</p>
<p><strong>新版mysql8.0.20修改</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在pom.xml中更改版本为8.0.13</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/how2java?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.jpa.properties.hibernate.hbm2ddl.auto</span>=<span class="string">update</span></span><br></pre></td></tr></table></figure>
<p>在application.properties中，修改url与driver-class-name的值。</p>
<h3 id="2、SPRINGBOOT中如何运用MYBATIS-简单例子"><a class="header-anchor" href="#2、SPRINGBOOT中如何运用MYBATIS-简单例子">¶</a>2、SPRINGBOOT中如何运用MYBATIS 简单例子</h3>
<h4 id="步骤-1-关于Mybatis"><a class="header-anchor" href="#步骤-1-关于Mybatis">¶</a>步骤 1 : 关于Mybatis</h4>
<p>Mybatis 是用来进行数据库操作的框架，如果没有相关知识最好学习一下先： [Mybatis 系列教材]</p>
<h4 id="步骤-2-创建数据库-v4"><a class="header-anchor" href="#步骤-2-创建数据库-v4">¶</a>步骤 2 : 创建数据库</h4>
<p>创建数据库，名称是 how2java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database how2java;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-创建表-v5"><a class="header-anchor" href="#步骤-3-创建表-v5">¶</a>步骤 3 : 创建表</h4>
<p>创建个分类表，字段很简单，就id和name</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use how2java;</span><br><span class="line">CREATE TABLE category_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  name varchar(30),</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) DEFAULT CHARSET&#x3D;UTF8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-准备数据-v3"><a class="header-anchor" href="#步骤-4-准备数据-v3">¶</a>步骤 4 : 准备数据</h4>
<p>插入4条数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">insert into category_ values(null,&#39;category 1&#39;);</span><br><span class="line">insert into category_ values(null,&#39;category 2&#39;);</span><br><span class="line">insert into category_ values(null,&#39;category 3&#39;);</span><br><span class="line">insert into category_ values(null,&#39;category 4&#39;);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-先运行，看到效果，再学习-v4"><a class="header-anchor" href="#步骤-5-先运行，看到效果，再学习-v4">¶</a>步骤 5 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7188.png" alt></p>
<h4 id="步骤-6-模仿和排错-v4"><a class="header-anchor" href="#步骤-6-模仿和排错-v4">¶</a>步骤 6 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-7-基于前面的知识点-v2"><a class="header-anchor" href="#步骤-7-基于前面的知识点-v2">¶</a>步骤 7 : 基于前面的知识点</h4>
<p>本知识点基于[错误处理]开发，所以最好要把前面的内容学习了哦，不然有些内容恐怕看不懂呢</p>
<h4 id="步骤-8-application-properties-v2"><a class="header-anchor" href="#步骤-8-application-properties-v2">¶</a>步骤 8 : application.properties</h4>
<p>新增数据库链接必须的参数</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-pom-xml-v2"><a class="header-anchor" href="#步骤-9-pom-xml-v2">¶</a>步骤 9 : pom.xml</h4>
<p>增加对mysql和mybatis的支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-Category-v2"><a class="header-anchor" href="#步骤-10-Category-v2">¶</a>步骤 10 : Category</h4>
<p>增加一个包：com.how2java.springboot.pojo，然后创建实体类Category。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">      </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-CategoryMapper"><a class="header-anchor" href="#步骤-11-CategoryMapper">¶</a>步骤 11 : CategoryMapper</h4>
<p>增加一个包：com.how2java.springboot.mapper，然后创建接口CategoryMapper。<br>
使用注解@Mapper 表示这是一个Mybatis Mapper接口。<br>
使用@Select注解表示调用findAll方法会去执行对应的sql语句。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Select</span>(<span class="string">"select * from category_ "</span>)</span><br><span class="line"><span class="function">List&lt;Category&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>关于Mybatis的注解方式有相关的系列教材： [Mybatis 注解教程]</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ "</span>)</span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-CategoryController-v2"><a class="header-anchor" href="#步骤-12-CategoryController-v2">¶</a>步骤 12 : CategoryController</h4>
<p>增加一个包：<a href="http://com.how2java.springboot.web" target="_blank" rel="noopener">com.how2java.springboot.web</a>，然后创建CategoryController 类。</p>
<ol>
<li>接受listCategory映射</li>
<li>然后获取所有的分类数据</li>
<li>接着放入Model中</li>
<li>跳转到listCategory.jsp中</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryMapper categoryMapper;</span><br><span class="line">      </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs=categoryMapper.findAll();</span><br><span class="line">          </span><br><span class="line">        m.addAttribute(<span class="string">"cs"</span>, cs);</span><br><span class="line">          </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-listCategory-jsp-v2"><a class="header-anchor" href="#步骤-13-listCategory-jsp-v2">¶</a>步骤 13 : listCategory.jsp</h4>
<p>用jstl遍历从[CategoryController] 传递过来的集合：cs.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">   </span><br><span class="line">&lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;cs&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                </span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-14-重启测试-v2"><a class="header-anchor" href="#步骤-14-重启测试-v2">¶</a>步骤 14 : 重启测试</h4>
<p>因为在pom.xml中增加了jar包的依赖，所以仅仅通过Springboot本身的热部署是无法起作用的，得手动重启一下。<br>
然后访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p>观察到如图所示的效果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7196.png" alt></p>
<h3 id="3、MYBATIS-XML方式"><a class="header-anchor" href="#3、MYBATIS-XML方式">¶</a>3、MYBATIS-XML方式</h3>
<h4 id="步骤-1-xml方式"><a class="header-anchor" href="#步骤-1-xml方式">¶</a>步骤 1 : xml方式</h4>
<p>[Mybatis-注解方式] 教程用的是 mybatis 注解方式，可是 mapper 加xml方式也很流行，所以本教程讲 xml 方式怎么做</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v6"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v6">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p>可以看到和[Mybatis-注解方式]一样的效果</p>
<h4 id="步骤-3-模仿和排错-v5"><a class="header-anchor" href="#步骤-3-模仿和排错-v5">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v3"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v3">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>本知识点在 [Mybatis-注解方式] 的基础上进行修改，所以就只讲解哪些地方做了调整</p>
<h4 id="步骤-5-CategoryMapper-v3"><a class="header-anchor" href="#步骤-5-CategoryMapper-v3">¶</a>步骤 5 : CategoryMapper</h4>
<p>去掉了sql 语句的注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-Category-xml-v2"><a class="header-anchor" href="#步骤-6-Category-xml-v2">¶</a>步骤 6 : Category.xml</h4>
<p>在Mapper类旁边，新增加Category.xml文件，里面就是放的这个sql语句</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7655.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.springboot.mapper.CategoryMapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultType</span>=<span class="string">"Category"</span>&gt;</span></span><br><span class="line">            select * from category_</span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-application-properties"><a class="header-anchor" href="#步骤-7-application-properties">¶</a>步骤 7 : application.properties</h4>
<p>修改application.properties， 指明从哪里去找xml配置文件，同时指定别名</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:com/how2java/springboot/mapper/*.xml</span></span><br><span class="line"><span class="meta">mybatis.type-aliases-package</span>=<span class="string">com.how2java.springboot.pojo</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-重启后测试"><a class="header-anchor" href="#步骤-8-重启后测试">¶</a>步骤 8 : 重启后测试</h4>
<p>重启后访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p>貌似可以不用重启，因为是自动重载的。。。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">        		<span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">        		<span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">        			<span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">        		<span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="三、CRUD-分页"><a class="header-anchor" href="#三、CRUD-分页">¶</a>三、CRUD+分页</h2>
<h3 id="1、SPRINGBOOT使用JPA实现完整的增删改查-CRUD和分页"><a class="header-anchor" href="#1、SPRINGBOOT使用JPA实现完整的增删改查-CRUD和分页">¶</a>1、SPRINGBOOT使用JPA实现完整的增删改查 CRUD和分页</h3>
<h4 id="步骤-1-CRUD和分页"><a class="header-anchor" href="#步骤-1-CRUD和分页">¶</a>步骤 1 : CRUD和分页</h4>
<p>在[ JPA 基本用法教程中] 学习了JPA的基本运用，可是最后呢，总归还是要搞 CRUD和分页的。 并且借助CRUD和分页对JPA 的常用手法做一个学习。</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v7"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v7">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
访问测试地址：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/listCategory?start=1</span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7198.png" alt></p>
<h4 id="步骤-3-模仿和排错-v6"><a class="header-anchor" href="#步骤-3-模仿和排错-v6">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v4"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v4">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>本知识点，在[Springboot JPA 基本用法]的基础上进行</p>
<h4 id="步骤-5-CategoryController"><a class="header-anchor" href="#步骤-5-CategoryController">¶</a>步骤 5 : CategoryController</h4>
<p>为CategoryController添加： 增加、删除、获取、修改映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/addCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	categoryDAO.save(c);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/deleteCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">deleteCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	categoryDAO.delete(c);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/updateCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">updateCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	categoryDAO.save(c);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editCategory</span><span class="params">(<span class="keyword">int</span> id,Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	Category c= categoryDAO.getOne(id);</span><br><span class="line">	m.addAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"editCategory"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>值得注意：JPA 新增和修改用的都是save. 它根据实体类的id是否为0来判断是进行增加还是修改</p>
<p>修改查询映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m,@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	start = start&lt;<span class="number">0</span>?<span class="number">0</span>:start;</span><br><span class="line">	Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</span><br><span class="line">	Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</span><br><span class="line">	Page&lt;Category&gt; page =categoryDAO.findAll(pageable);</span><br><span class="line">	m.addAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>在参数里接受当前是第几页 start ，以及每页显示多少条数据 size。 默认值分别是0和5。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(Model m,<span class="meta">@RequestParam</span>(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>) <span class="keyword">int</span> start,<span class="meta">@RequestParam</span>(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>) <span class="keyword">int</span> size)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>如果 start 为负，那么修改为0. 这个事情会发生在当前是首页，并点击了上一页的时候</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start = start&lt;<span class="number">0</span>?<span class="number">0</span>:start;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>设置倒排序</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>根据start,size和sort创建分页对象</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>CategoryDAO根据这个分页对象获取结果page.</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Page&lt;Category&gt; page =categoryDAO.findAll(pageable);</span><br></pre></td></tr></table></figure>
<p>在这个page对象里，不仅包含了分页信息，还包含了数据信息，即有哪些分类数据。 这个可以通过getContent()获取出来。</p>
<ol start="6">
<li>把page放在&quot;page&quot;属性里，跳转到listCategory.jsp</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m.addAttribute(<span class="string">"page"</span>, page);</span><br><span class="line"><span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryDAO categoryDAO;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m,@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        start = start&lt;<span class="number">0</span>?<span class="number">0</span>:start;</span><br><span class="line">         </span><br><span class="line">        Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</span><br><span class="line">        Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</span><br><span class="line">        Page&lt;Category&gt; page =categoryDAO.findAll(pageable);</span><br><span class="line">         </span><br><span class="line">        System.out.println(page.getNumber());</span><br><span class="line">        System.out.println(page.getNumberOfElements());</span><br><span class="line">        System.out.println(page.getSize());</span><br><span class="line">        System.out.println(page.getTotalElements());</span><br><span class="line">        System.out.println(page.getTotalPages());</span><br><span class="line">         </span><br><span class="line">        m.addAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/addCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryDAO.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/deleteCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryDAO.delete(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/updateCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryDAO.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/editCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">ediitCategory</span><span class="params">(<span class="keyword">int</span> id,Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Category c= categoryDAO.getOne(id);</span><br><span class="line">        m.addAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"editCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-listCategory-jsp"><a class="header-anchor" href="#步骤-6-listCategory-jsp">¶</a>步骤 6 : listCategory.jsp</h4>
<p>通过page.getContent遍历当前页面的Category对象。<br>
在分页的时候通过page.number获取当前页面，page.totalPages获取总页面数。<br>
**注：**page.getContent会返回一个泛型是Category的集合。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">   </span><br><span class="line">&lt;div align=<span class="string">"center"</span>&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div style=<span class="string">"width:500px;margin:20px auto;text-align: center"</span>&gt;</span><br><span class="line">    &lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;编辑&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;删除&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;page.content&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a href="editCategory?id=$&#123;c.id&#125;"&gt;编辑&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a href="deleteCategory?id=$&#123;c.id&#125;"&gt;删除&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">         </span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">                &lt;a href="?start=0"&gt;[首  页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.number-1&#125;"&gt;[上一页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.number+1&#125;"&gt;[下一页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.totalPages-1&#125;"&gt;[末  页]&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;form action=<span class="string">"addCategory"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">     </span><br><span class="line">    name: &lt;input name=<span class="string">"name"</span>&gt; &lt;br&gt;</span><br><span class="line">    &lt;button type="submit"&gt;提交&lt;/button&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-editCategory-jsp"><a class="header-anchor" href="#步骤-7-editCategory-jsp">¶</a>步骤 7 : editCategory.jsp</h4>
<p>修改分类的页面</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div style=<span class="string">"margin:0px auto; width:500px"</span>&gt;</span><br><span class="line"> </span><br><span class="line">&lt;form action=<span class="string">"updateCategory"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line"> </span><br><span class="line">name: &lt;input name=<span class="string">"name"</span> value=<span class="string">"$&#123;c.name&#125;"</span>&gt; &lt;br&gt;</span><br><span class="line"> </span><br><span class="line">&lt;input name=<span class="string">"id"</span> type=<span class="string">"hidden"</span> value=<span class="string">"$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">&lt;button type="submit"&gt;提交&lt;/button&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-重启测试"><a class="header-anchor" href="#步骤-8-重启测试">¶</a>步骤 8 : 重启测试</h4>
<p>因为在pom中增加了新jar的依赖，所以要手动重启，重启后访问测试地址：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/listCategory?start=1</span><br></pre></td></tr></table></figure>
<p>看到如图所示的效果</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7204.png" alt></p>
<h3 id="2、SPRINGBOOT使用MYBATIS实现完整的-增删改查-CRUD和分页"><a class="header-anchor" href="#2、SPRINGBOOT使用MYBATIS实现完整的-增删改查-CRUD和分页">¶</a>2、SPRINGBOOT使用MYBATIS实现完整的 增删改查 CRUD和分页</h3>
<h4 id="步骤-1-Mybatis-CRUD和分页"><a class="header-anchor" href="#步骤-1-Mybatis-CRUD和分页">¶</a>步骤 1 : Mybatis CRUD和分页</h4>
<p>这里使用Mybatis来做一个完整的CRUD和分页。 其中分页使用Mybatis 里讲解的[PageHelper插件]。</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v8"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v8">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7213.png" alt></p>
<h4 id="步骤-3-模仿和排错-v7"><a class="header-anchor" href="#步骤-3-模仿和排错-v7">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v5"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v5">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>本知识点基于[Springboot 中 Mybatis 的基本用法] 进行扩展学习</p>
<h4 id="步骤-5-pom-xml-v2"><a class="header-anchor" href="#步骤-5-pom-xml-v2">¶</a>步骤 5 : pom.xml</h4>
<p>增加对PageHelper的支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- pagehelper --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-PageHelperConfig"><a class="header-anchor" href="#步骤-6-PageHelperConfig">¶</a>步骤 6 : PageHelperConfig</h4>
<p>注解@Configuration 表示PageHelperConfig 这个类是用来做配置的。<br>
注解@Bean 表示启动PageHelper这个拦截器。</p>
<p>新增加一个包 com.how2java.springboot.config， 然后添加一个类PageHelperConfig ，其中进行PageHelper相关配置。<br>
offsetAsPageNum:设置为true时，会将RowBounds第一个参数offset当成pageNum页码使用.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.setProperty(<span class="string">"offsetAsPageNum"</span>, <span class="string">"true"</span>);</span><br></pre></td></tr></table></figure>
<p>rowBoundsWithCount:设置为true时，使用RowBounds分页会进行count查询.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.setProperty(<span class="string">"rowBoundsWithCount"</span>, <span class="string">"true"</span>);</span><br></pre></td></tr></table></figure>
<p>reasonable：启用合理化时，如果pageNum&lt;1会查询第一页，如果pageNum&gt;pages会查询最后一页。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.setProperty(<span class="string">"reasonable"</span>, <span class="string">"true"</span>);</span><br></pre></td></tr></table></figure>
<p>**注：**RowBounds是什么鬼？我也没搞太清楚。。。反正这么复制粘贴就对了 ：|</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.config;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageHelperConfig</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PageHelper <span class="title">pageHelper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageHelper pageHelper = <span class="keyword">new</span> PageHelper();</span><br><span class="line">        Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">        p.setProperty(<span class="string">"offsetAsPageNum"</span>, <span class="string">"true"</span>);</span><br><span class="line">        p.setProperty(<span class="string">"rowBoundsWithCount"</span>, <span class="string">"true"</span>);</span><br><span class="line">        p.setProperty(<span class="string">"reasonable"</span>, <span class="string">"true"</span>);</span><br><span class="line">        pageHelper.setProperties(p);</span><br><span class="line">        <span class="keyword">return</span> pageHelper;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-CategoryMapper-v2"><a class="header-anchor" href="#步骤-7-CategoryMapper-v2">¶</a>步骤 7 : CategoryMapper</h4>
<p>修改CategoryMapper，增加CRUD方法的支持。 其实就是调用不同的SQL语句。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ "</span>)</span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">" insert into category_ ( name ) values (#&#123;name&#125;) "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">save</span><span class="params">(Category category)</span></span>; </span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">" delete from category_ where id= #&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">         </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ where id= #&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">       </span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"update category_ set name=#&#123;name&#125; where id=#&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>; </span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-CategoryController"><a class="header-anchor" href="#步骤-8-CategoryController">¶</a>步骤 8 : CategoryController</h4>
<p>为CategoryController添加： 增加、删除、获取、修改映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/addCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	categoryMapper.save(c);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/deleteCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">deleteCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	categoryMapper.delete(c.getId());</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/updateCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">updateCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	categoryMapper.update(c);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(<span class="keyword">int</span> id,Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">	Category c= categoryMapper.get(id);</span><br><span class="line">	m.addAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"editCategory"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改查询映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m,@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    PageHelper.startPage(start,size,<span class="string">"id desc"</span>);</span><br><span class="line">    List&lt;Category&gt; cs=categoryMapper.findAll();</span><br><span class="line">    PageInfo&lt;Category&gt; page = <span class="keyword">new</span> PageInfo&lt;&gt;(cs);</span><br><span class="line">    m.addAttribute(<span class="string">"page"</span>, page);         </span><br><span class="line">    <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>在参数里接受当前是第几页 start ，以及每页显示多少条数据 size。 默认值分别是0和5。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestParam</span>(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>) <span class="keyword">int</span> start,<span class="meta">@RequestParam</span>(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>根据start,size进行分页，并且设置id 倒排序</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.startPage(start,size,<span class="string">"id desc"</span>);</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>因为PageHelper的作用，这里就会返回当前分页的集合了</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Category&gt; cs=categoryMapper.findAll();</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>根据返回的集合，创建PageInfo对象</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PageInfo&lt;Category&gt; page = <span class="keyword">new</span> PageInfo&lt;&gt;(cs);</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>把PageInfo对象扔进model，以供后续显示</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.addAttribute(<span class="string">"page"</span>, page);</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>跳转到listCategory.jsp</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">   </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryMapper categoryMapper;</span><br><span class="line">      </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/addCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryMapper.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/deleteCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryMapper.delete(c.getId());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/updateCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryMapper.update(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/editCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(<span class="keyword">int</span> id,Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Category c= categoryMapper.get(id);</span><br><span class="line">        m.addAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"editCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m,@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        PageHelper.startPage(start,size,<span class="string">"id desc"</span>);</span><br><span class="line">        List&lt;Category&gt; cs=categoryMapper.findAll();</span><br><span class="line">        PageInfo&lt;Category&gt; page = <span class="keyword">new</span> PageInfo&lt;&gt;(cs);</span><br><span class="line">        m.addAttribute(<span class="string">"page"</span>, page);        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-listCategory-jsp"><a class="header-anchor" href="#步骤-9-listCategory-jsp">¶</a>步骤 9 : listCategory.jsp</h4>
<p>通过page.getList遍历当前页面的Category对象。<br>
在分页的时候通过page.pageNum获取当前页面，page.pages获取总页面数。<br>
注：page.getList会返回一个泛型是Category的集合。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">    </span><br><span class="line">&lt;div align=<span class="string">"center"</span>&gt;</span><br><span class="line">  </span><br><span class="line">&lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">&lt;div style=<span class="string">"width:500px;margin:20px auto;text-align: center"</span>&gt;</span><br><span class="line">    &lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;编辑&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;删除&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;page.list&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a href="editCategory?id=$&#123;c.id&#125;"&gt;编辑&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a href="deleteCategory?id=$&#123;c.id&#125;"&gt;删除&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">          </span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">                &lt;a href="?start=1"&gt;[首  页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.pageNum-1&#125;"&gt;[上一页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.pageNum+1&#125;"&gt;[下一页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.pages&#125;"&gt;[末  页]&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;form action=<span class="string">"addCategory"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">      </span><br><span class="line">    name: &lt;input name=<span class="string">"name"</span>&gt; &lt;br&gt;</span><br><span class="line">    &lt;button type="submit"&gt;提交&lt;/button&gt;</span><br><span class="line">      </span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-editCategory-jsp"><a class="header-anchor" href="#步骤-10-editCategory-jsp">¶</a>步骤 10 : editCategory.jsp</h4>
<p>修改分类的页面</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line">  </span><br><span class="line">&lt;div style=<span class="string">"margin:0px auto; width:500px"</span>&gt;</span><br><span class="line">  </span><br><span class="line">&lt;form action=<span class="string">"updateCategory"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">  </span><br><span class="line">name: &lt;input name=<span class="string">"name"</span> value=<span class="string">"$&#123;c.name&#125;"</span>&gt; &lt;br&gt;</span><br><span class="line">  </span><br><span class="line">&lt;input name=<span class="string">"id"</span> type=<span class="string">"hidden"</span> value=<span class="string">"$&#123;c.id&#125;"</span>&gt;</span><br><span class="line">&lt;button type="submit"&gt;提交&lt;/button&gt;</span><br><span class="line">  </span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-重启测试访问"><a class="header-anchor" href="#步骤-11-重启测试访问">¶</a>步骤 11 : 重启测试访问</h4>
<p>因为在pom中增加了新jar的依赖，所以要手动重启，重启后访问测试地址：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/listCategory?start=2</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7221.png" alt></p>
<h3 id="3、SPRINGBOOT-基于SQLITE-和JPA-方式"><a class="header-anchor" href="#3、SPRINGBOOT-基于SQLITE-和JPA-方式">¶</a>3、SPRINGBOOT 基于SQLITE 和JPA 方式</h3>
<h4 id="步骤-1-SQLite-介绍"><a class="header-anchor" href="#步骤-1-SQLite-介绍">¶</a>步骤 1 : SQLite 介绍</h4>
<p>SQLite 是一种数据库，它是跑在 JVM里面的，所以不需要像 mysql 那样得独立安装配置，而是直接拿来就用。。。<br>
本知识点就会把对mysql 的依赖，建立在 sqlite 上，这样大家跑起来就不用费神地安装配置 mysql 数据了啦</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v9"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v9">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
如图所示，效果和使用 mysql 一样， CRUD和分页都有~<br>
测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/9142.png" alt></p>
<h4 id="步骤-3-模仿和排错-v8"><a class="header-anchor" href="#步骤-3-模仿和排错-v8">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v6"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v6">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>本知识点是建立在上一个知识点 [Springboot使用JPA实现完整的增删改查 CRUD和分页] 可运行项目的基础上进行的改进,所以最好把上个知识点理解和消化了.</p>
<h4 id="步骤-5-SQLite-方言一堆"><a class="header-anchor" href="#步骤-5-SQLite-方言一堆">¶</a>步骤 5 : SQLite 方言一堆</h4>
<p>因为是使用 JPA 来链接 SQlite, 而 JPA 默认用的是 Hibernate，所以要为 Hibernate 配置专门的方言。<br>
方言是什么意思呢？<br>
为了更好地和四川人打交道，最好说四川方言。<br>
为了更好地和浙江人打交道，最好说浙江方言。<br>
为了更好地和 sqlite 打交道，最好说 sqlite 方言。<br>
方言就是这么个意思啦，方便 Hibernate和 Sqlite打交道。 方言的英文是 Dialect， 所以就有了SQLiteDialect 这个类了。<br>
除此之外，还需要其他两个类配合。</p>
<p>至于他们是怎么工作的。。。就不用关心啦，反正能用就行啦。。。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.sqlite;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Types;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.hibernate.JDBCException;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.ScrollMode;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.Dialect;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.function.AbstractAnsiTrimEmulationFunction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.function.NoArgSQLFunction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.function.SQLFunction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.function.SQLFunctionTemplate;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.function.StandardSQLFunction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.function.VarArgsSQLFunction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.identity.IdentityColumnSupport;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.pagination.AbstractLimitHandler;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.pagination.LimitHandler;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.pagination.LimitHelper;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.unique.DefaultUniqueDelegate;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.unique.UniqueDelegate;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.engine.spi.RowSelection;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.exception.DataException;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.exception.JDBCConnectionException;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.exception.LockAcquisitionException;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.exception.spi.SQLExceptionConversionDelegate;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.exception.spi.TemplatedViolatedConstraintNameExtracter;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.exception.spi.ViolatedConstraintNameExtracter;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.internal.util.JdbcExceptionHelper;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.mapping.Column;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.type.StandardBasicTypes;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SQLiteDialect</span> <span class="keyword">extends</span> <span class="title">Dialect</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> UniqueDelegate uniqueDelegate;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SQLiteDialect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        registerColumnType(Types.BIT, <span class="string">"boolean"</span>);</span><br><span class="line">        registerColumnType(Types.DECIMAL, <span class="string">"decimal"</span>);</span><br><span class="line">        registerColumnType(Types.CHAR, <span class="string">"char"</span>);</span><br><span class="line">        registerColumnType(Types.LONGVARCHAR, <span class="string">"longvarchar"</span>);</span><br><span class="line">        registerColumnType(Types.TIMESTAMP, <span class="string">"datetime"</span>);</span><br><span class="line">        registerColumnType(Types.BINARY, <span class="string">"blob"</span>);</span><br><span class="line">        registerColumnType(Types.VARBINARY, <span class="string">"blob"</span>);</span><br><span class="line">        registerColumnType(Types.LONGVARBINARY, <span class="string">"blob"</span>);</span><br><span class="line">  </span><br><span class="line">        registerFunction(<span class="string">"concat"</span>, <span class="keyword">new</span> VarArgsSQLFunction(StandardBasicTypes.STRING, <span class="string">""</span>, <span class="string">"||"</span>, <span class="string">""</span>));</span><br><span class="line">        registerFunction(<span class="string">"mod"</span>, <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.INTEGER, <span class="string">"?1 % ?2"</span>));</span><br><span class="line">        registerFunction(<span class="string">"quote"</span>, <span class="keyword">new</span> StandardSQLFunction(<span class="string">"quote"</span>, StandardBasicTypes.STRING));</span><br><span class="line">        registerFunction(<span class="string">"random"</span>, <span class="keyword">new</span> NoArgSQLFunction(<span class="string">"random"</span>, StandardBasicTypes.INTEGER));</span><br><span class="line">        registerFunction(<span class="string">"round"</span>, <span class="keyword">new</span> StandardSQLFunction(<span class="string">"round"</span>));</span><br><span class="line">        registerFunction(<span class="string">"substr"</span>, <span class="keyword">new</span> StandardSQLFunction(<span class="string">"substr"</span>, StandardBasicTypes.STRING));</span><br><span class="line">        registerFunction(<span class="string">"trim"</span>, <span class="keyword">new</span> AbstractAnsiTrimEmulationFunction() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> SQLFunction <span class="title">resolveBothSpaceTrimFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.STRING, <span class="string">"trim(?1)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> SQLFunction <span class="title">resolveBothSpaceTrimFromFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.STRING, <span class="string">"trim(?2)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> SQLFunction <span class="title">resolveLeadingSpaceTrimFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.STRING, <span class="string">"ltrim(?1)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> SQLFunction <span class="title">resolveTrailingSpaceTrimFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.STRING, <span class="string">"rtrim(?1)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> SQLFunction <span class="title">resolveBothTrimFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.STRING, <span class="string">"trim(?1, ?2)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> SQLFunction <span class="title">resolveLeadingTrimFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.STRING, <span class="string">"ltrim(?1, ?2)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">  </span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> SQLFunction <span class="title">resolveTrailingTrimFunction</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> SQLFunctionTemplate(StandardBasicTypes.STRING, <span class="string">"rtrim(?1, ?2)"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        uniqueDelegate = <span class="keyword">new</span> SQLiteUniqueDelegate(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SQLiteDialectIdentityColumnSupport IDENTITY_COLUMN_SUPPORT = <span class="keyword">new</span></span><br><span class="line">            SQLiteDialectIdentityColumnSupport(<span class="keyword">new</span> SQLiteDialect());</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IdentityColumnSupport <span class="title">getIdentityColumnSupport</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> IDENTITY_COLUMN_SUPPORT;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// limit/offset support ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> AbstractLimitHandler LIMIT_HANDLER = <span class="keyword">new</span> AbstractLimitHandler() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">processSql</span><span class="params">(String sql, RowSelection selection)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">boolean</span> hasOffset = LimitHelper.hasFirstRow(selection);</span><br><span class="line">            <span class="keyword">return</span> sql + (hasOffset ? <span class="string">" limit ? offset ?"</span> : <span class="string">" limit ?"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">bindLimitParametersInReverseOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LimitHandler <span class="title">getLimitHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> LIMIT_HANDLER;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// lock acquisition support ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsLockTimeouts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// may be http://sqlite.org/c3ref/db_mutex.html ?</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getForUpdateString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsOuterJoinForUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// current timestamp support ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsCurrentTimestampSelection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isCurrentTimestampSelectStringCallable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCurrentTimestampSelectString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"select current_timestamp"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// SQLException support ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_BUSY = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_LOCKED = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_IOERR = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_CORRUPT = <span class="number">11</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_NOTFOUND = <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_FULL = <span class="number">13</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_CANTOPEN = <span class="number">14</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_PROTOCOL = <span class="number">15</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_TOOBIG = <span class="number">18</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_CONSTRAINT = <span class="number">19</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_MISMATCH = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SQLITE_NOTADB = <span class="number">26</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SQLExceptionConversionDelegate <span class="title">buildSQLExceptionConversionDelegate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SQLExceptionConversionDelegate() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> JDBCException <span class="title">convert</span><span class="params">(SQLException sqlException, String message, String sql)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> errorCode = JdbcExceptionHelper.extractErrorCode(sqlException) &amp; <span class="number">0xFF</span>;</span><br><span class="line">                <span class="keyword">if</span> (errorCode == SQLITE_TOOBIG || errorCode == SQLITE_MISMATCH) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> DataException(message, sqlException, sql);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (errorCode == SQLITE_BUSY || errorCode == SQLITE_LOCKED) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> LockAcquisitionException(message, sqlException, sql);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((errorCode &gt;= SQLITE_IOERR &amp;&amp; errorCode &lt;= SQLITE_PROTOCOL) || errorCode == SQLITE_NOTADB) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> JDBCConnectionException(message, sqlException, sql);</span><br><span class="line">                &#125;</span><br><span class="line">  </span><br><span class="line">                <span class="comment">// returning null allows other delegates to operate</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ViolatedConstraintNameExtracter <span class="title">getViolatedConstraintNameExtracter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> EXTRACTER;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ViolatedConstraintNameExtracter EXTRACTER = <span class="keyword">new</span> TemplatedViolatedConstraintNameExtracter() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> String <span class="title">doExtractConstraintName</span><span class="params">(SQLException sqle)</span> <span class="keyword">throws</span> NumberFormatException </span>&#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">int</span> errorCode = JdbcExceptionHelper.extractErrorCode(sqle) &amp; <span class="number">0xFF</span>;</span><br><span class="line">            <span class="keyword">if</span> (errorCode == SQLITE_CONSTRAINT) &#123;</span><br><span class="line">                <span class="keyword">return</span> extractUsingTemplate(<span class="string">"constraint "</span>, <span class="string">" failed"</span>, sqle.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// union subclass support ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsUnionAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// DDL support ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canCreateSchema</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasAlterTable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// As specified in NHibernate dialect</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dropConstraints</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">qualifyIndexName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddColumnString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"add column"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDropForeignKeyString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"No drop foreign key syntax supported by SQLiteDialect"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddForeignKeyConstraintString</span><span class="params">(String constraintName,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                   String[] foreignKey, String referencedTable, String[] primaryKey,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                   <span class="keyword">boolean</span> referencesPrimaryKey)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"No add foreign key syntax supported by SQLiteDialect"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddPrimaryKeyConstraintString</span><span class="params">(String constraintName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"No add primary key syntax supported by SQLiteDialect"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsCommentOn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsIfExistsBeforeTableName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">doesReadCommittedCauseWritersToBlockReaders</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Validate (WAL mode...)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">doesRepeatableReadCauseReadersToBlockWriters</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsTupleDistinctCounts</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getInExpressionCountLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1000</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UniqueDelegate <span class="title">getUniqueDelegate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> uniqueDelegate;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SQLiteUniqueDelegate</span> <span class="keyword">extends</span> <span class="title">DefaultUniqueDelegate</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">SQLiteUniqueDelegate</span><span class="params">(Dialect dialect)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(dialect);</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getColumnDefinitionUniquenessFragment</span><span class="params">(Column column)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">" unique"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSelectGUIDString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"select hex(randomblob(16))"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ScrollMode <span class="title">defaultScrollMode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ScrollMode.FORWARD_ONLY;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.sqlite;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.Dialect;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.dialect.identity.IdentityColumnSupportImpl;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SQLiteDialectIdentityColumnSupport</span> <span class="keyword">extends</span> <span class="title">IdentityColumnSupportImpl</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SQLiteDialectIdentityColumnSupport</span><span class="params">(Dialect dialect)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(dialect);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsIdentityColumns</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasDataTypeInIdentityColumn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIdentitySelectString</span><span class="params">(String table, String column, <span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"select last_insert_rowid()"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIdentityColumnString</span><span class="params">(<span class="keyword">int</span> type)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"integer"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.sqlite;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.hibernate.boot.MetadataBuilder;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.boot.registry.StandardServiceRegistry;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.boot.spi.MetadataBuilderInitializer;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.engine.jdbc.dialect.internal.DialectResolverSet;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.engine.jdbc.dialect.spi.DialectResolver;</span><br><span class="line"><span class="keyword">import</span> org.jboss.logging.Logger;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SQLiteMetadataBuilderInitializer</span> <span class="keyword">implements</span> <span class="title">MetadataBuilderInitializer</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger logger = Logger.getLogger(SQLiteMetadataBuilderInitializer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contribute</span><span class="params">(MetadataBuilder metadataBuilder, StandardServiceRegistry serviceRegistry)</span> </span>&#123;</span><br><span class="line">        DialectResolver dialectResolver = serviceRegistry.getService(DialectResolver<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">if</span> (!(dialectResolver <span class="keyword">instanceof</span> DialectResolverSet)) &#123;</span><br><span class="line">            logger.warnf(<span class="string">"DialectResolver '%s' is not an instance of DialectResolverSet, not registering SQLiteDialect"</span>,</span><br><span class="line">                    dialectResolver);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        ((DialectResolverSet) dialectResolver).addResolver(resolver);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> SQLiteDialect dialect = <span class="keyword">new</span> SQLiteDialect();</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">private</span> <span class="keyword">final</span> DialectResolver resolver = (DialectResolver) info -&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (info.getDatabaseName().equals(<span class="string">"SQLite"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> dialect;</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-application-properties-v2"><a class="header-anchor" href="#步骤-6-application-properties-v2">¶</a>步骤 6 : application.properties</h4>
<p>对 mysql 的配置，修改到了对 sqlite 的配置，都做了注释，很简单明了</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="comment">#spring.datasource.url=jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="comment">#spring.datasource.username=root</span></span><br><span class="line"><span class="comment">#spring.datasource.password=admin</span></span><br><span class="line"><span class="comment">#spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="comment">#spring.jpa.properties.hibernate.hbm2ddl.auto=update</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">spring.jpa.database-platform</span>=<span class="string">com.how2java.sqlite.SQLiteDialect</span></span><br><span class="line"><span class="comment">#表结构由hibernate根据实体类来帮你创建</span></span><br><span class="line"><span class="meta">spring.jpa.generate-ddl</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#自动根据Entity配置创建表</span></span><br><span class="line"><span class="meta">spring.jpa.hibernate.ddl-auto</span>=<span class="string">update</span></span><br><span class="line"><span class="comment">#数据库文件位置</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:sqlite:how2j.db</span></span><br><span class="line"><span class="comment">#驱动名称</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">org.sqlite.JDBC</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-pom-xml"><a class="header-anchor" href="#步骤-7-pom-xml">¶</a>步骤 7 : pom.xml</h4>
<p>增加 sqlite jar 包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.xerial<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sqlite-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- mysql--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- jpa--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-重启运行"><a class="header-anchor" href="#步骤-8-重启运行">¶</a>步骤 8 : 重启运行</h4>
<p>重启运行，然后访问如下地址就可以看到效果了啦，注： 刚开始没数据，要自己加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<h2 id="四、其他"><a class="header-anchor" href="#四、其他">¶</a>四、其他</h2>
<h3 id="1、单元测试"><a class="header-anchor" href="#1、单元测试">¶</a>1、单元测试</h3>
<h4 id="步骤-1-单元测试"><a class="header-anchor" href="#步骤-1-单元测试">¶</a>步骤 1 : 单元测试</h4>
<p>有时候呢，springboot 里要做单元测试，而不是直接跑起来。 比如 jpa 章节的查询数据，想跑个测试，看看数据库里的数据，那么这里就会讲如何做了</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v10"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v10">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行 TestJPA就可以看到如图所示，在控制台打印了数据库的数据</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8803.png" alt></p>
<h4 id="步骤-3-模仿和排错-v9"><a class="header-anchor" href="#步骤-3-模仿和排错-v9">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v7"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v7">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>本知识点在 [Springboot使用JPA实现完整的增删改查 CRUD和分页] 的基础上进行</p>
<h4 id="步骤-5-pom-xml-v3"><a class="header-anchor" href="#步骤-5-pom-xml-v3">¶</a>步骤 5 : pom.xml</h4>
<ol>
<li>
<p>修改junit 版本为 4.12</p>
</li>
<li>
<p>增加 spring-boot-starter-test</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- mysql--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- jpa--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>       </span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- springboot test --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-测试类-v2"><a class="header-anchor" href="#步骤-6-测试类-v2">¶</a>步骤 6 : 测试类</h4>
<ol>
<li>
<p>需要加上2个注解：<br>
@RunWith(SpringRunner.class)<br>
@SpringBootTest(classes = Application.class)</p>
</li>
<li>
<p>自动装配 CategoryDAO dao; 以便于使用</p>
</li>
<li>
<p>test 方法加上 @Test 注解，然后就可以使用dao来工作了</p>
</li>
<li>
<p>运行的时候选择 JUnit Test 方式</p>
</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8807.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.Application;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span>(<span class="title">classes</span> </span>= Application<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">TestJPA</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span> CategoryDAO dao;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs=  dao.findAll();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(<span class="string">"c.getName():"</span>+ c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-测试-v11"><a class="header-anchor" href="#步骤-7-测试-v11">¶</a>步骤 7 : 测试</h4>
<p>运行 TestJPA 就可以看到如图所示的效果了</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8808.png" alt></p>
<h3 id="2、SPRING-JPA-如何做条件查询"><a class="header-anchor" href="#2、SPRING-JPA-如何做条件查询">¶</a>2、SPRING JPA 如何做条件查询</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v99"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v99">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行 TestJPA可以看到如图所示：进行了3种查询。</p>
<ol>
<li>查询所有的</li>
<li>根据名称查询</li>
<li>根据名称模糊查询，同时 id &gt;5 ,同时 名称正排序</li>
</ol>
<p><strong>注：</strong> 本运行会重置 category 表所有数据</p>
<h4 id="步骤-2-模仿和排错-v99"><a class="header-anchor" href="#步骤-2-模仿和排错-v99">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前面的知识点-v3"><a class="header-anchor" href="#步骤-3-基于前面的知识点-v3">¶</a>步骤 3 : 基于前面的知识点</h4>
<p>本知识点是建立在上一个 spring 单元测试 知识点可运行项目的基础上进行的改进,所以最好把上个知识点理解和消化了.</p>
<h4 id="步骤-4-JPA-条件查询方式"><a class="header-anchor" href="#步骤-4-JPA-条件查询方式">¶</a>步骤 4 : JPA 条件查询方式</h4>
<p>JPA 条件查询方式很有意思，是不需要写 SQL 语句的，只需要在 dao 接口里按照规范的命名定义对应的方法名，及可达到查询相应字段的效果了。<br>
在如下代码里做了如下事情：</p>
<ol>
<li>首先通过 @Before 把 Category表里所有数据都删除了，并新增了10条。</li>
<li>然后 test1() 查询所有数据，看看新增的10条数据。</li>
<li>接着，test2() 通过自定义的接口方法 findByName，根据name 查询分类表</li>
<li>接着，test3() 通过自定义的接口方法 findByNameLikeAndIdGreaterThanOrderByNameAsc，根据名称模糊查询，id 大于某值, 并且名称正排序查询。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.test;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.Application;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span>(<span class="title">classes</span> </span>= Application<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">TestJPA</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span> CategoryDAO dao;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs=  dao.findAll();</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            dao.delete(c);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            Category c = <span class="keyword">new</span> Category();</span><br><span class="line">            c.setName(<span class="string">"category "</span> + i);</span><br><span class="line">            dao.save(c);</span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Category&gt; cs=  dao.findAll();</span><br><span class="line">        System.out.println(<span class="string">"所有的分类信息："</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"查询名称是 \"category 1 \"的分类:"</span>);</span><br><span class="line">        List&lt;Category&gt; cs=  dao.findByName(<span class="string">"category 1"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(<span class="string">"c.getName():"</span>+ c.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"根据名称模糊查询，id 大于5, 并且名称正排序查询"</span>);</span><br><span class="line">        List&lt;Category&gt; cs=  dao.findByNameLikeAndIdGreaterThanOrderByNameAsc(<span class="string">"%3%"</span>,<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (Category c : cs) &#123;</span><br><span class="line">            System.out.println(c);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryDAO</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Category</span>,<span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">findByName</span><span class="params">(String name)</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">findByNameLikeAndIdGreaterThanOrderByNameAsc</span><span class="params">(String name, <span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"category_"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Category [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-实现原理"><a class="header-anchor" href="#步骤-5-实现原理">¶</a>步骤 5 : 实现原理</h4>
<p>虽然 JPA 没有自己手动写sql 语句，但是通过反射获取自定义的接口方法里提供的信息，就知道用户希望根据什么条件来查询了。 然后 JPA 底层再偷偷摸摸地拼装对应的 sql 语句，丢给数据库，就达到了条件查询的效果啦。</p>
<p>对反射不熟悉的同学，可了解反射基础教程：[ 反射基础教程]</p>
<h4 id="步骤-6-条件查询规范"><a class="header-anchor" href="#步骤-6-条件查询规范">¶</a>步骤 6 : 条件查询规范</h4>
<p>[JPA 条件查询方式] 只是个别举例，下表把 jpa 做的各种查询规范都列出来了。 如果要做其他相关查询，按照表格中的规范设计接口方法即可。</p>
<table>
<thead>
<tr>
<th style="text-align:center">关键词</th>
<th style="text-align:center">举例</th>
<th style="text-align:center">生成的JPQL 语句片段</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">And</td>
<td style="text-align:center">findByLastnameAndFirstname</td>
<td style="text-align:center">… where x.lastname = ?1 and x.firstname = ?2</td>
</tr>
<tr>
<td style="text-align:center">Or</td>
<td style="text-align:center">findByLastnameOrFirstname</td>
<td style="text-align:center">… where x.lastname = ?1 or x.firstname = ?2</td>
</tr>
<tr>
<td style="text-align:center">Is,Equals</td>
<td style="text-align:center">findByFirstname, findByFirstnameIs, findByFirstnameEquals</td>
<td style="text-align:center">… where x.firstname = ?1</td>
</tr>
<tr>
<td style="text-align:center">Between</td>
<td style="text-align:center">findByStartDateBetween</td>
<td style="text-align:center">… where x.startDate between ?1 and ?2</td>
</tr>
<tr>
<td style="text-align:center">LessThan</td>
<td style="text-align:center">findByAgeLessThan</td>
<td style="text-align:center">… where x.age &lt; ?1</td>
</tr>
<tr>
<td style="text-align:center">LessThanEqual</td>
<td style="text-align:center">findByAgeLessThanEqual</td>
<td style="text-align:center">… where x.age ⇐ ?1</td>
</tr>
<tr>
<td style="text-align:center">GreaterThan</td>
<td style="text-align:center">findByAgeGreaterThan</td>
<td style="text-align:center">… where x.age &gt; ?1</td>
</tr>
<tr>
<td style="text-align:center">GreaterThanEqual</td>
<td style="text-align:center">findByAgeGreaterThanEqual</td>
<td style="text-align:center">… where x.age &gt;= ?1</td>
</tr>
<tr>
<td style="text-align:center">After</td>
<td style="text-align:center">findByStartDateAfter</td>
<td style="text-align:center">… where x.startDate &gt; ?1</td>
</tr>
<tr>
<td style="text-align:center">Before</td>
<td style="text-align:center">findByStartDateBefore</td>
<td style="text-align:center">… where x.startDate &lt; ?1</td>
</tr>
<tr>
<td style="text-align:center">IsNull</td>
<td style="text-align:center">findByAgeIsNull</td>
<td style="text-align:center">… where x.age is null</td>
</tr>
<tr>
<td style="text-align:center">IsNotNull,NotNull</td>
<td style="text-align:center">findByAge(Is)NotNull</td>
<td style="text-align:center">… where x.age not null</td>
</tr>
<tr>
<td style="text-align:center">Like</td>
<td style="text-align:center">findByFirstnameLike</td>
<td style="text-align:center">… where x.firstname like ?1</td>
</tr>
<tr>
<td style="text-align:center">NotLike</td>
<td style="text-align:center">findByFirstnameNotLike</td>
<td style="text-align:center">… where x.firstname not like ?1</td>
</tr>
<tr>
<td style="text-align:center">StartingWith</td>
<td style="text-align:center">findByFirstnameStartingWith</td>
<td style="text-align:center">… where x.firstname like ?1 (parameter bound with appended %)</td>
</tr>
<tr>
<td style="text-align:center">EndingWith</td>
<td style="text-align:center">findByFirstnameEndingWith</td>
<td style="text-align:center">… where x.firstname like ?1 (parameter bound with prepended %)</td>
</tr>
<tr>
<td style="text-align:center">Containing</td>
<td style="text-align:center">findByFirstnameContaining</td>
<td style="text-align:center">… where x.firstname like ?1 (parameter bound wrapped in %)</td>
</tr>
<tr>
<td style="text-align:center">OrderBy</td>
<td style="text-align:center">findByAgeOrderByLastnameDesc</td>
<td style="text-align:center">… where x.age = ?1 order by x.lastname desc</td>
</tr>
<tr>
<td style="text-align:center">Not</td>
<td style="text-align:center">findByLastnameNot</td>
<td style="text-align:center">… where x.lastname &lt;&gt; ?1</td>
</tr>
<tr>
<td style="text-align:center">In</td>
<td style="text-align:center">findByAgeIn(Collection ages)</td>
<td style="text-align:center">… where x.age in ?1</td>
</tr>
<tr>
<td style="text-align:center">NotIn</td>
<td style="text-align:center">findByAgeNotIn(Collectionage)</td>
<td style="text-align:center">… where x.age not in ?1</td>
</tr>
<tr>
<td style="text-align:center">True</td>
<td style="text-align:center">findByActiveTrue()</td>
<td style="text-align:center">… where x.active = true</td>
</tr>
<tr>
<td style="text-align:center">False</td>
<td style="text-align:center">findByActiveFalse()</td>
<td style="text-align:center">… where x.active = false</td>
</tr>
<tr>
<td style="text-align:center">IgnoreCase</td>
<td style="text-align:center">findByFirstnameIgnoreCase</td>
<td style="text-align:center">… where UPPER(x.firstame) = UPPER(?1)</td>
</tr>
</tbody>
</table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BeforeClass</span> – 表示在类中的任意<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span>方法执行之前执行</span><br><span class="line"><span class="meta">@AfterClass</span> – 表示在类中的任意<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span>方法执行之后执行</span><br><span class="line"><span class="meta">@Before</span> – 表示在任意使用<span class="meta">@Test</span>注解标注的<span class="keyword">public</span> <span class="keyword">void</span>方法执行之前执行</span><br><span class="line"><span class="meta">@After</span> – 表示在任意使用<span class="meta">@Test</span>注解标注的<span class="keyword">public</span> <span class="keyword">void</span>方法执行之后执行</span><br><span class="line"><span class="meta">@Test</span> – 使用该注解标注的<span class="keyword">public</span> <span class="keyword">void</span>方法会表示为一个测试方法</span><br></pre></td></tr></table></figure>
<h3 id="3、SPRINGBOOT-如何上传图片文件"><a class="header-anchor" href="#3、SPRINGBOOT-如何上传图片文件">¶</a>3、SPRINGBOOT 如何上传图片文件</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v100"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v100">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/uploadPage</span></span><br></pre></td></tr></table></figure>
<p>。。。如图所示看到上传后的图片<br>
<strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7223.png" alt></p>
<h4 id="步骤-2-模仿和排错-v100"><a class="header-anchor" href="#步骤-2-模仿和排错-v100">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-基于前面的知识点-v4"><a class="header-anchor" href="#步骤-3-基于前面的知识点-v4">¶</a>步骤 3 : 基于前面的知识点</h4>
<p>本知识点在[Springboot 热部署] 的基础上进行</p>
<h4 id="步骤-4-uploadPage-jsp"><a class="header-anchor" href="#步骤-4-uploadPage-jsp">¶</a>步骤 4 : uploadPage.jsp</h4>
<p>在jsp目录下新建uploadPage.jsp,需要几点：</p>
<ol>
<li>method=“post” 是必须的</li>
<li>enctype=“multipart/form-data” 是必须的，表示提交二进制文件</li>
<li>name=“file” 是必须的，和后续服务端对应</li>
<li>accept=“image/*” 表示只选择图片</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7226.png" alt></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;form action=<span class="string">"upload"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">  选择图片:&lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> accept=<span class="string">"image/*"</span> /&gt; &lt;br&gt;</span><br><span class="line">  &lt;input type=<span class="string">"submit"</span> value=<span class="string">"上传"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-UploadController-java"><a class="header-anchor" href="#步骤-5-UploadController-java">¶</a>步骤 5 : UploadController.java</h4>
<p>因为[uploadPage.jsp] 在WEB-INF下，不能直接从浏览器访问，所以要在这里加一个uploadPage跳转，这样就可以通过</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/uploadPage</span></span><br></pre></td></tr></table></figure>
<p>访问到uploadPage.jsp了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/uploadPage"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">uploadPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"uploadPage"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-UploadController-java"><a class="header-anchor" href="#步骤-6-UploadController-java">¶</a>步骤 6 : UploadController.java</h4>
<p>为UploadController.java 新增upload用来接受上传</p>
<ol>
<li>接受上传的文件</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestParam</span>(<span class="string">"file"</span>) MultipartFile file</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>根据时间戳创建新的文件名，这样即便是第二次上传相同名称的文件，也不会把第一次的文件覆盖了</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String fileName = System.currentTimeMillis()+file.getOriginalFilename();</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>通过req.getServletContext().getRealPath(&quot;&quot;) 获取当前项目的真实路径，然后拼接前面的文件名</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String destFileName=req.getServletContext().getRealPath(<span class="string">""</span>)+<span class="string">"uploaded"</span>+File.separator+fileName;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>第一次运行的时候，这个文件所在的目录往往是不存在的，这里需要创建一下目录</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">File destFile = <span class="keyword">new</span> File(destFileName);</span><br><span class="line">destFile.getParentFile().mkdirs();</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>把浏览器上传的文件复制到希望的位置</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file.transferTo(destFile);</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>把文件名放在model里，以便后续显示用</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m.addAttribute(<span class="string">"fileName"</span>,fileName);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/uploadPage"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">uploadPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"uploadPage"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/upload"</span>, method = RequestMethod.POST)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">upload</span><span class="params">(HttpServletRequest req, @RequestParam(<span class="string">"file"</span>)</span> MultipartFile file,Model m) </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                String fileName = System.currentTimeMillis()+file.getOriginalFilename();</span><br><span class="line">                String destFileName=req.getServletContext().getRealPath(<span class="string">""</span>)+<span class="string">"uploaded"</span>+File.separator+fileName;</span><br><span class="line">                 </span><br><span class="line">                File destFile = <span class="keyword">new</span> File(destFileName);</span><br><span class="line">                destFile.getParentFile().mkdirs();</span><br><span class="line">                file.transferTo(destFile);</span><br><span class="line">                 </span><br><span class="line">                m.addAttribute(<span class="string">"fileName"</span>,fileName);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"上传失败,"</span> + e.getMessage();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"上传失败,"</span> + e.getMessage();</span><br><span class="line">            &#125;</span><br><span class="line">             </span><br><span class="line">            <span class="keyword">return</span> <span class="string">"showImg"</span>;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-application-properties-v2"><a class="header-anchor" href="#步骤-7-application-properties-v2">¶</a>步骤 7 : application.properties</h4>
<p>设置上传文件的大小，默认是1m,太小了，文件稍微大一点就会出错</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">spring.http.multipart.maxFileSize</span>=<span class="string">100Mb</span></span><br><span class="line"><span class="meta">spring.http.multipart.maxRequestSize</span>=<span class="string">100Mb</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-测试-v6"><a class="header-anchor" href="#步骤-8-测试-v6">¶</a>步骤 8 : 测试</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/uploadPage</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7229.png" alt></p>
<h3 id="4、SPRINGBOOT-如何开发-RESTFUL-风格的项目"><a class="header-anchor" href="#4、SPRINGBOOT-如何开发-RESTFUL-风格的项目">¶</a>4、SPRINGBOOT 如何开发 RESTFUL 风格的项目</h3>
<h4 id="步骤-1-Restful-风格是什么-v2"><a class="header-anchor" href="#步骤-1-Restful-风格是什么-v2">¶</a>步骤 1 : Restful 风格是什么</h4>
<p>大家在做Web开发的过程中，method常用的值是get和post. 可事实上，method值还可以是put和delete等等其他值。<br>
既然method值如此丰富，那么就可以考虑使用同一个url，但是<strong>约定</strong>不同的method来实施不同的业务，这就是Restful的基本考虑。<br>
CRUD是最常见的操作，在使用Restful 风格之前，通常的增加做法是这样的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/addCategory?name=xxx</span><br></pre></td></tr></table></figure>
<p>可是使用了Restful风格之后，增加就变成了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/categories</span><br></pre></td></tr></table></figure>
<p>CRUD如下表所示，URL就都使用一样的 <strong>“/categories”</strong>，区别只是在于method不同，服务器根据method的不同来判断浏览器期望做的业务行为</p>
<table>
<thead>
<tr>
<th style="text-align:center">传统风格</th>
<th style="text-align:center">Restful风格</th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">url</td>
<td style="text-align:center">method</td>
<td style="text-align:center">url</td>
<td style="text-align:center">method</td>
</tr>
<tr>
<td style="text-align:center">增加</td>
<td style="text-align:center">/addCategory?name=xxx</td>
<td style="text-align:center">POST</td>
<td style="text-align:center">/categories</td>
<td style="text-align:center">POST</td>
</tr>
<tr>
<td style="text-align:center">删除</td>
<td style="text-align:center">/deleteCategory?id=123</td>
<td style="text-align:center">GET</td>
<td style="text-align:center">/categories/123</td>
<td style="text-align:center">DELETE</td>
</tr>
<tr>
<td style="text-align:center">修改</td>
<td style="text-align:center">/updateCategory?id=123&amp;name=yyy</td>
<td style="text-align:center">POST</td>
<td style="text-align:center">/categories/123</td>
<td style="text-align:center">PUT</td>
</tr>
<tr>
<td style="text-align:center">获取</td>
<td style="text-align:center">/getCategory?id=123</td>
<td style="text-align:center">GET</td>
<td style="text-align:center">/categories/123</td>
<td style="text-align:center">GET</td>
</tr>
<tr>
<td style="text-align:center">查询</td>
<td style="text-align:center">/listCategory</td>
<td style="text-align:center">GET</td>
<td style="text-align:center">/categories</td>
<td style="text-align:center">GET</td>
</tr>
</tbody>
</table>
<h4 id="步骤-2-先运行，看到效果，再学习-v11"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v11">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
访问测试地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/categories</span></span><br></pre></td></tr></table></figure>
<p><strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7233.png" alt></p>
<h4 id="步骤-3-模仿和排错-v10"><a class="header-anchor" href="#步骤-3-模仿和排错-v10">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v8"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v8">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>接下来我们就把 [基于springboot jpa的crud和分页]，修改为Restful风格</p>
<h4 id="步骤-5-listCategory-jsp"><a class="header-anchor" href="#步骤-5-listCategory-jsp">¶</a>步骤 5 : listCategory.jsp</h4>
<p>listCategory.jsp 做了如下修改</p>
<ol>
<li>
<p>增加<br>
1.1 action修改为&quot;categories&quot;</p>
</li>
<li>
<p>删除<br>
2.1 url修改为categories/id<br>
2.2 点击超链后，会使用form提交，并且提交_method的值为delete,以达到和增加类似的效果</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(function()&#123;                     </span><br><span class="line">  $(<span class="string">".delete"</span>).click(function()&#123;</span><br><span class="line">   <span class="keyword">var</span> href=$(<span class="keyword">this</span>).attr(<span class="string">"href"</span>);</span><br><span class="line">   $(<span class="string">"#formdelete"</span>).attr(<span class="string">"action"</span>,href).submit();</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>
<p>获取<br>
3.1 url修改为了/categories/id</p>
</li>
<li>
<p>在最开始增加了jquery.min.js的引入</p>
</li>
</ol>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type="text/javascript" src="js/jquery.min.js"&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br><span class="line">   </span><br><span class="line">&lt;script type="text/javascript" src="js/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">       <span class="comment">/*将post method 改变为delete*/</span></span><br><span class="line">      $(function()&#123;                    </span><br><span class="line">           $(<span class="string">".delete"</span>).click(function()&#123;</span><br><span class="line">               <span class="keyword">var</span> href=$(<span class="keyword">this</span>).attr(<span class="string">"href"</span>);</span><br><span class="line">               $(<span class="string">"#formdelete"</span>).attr(<span class="string">"action"</span>,href).submit();</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">           &#125;)</span><br><span class="line">       &#125;)</span><br><span class="line">   &lt;/script&gt;  </span><br><span class="line">    </span><br><span class="line">&lt;div align=<span class="string">"center"</span>&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div style=<span class="string">"width:500px;margin:20px auto;text-align: center"</span>&gt;</span><br><span class="line">    &lt;table align=<span class="string">'center'</span> border=<span class="string">'1'</span> cellspacing=<span class="string">'0'</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;id&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;name&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;编辑&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;删除&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;c:forEach items=<span class="string">"$&#123;page.content&#125;"</span> <span class="keyword">var</span>=<span class="string">"c"</span> varStatus=<span class="string">"st"</span>&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.id&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;c.name&#125;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a href="categories/$&#123;c.id&#125;"&gt;编辑&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">                &lt;td&gt;&lt;a class="delete" href="categories/$&#123;c.id&#125;"&gt;删除&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">        &lt;/c:forEach&gt;</span><br><span class="line">         </span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">                &lt;a href="?start=0"&gt;[首  页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.number-1&#125;"&gt;[上一页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.number+1&#125;"&gt;[下一页]&lt;/a&gt;</span><br><span class="line">            &lt;a href="?start=$&#123;page.totalPages-1&#125;"&gt;[末  页]&lt;/a&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;form action=<span class="string">"categories"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    name: &lt;input name=<span class="string">"name"</span>&gt; &lt;br&gt;</span><br><span class="line">    &lt;button type="submit"&gt;提交&lt;/button&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">     </span><br><span class="line">    &lt;form id=<span class="string">"formdelete"</span> action=<span class="string">""</span> method=<span class="string">"POST"</span> &gt;</span><br><span class="line">       &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"DELETE"</span>&gt;</span><br><span class="line">   &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-editCategory-jsp"><a class="header-anchor" href="#步骤-6-editCategory-jsp">¶</a>步骤 6 : editCategory.jsp</h4>
<p>action修改为了 categories/id<br>
<strong>注意</strong>：form 下增加 filed, 虽然这个form的method是post, 但是springmvc看到这个_method的值是put后，会把其修改为put.</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"PUT"</span>&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line"> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span>%&gt;</span><br><span class="line"> </span><br><span class="line">&lt;div style=<span class="string">"margin:0px auto; width:500px"</span>&gt;</span><br><span class="line"> </span><br><span class="line">&lt;form action=<span class="string">"../categories/$&#123;c.id&#125;"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"_method"</span> value=<span class="string">"PUT"</span>&gt;</span><br><span class="line">name: &lt;input name=<span class="string">"name"</span> value=<span class="string">"$&#123;c.name&#125;"</span>&gt; &lt;br&gt;</span><br><span class="line">&lt;button type="submit"&gt;提交&lt;/button&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-CategoryController"><a class="header-anchor" href="#步骤-7-CategoryController">¶</a>步骤 7 : CategoryController</h4>
<p>CRUD的RequestMapping都修改为了/categories,以前用的注解叫做@RequestMapper,现在分别叫做 <strong>Get</strong>Mapper, <strong>Put</strong>Mapper,<strong>Post</strong>Mapper 和 <strong>Delete</strong>Mapper 用于表示接受对应的Method</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.DeleteMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryDAO categoryDAO;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/categories"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m,@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        start = start&lt;<span class="number">0</span>?<span class="number">0</span>:start;</span><br><span class="line">        Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</span><br><span class="line">        Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</span><br><span class="line">        Page&lt;Category&gt; page =categoryDAO.findAll(pageable);</span><br><span class="line">        m.addAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/categories"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryDAO.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/categories"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"/categories/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryDAO.delete(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/categories"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/categories/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryDAO.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/categories"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/categories/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCategory</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id,Model m) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Category c= categoryDAO.getOne(id);</span><br><span class="line">        m.addAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"editCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5、SPRINGBOOT-做前后端分离"><a class="header-anchor" href="#5、SPRINGBOOT-做前后端分离">¶</a>5、SPRINGBOOT 做前后端分离</h3>
<h4 id="步骤-1-先运行，看到效果，再学习-v101"><a class="header-anchor" href="#步骤-1-先运行，看到效果，再学习-v101">¶</a>步骤 1 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
<strong>注：</strong> 启动方式是Springboot特有的，直接运行类：<strong>com.how2java.springboot.Application</strong> 的主方法。</p>
<h4 id="步骤-2-模仿和排错-v101"><a class="header-anchor" href="#步骤-2-模仿和排错-v101">¶</a>步骤 2 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-3-本知识点效果-v3"><a class="header-anchor" href="#步骤-3-本知识点效果-v3">¶</a>步骤 3 : 本知识点效果</h4>
<p>本知识点效果有三个，分别是以json方式：提交，获取单个和获取多个<br>
提交</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/submit.html</span></span><br></pre></td></tr></table></figure>
<p>获取单个</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/getOne.html</span></span><br></pre></td></tr></table></figure>
<p>获取多个</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/getMany.html</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-基于前面的知识点-v9"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v9">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>基于[Restful 风格的springboot]进行修改。 毕竟[Restful 风格的springboot]直接转换为json，很方便的啦</p>
<h4 id="步骤-5-Category"><a class="header-anchor" href="#步骤-5-Category">¶</a>步骤 5 : Category</h4>
<ol>
<li>增加个toString() 方便，便于显示</li>
<li>增加个注解：@JsonIgnoreProperties({ “handler”,“hibernateLazyInitializer” }) ，否则会出错</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"category_"</span>)</span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(&#123; <span class="string">"handler"</span>,<span class="string">"hibernateLazyInitializer"</span> &#125;) </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"id"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Category [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-CategoryController-v3"><a class="header-anchor" href="#步骤-6-CategoryController-v3">¶</a>步骤 6 : CategoryController</h4>
<p>控制器里提供3个方法，分别用来处理json 提交，json获取单个对象，json获取多个对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryDAO categoryDAO;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/category"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Category&gt; <span class="title">listCategory</span><span class="params">(@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        start = start&lt;<span class="number">0</span>?<span class="number">0</span>:start;</span><br><span class="line">        Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</span><br><span class="line">        Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</span><br><span class="line">        Page&lt;Category&gt; page =categoryDAO.findAll(pageable);</span><br><span class="line">        <span class="keyword">return</span> page.getContent();</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/category/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">getCategory</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Category c= categoryDAO.getOne(id);</span><br><span class="line">        System.out.println(c);</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/category"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCategory</span><span class="params">(@RequestBody Category category)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"springboot接受到浏览器以JSON格式提交的数据："</span>+category);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-submit-html-v2"><a class="header-anchor" href="#步骤-7-submit-html-v2">¶</a>步骤 7 : submit.html</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/submit.html</span></span><br></pre></td></tr></table></figure>
<p>提交成功后，在springboot控制台查看使用json方式提交的数据<br>
<strong>注：</strong> 不要在eclipse自带的浏览器里面点击，自带的浏览器有bug，有时候不能识别jquery, 会导致点击没有反应。 使用独立的浏览器，比如chrome,firefox点击测试</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7245.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式提交数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> &gt;</span></span><br><span class="line">       id：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"123"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">       名称：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"category xxx"</span>/&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"提交"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> id=<span class="built_in">document</span>.getElementById(<span class="string">'id'</span>).value;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> name=<span class="built_in">document</span>.getElementById(<span class="string">'name'</span>).value;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> category=&#123;<span class="string">"name"</span>:name,<span class="string">"id"</span>:id&#125;;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> jsonData = <span class="built_in">JSON</span>.stringify(category);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> page=<span class="string">"category"</span>;</span></span><br><span class="line">          </span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">               type:<span class="string">"put"</span>,</span></span><br><span class="line">               url: page,</span><br><span class="line">               data:jsonData,</span><br><span class="line"><span class="actionscript">               dataType:<span class="string">"json"</span>,</span></span><br><span class="line"><span class="actionscript">               contentType : <span class="string">"application/json;charset=UTF-8"</span>,</span></span><br><span class="line"><span class="actionscript">               success: <span class="function"><span class="keyword">function</span><span class="params">(result)</span></span>&#123;</span></span><br><span class="line">               &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"><span class="actionscript">           alert(<span class="string">"提交成功，请在springboot控制台查看服务端接收到的数据"</span>);</span></span><br><span class="line">  </span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-getOne-html-v2"><a class="header-anchor" href="#步骤-8-getOne-html-v2">¶</a>步骤 8 : getOne.html</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/getOne.html</span></span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>：要确保id=10的分类对象存在</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7246.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式获取数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"通过AJAX获取一个Hero对象---"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span> </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> url=<span class="string">"category/10"</span>;</span></span><br><span class="line"><span class="javascript">        $.<span class="keyword">get</span>(</span></span><br><span class="line">                url,</span><br><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="actionscript">                     <span class="keyword">var</span> json=data;</span></span><br><span class="line"><span class="actionscript">                     <span class="keyword">var</span> name =json.name;</span></span><br><span class="line"><span class="actionscript">                     <span class="keyword">var</span> id = json.id;</span></span><br><span class="line"><span class="javascript">                     $(<span class="string">"#messageDiv"</span>).html(<span class="string">"分类id："</span>+ id + <span class="string">"&lt;br&gt;分类名称:"</span> +name );</span></span><br><span class="line">                        </span><br><span class="line">         &#125;); </span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-getMany-html-v2"><a class="header-anchor" href="#步骤-9-getMany-html-v2">¶</a>步骤 9 : getMany.html</h4>
<p>访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://localhost:8080/getMany.html</span></span><br></pre></td></tr></table></figure>
<p>点击按钮，获取多个json数据</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7247.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>用AJAX以JSON方式获取数据<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"通过AJAX获取多个分类对象"</span> <span class="attr">id</span>=<span class="string">"sender"</span>&gt;</span> </span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"messageDiv"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">'#sender'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> url=<span class="string">"category?start=0&amp;size=100"</span>;</span></span><br><span class="line"><span class="javascript">        $.<span class="keyword">get</span>(</span></span><br><span class="line">                url,</span><br><span class="line"><span class="actionscript">                <span class="function"><span class="keyword">function</span><span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                    <span class="keyword">var</span> categorys = data;</span></span><br><span class="line">                     for(i in categorys)&#123;</span><br><span class="line"><span class="javascript">                         <span class="keyword">var</span> old = $(<span class="string">"#messageDiv"</span>).html();</span></span><br><span class="line"><span class="actionscript">                         <span class="keyword">var</span> category = categorys[i];</span></span><br><span class="line"><span class="javascript">                         $(<span class="string">"#messageDiv"</span>).html(old + <span class="string">"&lt;br&gt;"</span>+category.id+<span class="string">"   -----   "</span>+category.name);</span></span><br><span class="line">                     &#125;</span><br><span class="line">         &#125;); </span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">前端ajax传递的数据是data:jsonData里面的jsonData,至于你标为高亮的“category”，它在ajax里面是作为url来使用的，代码为:url:page，page就是上面定义的字符串“catrgory<span class="string">"（所以要用双引号）。</span></span><br><span class="line"><span class="string">@PutMapping("</span>/”）是用来映射url到方法上的，是对<span class="meta">@RequestMapping</span> 的细分，书写起来更简洁一些。<span class="meta">@PutMapping</span>(<span class="string">"/category"</span>)就是说http:<span class="comment">//localhost:8080/category这个url对应的就是这个方法。</span></span><br><span class="line">由于这个方法是put类型的，所以直接从浏览器中输入http:<span class="comment">//localhost:8080/category看到的是上面listCategory方法的结果（由于listCategory方法有些参数无法获取，所以结果不完整），可以看看类似的方法getCategory，它的参数通过url传值，所以在浏览器输入http://localhost:8080/category/10时就可以查看id为10的Catrgory实体数据了</span></span><br></pre></td></tr></table></figure>
<h3 id="6、SPRINGBOOT-JPA-REDIS-整合在一起做一套带分页的-增删改查-CRUD"><a class="header-anchor" href="#6、SPRINGBOOT-JPA-REDIS-整合在一起做一套带分页的-增删改查-CRUD">¶</a>6、SPRINGBOOT JPA REDIS 整合在一起做一套带分页的 增删改查 CRUD</h3>
<h4 id="步骤-1-Redis"><a class="header-anchor" href="#步骤-1-Redis">¶</a>步骤 1 : Redis</h4>
<p>Redis 是一套 key-value 高性能数据库。<br>
关于 Redis 如何安装，运用有专门的教程，在这里就不展开了。<br>
[Redis 教程]</p>
<h4 id="步骤-2-运行-Redis-服务器"><a class="header-anchor" href="#步骤-2-运行-Redis-服务器">¶</a>步骤 2 : 运行 Redis 服务器</h4>
<p>按照 [Redis 如何运行] 中的做法，把 Redis 服务器先跑起来，这个不跑起来，本教程就没法撸了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8057.png" alt></p>
<h4 id="步骤-3-基于前面的知识点-v5"><a class="header-anchor" href="#步骤-3-基于前面的知识点-v5">¶</a>步骤 3 : 基于前面的知识点</h4>
<p>本教程在前面的知识点：[SPRINGBOOT使用JPA实现完整的CRUD和分页] 的基础上进行扩展。 所以没有撸前面的同学，请先撸了，不然这里也撸不出来，因为数据库怎么建立都是在前面写的，你没做，后面也没法做的。</p>
<h4 id="步骤-4-先运行，看到效果，再学习-v3"><a class="header-anchor" href="#步骤-4-先运行，看到效果，再学习-v3">¶</a>步骤 4 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
启动后，访问如下地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listCategory</span></span><br></pre></td></tr></table></figure>
<p>可以看到如图所示的 CRUD 和分页的效果。<br>
虽然，在使用效果上，看起来和 [SPRINGBOOT使用JPA实现完整的CRUD和分页]没有任何分别，但是在后台，已经把数据都撸到 Redis 里面缓存起来了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8058.png" alt></p>
<h4 id="步骤-5-模仿和排错-v3"><a class="header-anchor" href="#步骤-5-模仿和排错-v3">¶</a>步骤 5 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-6-改动"><a class="header-anchor" href="#步骤-6-改动">¶</a>步骤 6 : 改动</h4>
<p>接下来，就一条条地说，在原来项目的基础上做了什么改动，以达到这样的效果</p>
<h4 id="步骤-7-pom-xml-v2"><a class="header-anchor" href="#步骤-7-pom-xml-v2">¶</a>步骤 7 : pom.xml</h4>
<p>增加对 Redis 支持的包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">         </span><br><span class="line">        <span class="comment">&lt;!-- mysql--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">&lt;!-- jpa--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- redis --&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>       </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span> 4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-application-properties-v3"><a class="header-anchor" href="#步骤-8-application-properties-v3">¶</a>步骤 8 : application.properties</h4>
<p>增加redis相关配置<br>
同时让hibernate的sql语句显示出来，这样才知道到底是通过 Redis 取到的数据，还是依然是从数据库取到的数据</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.jpa.show-sql</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/WEB-INF/jsp/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">spring.jpa.properties.hibernate.hbm2ddl.auto</span>=<span class="string">update</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">###########################redis#########################</span></span><br><span class="line"><span class="comment">#Redis数据库索引（默认为0）</span></span><br><span class="line"><span class="meta">spring.redis.database</span>=<span class="string">0</span></span><br><span class="line"><span class="comment">#Redis服务器地址</span></span><br><span class="line"><span class="meta">spring.redis.host</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="comment">#Redis服务器连接端口</span></span><br><span class="line"><span class="meta">spring.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="comment">#Redis服务器连接密码（默认为空）</span></span><br><span class="line"><span class="meta">spring.redis.password</span>=<span class="string"></span></span><br><span class="line"><span class="comment">#连接池最大连接数（使用负值表示没有限制）</span></span><br><span class="line"><span class="meta">spring.redis.pool.max-active</span>=<span class="string">10</span></span><br><span class="line"><span class="comment">#连接池最大阻塞等待时间（使用负值表示没有限制）</span></span><br><span class="line"><span class="meta">spring.redis.pool.max-wait</span>=<span class="string">-1</span></span><br><span class="line"><span class="comment">#连接池中的最大空闲连接</span></span><br><span class="line"><span class="meta">spring.redis.pool.max-idle</span>=<span class="string">8</span></span><br><span class="line"><span class="comment">#连接池中的最小空闲连接</span></span><br><span class="line"><span class="meta">spring.redis.pool.min-idle</span>=<span class="string">0</span></span><br><span class="line"><span class="comment">#连接超时时间（毫秒）</span></span><br><span class="line"><span class="meta">spring.redis.timeout</span>=<span class="string">0</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">spring.jpa.show-sql</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-Application"><a class="header-anchor" href="#步骤-9-Application">¶</a>步骤 9 : Application</h4>
<p>增加注解，以开启缓存</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableCaching</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.EnableCaching;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Application<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-RedisConfig-java"><a class="header-anchor" href="#步骤-10-RedisConfig-java">¶</a>步骤 10 : RedisConfig.java</h4>
<p>Redis 缓存配置类。<br>
这个配置，一个作用： 让保存到 Redis 里的 key 和 value 都转换为可读的 json 格式。 否则会是二进制格式，通过[RedisClient] 工具也无法识别。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.config;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.CacheManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CachingConfigurerSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.EnableCaching;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.cache.RedisCacheManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.RedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonAutoDetect;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.PropertyAccessor;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="comment">//Redis 缓存配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> <span class="keyword">extends</span> <span class="title">CachingConfigurerSupport</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheManager <span class="title">cacheManager</span><span class="params">(RedisTemplate&lt;?,?&gt; redisTemplate)</span> </span>&#123;</span><br><span class="line">        RedisSerializer stringSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.PUBLIC_ONLY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        redisTemplate.setKeySerializer(stringSerializer);</span><br><span class="line">        redisTemplate.setHashKeySerializer(stringSerializer);  </span><br><span class="line">         </span><br><span class="line">        redisTemplate.setValueSerializer(jackson2JsonRedisSerializer);         </span><br><span class="line">        redisTemplate.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        CacheManager cacheManager = <span class="keyword">new</span> RedisCacheManager(redisTemplate);</span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-Page4Navigator"><a class="header-anchor" href="#步骤-11-Page4Navigator">¶</a>步骤 11 : Page4Navigator</h4>
<p>创建一个工具类 Page4Navigator 用以替换 原本分页查询要返回的 org.springframework.data.domain.Page 类。 原因是 Page 类对json 还原不支持，在放如 Redis 之后，再拿出来，就会报错失败。<br>
使用 Page4Navigator 对其包裹，就解决了这个问题了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.util;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Page4Navigator</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    Page&lt;T&gt; page4jpa;</span><br><span class="line">    <span class="keyword">int</span> navigatePages;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">int</span> totalPages;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> number;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">long</span> totalElements;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">int</span> numberOfElements;</span><br><span class="line"> </span><br><span class="line">    List&lt;T&gt; content;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">boolean</span> isHasContent;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">boolean</span> first;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">boolean</span> last;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">boolean</span> isHasNext;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">boolean</span> isHasPrevious;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">int</span>[] navigatepageNums;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Page4Navigator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//这个空的分页是为了 Redis 从 json格式转换为 Page4Navigator 对象而专门提供的</span></span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Page4Navigator</span><span class="params">(Page&lt;T&gt; page4jpa,<span class="keyword">int</span> navigatePages)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.page4jpa = page4jpa;</span><br><span class="line">        <span class="keyword">this</span>.navigatePages = navigatePages;</span><br><span class="line">         </span><br><span class="line">        totalPages = page4jpa.getTotalPages();</span><br><span class="line">         </span><br><span class="line">        number  = page4jpa.getNumber() ;</span><br><span class="line">         </span><br><span class="line">        totalElements = page4jpa.getTotalElements();</span><br><span class="line">         </span><br><span class="line">        size = page4jpa.getSize();</span><br><span class="line">         </span><br><span class="line">        numberOfElements = page4jpa.getNumberOfElements();</span><br><span class="line">         </span><br><span class="line">        content = page4jpa.getContent();</span><br><span class="line">         </span><br><span class="line">        isHasContent = page4jpa.hasContent();</span><br><span class="line">                 </span><br><span class="line">        first = page4jpa.isFirst();</span><br><span class="line">         </span><br><span class="line">        last = page4jpa.isLast();</span><br><span class="line">         </span><br><span class="line">        isHasNext = page4jpa.hasNext();</span><br><span class="line">         </span><br><span class="line">        isHasPrevious  = page4jpa.hasPrevious();       </span><br><span class="line">         </span><br><span class="line">        calcNavigatepageNums();</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">calcNavigatepageNums</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> navigatepageNums[];</span><br><span class="line">        <span class="keyword">int</span> totalPages = getTotalPages();</span><br><span class="line">        <span class="keyword">int</span> num = getNumber();</span><br><span class="line">        <span class="comment">//当总页数小于或等于导航页码数时</span></span><br><span class="line">        <span class="keyword">if</span> (totalPages &lt;= navigatePages) &#123;</span><br><span class="line">            navigatepageNums = <span class="keyword">new</span> <span class="keyword">int</span>[totalPages];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; totalPages; i++) &#123;</span><br><span class="line">                navigatepageNums[i] = i + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">//当总页数大于导航页码数时</span></span><br><span class="line">            navigatepageNums = <span class="keyword">new</span> <span class="keyword">int</span>[navigatePages];</span><br><span class="line">            <span class="keyword">int</span> startNum = num - navigatePages / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> endNum = num + navigatePages / <span class="number">2</span>;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (startNum &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                startNum = <span class="number">1</span>;</span><br><span class="line">                <span class="comment">//(最前navigatePages页</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; navigatePages; i++) &#123;</span><br><span class="line">                    navigatepageNums[i] = startNum++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (endNum &gt; totalPages) &#123;</span><br><span class="line">                endNum = totalPages;</span><br><span class="line">                <span class="comment">//最后navigatePages页</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = navigatePages - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                    navigatepageNums[i] = endNum--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//所有中间页</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; navigatePages; i++) &#123;</span><br><span class="line">                    navigatepageNums[i] = startNum++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">this</span>.navigatepageNums = navigatepageNums;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNavigatePages</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> navigatePages;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNavigatePages</span><span class="params">(<span class="keyword">int</span> navigatePages)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.navigatePages = navigatePages;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getTotalPages</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> totalPages;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTotalPages</span><span class="params">(<span class="keyword">int</span> totalPages)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.totalPages = totalPages;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> number;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNumber</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.number = number;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getTotalElements</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> totalElements;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTotalElements</span><span class="params">(<span class="keyword">long</span> totalElements)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.totalElements = totalElements;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSize</span><span class="params">(<span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.size = size;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNumberOfElements</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> numberOfElements;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNumberOfElements</span><span class="params">(<span class="keyword">int</span> numberOfElements)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.numberOfElements = numberOfElements;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;T&gt; <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContent</span><span class="params">(List&lt;T&gt; content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHasContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isHasContent;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHasContent</span><span class="params">(<span class="keyword">boolean</span> isHasContent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isHasContent = isHasContent;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> first;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirst</span><span class="params">(<span class="keyword">boolean</span> first)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.first = first;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLast</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> last;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLast</span><span class="params">(<span class="keyword">boolean</span> last)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.last = last;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isHasNext;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHasNext</span><span class="params">(<span class="keyword">boolean</span> isHasNext)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isHasNext = isHasNext;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isHasPrevious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isHasPrevious;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHasPrevious</span><span class="params">(<span class="keyword">boolean</span> isHasPrevious)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isHasPrevious = isHasPrevious;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] getNavigatepageNums() &#123;</span><br><span class="line">        <span class="keyword">return</span> navigatepageNums;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNavigatepageNums</span><span class="params">(<span class="keyword">int</span>[] navigatepageNums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.navigatepageNums = navigatepageNums;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-CategoryService-v2"><a class="header-anchor" href="#步骤-12-CategoryService-v2">¶</a>步骤 12 : CategoryService</h4>
<p>增加 Service接口。 注意： list 返回的是 Page4Navigator 而不是 Page 类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.util.Page4Navigator;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Page4Navigator&lt;Category&gt; <span class="title">list</span><span class="params">(Pageable pageable)</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Category category)</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-CategoryServiceImpl-v2"><a class="header-anchor" href="#步骤-13-CategoryServiceImpl-v2">¶</a>步骤 13 : CategoryServiceImpl</h4>
<p>实现类CategoryServiceImp 做了一下工作：</p>
<ol>
<li>
<p>实现 CategoryService 接口，提供 crud</p>
</li>
<li>
<p>在相应方法实现的时候，都是通过调用 dao 实现的</p>
</li>
<li>
<p>CacheConfig，表示 分类数据在 redis 中都放在 category 这个分组里。</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CacheConfig</span>(cacheNames=<span class="string">"category"</span>)</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>list方法讲解：<br>
先说注解</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Cacheable</span>(key=<span class="string">"'category '+#p0.offset + '-' + #p0.pageSize "</span>)</span><br></pre></td></tr></table></figure>
<p>假如是第一页，即offset=0，pageSize=5，那么会创建一个 key: “category 0-5”<br>
首先根据这个key 到 redis中查询数据。 第一次是不会有数据的，那么就会从数据库中取到这5条数据，然后以这个 key: “category 0-5” 保存到 redis 数据库中。<br>
下一次再次访问的时候，根据这个key，就可以从 redis 里取到数据了。</p>
<ol start="5">
<li>get 方法讲解<br>
先说注解：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Cacheable</span>(key=<span class="string">"'category '+ #p0"</span>)</span><br></pre></td></tr></table></figure>
<p>假如是获取id=71的数据，那么<br>
就会以 key= “category 71” 到reids中去获取，如果没有就会从数据库中拿到，然后再以 key= “category 71” 这个值存放到 redis 当中。<br>
下一次再次访问的时候，根据这个key，就可以从 redis 里取到数据了。</p>
<ol start="6">
<li>add 方法讲解<br>
先说注解：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@CacheEvict</span>(allEntries=<span class="keyword">true</span>)</span><br><span class="line"><span class="comment">//	@CachePut(key="'category '+ #p0")</span></span><br></pre></td></tr></table></figure>
<p>可以看到，本来有个 CachePut，但是被注释掉了。 按理说，本来是应该用这个的。 这样会到在，在增加数据之后，就会在Redis 中以 key= “category 71” 缓存一条数据。 但是为什么被注释掉不用呢？<br>
因为加入这样做了，那么 list 对应的数据，在缓存在对应的数据，并没有发生变化呀？ 因为 list 对应的数据是这样的 key: “category 0-5”。 如果用这种方式，就会导致数据不同步，即，虽然增加了，并且也增加到缓存中了，但是因为 key 不一样，通过查询拿到的数据，<strong>是不会包含新的这一条的</strong>。<br>
所以，才会使用CacheEvict 这个注解，这个注解就表示清除掉缓存。 allEntries= true 是表示清除掉 category 分组 下所有的keys. 注意看截图，里面有一个 category~keys ，里面就表明了都有哪些 keys,都会被清除掉。<br>
假如这个时候，还有一个分组 cacheNames=“product”, 那么它下面对应的缓存，都是不会被影响到的。 这样就保证了，只清楚当前分组下的缓存，而不是清除 redis 所有的数据了。</p>
<ol start="7">
<li>delete 方法讲解<br>
先说注解：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@CacheEvict</span>(allEntries=<span class="keyword">true</span>)</span><br><span class="line"><span class="comment">//	@CacheEvict(key="'category '+ #p0")</span></span><br></pre></td></tr></table></figure>
<p>这个道理和 add 是一样的，仅仅删除 key= “category 71” ，没有什么意义， key: “category 0-5” 里面的数据没有影响呀。 所以还是通过 CacheEvict删除掉所有的缓存就好了。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8069.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CacheConfig;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CacheEvict;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CachePut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.Cacheable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.dao.CategoryDAO;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.service.CategoryService;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.util.Page4Navigator;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@CacheConfig</span>(cacheNames=<span class="string">"category"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title">CategoryService</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span> CategoryDAO categoryDAO;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Cacheable</span>(key=<span class="string">"'category '+#p0.offset + '-' + #p0.pageSize "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Page4Navigator&lt;Category&gt; <span class="title">list</span><span class="params">(Pageable pageable)</span> </span>&#123;</span><br><span class="line">        Page&lt;Category&gt; pageFromJPA=  categoryDAO.findAll(pageable);</span><br><span class="line">        Page4Navigator&lt;Category&gt; page = <span class="keyword">new</span> Page4Navigator&lt;&gt;(pageFromJPA,<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">return</span> page;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Cacheable</span>(key=<span class="string">"'category '+ #p0"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        Category c =categoryDAO.findOne(id);</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;  </span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@CacheEvict</span>(allEntries=<span class="keyword">true</span>)</span><br><span class="line"><span class="comment">//  @CachePut(key="'category '+ #p0")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Category category)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        categoryDAO.save(category);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@CacheEvict</span>(allEntries=<span class="keyword">true</span>)</span><br><span class="line"><span class="comment">//  @CacheEvict(key="'category '+ #p0")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        categoryDAO.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-14-CategoryController-v2"><a class="header-anchor" href="#步骤-14-CategoryController-v2">¶</a>步骤 14 : CategoryController</h4>
<p>由原来直接从 dao 获取，变为从 Service 获取了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Pageable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.service.CategoryService;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.util.Page4Navigator;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryService categoryService;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m,@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        start = start&lt;<span class="number">0</span>?<span class="number">0</span>:start;</span><br><span class="line">        Sort sort = <span class="keyword">new</span> Sort(Sort.Direction.DESC, <span class="string">"id"</span>);</span><br><span class="line">        Pageable pageable = <span class="keyword">new</span> PageRequest(start, size, sort);</span><br><span class="line">        Page4Navigator&lt;Category&gt; page =categoryService.list(pageable);</span><br><span class="line">        m.addAttribute(<span class="string">"page"</span>, page);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/addCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryService.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/deleteCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryService.delete(c.getId());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/updateCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryService.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/editCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">ediitCategory</span><span class="params">(<span class="keyword">int</span> id,Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Category c= categoryService.get(id);</span><br><span class="line">        m.addAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"editCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7、ELASTICSEARCH"><a class="header-anchor" href="#7、ELASTICSEARCH">¶</a>7、ELASTICSEARCH</h3>
<p>springboot 和 elasticsearch 的整合放在 ElasticSearch 模块下了：<br>
点击访问： [springboot 整合 elasticsearch]</p>
<h2 id="五、THYMELEAF"><a class="header-anchor" href="#五、THYMELEAF">¶</a>五、THYMELEAF</h2>
<h3 id="1、入门-基于-SPRINGBOOT-方式"><a class="header-anchor" href="#1、入门-基于-SPRINGBOOT-方式">¶</a>1、入门 基于 SPRINGBOOT 方式</h3>
<h4 id="步骤-1-什么是-thymeleaf"><a class="header-anchor" href="#步骤-1-什么是-thymeleaf">¶</a>步骤 1 : 什么是 thymeleaf</h4>
<p>thymeleaf 跟 JSP 一样，就是运行之后，就得到纯 HTML了。 区别在与，不运行之前， thymeleaf 也是 纯 html …<br>
所以 thymeleaf 不需要 服务端的支持，就能够被以 html 的方式打开，这样就方便前端人员独立设计与调试, jsp 就不行了， 不启动服务器 jsp 都没法运行出结果来。</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v12"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v12">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行 Application.java, 然后访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/hello</span></span><br></pre></td></tr></table></figure>
<p>就可以看到如图所示的三行话</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7689.png" alt></p>
<h4 id="步骤-3-模仿和排错-v11"><a class="header-anchor" href="#步骤-3-模仿和排错-v11">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-基于前面的知识点-v10"><a class="header-anchor" href="#步骤-4-基于前面的知识点-v10">¶</a>步骤 4 : 基于前面的知识点</h4>
<p>thymeleaf 可以配合 Servlet 运行，但是比较常见的是配合 springboot 来运行。 当然本质上也是配合springboot 里的 springmvc 来运行的，毕竟 springboot 本身就是个老鸨，干活的还是 springmvc。<br>
本知识点基于前面的 [springboot 配置切换] 的基础上展开。 所以如果没有学过 springboot, 还是把 springboot 过一遍的好，至少要过到[springboot 配置切换] 这里。</p>
<h4 id="步骤-5-pom-xml-v4"><a class="header-anchor" href="#步骤-5-pom-xml-v4">¶</a>步骤 5 : pom.xml</h4>
<p>修改 pom.xml, 增加了对 thymeleaf 的支持。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>	</span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>thymeleaf<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>thymeleaf<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-增加个控制器"><a class="header-anchor" href="#步骤-6-增加个控制器">¶</a>步骤 6 : 增加个控制器</h4>
<p>很简单，访问地址 hello, 跳转到 hello.html ，并带上数据 “name”， 其值是 “thymeleaf”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(Model m)</span> </span>&#123;</span><br><span class="line">        m.addAttribute(<span class="string">"name"</span>, <span class="string">"thymeleaf"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-hello-html"><a class="header-anchor" href="#步骤-7-hello-html">¶</a>步骤 7 : hello.html</h4>
<p>在 resources 下新建目录 templates, 然后新建文件 hello.html<br>
<strong>注：</strong> 并不是在 webapp下，这点和 jsp 不一样<br>
hello.html 做了如下事情：</p>
<ol>
<li>声明当前文件是 thymeleaf, 里面可以用th开头的属性</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>
<p>&lt;head&gt; 内容和普通 html 并无二致，略过</p>
</li>
<li>
<p>把 name 的值显示在当前 p里，用的是th开头的属性: th:text, 而取值用的是 “${name}” 这种写法叫做 ognl，额。。。什么意思呢。。。就是跟EL表达式一样吧。 这样取出来放进p 里，从而替换到 原来p 标签里的 4个字符 “name” .</p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;name&#125;"</span> &gt;</span>name<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>用这种方式，就可以把服务端的数据，显示在当前html里了。 <strong>重要的是：</strong> 这种写法是完全合法的 html 语法，所以可以直接通过浏览器打开 hello.html,也是可以看到效果的， 只不过看到的是 “name”, 而不是 服务端传过来的值 “thymeleaf”。</p>
<ol start="4">
<li>字符串拼写。 两种方式，一种是用加号，一种是在前后放上 ||, 显然第二种方式可读性更好。</li>
</ol>
<p th:text="'Hello！ ' + ${name} + '!'">hello world</p>
<p th:text="|Hello！ ${name}!|">hello world</p>
<p>这两种方式都会得到： hello thymeleaf。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7694.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;name&#125;"</span> &gt;</span>name<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"'Hello！ ' + $&#123;name&#125; + '!'"</span> &gt;</span>hello world<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"|Hello！ $&#123;name&#125;!|"</span> &gt;</span>hello world<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-application-properties-v4"><a class="header-anchor" href="#步骤-8-application-properties-v4">¶</a>步骤 8 : application.properties</h4>
<p>application.properties 撸成这样</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#thymeleaf 配置</span></span><br><span class="line"><span class="meta">spring.thymeleaf.mode</span>=<span class="string">HTML5</span></span><br><span class="line"><span class="meta">spring.thymeleaf.encoding</span>=<span class="string">UTF-8</span></span><br><span class="line"><span class="meta">spring.thymeleaf.content-type</span>=<span class="string">text/html</span></span><br><span class="line"><span class="comment">#缓存设置为false, 这样修改之后马上生效，便于调试</span></span><br><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br><span class="line"><span class="comment">#上下文</span></span><br><span class="line"><span class="meta">server.context-path</span>=<span class="string">/thymeleaf</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-重启测试"><a class="header-anchor" href="#步骤-9-重启测试">¶</a>步骤 9 : 重启测试</h4>
<p>运行 Application.java, 然后访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/hello</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7695.png" alt></p>
<h3 id="2、URL-用法"><a class="header-anchor" href="#2、URL-用法">¶</a>2、URL 用法</h3>
<h4 id="步骤-1-基于上一个知识点改进"><a class="header-anchor" href="#步骤-1-基于上一个知识点改进">¶</a>步骤 1 : 基于上一个知识点改进</h4>
<p>本知识点是基于上一个知识点进行改进</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v13"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v13">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
访问地址</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/hello</span></span><br></pre></td></tr></table></figure>
<p>如图所示，可以看到 一个 js 的对话框，以及灰色的边框效果。<br>
这两个效果是通过@URL 外部引用css 文件和 js 文件得到的。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7696.png" alt></p>
<h4 id="步骤-3-模仿和排错-v12"><a class="header-anchor" href="#步骤-3-模仿和排错-v12">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-css-文件"><a class="header-anchor" href="#步骤-4-css-文件">¶</a>步骤 4 : css 文件</h4>
<p>在 webapp 目录下新建 css 目录，然后新建 style.css 文件</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7698.png" alt></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-class">.showing</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">80%</span>;</span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">20px</span> auto;</span><br><span class="line">    <span class="attribute">border</span>:<span class="number">1px</span> solid grey;</span><br><span class="line">    <span class="attribute">padding</span>:<span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.even</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: red; </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.odd</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-js-文件"><a class="header-anchor" href="#步骤-5-js-文件">¶</a>步骤 5 : js 文件</h4>
<p>在 webapp 目录下新建 js 目录，然后新建 thymeleaf.js 文件</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7699.png" alt></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(<span class="string">"test Thymeleaf.js!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-修改-hello-html"><a class="header-anchor" href="#步骤-6-修改-hello-html">¶</a>步骤 6 : 修改 hello.html</h4>
<p>通过 th:href=&quot;@{/static/css/style.css}&quot; 和 th:src=&quot;@{/static/js/thymeleaf.js}&quot; 引入 css 和 js 文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"all"</span> <span class="attr">href</span>=<span class="string">"../../webapp/static/css/style.css"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/static/css/style.css&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../../webapp/static/js/thymeleaf.js"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/static/js/thymeleaf.js&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>注意几点：</p>
<ol>
<li>使用 @这种方式引入，在渲染后的html 里会自动生成 上下文路径，既如图所示的 /thymeleaf 这个路径</li>
<li>如果使用浏览器直接打开当前的 hello.html, 依然可以看到css 和 js 效果，因为如下代码起作用：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">href=<span class="string">"../../webapp/static/css/style.css"</span></span><br><span class="line">src=<span class="string">"../../webapp/static/js/thymeleaf.js"</span></span><br></pre></td></tr></table></figure>
<p>所以这样就非常方便前端开发和测试</p>
<ol start="3">
<li>在header标签里有这么一段：</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">testFunction();</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>用以表示访问thymeleaf.js里的 testFunction函数</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7700.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"all"</span> <span class="attr">href</span>=<span class="string">"../../webapp/static/css/style.css"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/static/css/style.css&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../../webapp/static/js/thymeleaf.js"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/static/js/thymeleaf.js&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    testFunction();</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">         </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;name&#125;"</span> &gt;</span>name<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"'Hello！ ' + $&#123;name&#125; + '!'"</span> &gt;</span>hello world<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"|Hello！ $&#123;name&#125;!|"</span> &gt;</span>hello world<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-重启测试"><a class="header-anchor" href="#步骤-7-重启测试">¶</a>步骤 7 : 重启测试</h4>
<p>重新运行 Application, 然后访问如下地址进行测试：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/hello</span></span><br></pre></td></tr></table></figure>
<h3 id="3、THYMELEAF-中各种表达式YONG’F"><a class="header-anchor" href="#3、THYMELEAF-中各种表达式YONG’F">¶</a>3、THYMELEAF 中各种表达式YONG’F</h3>
<h4 id="步骤-1-基于上一个知识点改进-v2"><a class="header-anchor" href="#步骤-1-基于上一个知识点改进-v2">¶</a>步骤 1 : 基于上一个知识点改进</h4>
<p>本知识点是基于上一个知识点进行改进</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v14"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v14">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行Application, 然后访问地址, 即可看到如图效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7702.png" alt></p>
<h4 id="步骤-3-模仿和排错-v13"><a class="header-anchor" href="#步骤-3-模仿和排错-v13">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-Product类"><a class="header-anchor" href="#步骤-4-Product类">¶</a>步骤 4 : Product类</h4>
<p>准备实体类，用于页面上显示数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Product</span><span class="params">(<span class="keyword">int</span> id, String name, <span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-TestController"><a class="header-anchor" href="#步骤-5-TestController">¶</a>步骤 5 : TestController</h4>
<p>控制器里准备数据，然后映射 /test 路径，返回到test.html中<br>
准备了 一个html片段和 一个 Product对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(Model m)</span> </span>&#123;</span><br><span class="line">        String htmlContent = <span class="string">"&lt;p style='color:red'&gt; 红色文字&lt;/p&gt;"</span>;</span><br><span class="line">        Product currentProduct =<span class="keyword">new</span> Product(<span class="number">5</span>,<span class="string">"product e"</span>, <span class="number">200</span>);</span><br><span class="line">         </span><br><span class="line">        m.addAttribute(<span class="string">"htmlContent"</span>, htmlContent);</span><br><span class="line">        m.addAttribute(<span class="string">"currentProduct"</span>, currentProduct);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-test-html"><a class="header-anchor" href="#步骤-6-test-html">¶</a>步骤 6 : test.html</h4>
<p>test.html 把控制器中准备的数据展示出来</p>
<ol>
<li>转义和非转义的html</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:utext</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>获取对象属性的两种方式，这里可以直接调用方法了</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.getName()&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>使用 *{} 方式显示当前对象的属性</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span> <span class="attr">th:object</span>=<span class="string">"$&#123;currentProduct&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>*&#123;&#125;方式显示属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"*&#123;name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>算数运算，这里之演示了加法，其他的减法，乘法什么的略过不表</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.price+999&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"all"</span> <span class="attr">href</span>=<span class="string">"../../webapp/static/css/style.css"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/static/css/style.css&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../../webapp/static/js/thymeleaf.js"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/static/js/thymeleaf.js&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        h2&#123;</span><br><span class="line">            text-decoration: underline;</span><br><span class="line"><span class="css">            <span class="selector-tag">font-size</span><span class="selector-pseudo">:0.9em</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span>       </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示 转义和非转义的 html 文本<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:utext</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示对象以及对象属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.getName()&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span> <span class="attr">th:object</span>=<span class="string">"$&#123;currentProduct&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>*&#123;&#125;方式显示属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"*&#123;name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>算数运算<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.price+999&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-重启测试-v2"><a class="header-anchor" href="#步骤-7-重启测试-v2">¶</a>步骤 7 : 重启测试</h4>
<p>重新运行Application, 然后访问地址, 即可看到如图效果</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<h3 id="4、THYMELEAF-如何通过-FRAGMENT-包含另一个文件举例"><a class="header-anchor" href="#4、THYMELEAF-如何通过-FRAGMENT-包含另一个文件举例">¶</a>4、THYMELEAF 如何通过 FRAGMENT 包含另一个文件举例</h3>
<h4 id="步骤-1-基于上一个知识点改进-v3"><a class="header-anchor" href="#步骤-1-基于上一个知识点改进-v3">¶</a>步骤 1 : 基于上一个知识点改进</h4>
<p>本知识点是基于上一个知识点进行改进</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v15"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v15">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行 Application.java, 然后访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<p>在页面底部可以看到如图所示的版权信息，这个版权信息就是包含另一个页面的内容而来的。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7710.png" alt></p>
<h4 id="步骤-3-模仿和排错-v14"><a class="header-anchor" href="#步骤-3-模仿和排错-v14">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-include-html"><a class="header-anchor" href="#步骤-4-include-html">¶</a>步骤 4 : include.html</h4>
<p>新建一个 include.html 文件，然后里面用 th:fragment 标记代码片段。<br>
footer1 是 不带参数的<br>
footer2 是带参数的<br>
这两种情况也是包含业务经常会用到的做法</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7713.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">th:fragment</span>=<span class="string">"footer1"</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> &gt;</span>All Rights Reserved<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">th:fragment</span>=<span class="string">"footer2(start,now)"</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"|$&#123;start&#125; - $&#123;now&#125; All Rights Reserved|"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-test-html"><a class="header-anchor" href="#步骤-5-test-html">¶</a>步骤 5 : test.html</h4>
<p>使用的时候就按照如下方式：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer1"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer2(2015,2018)"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>就达到了包含的效果，其中第二种可以传参。<br>
除了th:replace， 还可以用th:insert, 区别：<br>
th:insert ：保留自己的主标签，保留th:fragment的主标签。<br>
th:replace ：不要自己的主标签，保留th:fragment的主标签。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"all"</span> <span class="attr">href</span>=<span class="string">"../../webapp/static/css/style.css"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/static/css/style.css&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../../webapp/static/js/thymeleaf.js"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/static/js/thymeleaf.js&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        h2&#123;</span><br><span class="line">            text-decoration: underline;</span><br><span class="line"><span class="css">            <span class="selector-tag">font-size</span><span class="selector-pseudo">:0.9em</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span>       </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示 转义和非转义的 html 文本<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:utext</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示对象以及对象属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.getName()&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span> <span class="attr">th:object</span>=<span class="string">"$&#123;currentProduct&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>*&#123;&#125;方式显示属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"*&#123;name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>算数运算<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.price+999&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer1"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer2(2015,2018)"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-重启测试-v2"><a class="header-anchor" href="#步骤-6-重启测试-v2">¶</a>步骤 6 : 重启测试</h4>
<p>重新运行 Application，然后访问地址测试：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<h3 id="5、THYMELEAF-如何用TH-IF做条件判断"><a class="header-anchor" href="#5、THYMELEAF-如何用TH-IF做条件判断">¶</a>5、THYMELEAF 如何用TH:IF做条件判断</h3>
<h4 id="步骤-1-基于上一个知识点改进-v4"><a class="header-anchor" href="#步骤-1-基于上一个知识点改进-v4">¶</a>步骤 1 : 基于上一个知识点改进</h4>
<p>本知识点是建立在上一个知识点可运行项目的基础上进行的改进,所以最好把上个知识点理解和消化了.</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v16"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v16">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行 Application.java, 然后访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<p>即可看到如图所示的效果。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7717.png" alt></p>
<h4 id="步骤-3-模仿和排错-v15"><a class="header-anchor" href="#步骤-3-模仿和排错-v15">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-TestController"><a class="header-anchor" href="#步骤-4-TestController">¶</a>步骤 4 : TestController</h4>
<p>增加一个布尔值数据，并且放在model中便于视图上获取</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(Model m)</span> </span>&#123;</span><br><span class="line">        String htmlContent = <span class="string">"&lt;p style='color:red'&gt; 红色文字&lt;/p&gt;"</span>;</span><br><span class="line">        Product currentProduct =<span class="keyword">new</span> Product(<span class="number">5</span>,<span class="string">"product e"</span>, <span class="number">200</span>);</span><br><span class="line">        <span class="keyword">boolean</span> testBoolean = <span class="keyword">true</span>;</span><br><span class="line">         </span><br><span class="line">        m.addAttribute(<span class="string">"htmlContent"</span>, htmlContent);</span><br><span class="line">        m.addAttribute(<span class="string">"currentProduct"</span>, currentProduct);</span><br><span class="line">        m.addAttribute(<span class="string">"testBoolean"</span>, testBoolean);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-test-html-v2"><a class="header-anchor" href="#步骤-5-test-html-v2">¶</a>步骤 5 : test.html</h4>
<p>Thymeleaf 的条件判断是 通过 th:if 来做的，只有为真的时候，才会显示当前元素</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>如果testBoolean 是 true ，本句话就会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>取反可以用not, 或者用th:unless.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;not testBoolean&#125;"</span> &gt;</span>取反 ，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:unless</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>unless 等同于上一句，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>除此之外，三元表达式也比较常见</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;testBoolean&#125;?'当testBoolean为真的时候，显示本句话，这是用三相表达式做的':''"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"all"</span> <span class="attr">href</span>=<span class="string">"../../webapp/static/css/style.css"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/static/css/style.css&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../../webapp/static/js/thymeleaf.js"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/static/js/thymeleaf.js&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        h2&#123;</span><br><span class="line">            text-decoration: underline;</span><br><span class="line"><span class="css">            <span class="selector-tag">font-size</span><span class="selector-pseudo">:0.9em</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span>       </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>条件判断<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>如果testBoolean 是 true ，本句话就会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"not$&#123;testBoolean&#125;"</span> &gt;</span>取反 ，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:unless</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>unless 等同于上一句，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;testBoolean&#125;?'当testBoolean为真的时候，显示本句话，这是用三相表达式做的':''"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示 转义和非转义的 html 文本<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:utext</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示对象以及对象属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.getName()&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span> <span class="attr">th:object</span>=<span class="string">"$&#123;currentProduct&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>*&#123;&#125;方式显示属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"*&#123;name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>算数运算<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.price+999&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer1"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer2(2015,2018)"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-关于真假判断"><a class="header-anchor" href="#步骤-6-关于真假判断">¶</a>步骤 6 : 关于真假判断</h4>
<p>不只是布尔值的 true 和 false, th:if 表达式返回其他值时也会被认为是 true 或 false，规则如下:</p>
<p>boolean 类型并且值是 true, 返回 true<br>
数值类型并且值不是 0, 返回 true<br>
字符类型(Char)并且值不是 0, 返回 true<br>
String 类型并且值不是 “false”, “off”, “no”, 返回 true<br>
不是 boolean, 数值, 字符, String 的其他类型, 返回 true</p>
<p>值是 null, 返回 false</p>
<h4 id="步骤-7-重启测试-v3"><a class="header-anchor" href="#步骤-7-重启测试-v3">¶</a>步骤 7 : 重启测试</h4>
<p>重新启动Application.java, 然后访问如下地址测试：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<h3 id="6、THYMELEAF-如何用TH-EACH-做条件遍历"><a class="header-anchor" href="#6、THYMELEAF-如何用TH-EACH-做条件遍历">¶</a>6、THYMELEAF 如何用TH:EACH 做条件遍历</h3>
<h4 id="步骤-1-基于前面的知识点-v2"><a class="header-anchor" href="#步骤-1-基于前面的知识点-v2">¶</a>步骤 1 : 基于前面的知识点</h4>
<p>本知识点是建立在上一个知识点可运行项目的基础上进行的改进,所以最好把上个知识点理解和消化了.</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v17"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v17">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行Application.java 然后访问如下测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<p>可以看到如图所示的集中常见遍历需求</p>
<ol>
<li>单纯表格</li>
<li>取status值的表格</li>
<li>下拉框</li>
<li>单选框</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7724.png" alt></p>
<h4 id="步骤-3-模仿和排错-v16"><a class="header-anchor" href="#步骤-3-模仿和排错-v16">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-TestController-v2"><a class="header-anchor" href="#步骤-4-TestController-v2">¶</a>步骤 4 : TestController</h4>
<p>准备集合 List&lt;Product&gt; 用于视图上显示。<br>
需要注意的是 第5个产品用的是 currentProduct</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(Model m)</span> </span>&#123;</span><br><span class="line">        String htmlContent = <span class="string">"&lt;p style='color:red'&gt; 红色文字&lt;/p&gt;"</span>;</span><br><span class="line">        Product currentProduct =<span class="keyword">new</span> Product(<span class="number">5</span>,<span class="string">"product e"</span>, <span class="number">200</span>);</span><br><span class="line">        <span class="keyword">boolean</span> testBoolean = <span class="keyword">true</span>;</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; ps = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">1</span>,<span class="string">"product a"</span>, <span class="number">50</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">2</span>,<span class="string">"product b"</span>, <span class="number">100</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">3</span>,<span class="string">"product c"</span>, <span class="number">150</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">4</span>,<span class="string">"product d"</span>, <span class="number">200</span>));</span><br><span class="line">        ps.add(currentProduct);</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">6</span>,<span class="string">"product f"</span>, <span class="number">200</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">7</span>,<span class="string">"product g"</span>, <span class="number">200</span>));       </span><br><span class="line">         </span><br><span class="line">        m.addAttribute(<span class="string">"ps"</span>, ps);</span><br><span class="line">        m.addAttribute(<span class="string">"htmlContent"</span>, htmlContent);</span><br><span class="line">        m.addAttribute(<span class="string">"currentProduct"</span>, currentProduct);</span><br><span class="line">        m.addAttribute(<span class="string">"testBoolean"</span>, testBoolean);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-普通遍历"><a class="header-anchor" href="#步骤-5-普通遍历">¶</a>步骤 5 : 普通遍历</h4>
<p>使用 th:each 遍历</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7727.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>产品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"p: $&#123;ps&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.price&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-带状态的遍历"><a class="header-anchor" href="#步骤-6-带状态的遍历">¶</a>步骤 6 : 带状态的遍历</h4>
<p>使用 th:each=&quot;p,status: ${ps} 方式遍历就把状态放在 status里面了， 同时还用3元表达式判断奇偶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">th:<span class="class"><span class="keyword">class</span></span>=<span class="string">"$&#123;status.even&#125;?'even':'odd'"</span></span><br></pre></td></tr></table></figure>
<p>status里还包含了如下信息：<br>
index 属性, 0 开始的索引值<br>
count 属性, 1 开始的索引值<br>
size 属性, 集合内元素的总量<br>
current 属性, 当前的迭代对象<br>
even/odd 属性, boolean 类型的, 用来判断是否是偶数个还是奇数个<br>
first 属性, boolean 类型, 是否是第一个<br>
last 属性, boolean 类型, 是否是最后一个</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7728.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>带状态遍历<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>index<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>产品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:class</span>=<span class="string">"$&#123;status.even&#125;?'even':'odd'"</span> <span class="attr">th:each</span>=<span class="string">"p,status: $&#123;ps&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>  <span class="attr">th:text</span>=<span class="string">"$&#123;status.index&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.price&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-结合-select"><a class="header-anchor" href="#步骤-7-结合-select">¶</a>步骤 7 : 结合 select</h4>
<p>还是用 th:each,但是放在option元素上，就可以遍历出多个下拉框出来了。<br>
其中 th:selected 表示被选中的项。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7729.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历 select <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">size</span>=<span class="string">"3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:each</span>=<span class="string">"p:$&#123;ps&#125;"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;p.id&#125;"</span>     <span class="attr">th:selected</span>=<span class="string">"$&#123;p.id==currentProduct.id&#125;"</span>    <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-结合-单选框"><a class="header-anchor" href="#步骤-8-结合-单选框">¶</a>步骤 8 : 结合 单选框</h4>
<p>单选框也是同样的做法，其中 th:checked用于判断是否选中</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7730.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历 radio <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"product"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">th:each</span>=<span class="string">"p:$&#123;ps&#125;"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;p.id&#125;"</span>  <span class="attr">th:checked</span>=<span class="string">"$&#123;p.id==currentProduct.id&#125;"</span>     <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>  /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-完整的-test-html"><a class="header-anchor" href="#步骤-9-完整的-test-html">¶</a>步骤 9 : 完整的 test.html</h4>
<p>完整的 test.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"all"</span> <span class="attr">href</span>=<span class="string">"../../webapp/static/css/style.css"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/static/css/style.css&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../../webapp/static/js/thymeleaf.js"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/static/js/thymeleaf.js&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        h2&#123;</span><br><span class="line">            text-decoration: underline;</span><br><span class="line"><span class="css">            <span class="selector-tag">font-size</span><span class="selector-pseudo">:0.9em</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span>       </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>产品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"p: $&#123;ps&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.price&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>带状态遍历<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>index<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>产品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:class</span>=<span class="string">"$&#123;status.even&#125;?'even':'odd'"</span> <span class="attr">th:each</span>=<span class="string">"p,status: $&#123;ps&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>  <span class="attr">th:text</span>=<span class="string">"$&#123;status.index&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.price&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历 select <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">size</span>=<span class="string">"3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:each</span>=<span class="string">"p:$&#123;ps&#125;"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;p.id&#125;"</span>     <span class="attr">th:selected</span>=<span class="string">"$&#123;p.id==currentProduct.id&#125;"</span>    <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历 radio <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"product"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">th:each</span>=<span class="string">"p:$&#123;ps&#125;"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;p.id&#125;"</span>  <span class="attr">th:checked</span>=<span class="string">"$&#123;p.id==currentProduct.id&#125;"</span>     <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>  /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>条件判断<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>如果testBoolean 是 true ，本句话就会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"not$&#123;testBoolean&#125;"</span> &gt;</span>取反 ，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:unless</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>unless 等同于上一句，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;testBoolean&#125;?'当testBoolean为真的时候，显示本句话，这是用三相表达式做的':''"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示 转义和非转义的 html 文本<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:utext</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示对象以及对象属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.getName()&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span> <span class="attr">th:object</span>=<span class="string">"$&#123;currentProduct&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>*&#123;&#125;方式显示属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"*&#123;name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>算数运算<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.price+999&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer1"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer2(2015,2018)"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-重启测试"><a class="header-anchor" href="#步骤-10-重启测试">¶</a>步骤 10 : 重启测试</h4>
<p>重新运行 Application.java, 然后测试</p>
<p><a href="http://127.0.0.1:8080/thymeleaf/test" target="_blank" rel="noopener">http://127.0.0.1:8080/thymeleaf/test</a></p>
<h3 id="7、THYMELEAF-内置工具用法示例和手册"><a class="header-anchor" href="#7、THYMELEAF-内置工具用法示例和手册">¶</a>7、THYMELEAF 内置工具用法示例和手册</h3>
<h4 id="步骤-1-基于前面的知识点-v3"><a class="header-anchor" href="#步骤-1-基于前面的知识点-v3">¶</a>步骤 1 : 基于前面的知识点</h4>
<p>本知识点是建立在上一个知识点可运行项目的基础上进行的改进,所以最好把上个知识点理解和消化了.</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v18"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v18">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行 Application.java 然后访问测试地址:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/test</span></span><br></pre></td></tr></table></figure>
<p>可以看到如图所示的日期信息被格式化后的结果。<br>
日期格式化的方式，就是借助了 thymeleaf 内置工具实现的。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7734.png" alt></p>
<h4 id="步骤-3-模仿和排错-v17"><a class="header-anchor" href="#步骤-3-模仿和排错-v17">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-TestController-v3"><a class="header-anchor" href="#步骤-4-TestController-v3">¶</a>步骤 4 : TestController</h4>
<p>增加了日期对象，并且放在 “now” 这个变量上扔给视图</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Product;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(Model m)</span> </span>&#123;</span><br><span class="line">        String htmlContent = <span class="string">"&lt;p style='color:red'&gt; 红色文字&lt;/p&gt;"</span>;</span><br><span class="line">        Product currentProduct =<span class="keyword">new</span> Product(<span class="number">5</span>,<span class="string">"product e"</span>, <span class="number">200</span>);</span><br><span class="line">        <span class="keyword">boolean</span> testBoolean = <span class="keyword">true</span>;</span><br><span class="line">         </span><br><span class="line">        Date now = <span class="keyword">new</span> Date();</span><br><span class="line">         </span><br><span class="line">        List&lt;Product&gt; ps = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">1</span>,<span class="string">"product a"</span>, <span class="number">50</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">2</span>,<span class="string">"product b"</span>, <span class="number">100</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">3</span>,<span class="string">"product c"</span>, <span class="number">150</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">4</span>,<span class="string">"product d"</span>, <span class="number">200</span>));</span><br><span class="line">        ps.add(currentProduct);</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">6</span>,<span class="string">"product f"</span>, <span class="number">200</span>));</span><br><span class="line">        ps.add(<span class="keyword">new</span> Product(<span class="number">7</span>,<span class="string">"product g"</span>, <span class="number">200</span>));       </span><br><span class="line">         </span><br><span class="line">        m.addAttribute(<span class="string">"now"</span>, now);</span><br><span class="line">        m.addAttribute(<span class="string">"ps"</span>, ps);</span><br><span class="line">        m.addAttribute(<span class="string">"htmlContent"</span>, htmlContent);</span><br><span class="line">        m.addAttribute(<span class="string">"currentProduct"</span>, currentProduct);</span><br><span class="line">        m.addAttribute(<span class="string">"testBoolean"</span>, testBoolean);</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-test-html-v3"><a class="header-anchor" href="#步骤-5-test-html-v3">¶</a>步骤 5 : test.html</h4>
<p>使用#dates这个内置工具进行格式化日期</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing date"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h2</span>&gt;</span>格式化日期<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">	直接输出日期 $&#123;now&#125;:</span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;now&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	默认格式化 $&#123;#dates.format(now)&#125;:</span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;#dates.format(now)&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">	自定义格式化 $&#123;#dates.format(now,'yyyy-MM-dd HH:mm:ss')&#125;:</span><br><span class="line">	<span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;#dates.format(now,'yyyy-MM-dd HH:mm:ss')&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">media</span>=<span class="string">"all"</span> <span class="attr">href</span>=<span class="string">"../../webapp/static/css/style.css"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/static/css/style.css&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../../webapp/static/js/thymeleaf.js"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/static/js/thymeleaf.js&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        h2&#123;</span><br><span class="line">            text-decoration: underline;</span><br><span class="line"><span class="css">            <span class="selector-tag">font-size</span><span class="selector-pseudo">:0.9em</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-class">.date</span> <span class="selector-tag">p</span>&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">padding-left</span><span class="selector-pseudo">:20px</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">color</span><span class="selector-pseudo">:gray</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span>       </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing date"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>格式化日期<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    直接输出日期 $&#123;now&#125;:</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;now&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    默认格式化 $&#123;#dates.format(now)&#125;:</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;#dates.format(now)&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    自定义格式化 $&#123;#dates.format(now,'yyyy-MM-dd HH:mm:ss')&#125;:</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;#dates.format(now,'yyyy-MM-dd HH:mm:ss')&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>产品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"p: $&#123;ps&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.price&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>带状态遍历<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>index<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>产品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:class</span>=<span class="string">"$&#123;status.even&#125;?'even':'odd'"</span> <span class="attr">th:each</span>=<span class="string">"p,status: $&#123;ps&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span>  <span class="attr">th:text</span>=<span class="string">"$&#123;status.index&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;p.price&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历 select <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">size</span>=<span class="string">"3"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">th:each</span>=<span class="string">"p:$&#123;ps&#125;"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;p.id&#125;"</span>     <span class="attr">th:selected</span>=<span class="string">"$&#123;p.id==currentProduct.id&#125;"</span>    <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>遍历 radio <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"product"</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">th:each</span>=<span class="string">"p:$&#123;ps&#125;"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;p.id&#125;"</span>  <span class="attr">th:checked</span>=<span class="string">"$&#123;p.id==currentProduct.id&#125;"</span>     <span class="attr">th:text</span>=<span class="string">"$&#123;p.name&#125;"</span>  /&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>条件判断<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>如果testBoolean 是 true ，本句话就会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">"$&#123;not testBoolean&#125;"</span> &gt;</span>取反 ，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:unless</span>=<span class="string">"$&#123;testBoolean&#125;"</span> &gt;</span>unless 等同于上一句，所以如果testBoolean 是 true ，本句话就不会显示<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;testBoolean&#125;?'当testBoolean为真的时候，显示本句话，这是用三相表达式做的':''"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示 转义和非转义的 html 文本<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:utext</span>=<span class="string">"$&#123;htmlContent&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>显示对象以及对象属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.getName()&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span> <span class="attr">th:object</span>=<span class="string">"$&#123;currentProduct&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>*&#123;&#125;方式显示属性<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"*&#123;name&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>算数运算<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">"$&#123;currentProduct.price+999&#125;"</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"showing"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer1"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"include::footer2(2015,2018)"</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-thymeleaf-内置工具"><a class="header-anchor" href="#步骤-6-thymeleaf-内置工具">¶</a>步骤 6 : thymeleaf 内置工具</h4>
<p>像 #date 这样的 thymeleaf内置工具有很多种，一共有如下16种。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Execution Info</span><br><span class="line">Messages</span><br><span class="line">URIs/URLs</span><br><span class="line">Conversions</span><br><span class="line">Dates</span><br><span class="line">Calendars</span><br><span class="line">Numbers</span><br><span class="line">Strings</span><br><span class="line">Objects</span><br><span class="line">Booleans</span><br><span class="line">Arrays</span><br><span class="line">Lists</span><br><span class="line">Sets</span><br><span class="line">Maps</span><br><span class="line">Aggregates</span><br><span class="line">IDs</span><br></pre></td></tr></table></figure>
<p>并不是每一种都用得到，所以这里把他们的用法手册列出来了，将来用到的时候再来查看就行了。</p>
<h4 id="步骤-7-Execution-Info"><a class="header-anchor" href="#步骤-7-Execution-Info">¶</a>步骤 7 : Execution Info</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#execInfo.templateName&#125;</span><br><span class="line">$&#123;#execInfo.templateMode&#125;</span><br><span class="line">$&#123;#execInfo.processedTemplateName&#125;</span><br><span class="line">$&#123;#execInfo.processedTemplateMode&#125;</span><br><span class="line">$&#123;#execInfo.templateNames&#125;</span><br><span class="line">$&#123;#execInfo.templateModes&#125;</span><br><span class="line">$&#123;#execInfo.templateStack&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-Messages"><a class="header-anchor" href="#步骤-8-Messages">¶</a>步骤 8 : Messages</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#messages.msg('msgKey')&#125;</span><br><span class="line">$&#123;#messages.msg('msgKey', param1)&#125;</span><br><span class="line">$&#123;#messages.msg('msgKey', param1, param2)&#125;</span><br><span class="line">$&#123;#messages.msg('msgKey', param1, param2, param3)&#125;</span><br><span class="line">$&#123;#messages.msgWithParams('msgKey', new Object[] &#123;param1, param2, param3, param4&#125;)&#125;</span><br><span class="line">$&#123;#messages.arrayMsg(messageKeyArray)&#125;</span><br><span class="line">$&#123;#messages.listMsg(messageKeyList)&#125;</span><br><span class="line">$&#123;#messages.setMsg(messageKeySet)&#125;</span><br><span class="line">$&#123;#messages.msgOrNull('msgKey')&#125;</span><br><span class="line">$&#123;#messages.msgOrNull('msgKey', param1)&#125;</span><br><span class="line">$&#123;#messages.msgOrNull('msgKey', param1, param2)&#125;</span><br><span class="line">$&#123;#messages.msgOrNull('msgKey', param1, param2, param3)&#125;</span><br><span class="line">$&#123;#messages.msgOrNullWithParams('msgKey', new Object[] &#123;param1, param2, param3, param4&#125;)&#125;</span><br><span class="line">$&#123;#messages.arrayMsgOrNull(messageKeyArray)&#125;</span><br><span class="line">$&#123;#messages.listMsgOrNull(messageKeyList)&#125;</span><br><span class="line">$&#123;#messages.setMsgOrNull(messageKeySet)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-URIs-URLs"><a class="header-anchor" href="#步骤-9-URIs-URLs">¶</a>步骤 9 : URIs/URLs</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#uris.escapePath(uri)&#125;</span><br><span class="line">$&#123;#uris.escapePath(uri, encoding)&#125;</span><br><span class="line">$&#123;#uris.unescapePath(uri)&#125;</span><br><span class="line">$&#123;#uris.unescapePath(uri, encoding)&#125;</span><br><span class="line">$&#123;#uris.escapePathSegment(uri)&#125;</span><br><span class="line">$&#123;#uris.escapePathSegment(uri, encoding)&#125;</span><br><span class="line">$&#123;#uris.unescapePathSegment(uri)&#125;</span><br><span class="line">$&#123;#uris.unescapePathSegment(uri, encoding)&#125;</span><br><span class="line">$&#123;#uris.escapeFragmentId(uri)&#125;</span><br><span class="line">$&#123;#uris.escapeFragmentId(uri, encoding)&#125;</span><br><span class="line">$&#123;#uris.unescapeFragmentId(uri)&#125;</span><br><span class="line">$&#123;#uris.unescapeFragmentId(uri, encoding)&#125;</span><br><span class="line">$&#123;#uris.escapeQueryParam(uri)&#125;</span><br><span class="line">$&#123;#uris.escapeQueryParam(uri, encoding)&#125;</span><br><span class="line">$&#123;#uris.unescapeQueryParam(uri)&#125;</span><br><span class="line">$&#123;#uris.unescapeQueryParam(uri, encoding)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-Conversions"><a class="header-anchor" href="#步骤-10-Conversions">¶</a>步骤 10 : Conversions</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#conversions.convert(object, 'java.util.TimeZone')&#125;</span><br><span class="line">$&#123;#conversions.convert(object, targetClass)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-Dates"><a class="header-anchor" href="#步骤-11-Dates">¶</a>步骤 11 : Dates</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#dates.format(date)&#125;</span><br><span class="line">$&#123;#dates.arrayFormat(datesArray)&#125;</span><br><span class="line">$&#123;#dates.listFormat(datesList)&#125;</span><br><span class="line">$&#123;#dates.setFormat(datesSet)&#125;</span><br><span class="line">$&#123;#dates.formatISO(date)&#125;</span><br><span class="line">$&#123;#dates.arrayFormatISO(datesArray)&#125;</span><br><span class="line">$&#123;#dates.listFormatISO(datesList)&#125;</span><br><span class="line">$&#123;#dates.setFormatISO(datesSet)&#125;</span><br><span class="line">$&#123;#dates.format(date, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#dates.arrayFormat(datesArray, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#dates.listFormat(datesList, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#dates.setFormat(datesSet, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#dates.day(date)&#125;                   </span><br><span class="line">$&#123;#dates.month(date)&#125;                 </span><br><span class="line">$&#123;#dates.monthName(date)&#125;             </span><br><span class="line">$&#123;#dates.monthNameShort(date)&#125;        </span><br><span class="line">$&#123;#dates.year(date)&#125;                  </span><br><span class="line">$&#123;#dates.dayOfWeek(date)&#125;             </span><br><span class="line">$&#123;#dates.dayOfWeekName(date)&#125;         </span><br><span class="line">$&#123;#dates.dayOfWeekNameShort(date)&#125;    </span><br><span class="line">$&#123;#dates.hour(date)&#125;                  </span><br><span class="line">$&#123;#dates.minute(date)&#125;                </span><br><span class="line">$&#123;#dates.second(date)&#125;                </span><br><span class="line">$&#123;#dates.millisecond(date)&#125;           </span><br><span class="line">$&#123;#dates.create(year,month,day)&#125;</span><br><span class="line">$&#123;#dates.create(year,month,day,hour,minute)&#125;</span><br><span class="line">$&#123;#dates.create(year,month,day,hour,minute,second)&#125;</span><br><span class="line">$&#123;#dates.create(year,month,day,hour,minute,second,millisecond)&#125;</span><br><span class="line">$&#123;#dates.createNow()&#125;</span><br><span class="line">$&#123;#dates.createNowForTimeZone()&#125;</span><br><span class="line">$&#123;#dates.createToday()&#125;</span><br><span class="line">$&#123;#dates.createTodayForTimeZone()&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-Calendars"><a class="header-anchor" href="#步骤-12-Calendars">¶</a>步骤 12 : Calendars</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#calendars.format(cal)&#125;</span><br><span class="line">$&#123;#calendars.arrayFormat(calArray)&#125;</span><br><span class="line">$&#123;#calendars.listFormat(calList)&#125;</span><br><span class="line">$&#123;#calendars.setFormat(calSet)&#125;</span><br><span class="line">$&#123;#calendars.formatISO(cal)&#125;</span><br><span class="line">$&#123;#calendars.arrayFormatISO(calArray)&#125;</span><br><span class="line">$&#123;#calendars.listFormatISO(calList)&#125;</span><br><span class="line">$&#123;#calendars.setFormatISO(calSet)&#125;</span><br><span class="line">$&#123;#calendars.format(cal, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#calendars.arrayFormat(calArray, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#calendars.listFormat(calList, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#calendars.setFormat(calSet, 'dd/MMM/yyyy HH:mm')&#125;</span><br><span class="line">$&#123;#calendars.day(date)&#125;               </span><br><span class="line">$&#123;#calendars.month(date)&#125;             </span><br><span class="line">$&#123;#calendars.monthName(date)&#125;         </span><br><span class="line">$&#123;#calendars.monthNameShort(date)&#125;    </span><br><span class="line">$&#123;#calendars.year(date)&#125;              </span><br><span class="line">$&#123;#calendars.dayOfWeek(date)&#125;         </span><br><span class="line">$&#123;#calendars.dayOfWeekName(date)&#125;     </span><br><span class="line">$&#123;#calendars.dayOfWeekNameShort(date)&#125;</span><br><span class="line">$&#123;#calendars.hour(date)&#125;              </span><br><span class="line">$&#123;#calendars.minute(date)&#125;            </span><br><span class="line">$&#123;#calendars.second(date)&#125;            </span><br><span class="line">$&#123;#calendars.millisecond(date)&#125;       </span><br><span class="line">$&#123;#calendars.create(year,month,day)&#125;</span><br><span class="line">$&#123;#calendars.create(year,month,day,hour,minute)&#125;</span><br><span class="line">$&#123;#calendars.create(year,month,day,hour,minute,second)&#125;</span><br><span class="line">$&#123;#calendars.create(year,month,day,hour,minute,second,millisecond)&#125;</span><br><span class="line">$&#123;#calendars.createForTimeZone(year,month,day,timeZone)&#125;</span><br><span class="line">$&#123;#calendars.createForTimeZone(year,month,day,hour,minute,timeZone)&#125;</span><br><span class="line">$&#123;#calendars.createForTimeZone(year,month,day,hour,minute,second,timeZone)&#125;</span><br><span class="line">$&#123;#calendars.createForTimeZone(year,month,day,hour,minute,second,millisecond,timeZone)&#125;</span><br><span class="line">$&#123;#calendars.createNow()&#125;</span><br><span class="line">$&#123;#calendars.createNowForTimeZone()&#125;</span><br><span class="line">$&#123;#calendars.createToday()&#125;</span><br><span class="line">$&#123;#calendars.createTodayForTimeZone()&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-Numbers"><a class="header-anchor" href="#步骤-13-Numbers">¶</a>步骤 13 : Numbers</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#numbers.formatInteger(num,3)&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatInteger(numArray,3)&#125;</span><br><span class="line">$&#123;#numbers.listFormatInteger(numList,3)&#125;</span><br><span class="line">$&#123;#numbers.setFormatInteger(numSet,3)&#125;</span><br><span class="line">$&#123;#numbers.formatInteger(num,3,'POINT')&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatInteger(numArray,3,'POINT')&#125;</span><br><span class="line">$&#123;#numbers.listFormatInteger(numList,3,'POINT')&#125;</span><br><span class="line">$&#123;#numbers.setFormatInteger(numSet,3,'POINT')&#125;</span><br><span class="line">$&#123;#numbers.formatDecimal(num,3,2)&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatDecimal(numArray,3,2)&#125;</span><br><span class="line">$&#123;#numbers.listFormatDecimal(numList,3,2)&#125;</span><br><span class="line">$&#123;#numbers.setFormatDecimal(numSet,3,2)&#125;</span><br><span class="line">$&#123;#numbers.formatDecimal(num,3,2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatDecimal(numArray,3,2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.listFormatDecimal(numList,3,2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.setFormatDecimal(numSet,3,2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.formatDecimal(num,3,'POINT',2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatDecimal(numArray,3,'POINT',2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.listFormatDecimal(numList,3,'POINT',2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.setFormatDecimal(numSet,3,'POINT',2,'COMMA')&#125;</span><br><span class="line">$&#123;#numbers.formatCurrency(num)&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatCurrency(numArray)&#125;</span><br><span class="line">$&#123;#numbers.listFormatCurrency(numList)&#125;</span><br><span class="line">$&#123;#numbers.setFormatCurrency(numSet)&#125;</span><br><span class="line">$&#123;#numbers.formatPercent(num)&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatPercent(numArray)&#125;</span><br><span class="line">$&#123;#numbers.listFormatPercent(numList)&#125;</span><br><span class="line">$&#123;#numbers.setFormatPercent(numSet)&#125;</span><br><span class="line">$&#123;#numbers.formatPercent(num, 3, 2)&#125;</span><br><span class="line">$&#123;#numbers.arrayFormatPercent(numArray, 3, 2)&#125;</span><br><span class="line">$&#123;#numbers.listFormatPercent(numList, 3, 2)&#125;</span><br><span class="line">$&#123;#numbers.setFormatPercent(numSet, 3, 2)&#125;</span><br><span class="line">$&#123;#numbers.sequence(from,to)&#125;</span><br><span class="line">$&#123;#numbers.sequence(from,to,step)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-14-Strings"><a class="header-anchor" href="#步骤-14-Strings">¶</a>步骤 14 : Strings</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#strings.toString(obj)&#125;                          </span><br><span class="line">$&#123;#strings.isEmpty(name)&#125;</span><br><span class="line">$&#123;#strings.arrayIsEmpty(nameArr)&#125;</span><br><span class="line">$&#123;#strings.listIsEmpty(nameList)&#125;</span><br><span class="line">$&#123;#strings.setIsEmpty(nameSet)&#125;</span><br><span class="line">$&#123;#strings.defaultString(text,default)&#125;</span><br><span class="line">$&#123;#strings.arrayDefaultString(textArr,default)&#125;</span><br><span class="line">$&#123;#strings.listDefaultString(textList,default)&#125;</span><br><span class="line">$&#123;#strings.setDefaultString(textSet,default)&#125;</span><br><span class="line">$&#123;#strings.contains(name,'ez')&#125;                    </span><br><span class="line">$&#123;#strings.containsIgnoreCase(name,'ez')&#125;          </span><br><span class="line">$&#123;#strings.startsWith(name,'Don')&#125;                 </span><br><span class="line">$&#123;#strings.endsWith(name,endingFragment)&#125;          </span><br><span class="line">$&#123;#strings.indexOf(name,frag)&#125;                     </span><br><span class="line">$&#123;#strings.substring(name,3,5)&#125;                    </span><br><span class="line">$&#123;#strings.substringAfter(name,prefix)&#125;            </span><br><span class="line">$&#123;#strings.substringBefore(name,suffix)&#125;           </span><br><span class="line">$&#123;#strings.replace(name,'las','ler')&#125;              </span><br><span class="line">$&#123;#strings.prepend(str,prefix)&#125;                    </span><br><span class="line">$&#123;#strings.append(str,suffix)&#125;                     </span><br><span class="line">$&#123;#strings.toUpperCase(name)&#125;                      </span><br><span class="line">$&#123;#strings.toLowerCase(name)&#125;                      </span><br><span class="line">$&#123;#strings.arrayJoin(namesArray,',')&#125;</span><br><span class="line">$&#123;#strings.listJoin(namesList,',')&#125;</span><br><span class="line">$&#123;#strings.setJoin(namesSet,',')&#125;</span><br><span class="line">$&#123;#strings.arraySplit(namesStr,',')&#125;               </span><br><span class="line">$&#123;#strings.listSplit(namesStr,',')&#125;                </span><br><span class="line">$&#123;#strings.setSplit(namesStr,',')&#125;                 </span><br><span class="line">$&#123;#strings.trim(str)&#125;                              </span><br><span class="line">$&#123;#strings.length(str)&#125;                            </span><br><span class="line">$&#123;#strings.abbreviate(str,10)&#125;                     </span><br><span class="line">$&#123;#strings.capitalize(str)&#125;                        </span><br><span class="line">$&#123;#strings.unCapitalize(str)&#125;                      </span><br><span class="line">$&#123;#strings.capitalizeWords(str)&#125;                   </span><br><span class="line">$&#123;#strings.capitalizeWords(str,delimiters)&#125;        </span><br><span class="line">$&#123;#strings.escapeXml(str)&#125;                         </span><br><span class="line">$&#123;#strings.escapeJava(str)&#125;                        </span><br><span class="line">$&#123;#strings.escapeJavaScript(str)&#125;                  </span><br><span class="line">$&#123;#strings.unescapeJava(str)&#125;                      </span><br><span class="line">$&#123;#strings.unescapeJavaScript(str)&#125;                </span><br><span class="line">$&#123;#strings.equals(first, second)&#125;</span><br><span class="line">$&#123;#strings.equalsIgnoreCase(first, second)&#125;</span><br><span class="line">$&#123;#strings.concat(values...)&#125;</span><br><span class="line">$&#123;#strings.concatReplaceNulls(nullValue, values...)&#125;</span><br><span class="line">$&#123;#strings.randomAlphanumeric(count)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-15-Objects"><a class="header-anchor" href="#步骤-15-Objects">¶</a>步骤 15 : Objects</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#objects.nullSafe(obj,default)&#125;</span><br><span class="line">$&#123;#objects.arrayNullSafe(objArray,default)&#125;</span><br><span class="line">$&#123;#objects.listNullSafe(objList,default)&#125;</span><br><span class="line">$&#123;#objects.setNullSafe(objSet,default)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-16-Booleans"><a class="header-anchor" href="#步骤-16-Booleans">¶</a>步骤 16 : Booleans</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#bools.isTrue(obj)&#125;</span><br><span class="line">$&#123;#bools.arrayIsTrue(objArray)&#125;</span><br><span class="line">$&#123;#bools.listIsTrue(objList)&#125;</span><br><span class="line">$&#123;#bools.setIsTrue(objSet)&#125;</span><br><span class="line">$&#123;#bools.isFalse(cond)&#125;</span><br><span class="line">$&#123;#bools.arrayIsFalse(condArray)&#125;</span><br><span class="line">$&#123;#bools.listIsFalse(condList)&#125;</span><br><span class="line">$&#123;#bools.setIsFalse(condSet)&#125;</span><br><span class="line">$&#123;#bools.arrayAnd(condArray)&#125;</span><br><span class="line">$&#123;#bools.listAnd(condList)&#125;</span><br><span class="line">$&#123;#bools.setAnd(condSet)&#125;</span><br><span class="line">$&#123;#bools.arrayOr(condArray)&#125;</span><br><span class="line">$&#123;#bools.listOr(condList)&#125;</span><br><span class="line">$&#123;#bools.setOr(condSet)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-17-Arrays"><a class="header-anchor" href="#步骤-17-Arrays">¶</a>步骤 17 : Arrays</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#arrays.toArray(object)&#125;</span><br><span class="line">$&#123;#arrays.toStringArray(object)&#125;</span><br><span class="line">$&#123;#arrays.toIntegerArray(object)&#125;</span><br><span class="line">$&#123;#arrays.toLongArray(object)&#125;</span><br><span class="line">$&#123;#arrays.toDoubleArray(object)&#125;</span><br><span class="line">$&#123;#arrays.toFloatArray(object)&#125;</span><br><span class="line">$&#123;#arrays.toBooleanArray(object)&#125;</span><br><span class="line">$&#123;#arrays.length(array)&#125;</span><br><span class="line">$&#123;#arrays.isEmpty(array)&#125;</span><br><span class="line">$&#123;#arrays.contains(array, element)&#125;</span><br><span class="line">$&#123;#arrays.containsAll(array, elements)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-18-Lists"><a class="header-anchor" href="#步骤-18-Lists">¶</a>步骤 18 : Lists</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#lists.toList(object)&#125;</span><br><span class="line">$&#123;#lists.size(list)&#125;</span><br><span class="line">$&#123;#lists.isEmpty(list)&#125;</span><br><span class="line">$&#123;#lists.contains(list, element)&#125;</span><br><span class="line">$&#123;#lists.containsAll(list, elements)&#125;</span><br><span class="line">$&#123;#lists.sort(list)&#125;</span><br><span class="line">$&#123;#lists.sort(list, comparator)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-19-Sets"><a class="header-anchor" href="#步骤-19-Sets">¶</a>步骤 19 : Sets</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#sets.size(set)&#125;</span><br><span class="line">$&#123;#sets.isEmpty(set)&#125;</span><br><span class="line">$&#123;#sets.contains(set, element)&#125;</span><br><span class="line">$&#123;#sets.containsAll(set, elements)&#125;</span><br><span class="line">$&#123;#sets.toSet(object)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-20-Maps"><a class="header-anchor" href="#步骤-20-Maps">¶</a>步骤 20 : Maps</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#maps.size(map)&#125;</span><br><span class="line">$&#123;#maps.isEmpty(map)&#125;</span><br><span class="line">$&#123;#maps.containsKey(map, key)&#125;</span><br><span class="line">$&#123;#maps.containsAllKeys(map, keys)&#125;</span><br><span class="line">$&#123;#maps.containsValue(map, value)&#125;</span><br><span class="line">$&#123;#maps.containsAllValues(map, value)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-21-Aggregates"><a class="header-anchor" href="#步骤-21-Aggregates">¶</a>步骤 21 : Aggregates</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#aggregates.sum(array)&#125;</span><br><span class="line">$&#123;#aggregates.sum(collection)&#125;</span><br><span class="line">$&#123;#aggregates.avg(array)&#125;</span><br><span class="line">$&#123;#aggregates.avg(collection)&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-22-IDs"><a class="header-anchor" href="#步骤-22-IDs">¶</a>步骤 22 : IDs</h4>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;#ids.seq('someId')&#125;</span><br><span class="line">$&#123;#ids.next('someId')&#125;</span><br><span class="line">$&#123;#ids.prev('someId')&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">内置工具</span><br><span class="line">	Execution Info</span><br><span class="line">		获取页面模板的处理信息</span><br><span class="line">	Messages</span><br><span class="line">		在变量表达式中获取外部消息的方法，与使用＃&#123;...&#125;语法获取的方法相同</span><br><span class="line">	URIs/URLs</span><br><span class="line">		转义部分URL / URI的方法</span><br><span class="line">	Conversions</span><br><span class="line">		用于执行已配置的转换服务的方法</span><br><span class="line">	Dates</span><br><span class="line">		时间操作和时间格式化等</span><br><span class="line">	Calendars</span><br><span class="line">		用于更复杂时间的格式化</span><br><span class="line">	Numbers</span><br><span class="line">		格式化数字对象的方法</span><br><span class="line">	Strings</span><br><span class="line">		字符串工具类</span><br><span class="line">	Objects</span><br><span class="line">		一般对象类，通常用来判断非空</span><br><span class="line">	Booleans</span><br><span class="line">		常用的布尔方法</span><br><span class="line">	Arrays</span><br><span class="line">		数组工具类</span><br><span class="line">	Lists</span><br><span class="line">		List 工具类</span><br><span class="line">	Sets</span><br><span class="line">		Set 工具类</span><br><span class="line">	Maps</span><br><span class="line">		常用Map方法</span><br><span class="line">	Aggregates</span><br><span class="line">		在数组或集合上创建聚合的方法</span><br><span class="line">	IDs</span><br><span class="line">		处理可能重复的id属性的方法</span><br></pre></td></tr></table></figure>
<h3 id="8、SPRINGBOOT-整合-THYMELEAF-做增删改查-CRUD和分页"><a class="header-anchor" href="#8、SPRINGBOOT-整合-THYMELEAF-做增删改查-CRUD和分页">¶</a>8、SPRINGBOOT 整合 THYMELEAF 做增删改查 CRUD和分页</h3>
<h4 id="步骤-1-基于前面的知识点-v4"><a class="header-anchor" href="#步骤-1-基于前面的知识点-v4">¶</a>步骤 1 : 基于前面的知识点</h4>
<p>本知识点是建立在上一个知识点可运行项目的基础上进行的改进,所以最好把上个知识点理解和消化了.</p>
<h4 id="步骤-2-先运行，看到效果，再学习-v19"><a class="header-anchor" href="#步骤-2-先运行，看到效果，再学习-v19">¶</a>步骤 2 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行 Application.java ，然后访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/listCategory</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/7756.png" alt></p>
<h4 id="步骤-3-模仿和排错-v18"><a class="header-anchor" href="#步骤-3-模仿和排错-v18">¶</a>步骤 3 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-4-表结构和数据"><a class="header-anchor" href="#步骤-4-表结构和数据">¶</a>步骤 4 : 表结构和数据</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create database how2java;</span><br><span class="line">use how2java;</span><br><span class="line">CREATE TABLE category_ (</span><br><span class="line">  id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  name varchar(30),</span><br><span class="line">  PRIMARY KEY (id)</span><br><span class="line">) DEFAULT CHARSET&#x3D;UTF8;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-5-application-properties"><a class="header-anchor" href="#步骤-5-application-properties">¶</a>步骤 5 : application.properties</h4>
<p>增加数据库相关配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据库</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#thymeleaf 配置</span></span><br><span class="line"><span class="meta">spring.thymeleaf.mode</span>=<span class="string">HTML5</span></span><br><span class="line"><span class="meta">spring.thymeleaf.encoding</span>=<span class="string">UTF-8</span></span><br><span class="line"><span class="meta">spring.thymeleaf.content-type</span>=<span class="string">text/html</span></span><br><span class="line"><span class="comment">#缓存设置为false, 这样修改之后马上生效，便于调试</span></span><br><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br><span class="line"><span class="comment">#上下文</span></span><br><span class="line"><span class="meta">server.context-path</span>=<span class="string">/thymeleaf</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#数据库</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-6-pom-xml"><a class="header-anchor" href="#步骤-6-pom-xml">¶</a>步骤 6 : pom.xml</h4>
<p>修改pom.xml, 增加 jdbc,mybatis, pageHelper 的jar包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>thymeleaf<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>thymeleaf<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet依赖. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                </span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>   </span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="comment">&lt;!-- pageHelper --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-7-Category"><a class="header-anchor" href="#步骤-7-Category">¶</a>步骤 7 : Category</h4>
<p>增加实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.pojo;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Category</span> </span>&#123;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">       </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-CategoryMapper"><a class="header-anchor" href="#步骤-8-CategoryMapper">¶</a>步骤 8 : CategoryMapper</h4>
<p>增加Mapper类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CategoryMapper</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ "</span>)</span><br><span class="line">    <span class="function">List&lt;Category&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line">      </span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">" insert into category_ ( name ) values (#&#123;name&#125;) "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">save</span><span class="params">(Category category)</span></span>;</span><br><span class="line">      </span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">" delete from category_ where id= #&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">          </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from category_ where id= #&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Category <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">        </span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"update category_ set name=#&#123;name&#125; where id=#&#123;id&#125; "</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Category category)</span></span>;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-CategoryController"><a class="header-anchor" href="#步骤-9-CategoryController">¶</a>步骤 9 : CategoryController</h4>
<p>增加控制类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.mapper.CategoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Category;</span><br><span class="line">    </span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CategoryController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> CategoryMapper categoryMapper;</span><br><span class="line">       </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/addCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryMapper.save(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/deleteCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">deleteCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryMapper.delete(c.getId());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/updateCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">updateCategory</span><span class="params">(Category c)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        categoryMapper.update(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/editCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(<span class="keyword">int</span> id,Model m)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Category c= categoryMapper.get(id);</span><br><span class="line">        m.addAttribute(<span class="string">"c"</span>, c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"editCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/listCategory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">listCategory</span><span class="params">(Model m,@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"0"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        PageHelper.startPage(start,size,<span class="string">"id desc"</span>);</span><br><span class="line">        List&lt;Category&gt; cs=categoryMapper.findAll();</span><br><span class="line">        PageInfo&lt;Category&gt; page = <span class="keyword">new</span> PageInfo&lt;&gt;(cs);</span><br><span class="line">        m.addAttribute(<span class="string">"page"</span>, page);       </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"listCategory"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-PageHelperConfig"><a class="header-anchor" href="#步骤-10-PageHelperConfig">¶</a>步骤 10 : PageHelperConfig</h4>
<p>配置 PageHealper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.config;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageHelperConfig</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PageHelper <span class="title">pageHelper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageHelper pageHelper = <span class="keyword">new</span> PageHelper();</span><br><span class="line">        Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">        p.setProperty(<span class="string">"offsetAsPageNum"</span>, <span class="string">"true"</span>);</span><br><span class="line">        p.setProperty(<span class="string">"rowBoundsWithCount"</span>, <span class="string">"true"</span>);</span><br><span class="line">        p.setProperty(<span class="string">"reasonable"</span>, <span class="string">"true"</span>);</span><br><span class="line">        pageHelper.setProperties(p);</span><br><span class="line">        <span class="keyword">return</span> pageHelper;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-listCategory-html"><a class="header-anchor" href="#步骤-11-listCategory-html">¶</a>步骤 11 : listCategory.html</h4>
<p>增加和查询的页面 listCategory.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width:500px;margin:20px auto;text-align: center"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">align</span>=<span class="string">'center'</span> <span class="attr">border</span>=<span class="string">'1'</span> <span class="attr">cellspacing</span>=<span class="string">'0'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>id<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>name<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"c:$&#123;page.list&#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;c.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;c.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/editCategory(id=$&#123;c.id&#125;)&#125;"</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/deleteCategory(id=$&#123;c.id&#125;)&#125;"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/listCategory(start=0)&#125;"</span>&gt;</span>[首  页]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/listCategory(start=$&#123;page.pageNum-1&#125;)&#125;"</span>&gt;</span>[上一页]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/listCategory(start=$&#123;page.pageNum+1&#125;)&#125;"</span>&gt;</span>[下一页]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/listCategory(start=$&#123;page.pages&#125;)&#125;"</span>&gt;</span>[末  页]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>/&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"addCategory"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">    name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"name"</span>/&gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-editCategory-html"><a class="header-anchor" href="#步骤-12-editCategory-html">¶</a>步骤 12 : editCategory.html</h4>
<p>修改页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin:0px auto; width:500px"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"updateCategory"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">    name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;c.name&#125;"</span>/&gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">th:value</span>=<span class="string">"$&#123;c.id&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-重启测试"><a class="header-anchor" href="#步骤-13-重启测试">¶</a>步骤 13 : 重启测试</h4>
<p>重新运行 Application.java 然后访问地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/thymeleaf/listCategory</span></span><br></pre></td></tr></table></figure>
<h3 id="9、VUE-JS-RESTFUL-PAGEHELPER-THYMELEAF-SPRINGBOOT-前后端分离-增删改查-CRUD-教程"><a class="header-anchor" href="#9、VUE-JS-RESTFUL-PAGEHELPER-THYMELEAF-SPRINGBOOT-前后端分离-增删改查-CRUD-教程">¶</a>9、VUE.JS + RESTFUL + PAGEHELPER + THYMELEAF + SPRINGBOOT 前后端分离 增删改查 CRUD 教程</h3>
<h4 id="步骤-1-教程说明"><a class="header-anchor" href="#步骤-1-教程说明">¶</a>步骤 1 : 教程说明</h4>
<p>这个教程比较复杂，涉及到了多方面的知识点，包括 Vue.js Springboot, Restful风格， 分页 PageHelper 的使用， Thymeleaf 模板。<br>
对任何一个知识点不熟悉，都可以通过右上角搜索找到相关教程。</p>
<h4 id="步骤-2-数据库准备"><a class="header-anchor" href="#步骤-2-数据库准备">¶</a>步骤 2 : 数据库准备</h4>
<p>首先准备数据库 how2java</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database how2java</span><br></pre></td></tr></table></figure>
<h4 id="步骤-3-准备表"><a class="header-anchor" href="#步骤-3-准备表">¶</a>步骤 3 : 准备表</h4>
<p>准备 Hero 表和相关数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">USE &#96;how2java&#96;;</span><br><span class="line">CREATE TABLE &#96;hero&#96; (</span><br><span class="line">  &#96;id&#96; int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  &#96;name&#96; varchar(30) DEFAULT NULL,</span><br><span class="line">  &#96;hp&#96; float DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;id&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;6194 DEFAULT CHARSET&#x3D;utf8;</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6094,&#39;name0&#39;,0);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6095,&#39;name1&#39;,1);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6096,&#39;name2&#39;,2);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6097,&#39;name3&#39;,3);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6098,&#39;name4&#39;,4);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6099,&#39;name5&#39;,5);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6100,&#39;name6&#39;,6);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6101,&#39;name7&#39;,7);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6102,&#39;name8&#39;,8);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6103,&#39;name9&#39;,9);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6104,&#39;name10&#39;,10);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6105,&#39;name11&#39;,11);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6106,&#39;name12&#39;,12);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6107,&#39;name13&#39;,13);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6108,&#39;name14&#39;,14);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6109,&#39;name15&#39;,15);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6110,&#39;name16&#39;,16);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6111,&#39;name17&#39;,17);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6112,&#39;name18&#39;,18);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6113,&#39;name19&#39;,19);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6114,&#39;name20&#39;,20);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6115,&#39;name21&#39;,21);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6116,&#39;name22&#39;,22);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6117,&#39;name23&#39;,23);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6118,&#39;name24&#39;,24);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6119,&#39;name25&#39;,25);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6120,&#39;name26&#39;,26);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6121,&#39;name27&#39;,27);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6122,&#39;name28&#39;,28);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6123,&#39;name29&#39;,29);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6124,&#39;name30&#39;,30);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6125,&#39;name31&#39;,31);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6126,&#39;name32&#39;,32);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6127,&#39;name33&#39;,33);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6128,&#39;name34&#39;,34);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6129,&#39;name35&#39;,35);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6130,&#39;name36&#39;,36);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6131,&#39;name37&#39;,37);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6132,&#39;name38&#39;,38);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6133,&#39;name39&#39;,39);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6134,&#39;name40&#39;,40);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6135,&#39;name41&#39;,41);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6136,&#39;name42&#39;,42);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6137,&#39;name43&#39;,43);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6138,&#39;name44&#39;,44);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6139,&#39;name45&#39;,45);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6140,&#39;name46&#39;,46);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6141,&#39;name47&#39;,47);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6142,&#39;name48&#39;,48);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6143,&#39;name49&#39;,49);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6144,&#39;name50&#39;,50);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6145,&#39;name51&#39;,51);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6146,&#39;name52&#39;,52);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6147,&#39;name53&#39;,53);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6148,&#39;name54&#39;,54);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6149,&#39;name55&#39;,55);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6150,&#39;name56&#39;,56);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6151,&#39;name57&#39;,57);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6152,&#39;name58&#39;,58);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6153,&#39;name59&#39;,59);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6154,&#39;name60&#39;,60);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6155,&#39;name61&#39;,61);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6156,&#39;name62&#39;,62);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6157,&#39;name63&#39;,63);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6158,&#39;name64&#39;,64);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6159,&#39;name65&#39;,65);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6160,&#39;name66&#39;,66);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6161,&#39;name67&#39;,67);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6162,&#39;name68&#39;,68);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6163,&#39;name69&#39;,69);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6164,&#39;name70&#39;,70);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6165,&#39;name71&#39;,71);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6166,&#39;name72&#39;,72);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6167,&#39;name73&#39;,73);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6168,&#39;name74&#39;,74);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6169,&#39;name75&#39;,75);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6170,&#39;name76&#39;,76);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6171,&#39;name77&#39;,77);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6172,&#39;name78&#39;,78);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6173,&#39;name79&#39;,79);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6174,&#39;name80&#39;,80);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6175,&#39;name81&#39;,81);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6176,&#39;name82&#39;,82);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6177,&#39;name83&#39;,83);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6178,&#39;name84&#39;,84);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6179,&#39;name85&#39;,85);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6180,&#39;name86&#39;,86);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6181,&#39;name87&#39;,87);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6182,&#39;name88&#39;,88);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6183,&#39;name89&#39;,89);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6184,&#39;name90&#39;,90);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6185,&#39;name91&#39;,91);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6186,&#39;name92&#39;,92);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6187,&#39;name93&#39;,93);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6188,&#39;name94&#39;,94);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6189,&#39;name95&#39;,95);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6190,&#39;name96&#39;,96);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6191,&#39;name97&#39;,97);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6192,&#39;name98&#39;,98);</span><br><span class="line">INSERT INTO &#96;hero&#96; VALUES (6193,&#39;name99&#39;,99);</span><br></pre></td></tr></table></figure>
<h4 id="步骤-4-先运行，看到效果，再学习-v4"><a class="header-anchor" href="#步骤-4-先运行，看到效果，再学习-v4">¶</a>步骤 4 : 先运行，看到效果，再学习</h4>
<p>老规矩，先下载右上角的可运行项目，配置运行起来，确认可用之后，再学习做了哪些步骤以达到这样的效果。<br>
运行下面类的主方法启动项目</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.how2java.springboot.Application</span><br></pre></td></tr></table></figure>
<p>然后访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listHero</span></span><br></pre></td></tr></table></figure>
<p>这就是前后端分离的 CRUD 了。<br>
没有套用 bootstrap 美化界面，尽量要足够少的知识来展现本教程的核心内容，以免被分散精力。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8032.png" alt></p>
<h4 id="步骤-5-模仿和排错-v4"><a class="header-anchor" href="#步骤-5-模仿和排错-v4">¶</a>步骤 5 : 模仿和排错</h4>
<p>在确保可运行项目能够正确无误地运行之后，再严格照着教程的步骤，对代码模仿一遍。<br>
模仿过程难免代码有出入，导致无法得到期望的运行结果，此时此刻通过比较<strong>正确答案</strong> ( 可运行项目 ) 和自己的代码，来定位问题所在。<br>
采用这种方式，<strong>学习有效果，排错有效率</strong>，可以较为明显地提升学习速度，跨过学习路上的各个槛。</p>
<p>推荐使用diffmerge软件，进行文件夹比较。把你自己做的项目文件夹，和我的可运行项目文件夹进行比较。<br>
这个软件很牛逼的，可以知道文件夹里哪两个文件不对，并且很明显地标记出来<br>
这里提供了绿色安装和使用教程：[diffmerge 下载和使用教程]</p>
<h4 id="步骤-6-新建-springboot-项目"><a class="header-anchor" href="#步骤-6-新建-springboot-项目">¶</a>步骤 6 : 新建 springboot 项目</h4>
<p>新建一个 springboot 项目，新建方式在前面教程已经讲解过了，这里不赘述<br>
[Eclipse 方式创建 Springboot 项目]<br>
[IDEA 方式创建 Springboot 项目]</p>
<h4 id="步骤-7-pom-xml-v3"><a class="header-anchor" href="#步骤-7-pom-xml-v3">¶</a>步骤 7 : pom.xml</h4>
<p>pom.xml 中的相关导包，各个部分都做了注释</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.how2java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>springboot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- springboot web --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- springboot tomcat 支持 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- thymeleaf --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- thymeleaf legacyhtml5 模式支持 --&gt;</span>      </span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sourceforge.nekohtml<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nekohtml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>        </span><br><span class="line">        <span class="comment">&lt;!-- 测试支持 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 分页 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>        </span><br><span class="line">        <span class="comment">&lt;!-- tomcat的支持.--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>    </span><br><span class="line">        <span class="comment">&lt;!-- 热部署 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-8-application-properties-v5"><a class="header-anchor" href="#步骤-8-application-properties-v5">¶</a>步骤 8 : application.properties</h4>
<p>在 src/main/resources 下新建 application.properties 文件<br>
配置文件指定了 数据库参数， mybatis 参数 和 thymeleaf 参数<br>
其中 LEGACYHTML5 表示使用传统模式，比起 HTML5 来对 html的校验更宽松点，符合大家（懒散）的开发习惯。。。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8036.png" alt></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#database</span></span><br><span class="line"><span class="meta">spring.datasource.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/how2java?characterEncoding=UTF-8</span></span><br><span class="line"><span class="meta">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">spring.datasource.password</span>=<span class="string">admin</span></span><br><span class="line"><span class="meta">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="comment">#mybatis</span></span><br><span class="line"><span class="meta">mybatis.mapper-locations</span>=<span class="string">classpath:mapper/*.xml</span></span><br><span class="line"><span class="meta">mybatis.type-aliases-package</span>=<span class="string">com.how2java.springboot.pojo</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#thymeleaf</span></span><br><span class="line"><span class="meta">spring.thymeleaf.mode</span>=<span class="string">LEGACYHTML5</span></span><br><span class="line"><span class="meta">spring.thymeleaf.encoding</span>=<span class="string">UTF-8</span></span><br><span class="line"><span class="meta">spring.thymeleaf.content-type</span>=<span class="string">text/html</span></span><br><span class="line"><span class="meta">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-9-Application-java"><a class="header-anchor" href="#步骤-9-Application-java">¶</a>步骤 9 : Application.java</h4>
<p>启动类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Application<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-10-分页配置"><a class="header-anchor" href="#步骤-10-分页配置">¶</a>步骤 10 : 分页配置</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.config;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageHelperConfig</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PageHelper <span class="title">pageHelper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        PageHelper pageHelper = <span class="keyword">new</span> PageHelper();</span><br><span class="line">        Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">        p.setProperty(<span class="string">"offsetAsPageNum"</span>, <span class="string">"true"</span>);</span><br><span class="line">        p.setProperty(<span class="string">"rowBoundsWithCount"</span>, <span class="string">"true"</span>);</span><br><span class="line">        p.setProperty(<span class="string">"reasonable"</span>, <span class="string">"true"</span>);</span><br><span class="line">        pageHelper.setProperties(p);</span><br><span class="line">        <span class="keyword">return</span> pageHelper;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-11-异常处理"><a class="header-anchor" href="#步骤-11-异常处理">¶</a>步骤 11 : 异常处理</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.exception;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler</span>(value = Exception<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">ModelAndView</span> <span class="title">defaultErrorHandler</span>(<span class="title">HttpServletRequest</span> <span class="title">req</span>, <span class="title">Exception</span> <span class="title">e</span>) <span class="title">throws</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">        ModelAndView mav = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mav.addObject(<span class="string">"exception"</span>, e);</span><br><span class="line">        mav.addObject(<span class="string">"url"</span>, req.getRequestURL());</span><br><span class="line"> </span><br><span class="line">        mav.setViewName(<span class="string">"errorPage"</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-12-实体类"><a class="header-anchor" href="#步骤-12-实体类">¶</a>步骤 12 : 实体类</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.pojo;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hero</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> hp;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHp</span><span class="params">(<span class="keyword">int</span> hp)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hp = hp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hero [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">", hp="</span> + hp + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-13-Mapper"><a class="header-anchor" href="#步骤-13-Mapper">¶</a>步骤 13 : Mapper</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.mapper;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Hero;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HeroMapper</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Hero hero)</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Hero <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">       </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Hero hero)</span></span>; </span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Hero&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-14-Hero-xml"><a class="header-anchor" href="#步骤-14-Hero-xml">¶</a>步骤 14 : Hero.xml</h4>
<p>这个文件就放在 src/main/resources/mapper 目录下</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8041.png" alt></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.how2java.springboot.mapper.HeroMapper"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"add"</span> <span class="attr">parameterType</span>=<span class="string">"Hero"</span> &gt;</span></span><br><span class="line">            insert into hero ( name,hp ) values (#&#123;name&#125;,#&#123;hp&#125;)  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">          </span><br><span class="line">        <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"delete"</span> <span class="attr">parameterType</span>=<span class="string">"Hero"</span> &gt;</span></span><br><span class="line">            delete from hero where id= #&#123;id&#125; </span><br><span class="line">        <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line">          </span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"get"</span> <span class="attr">parameterType</span>=<span class="string">"_int"</span> <span class="attr">resultType</span>=<span class="string">"Hero"</span>&gt;</span></span><br><span class="line">            select * from   hero  where id= #&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">        <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update"</span> <span class="attr">parameterType</span>=<span class="string">"Hero"</span> &gt;</span></span><br><span class="line">            update hero set name=#&#123;name&#125;, hp = #&#123;hp&#125; where id=#&#123;id&#125;  </span><br><span class="line">        <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"list"</span> <span class="attr">resultType</span>=<span class="string">"Hero"</span>&gt;</span></span><br><span class="line">            select * from   hero    </span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-15-Service-接口"><a class="header-anchor" href="#步骤-15-Service-接口">¶</a>步骤 15 : Service 接口</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Hero;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HeroService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Hero hero)</span></span>;</span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Hero <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">       </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Hero hero)</span></span>; </span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Hero&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-16-Service-实现类"><a class="header-anchor" href="#步骤-16-Service-实现类">¶</a>步骤 16 : Service 实现类</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.mapper.HeroMapper;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Hero;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.service.HeroService;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroServiceImpl</span> <span class="keyword">implements</span> <span class="title">HeroService</span></span>&#123;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Autowired</span> HeroMapper heroMapper;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Hero hero)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> heroMapper.add(hero);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        heroMapper.delete(id);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Hero <span class="title">get</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> heroMapper.get(id);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">update</span><span class="params">(Hero hero)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> heroMapper.update(hero);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Hero&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> heroMapper.list();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-17-Controller-类"><a class="header-anchor" href="#步骤-17-Controller-类">¶</a>步骤 17 : Controller 类</h4>
<p>首先 HeroController 分为两部分:</p>
<ol>
<li>restful 部分</li>
<li>页面跳转部分</li>
</ol>
<p>restful 就提供 CRUD 等等操作<br>
页面跳转主要用来跳转到 thymeleaf 对应的 html 文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.how2java.springboot.web;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.DeleteMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.pojo.Hero;</span><br><span class="line"><span class="keyword">import</span> com.how2java.springboot.service.HeroService;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeroController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span> HeroService heroService;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/*restful 部分*/</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/heroes"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> PageInfo&lt;Hero&gt; <span class="title">list</span><span class="params">(@RequestParam(value = <span class="string">"start"</span>, defaultValue = <span class="string">"1"</span>)</span> <span class="keyword">int</span> start,@<span class="title">RequestParam</span><span class="params">(value = <span class="string">"size"</span>, defaultValue = <span class="string">"5"</span>)</span> <span class="keyword">int</span> size) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        PageHelper.startPage(start,size,<span class="string">"id desc"</span>);</span><br><span class="line">        List&lt;Hero&gt; hs=heroService.list();</span><br><span class="line">        System.out.println(hs.size());</span><br><span class="line"> </span><br><span class="line">        PageInfo&lt;Hero&gt; page = <span class="keyword">new</span> PageInfo&lt;&gt;(hs,<span class="number">5</span>); <span class="comment">//5表示导航分页最多有5个，像 [1,2,3,4,5] 这样</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> page;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/heroes/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Hero <span class="title">get</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(id);</span><br><span class="line">        Hero h=heroService.get(id);</span><br><span class="line">        System.out.println(h);</span><br><span class="line">        <span class="keyword">return</span> h;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/heroes"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">add</span><span class="params">(@RequestBody Hero h)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        heroService.add(h);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@DeleteMapping</span>(<span class="string">"/heroes/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">delete</span><span class="params">(Hero h)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        heroService.delete(h.getId());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@PutMapping</span>(<span class="string">"/heroes/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">update</span><span class="params">(@RequestBody Hero h)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        heroService.update(h);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/*页面跳转 部分*/</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/listHero"</span>, method=RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">listHero</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView(<span class="string">"listHero"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/editHero"</span>, method=RequestMethod.GET)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editHero</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView(<span class="string">"editHero"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步骤-18-js-文件"><a class="header-anchor" href="#步骤-18-js-文件">¶</a>步骤 18 : js 文件</h4>
<p>在 src/main/webapp 下新建 js 目录，里面放上3个要用到的 第三方 js 库： axios.min.js, jquery.min.js, vue.min.js<br>
这3个文件压缩了在右上角下载</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8047.png" alt></p>
<h4 id="步骤-19-模板文件"><a class="header-anchor" href="#步骤-19-模板文件">¶</a>步骤 19 : 模板文件</h4>
<p>在 resources 下新建 templates 目录，创建3个模板文件</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8046.png" alt></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/axios.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line">        td&#123;</span><br><span class="line"><span class="css">            <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-tag">gray</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">           </span><br><span class="line">        table&#123;</span><br><span class="line"><span class="css">            <span class="selector-tag">border-collapse</span><span class="selector-pseudo">:collapse</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-id">#app</span>&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">margin</span><span class="selector-pseudo">:20px</span> <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">width</span><span class="selector-pseudo">:400px</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">padding</span><span class="selector-pseudo">:20px</span>;</span></span><br><span class="line"> </span><br><span class="line">        &#125;     </span><br><span class="line">         </span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-id">#pagination</span>&#123;</span></span><br><span class="line">            text-align: center;</span><br><span class="line">            line-height: 100px;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-id">#pagination</span> <span class="selector-tag">a</span>&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">text-decoration</span><span class="selector-pseudo">:none</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">         </span><br><span class="line"><span class="css">        <span class="selector-class">.disableHref</span>&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">cursor</span><span class="selector-pseudo">:default</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">color</span>:<span class="selector-id">#E5E0E0</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">text-decoration</span><span class="selector-pseudo">:none</span>;       </span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">"a.disableHref"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//                event.preventDefault();</span></span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">"heroListTable"</span> &gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"3"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"pagination"</span> &gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">:class</span>=<span class="string">"&#123; disableHref: pagination.pageNum==1 &#125;"</span> <span class="attr">href</span>=<span class="string">"#nowhere"</span> @<span class="attr">click</span>=<span class="string">"jump('first')"</span>&gt;</span>[first]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">:class</span>=<span class="string">"&#123; disableHref: !pagination.hasPreviousPage &#125;"</span> <span class="attr">href</span>=<span class="string">"#nowhere"</span> @<span class="attr">click</span>=<span class="string">"jump('pre')"</span>&gt;</span>[pre]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#nowhere"</span> <span class="attr">:class</span>=<span class="string">"&#123;disableHref:pagination.pageNum==i&#125;"</span>  <span class="attr">v-for</span>=<span class="string">"i in pagination.navigatepageNums"</span> @<span class="attr">click</span>=<span class="string">"jumpByNumber(i)"</span> &gt;</span></span><br><span class="line">                                    &#123;&#123;i&#125;&#125;</span><br><span class="line">                                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">:class</span>=<span class="string">"&#123; disableHref: !pagination.hasNextPage &#125;"</span> <span class="attr">href</span>=<span class="string">"#nowhere"</span> @<span class="attr">click</span>=<span class="string">"jump('next')"</span>&gt;</span>[next]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">:class</span>=<span class="string">"&#123; disableHref: pagination.pageNum==pagination.pages &#125;"</span> <span class="attr">href</span>=<span class="string">"#nowhere"</span> @<span class="attr">click</span>=<span class="string">"jump('last')"</span>&gt;</span>[last]<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">                        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                                 </span><br><span class="line">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span>&gt;</span>英雄名称<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span>&gt;</span>血量<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">                    <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">"hero in heros "</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;hero.name&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;hero.hp&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">"'editHero?id=' + hero.id "</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#nowhere"</span> @<span class="attr">click</span>=<span class="string">"deleteHero(hero.id)"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"3"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                            英雄名称:</span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>    <span class="attr">v-model</span>=<span class="string">"hero4Add.name"</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                            血量：</span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span>    <span class="attr">v-model</span>=<span class="string">"hero4Add.hp"</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span>  <span class="attr">v-on:click</span>=<span class="string">"add"</span>&gt;</span>增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                         <span class="tag">&lt;/<span class="name">td</span>&gt;</span>                 </span><br><span class="line">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                     </span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> data4Vue = &#123;</span></span><br><span class="line">            heros: [],</span><br><span class="line"><span class="actionscript">            hero4Add: &#123; id: <span class="number">0</span>, name: <span class="string">''</span>, hp: <span class="string">'0'</span>&#125;,</span></span><br><span class="line">            pagination:&#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"> </span><br><span class="line"><span class="actionscript">    <span class="comment">//ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vue = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line">        data: data4Vue,</span><br><span class="line"><span class="actionscript">        mounted:<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123; <span class="comment">//mounted　表示这个 Vue 对象加载成功了</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.list(<span class="number">1</span>);</span></span><br><span class="line">        &#125;,       </span><br><span class="line">        methods: &#123;     </span><br><span class="line"><span class="actionscript">            list:<span class="function"><span class="keyword">function</span><span class="params">(start)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> url = <span class="string">"heroes?start="</span>+start;</span></span><br><span class="line"><span class="actionscript">                axios.get(url).then(<span class="function"><span class="keyword">function</span><span class="params">(response)</span> </span>&#123;</span></span><br><span class="line">                    vue.pagination = response.data;</span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(vue.pagination);</span></span><br><span class="line">                    vue.heros = response.data.list;</span><br><span class="line">                &#125;)    </span><br><span class="line">            &#125;,         </span><br><span class="line"><span class="actionscript">            add: <span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> url = <span class="string">"heroes"</span>;</span></span><br><span class="line">                 </span><br><span class="line"><span class="actionscript">                axios.post(url,<span class="keyword">this</span>.hero4Add).then(<span class="function"><span class="keyword">function</span><span class="params">(response)</span></span>&#123;</span></span><br><span class="line">                    vue.list(1);</span><br><span class="line"><span class="actionscript">                    vue.hero4Add = &#123; id: <span class="number">0</span>, name: <span class="string">''</span>, hp: <span class="string">'0'</span>&#125;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            deleteHero: <span class="function"><span class="keyword">function</span> <span class="params">(id)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> url = <span class="string">"heroes/"</span>+id;</span></span><br><span class="line"><span class="actionscript">                axios.delete(url).then(<span class="function"><span class="keyword">function</span><span class="params">(response)</span></span>&#123;</span></span><br><span class="line">                    vue.list(1);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            jump: <span class="function"><span class="keyword">function</span><span class="params">(page)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">if</span>(<span class="string">'first'</span>== page &amp;&amp; <span class="number">1</span>!=vue.pagination.pageNum)</span></span><br><span class="line">                    vue.list(1);</span><br><span class="line">                 </span><br><span class="line"><span class="actionscript">                <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">'pre'</span>== page &amp;&amp; vue.pagination.hasPreviousPage )</span></span><br><span class="line">                    vue.list(vue.pagination.prePage);</span><br><span class="line">                 </span><br><span class="line"><span class="actionscript">                <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">'next'</span>== page &amp;&amp; vue.pagination.hasNextPage)</span></span><br><span class="line">                    vue.list(vue.pagination.nextPage);                 </span><br><span class="line">                 </span><br><span class="line"><span class="actionscript">                <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">'last'</span>== page &amp;&amp; vue.pagination.pageNum!=vue.pagination.pages)</span></span><br><span class="line">                    vue.list(vue.pagination.pages);</span><br><span class="line">                 </span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            jumpByNumber: <span class="function"><span class="keyword">function</span><span class="params">(start)</span></span>&#123;</span></span><br><span class="line">                if(start!=vue.pagination.pageNum)</span><br><span class="line">                    vue.list(start);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/vue.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/axios.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">div</span><span class="selector-id">#app</span>&#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">margin</span><span class="selector-pseudo">:20px</span> <span class="selector-tag">auto</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">width</span><span class="selector-pseudo">:400px</span>;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">padding</span><span class="selector-pseudo">:20px</span>;</span></span><br><span class="line">        &#125;     </span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div4Update"</span>&gt;</span></span><br><span class="line">               </span><br><span class="line">                            英雄名称:</span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>    <span class="attr">v-model</span>=<span class="string">"hero4Update.name"</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                            血量：</span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span>    <span class="attr">v-model</span>=<span class="string">"hero4Update.hp"</span> /&gt;</span>                      </span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span>    <span class="attr">v-model</span>=<span class="string">"hero4Update.id"</span> /&gt;</span>                      </span><br><span class="line">                            <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span>  <span class="attr">v-on:click</span>=<span class="string">"update"</span>&gt;</span>修改<span class="tag">&lt;/<span class="name">button</span>&gt;</span>               </span><br><span class="line">                            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span>  <span class="attr">v-on:click</span>=<span class="string">"cancel"</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span>               </span><br><span class="line">               </span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">//获取地址栏参数的函数</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">getUrlParms</span><span class="params">(name)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">           <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^|&amp;)"</span>+ name +<span class="string">"=([^&amp;]*)(&amp;|$)"</span>);</span></span><br><span class="line"><span class="javascript">           <span class="keyword">var</span> r = <span class="built_in">window</span>.location.search.substr(<span class="number">1</span>).match(reg);</span></span><br><span class="line"><span class="actionscript">           <span class="keyword">if</span>(r!=<span class="literal">null</span>)</span></span><br><span class="line"><span class="javascript">               <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>]);</span></span><br><span class="line"><span class="actionscript">           <span class="keyword">return</span> <span class="literal">null</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> data4Vue = &#123;</span></span><br><span class="line">            heros: [],</span><br><span class="line"><span class="actionscript">            hero4Update: &#123; id: <span class="number">0</span>, name: <span class="string">''</span>, hp: <span class="string">'0'</span>&#125;</span></span><br><span class="line">    &#125;;     </span><br><span class="line">     </span><br><span class="line"><span class="actionscript">    <span class="comment">//ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vue = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line">        data: data4Vue,</span><br><span class="line"><span class="actionscript">        mounted:<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123; <span class="comment">//mounted　表示这个 Vue 对象加载成功了</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.get();</span></span><br><span class="line">        &#125;,       </span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">get</span>:<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> id = getUrlParms(<span class="string">"id"</span>);</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> url = <span class="string">"heroes/"</span>+id;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(url);</span></span><br><span class="line"><span class="actionscript">                axios.get(url).then(<span class="function"><span class="keyword">function</span><span class="params">(response)</span> </span>&#123;</span></span><br><span class="line">                    vue.hero4Update = response.data;</span><br><span class="line">                &#125;)    </span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            update:<span class="function"><span class="keyword">function</span> <span class="params">(event)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> url = <span class="string">"heroes/"</span>+vue.hero4Update.id;</span></span><br><span class="line"><span class="actionscript">                axios.put(url,vue.hero4Update).then(<span class="function"><span class="keyword">function</span><span class="params">(response)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                    location.href=<span class="string">"listHero"</span>;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            cancel:<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">                location.href=<span class="string">"listHero"</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width:500px;border:1px solid lightgray;margin:200px auto;padding:80px"</span>&gt;</span></span><br><span class="line">        系统 出现了异常，异常原因是：</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">"$&#123;exception&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        出现异常的地址是：</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">"$&#123;url&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="步骤-20-启动测试"><a class="header-anchor" href="#步骤-20-启动测试">¶</a>步骤 20 : 启动测试</h4>
<p>运行下面类的主方法启动项目</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.how2java.springboot.Application</span><br></pre></td></tr></table></figure>
<p>然后访问测试地址：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http://127.0.0.1:8080/listHero</span></span><br></pre></td></tr></table></figure>
<p>这就是前后端分离的 CRUD 了。<br>
没有套用 bootstrap 美化界面，尽量要足够少的知识来展现本教程的核心内容，以免被分散精力。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8048.png" alt></p>
<h3 id="10、在-IDEA2017-里-SPRINGBOOT-THYMELEAF-修改-HTML-之后不能立即看到效果的解决办法"><a class="header-anchor" href="#10、在-IDEA2017-里-SPRINGBOOT-THYMELEAF-修改-HTML-之后不能立即看到效果的解决办法">¶</a>10、在 IDEA2017 里 SPRINGBOOT THYMELEAF 修改 HTML 之后不能立即看到效果的解决办法</h3>
<h4 id="步骤-1-idea-热更新"><a class="header-anchor" href="#步骤-1-idea-热更新">¶</a>步骤 1 : idea 热更新</h4>
<p>在 idea2017 里， springboot thymeleaf 修改 html 之后不能立即看到效果，要重新启动 Application 才可以看到效果。 这样做开发效率肯定是大受影响的。<br>
本知识点讲解如何进行相关设置，以达到修改 html 之后，马上就可以看到效果。</p>
<h4 id="步骤-2-pom-xml-v2"><a class="header-anchor" href="#步骤-2-pom-xml-v2">¶</a>步骤 2 : pom.xml</h4>
<p>首先要确保 pom.xml 里有热部署的依赖和插件：<br>
做法很简单，在pom.xml中新增加一个依赖和一个插件就行了。<br>
依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span> <span class="comment">&lt;!-- 这个需要为 true 热部署才有效 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>插件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这一点在前面的 [热部署] 教程里已经有讲解了。</p>
<h4 id="步骤-3-idea-设置"><a class="header-anchor" href="#步骤-3-idea-设置">¶</a>步骤 3 : idea 设置</h4>
<p>然后是 idea 设置。<br>
设置两个内容：</p>
<ol>
<li>项目自动编译</li>
<li>automake 选项开启</li>
</ol>
<h4 id="步骤-4-1-项目自动编译"><a class="header-anchor" href="#步骤-4-1-项目自动编译">¶</a>步骤 4 : 1. 项目自动编译</h4>
<p>菜单 -&gt; Other Settings -&gt; Default Settings -&gt; Builld, Execution, Deployment -&gt; Compiler<br>
勾选其中的 Build project automatically. 这个选项默认是没有被勾选的。</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8699.png" alt></p>
<h4 id="步骤-5-2-automake-选项开启-A"><a class="header-anchor" href="#步骤-5-2-automake-选项开启-A">¶</a>步骤 5 : 2. automake 选项开启-A</h4>
<p>automake 选项开启比较麻烦，因为它的开启界面默认是不能够被打开的，需要通过快捷键才能打开。。。</p>
<p>设置快捷键办法：</p>
<ol>
<li>菜单-&gt;File-&gt;Settings-&gt;左上角的搜索框里输入 Registry</li>
<li>右边搜索结果出现 Registry… 这么一个功能，然后给这个功能增加一个快捷键 Alt+Shift+M。 用这个快捷键是因为它默认情况下是没有冲突的。</li>
<li>点击 OK<br>
继续下一步</li>
</ol>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8700.png" alt></p>
<h4 id="步骤-6-2-automake-选项开启-B"><a class="header-anchor" href="#步骤-6-2-automake-选项开启-B">¶</a>步骤 6 : 2. automake 选项开启-B</h4>
<p>然后通过 Alt+Shift +M 快捷键打开 Registry 窗口，找到 如图所示的 comipler.automake.allow.when.app.running 勾上。<br>
然后点 Close.<br>
接着重启 idea, 这样修改 html 就可以马上看到效果了</p>
<p><img src="/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/../../Blog-Hexo/source/_posts/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/8701.png" alt></p>

      
    </div>
    
    
    

    <div>
     
         <div>
 
  <div style="text-align:center;color:#bfbfbf;font-size:16px;">
   <span>-------- 本文结束 </span>
   <i class="fa fa-paw"></i>
   <span> 感谢阅读 --------</span>
  </div>
 
</div>
     
    </div>

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="潇 卟 甸 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="潇 卟 甸 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <!-- JS库 clipboard 拷贝内容到粘贴板-->
<script src="https://cdn.bootcss.com/clipboard.js/2.0.1/clipboard.min.js"></script>

<!-- JS库 sweetalert 显示提示信息-->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<ul class="post-copyright">
<!-- 本文标题 -->
<li>
  <strong>本文标题： </strong>
  Java框架【HOW2J】
</li>

<!-- 本文作者 -->
<li class="post-copyright-author">
  <strong>本文作者： </strong>
  
</li>

<!-- 创建时间 -->
<li>
  <strong>创建时间： </strong>
  2020年09月08日 - 19时09分
</li>

<!-- 修改时间 -->
<li>
  <strong>修改时间： </strong>
  2020年10月15日 - 18时10分
</li>

<!-- 引用链接 -->
<li class="post-copyright-link">
  <strong>本文链接：</strong>
  <a href="http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/" title="Java框架【HOW2J】"
    >http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/</a
  >
  <span class="copy-path" title="点击复制引用链接"
    ><i
      style="cursor: pointer"
      class="fa fa-clipboard"
      data-clipboard-text="['s Blog | Java框架【HOW2J】](http://yoursite.com/2020/09/08/Java%E6%A1%86%E6%9E%B6%E3%80%90HOW2J%E3%80%91/)"
      aria-label="复制成功"
    ></i
  ></span>
</li>

<!-- 版权声明 -->
<li class="post-copyright-license">
  <strong
    >版权声明：
  </strong>
  本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
</li>
</ul>

<script>
var clipboard = new ClipboardJS(".fa-clipboard");
clipboard.on("success", function(target) {
  var message = document.createElement("div");
  message.innerHTML =
    '<i class="fa fa-check-circle message-icon"></i><span class="message-content">' +
    target.trigger.getAttribute("aria-label") +
    "</span>";
  swal({
    content: message,
    className: "copy-success-message",
    timer: 1000,
    button: false
  });
});
</script>
      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
          
            <a href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag"><i class="fa fa-tag"></i> 编程</a>
          
            <a href="/tags/%E8%BF%9B%E9%98%B6/" rel="tag"><i class="fa fa-tag"></i> 进阶</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/08/21/J2EE%E3%80%90HOW2J%E3%80%91/" rel="next" title="J2EE【HOW2J】">
                <i class="fa fa-chevron-left"></i> J2EE【HOW2J】
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/09/22/%E5%B7%A5%E5%85%B7%E5%92%8C%E4%B8%AD%E9%97%B4%E4%BB%B6%E3%80%90HOW2J%E3%80%91/" rel="prev" title="工具和中间件【HOW2J】">
                工具和中间件【HOW2J】 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <a href="/">
              <img class="site-author-image" itemprop="image"
                src="/uploads/picture.jpg"
                alt="潇 卟 甸" />
              </a>
            
              <p class="site-author-name" itemprop="name">潇 卟 甸</p>
              <p class="site-description motion-element" itemprop="description">总结自己一些知识，一些事</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">67</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

			
				<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
				<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
				<div class="widget-wrap">
					<div id="myCanvasContainer" class="widget tagcloud">
						<canvas width="250" height="250" id="resCanvas" style="width=100%">
							<ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">40</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%AE%9E%E8%B7%B5/" rel="tag">Java实践</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/b%E7%AB%99%E8%A7%86%E9%A2%91/" rel="tag">b站视频</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E7%BA%A7/" rel="tag">中级</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%96%9C%E9%A9%AC%E6%8B%89%E9%9B%85/" rel="tag">喜马拉雅</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80/" rel="tag">基础</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E8%AF%AD/" rel="tag">日语</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E4%BB%A3%E7%A0%81/" rel="tag">源代码</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%B5%E5%AD%90%E4%B9%A6/" rel="tag">电子书</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">编程</a><span class="tag-list-count">54</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BE%8E%E5%8C%96/" rel="tag">美化</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8B%B1%E8%AF%AD/" rel="tag">英语</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" rel="tag">计算机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E6%8E%A8%E8%8D%90/" rel="tag">读书推荐</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E9%98%B6/" rel="tag">进阶</a><span class="tag-list-count">4</span></li></ul>
						</canvas>
					</div>
				</div>
			

          </nav>

          

          
		  
		  <!-- 添加近期文章 -->
			
				<div class="links-of-blogroll motion-element links-of-blogroll-block">
				<div class="links-of-blogroll-title">
				<!-- modify icon to fire by szw -->
				<i class="fa fa-history fa-" aria-hidden="true"></i>
				近期文章
				</div>
				<ul class="links-of-blogroll-list">
				
				
					<li>
					<a href="/2021/07/21/%E5%B0%9A%E7%A1%85%E8%B0%B7-Zookeeper%E6%95%99%E7%A8%8B/" title="尚硅谷-Zookeeper教程" target="_blank">尚硅谷-Zookeeper教程</a>
					</li>
				
					<li>
					<a href="/2021/07/19/%E5%B0%9A%E7%A1%85%E8%B0%B7-Spring%E6%B3%A8%E8%A7%A3%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91/" title="尚硅谷-Spring注解驱动开发" target="_blank">尚硅谷-Spring注解驱动开发</a>
					</li>
				
					<li>
					<a href="/2021/07/18/%E5%B0%9A%E7%A1%85%E8%B0%B7-MyBatisPlus%E6%95%99%E7%A8%8B/" title="尚硅谷-MyBatisPlus教程" target="_blank">尚硅谷-MyBatisPlus教程</a>
					</li>
				
					<li>
					<a href="/2021/07/16/%E5%B0%9A%E7%A1%85%E8%B0%B7-%E7%AC%AC1%E5%AD%A3%E9%9D%A2%E8%AF%95%E9%A2%98%E3%80%90Java%E5%AD%A6%E7%A7%91%E3%80%91/" title="尚硅谷-第1季面试题【Java学科】" target="_blank">尚硅谷-第1季面试题【Java学科】</a>
					</li>
				
					<li>
					<a href="/2021/07/12/%E5%B0%9A%E7%A1%85%E8%B0%B7-Linux%E6%95%99%E7%A8%8B/" title="尚硅谷-Linux教程" target="_blank">尚硅谷-Linux教程</a>
					</li>
				
				</ul>
			</div>
			

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐阅读
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://sushan102.top/posts/1410804403/" title="博客搭建" target="_blank">博客搭建</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://how2j.cn?p=154642" title="HOW2J" target="_blank">HOW2J</a>
                  </li>
                
              </ul>
            </div>
          
		  
		  
			
		  
		  <div style="">
  <canvas id="canvas" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();
</script>


        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#壹、HIBERNATE"><span class="nav-text">壹、HIBERNATE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、基础"><span class="nav-text">一、基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、hello-hibernate"><span class="nav-text">1、hello hibernate</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-学习之前先看效果"><span class="nav-text">步骤 1 : 学习之前先看效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-创建数据库"><span class="nav-text">步骤 2 : 创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建表"><span class="nav-text">步骤 3 : 创建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-创建一个java-project"><span class="nav-text">步骤 4 : 创建一个java project</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-导入hibernate所依赖的jar包"><span class="nav-text">步骤 5 : 导入hibernate所依赖的jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-创建实体类"><span class="nav-text">步骤 6 : 创建实体类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-配置-Product-hbm-xml"><span class="nav-text">步骤 7 : 配置 Product.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-配置-hibernate-cfg-xml"><span class="nav-text">步骤 8 : 配置 hibernate.cfg.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-测试类-TestHibernate"><span class="nav-text">步骤 9 : 测试类 TestHibernate</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-基本原理图"><span class="nav-text">步骤 10 : 基本原理图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-可运行项目"><span class="nav-text">步骤 11 : 可运行项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-关于运行警告信息"><span class="nav-text">步骤 12 : 关于运行警告信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-练习"><span class="nav-text">步骤 13 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、插入数据"><span class="nav-text">2、插入数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-插入数据到数据库"><span class="nav-text">步骤 4 : 插入数据到数据库</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、对象的三种状态-瞬时-持久-脱管"><span class="nav-text">3、对象的三种状态 瞬时 持久 脱管</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v2"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v2"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-代码演示3种状态"><span class="nav-text">步骤 3 : 代码演示3种状态</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、通过ID获取一个对象"><span class="nav-text">4、通过ID获取一个对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v3"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v3"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v2"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-通过ID获取一个对象"><span class="nav-text">步骤 4 : 通过ID获取一个对象</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、删除一条数据"><span class="nav-text">5、删除一条数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v4"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v4"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-删除一条数据"><span class="nav-text">步骤 3 : 删除一条数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、修改-更新-一个对象"><span class="nav-text">6、修改(更新)一个对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v5"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v5"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-先看修改后的效果"><span class="nav-text">步骤 3 : 先看修改后的效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改一个对象的属性，并更新到数据库中"><span class="nav-text">步骤 4 : 修改一个对象的属性，并更新到数据库中</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、使用HQL进行查询"><span class="nav-text">7、使用HQL进行查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v6"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v6"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-先看查询的结果"><span class="nav-text">步骤 3 : 先看查询的结果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-使用HQL-根据name进行模糊查询"><span class="nav-text">步骤 4 : 使用HQL,根据name进行模糊查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、使用CRITERIA进行查询"><span class="nav-text">8、使用CRITERIA进行查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v7"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v7"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-先看用Criteria-查询的效果"><span class="nav-text">步骤 3 : 先看用Criteria 查询的效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-使用Criteria-根据name进行模糊查询"><span class="nav-text">步骤 4 : 使用Criteria,根据name进行模糊查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、使用标准SQL语句进行查询"><span class="nav-text">9、使用标准SQL语句进行查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v8"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v8"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-先看使用标准SQL语句查询的效果"><span class="nav-text">步骤 3 : 先看使用标准SQL语句查询的效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-使用标准SQL-根据name进行模糊查询"><span class="nav-text">步骤 4 : 使用标准SQL,根据name进行模糊查询</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、关系"><span class="nav-text">二、关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、实现多对一"><span class="nav-text">1、实现多对一</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v9"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v9"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v3"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-准备Category-java"><span class="nav-text">步骤 4 : 准备Category.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-准备Category-hbm-xml"><span class="nav-text">步骤 5 : 准备Category.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-为Product-java增加Category属性"><span class="nav-text">步骤 6 : 为Product.java增加Category属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-在Product-hbm-xml中设置Category-多对一关系"><span class="nav-text">步骤 7 : 在Product.hbm.xml中设置Category 多对一关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-在hibernate-cfg-xml中增加Category的映射"><span class="nav-text">步骤 8 : 在hibernate.cfg.xml中增加Category的映射</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-TestHibernate-测试many-to-one关系"><span class="nav-text">步骤 9 : TestHibernate 测试many-to-one关系</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、实现一对多"><span class="nav-text">2、实现一对多</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v10"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v10"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v4"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-为Category增加一个Set集合"><span class="nav-text">步骤 4 : 为Category增加一个Set集合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-为Category-hbm-xml增加one-to-many映射"><span class="nav-text">步骤 5 : 为Category.hbm.xml增加one-to-many映射</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-TestHibernate-测试one-to-many关系"><span class="nav-text">步骤 6 : TestHibernate 测试one-to-many关系</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、实现多对多"><span class="nav-text">3、实现多对多</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v11"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v11"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-User-java"><span class="nav-text">步骤 3 : User.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-User-hbm-xml"><span class="nav-text">步骤 4 : User.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-Product-java"><span class="nav-text">步骤 5 : Product.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-Product-hbm-xml"><span class="nav-text">步骤 6 : Product.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-在hibernate-cfg-xml中增加User的映射"><span class="nav-text">步骤 7 : 在hibernate.cfg.xml中增加User的映射</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-TestHibernate-测试many-to-many关系"><span class="nav-text">步骤 8 : TestHibernate 测试many-to-many关系</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、各类概念"><span class="nav-text">三、各类概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、如何支持事务"><span class="nav-text">1、如何支持事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v12"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v12"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v5"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-TestHibernate-事务"><span class="nav-text">步骤 4 : TestHibernate 事务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-MYSQL-表的类型必须是INNODB才支持事务"><span class="nav-text">步骤 5 : MYSQL 表的类型必须是INNODB才支持事务</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、属性延迟加载-LAZYLOAD"><span class="nav-text">2、属性延迟加载 LAZYLOAD</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v13"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v13"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-演示属性的延迟加载"><span class="nav-text">步骤 3 : 演示属性的延迟加载</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、关系延迟加载"><span class="nav-text">3、关系延迟加载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v14"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v14"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-修改配置文件-Category-hbm-xml"><span class="nav-text">步骤 3 : 修改配置文件 Category.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-lazy-true的代码演示"><span class="nav-text">步骤 4 : lazy&#x3D;true的代码演示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、级联"><span class="nav-text">4、级联</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v15"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v15"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-什么是级联"><span class="nav-text">步骤 3 : 什么是级联</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-4种级联"><span class="nav-text">步骤 4 : 4种级联</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-delete-级联"><span class="nav-text">步骤 5 : delete 级联</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-save-update-级联"><span class="nav-text">步骤 6 : save-update 级联</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-all和none级联"><span class="nav-text">步骤 7 : all和none级联</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、什么是HIBERNATE的一级缓存"><span class="nav-text">5、什么是HIBERNATE的一级缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v16"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v16"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-两次获取id-1的category对象"><span class="nav-text">步骤 3 : 两次获取id&#x3D;1的category对象</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、如何进行HIBERNATE的EHCACHE二级缓存配置"><span class="nav-text">6、如何进行HIBERNATE的EHCACHE二级缓存配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v17"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v17"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-先看没有开启二级缓存的情况"><span class="nav-text">步骤 3 : 先看没有开启二级缓存的情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-hibernate-cfg-xml-中增加对二级缓存的配置"><span class="nav-text">步骤 4 : hibernate.cfg.xml 中增加对二级缓存的配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-ehcache-xml"><span class="nav-text">步骤 5 : ehcache.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-设置HBM"><span class="nav-text">步骤 6 : 设置HBM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试效果"><span class="nav-text">步骤 7 : 测试效果</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、实现分页查询"><span class="nav-text">7、实现分页查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v18"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v18"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-分页，从第3个开始，一共查询5个Product"><span class="nav-text">步骤 3 : 分页，从第3个开始，一共查询5个Product</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、GET和LOAD的区别"><span class="nav-text">8、GET和LOAD的区别</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v19"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v19"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-延迟加载"><span class="nav-text">步骤 3 : 延迟加载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-对于id不存在的对象的处理"><span class="nav-text">步骤 4 : 对于id不存在的对象的处理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、OPENSESSION与GETCURRENTSESSION的区别"><span class="nav-text">9、OPENSESSION与GETCURRENTSESSION的区别</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v20"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v20"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-OpenSession每次都会得到一个新的Session对象"><span class="nav-text">步骤 3 : OpenSession每次都会得到一个新的Session对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-相同线程的getCurrentSession"><span class="nav-text">步骤 4 : 相同线程的getCurrentSession</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-不同线程的getCurrentSession"><span class="nav-text">步骤 5 : 不同线程的getCurrentSession</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-openSession查询时候不需要事务"><span class="nav-text">步骤 6 : openSession查询时候不需要事务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-getCurrentSession所有操作都必须放在事务中"><span class="nav-text">步骤 7 : getCurrentSession所有操作都必须放在事务中</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-getCurrentSession在提交事务后，session自动关闭"><span class="nav-text">步骤 8 : getCurrentSession在提交事务后，session自动关闭</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、N-1-什么意思？-以及LIST和ITERATOR的区别"><span class="nav-text">10、N+1 什么意思？ 以及LIST和ITERATOR的区别</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v21"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v21"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-Hibernate使用Iterator实现N-1"><span class="nav-text">步骤 3 : Hibernate使用Iterator实现N 1</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11、如何查询总数"><span class="nav-text">11、如何查询总数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v22"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v22"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-查询总数"><span class="nav-text">步骤 3 : 查询总数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12、乐观锁原理以及其配置方法"><span class="nav-text">12、乐观锁原理以及其配置方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v23"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v23"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-首先看不使用乐观锁的情况"><span class="nav-text">步骤 3 : 首先看不使用乐观锁的情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改配置文件-Product-hbm-xml"><span class="nav-text">步骤 4 : 修改配置文件 Product.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-修改-Product-java"><span class="nav-text">步骤 5 : 修改 Product.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-重新运行一样的代码"><span class="nav-text">步骤 6 : 重新运行一样的代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-原理"><span class="nav-text">步骤 7 : 原理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13、C3P0数据库连接池配置办法"><span class="nav-text">13、C3P0数据库连接池配置办法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v24"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v24"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-jar包"><span class="nav-text">步骤 3 : jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-进行c3p0连接池的配置"><span class="nav-text">步骤 4 : 进行c3p0连接池的配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-Category-hbm-xml"><span class="nav-text">步骤 5 : Category.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试"><span class="nav-text">步骤 6 : 测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、注解"><span class="nav-text">四、注解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、在HIBERNATE中使用注解示例"><span class="nav-text">1、在HIBERNATE中使用注解示例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v25"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v25"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-删除表"><span class="nav-text">步骤 3 : 删除表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-Product-hbm-xml"><span class="nav-text">步骤 4 : Product.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-注解方式"><span class="nav-text">步骤 5 : 注解方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-hibernate-cfg-xml-配置文件改动"><span class="nav-text">步骤 6 : hibernate.cfg.xml 配置文件改动</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、类与属性"><span class="nav-text">2、类与属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-hibernate-注解分类"><span class="nav-text">步骤 1 : hibernate 注解分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-类注解"><span class="nav-text">步骤 2 : 类注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-属性注解"><span class="nav-text">步骤 3 : 属性注解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、多对一关系映射注解，一对多关系映射注解，多对多关系映射"><span class="nav-text">3、多对一关系映射注解，一对多关系映射注解，多对多关系映射</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v26"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v26"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-多对一注解"><span class="nav-text">步骤 3 : 多对一注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-一对多注解"><span class="nav-text">步骤 4 : 一对多注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-多对多注解"><span class="nav-text">步骤 5 : 多对多注解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、常见注解一览"><span class="nav-text">4、常见注解一览</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-类相关注解"><span class="nav-text">步骤 1 : 类相关注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-属性相关注解"><span class="nav-text">步骤 2 : 属性相关注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-关系相关注解"><span class="nav-text">步骤 3 : 关系相关注解</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、HIBERNATE-应该使用注解还是XML配置文件？"><span class="nav-text">5、HIBERNATE 应该使用注解还是XML配置文件？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、注解运行原理"><span class="nav-text">6、注解运行原理</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#贰、STRUTS"><span class="nav-text">贰、STRUTS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、基础-v2"><span class="nav-text">一、基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、Hello-Struts"><span class="nav-text">1、Hello Struts</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v27"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v27"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-在eclipse中创建Web动态项目struts"><span class="nav-text">步骤 3 : 在eclipse中创建Web动态项目struts</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-导入jar包"><span class="nav-text">步骤 4 : 导入jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-新建web-xml"><span class="nav-text">步骤 5 : 新建web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-配置struts-xml"><span class="nav-text">步骤 6 : 配置struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-创建index-jsp"><span class="nav-text">步骤 7 : 创建index.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-部署在tomcat中，重启测试"><span class="nav-text">步骤 8 : 部署在tomcat中，重启测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-思路图"><span class="nav-text">步骤 9 : 思路图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-可运行项目"><span class="nav-text">步骤 10 : 可运行项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-练习"><span class="nav-text">步骤 11 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、IDEA"><span class="nav-text">2、IDEA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、显示数据到JSP"><span class="nav-text">3、显示数据到JSP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v28"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v28"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-Product-java-用于存放数据"><span class="nav-text">步骤 3 : Product.java 用于存放数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-ProductAction用于控制"><span class="nav-text">步骤 4 : ProductAction用于控制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-在struts-xml中配置跳转"><span class="nav-text">步骤 5 : 在struts.xml中配置跳转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-show-jsp"><span class="nav-text">步骤 6 : show.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试"><span class="nav-text">步骤 7 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-原理图"><span class="nav-text">步骤 8 : 原理图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-练习"><span class="nav-text">步骤 9 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、提交数据到ACTION"><span class="nav-text">4、提交数据到ACTION</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v29"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v29"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v6"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-addProduct-jsp"><span class="nav-text">步骤 4 : addProduct.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-配置struts-xml"><span class="nav-text">步骤 5 : 配置struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-ProductAction增加add方法"><span class="nav-text">步骤 6 : ProductAction增加add方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v2"><span class="nav-text">步骤 7 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-原理图-v2"><span class="nav-text">步骤 8 : 原理图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-练习-v2"><span class="nav-text">步骤 9 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、中文问题"><span class="nav-text">5、中文问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v30"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v30"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v7"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-提交数据的-addProduct-jsp"><span class="nav-text">步骤 4 : 提交数据的 addProduct.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-struts-xml"><span class="nav-text">步骤 5 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-显示数据的-show-jsp"><span class="nav-text">步骤 6 : 显示数据的 show.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v3"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、启动失败，出现错误ERROR-FILTERSTART-应该如何调试"><span class="nav-text">6、启动失败，出现错误ERROR FILTERSTART 应该如何调试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v31"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v31"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-故意制造一个struts的配置错误"><span class="nav-text">步骤 3 : 故意制造一个struts的配置错误</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-在src目录下增加log4j-xml"><span class="nav-text">步骤 4 : 在src目录下增加log4j.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-关闭log4j-xml日志输出"><span class="nav-text">步骤 5 : 关闭log4j.xml日志输出</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、获取-REQUEST对象和-RESPONSE对象"><span class="nav-text">7、获取 REQUEST对象和 RESPONSE对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v32"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v32"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-获取request和response对象"><span class="nav-text">步骤 3 : 获取request和response对象</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、获取SESSION对象"><span class="nav-text">8、获取SESSION对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v33"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v33"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v8"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-在ProductAction的add方法中访问Session"><span class="nav-text">步骤 4 : 在ProductAction的add方法中访问Session</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-在show-jsp中把通过EL表达式把session中的数据取出来"><span class="nav-text">步骤 5 : 在show.jsp中把通过EL表达式把session中的数据取出来</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v2"><span class="nav-text">步骤 6 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、如何上传文件"><span class="nav-text">9、如何上传文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v34"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v34"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v9"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-首先准备-upload-jsp"><span class="nav-text">步骤 4 : 首先准备 upload.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-UploadAction"><span class="nav-text">步骤 5 : UploadAction</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-struts-xml"><span class="nav-text">步骤 6 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-success-jsp"><span class="nav-text">步骤 7 : success.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、上传文件最大值"><span class="nav-text">10、上传文件最大值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-struts-xml"><span class="nav-text">步骤 1 : struts.xml</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、标签"><span class="nav-text">二、标签</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、FORM-标签"><span class="nav-text">1、FORM 标签</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v35"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v35"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-修改addProduct-jsp"><span class="nav-text">步骤 3 : 修改addProduct.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-访问http-127-0-0-1-addProduct-jsp"><span class="nav-text">步骤 4 : 访问http:&#x2F;&#x2F;127.0.0.1&#x2F;addProduct.jsp</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、使用S-ITERATOR-标签遍历集合"><span class="nav-text">2、使用S:ITERATOR 标签遍历集合</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v36"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v36"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v10"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-为ProductAction增加list方法"><span class="nav-text">步骤 4 : 为ProductAction增加list方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-struts-xml-v2"><span class="nav-text">步骤 5 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-list-jsp"><span class="nav-text">步骤 6 : list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v4"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、如何使用CHECKBOXLIST-标签"><span class="nav-text">3、如何使用CHECKBOXLIST 标签</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v37"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v37"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v11"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-ProductAction-java"><span class="nav-text">步骤 4 : ProductAction.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-list-jsp"><span class="nav-text">步骤 5 : list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v3"><span class="nav-text">步骤 6 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、如何使用-S-RADIO-标签"><span class="nav-text">4、如何使用&lt;S:RADIO&gt;标签</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v38"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v38"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v12"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改-list-jsp"><span class="nav-text">步骤 4 : 修改 list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试"><span class="nav-text">步骤 5 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、如何使用S-SELECT-标签"><span class="nav-text">5、如何使用S:SELECT 标签</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v39"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v39"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v13"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改-list-jsp-v2"><span class="nav-text">步骤 4 : 修改 list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试-v2"><span class="nav-text">步骤 5 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、使用ITERATOR-迭代遍历集合中的集合"><span class="nav-text">6、使用ITERATOR 迭代遍历集合中的集合</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v40"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v40"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v14"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-创建Category-java"><span class="nav-text">步骤 4 : 创建Category.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-ProductAction-java"><span class="nav-text">步骤 5 : ProductAction.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-list-jsp-v2"><span class="nav-text">步骤 6 : list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v5"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、其他"><span class="nav-text">三、其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、调试1"><span class="nav-text">1、调试1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v41"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v41"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v15"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-jar"><span class="nav-text">步骤 4 : jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-访问页面"><span class="nav-text">步骤 5 : 访问页面</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、使用S-DEBUG进行调试"><span class="nav-text">2、使用S:DEBUG进行调试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v42"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v42"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v16"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-list-jsp"><span class="nav-text">步骤 4 : list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试-v3"><span class="nav-text">步骤 5 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、使用使用通配符匹配"><span class="nav-text">3、使用使用通配符匹配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v43"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v43"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-struts-xml"><span class="nav-text">步骤 3 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-测试"><span class="nav-text">步骤 4 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、如何使用拦截器的例子"><span class="nav-text">4、如何使用拦截器的例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v44"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v44"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v17"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-ProductAction-java-v2"><span class="nav-text">步骤 4 : ProductAction.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-list-jsp-v2"><span class="nav-text">步骤 5 : list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-创建拦截器"><span class="nav-text">步骤 6 : 创建拦截器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-配置struts-xml"><span class="nav-text">步骤 7 : 配置struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试-v2"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、客户端跳转"><span class="nav-text">5、客户端跳转</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v45"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v45"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v18"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-ProductAction-java-v3"><span class="nav-text">步骤 4 : ProductAction.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-struts-xml-v3"><span class="nav-text">步骤 5 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v4"><span class="nav-text">步骤 6 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、如何进行客户端跳转传参"><span class="nav-text">6、如何进行客户端跳转传参</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v46"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v46"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v19"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-ProductAction-java-v4"><span class="nav-text">步骤 4 : ProductAction.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-struts-xml-v4"><span class="nav-text">步骤 5 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-addProduct-jsp"><span class="nav-text">步骤 6 : addProduct.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v6"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、表单验证"><span class="nav-text">7、表单验证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v47"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v47"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v20"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-在ProductAction中增加validate-方法"><span class="nav-text">步骤 4 : 在ProductAction中增加validate()方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-增加一个input-的result"><span class="nav-text">步骤 5 : 增加一个input 的result</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-错误提示信息显示成红色"><span class="nav-text">步骤 6 : 错误提示信息显示成红色</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v7"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、XML-表单验证"><span class="nav-text">8、XML 表单验证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v48"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v48"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v21"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-把ProductAction中的validate-方法去掉"><span class="nav-text">步骤 4 : 把ProductAction中的validate()方法去掉</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-新建文件ProductAction-validation-xml"><span class="nav-text">步骤 5 : 新建文件ProductAction-validation.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v5"><span class="nav-text">步骤 6 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、ACTION是多实例的"><span class="nav-text">9、ACTION是多实例的</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v49"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v49"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v22"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改ProductAction"><span class="nav-text">步骤 4 : 修改ProductAction</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试-v4"><span class="nav-text">步骤 5 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、使用注解方式进行配置实例"><span class="nav-text">10、使用注解方式进行配置实例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v50"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v50"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的教程"><span class="nav-text">步骤 3 : 基于前面的教程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-jar-v2"><span class="nav-text">步骤 4 : jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-注释掉struts-xml"><span class="nav-text">步骤 5 : 注释掉struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-添加注解"><span class="nav-text">步骤 6 : 添加注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-运行测试"><span class="nav-text">步骤 7 : 运行测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-其他常用注解"><span class="nav-text">步骤 8 : 其他常用注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-总结"><span class="nav-text">步骤 9 : 总结</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#叁、SPRING"><span class="nav-text">叁、SPRING</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、IOC-DI"><span class="nav-text">1、IOC&#x2F;DI</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v51"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v51"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-本知识点目的"><span class="nav-text">步骤 3 : 本知识点目的</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-新建项目"><span class="nav-text">步骤 4 : 新建项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-下载包"><span class="nav-text">步骤 5 : 下载包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-导入包"><span class="nav-text">步骤 6 : 导入包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-pojo"><span class="nav-text">步骤 7 : pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-applicationContext-xml"><span class="nav-text">步骤 8 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-TestSpring"><span class="nav-text">步骤 9 : TestSpring</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-原理图"><span class="nav-text">步骤 10 : 原理图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-练习-v2"><span class="nav-text">步骤 11 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、注入对象"><span class="nav-text">2、注入对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v52"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v52"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-Product-java"><span class="nav-text">步骤 3 : Product.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-applicationContext-xml"><span class="nav-text">步骤 4 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-TestSpring"><span class="nav-text">步骤 5 : TestSpring</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、注解方式-IOC-DI"><span class="nav-text">3、注解方式 IOC&#x2F;DI</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v53"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v53"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-修改applicationContext-xml"><span class="nav-text">步骤 3 : 修改applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-Autowired"><span class="nav-text">步骤 4 : @Autowired</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-运行测试"><span class="nav-text">步骤 5 : 运行测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-Autowired的位置"><span class="nav-text">步骤 6 : @Autowired的位置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-Resource"><span class="nav-text">步骤 7 : @Resource</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-对Bean的注解"><span class="nav-text">步骤 8 : 对Bean的注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-applicationContext-xml"><span class="nav-text">步骤 9 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-Component"><span class="nav-text">步骤 10 : @Component</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-运行测试"><span class="nav-text">步骤 11 : 运行测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、AOP-面向切面编程"><span class="nav-text">4、AOP 面向切面编程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v54"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v54"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-jar包-v2"><span class="nav-text">步骤 3 : jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-思路图"><span class="nav-text">步骤 4 : 思路图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-准备业务类-ProductService"><span class="nav-text">步骤 5 : 准备业务类 ProductService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-TestSpring"><span class="nav-text">步骤 6 : TestSpring</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-准备日志切面-LoggerAspect"><span class="nav-text">步骤 7 : 准备日志切面 LoggerAspect</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-applicationContext-xml-v2"><span class="nav-text">步骤 8 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-TestSpring-v2"><span class="nav-text">步骤 9 : TestSpring</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-练习-性能统计切面"><span class="nav-text">步骤 10 : 练习-性能统计切面</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、注解方式-AOP"><span class="nav-text">5、注解方式 AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v55"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v55"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-注解配置业务类"><span class="nav-text">步骤 3 : 注解配置业务类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-注解配置切面"><span class="nav-text">步骤 4 : 注解配置切面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-applicationContext-xml"><span class="nav-text">步骤 5 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-运行测试"><span class="nav-text">步骤 6 : 运行测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、注解方式测试"><span class="nav-text">6、注解方式测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v56"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v56"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v23"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-jar-v3"><span class="nav-text">步骤 4 : jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-导入到当前项目中"><span class="nav-text">步骤 5 : 导入到当前项目中</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-TestSpring-v2"><span class="nav-text">步骤 6 : TestSpring</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、SPRING-MVC"><span class="nav-text">7、SPRING MVC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、SPRINGBOOT"><span class="nav-text">8、SPRINGBOOT</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#肆、STRUTS-HIBERNATE"><span class="nav-text">肆、STRUTS+HIBERNATE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程-v2"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、简介"><span class="nav-text">1、简介</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-思路图"><span class="nav-text">步骤 1 : 思路图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、HIBERANTE-部分"><span class="nav-text">2、HIBERANTE 部分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-Hibernate准备工作"><span class="nav-text">步骤 1 : Hibernate准备工作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-创建数据库how2java"><span class="nav-text">步骤 2 : 创建数据库how2java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-pojo"><span class="nav-text">步骤 3 : pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-Product-hbm-xml-v2"><span class="nav-text">步骤 4 : Product.hbm.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-hibernate-cfg-xml"><span class="nav-text">步骤 5 : hibernate.cfg.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-dao"><span class="nav-text">步骤 6 : dao</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、STRUTS-部分"><span class="nav-text">3、STRUTS 部分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v57"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v57"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-配置web-xml"><span class="nav-text">步骤 3 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-struts-xml"><span class="nav-text">步骤 4 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-Action"><span class="nav-text">步骤 5 : Action</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-list-jsp-v3"><span class="nav-text">步骤 6 : list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-edit-jsp"><span class="nav-text">步骤 7 : edit.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-index-jsp"><span class="nav-text">步骤 8 : index.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-测试"><span class="nav-text">步骤 9 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、完整项目下载"><span class="nav-text">4、完整项目下载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v58"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v58"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-查询和增加界面"><span class="nav-text">步骤 3 : 查询和增加界面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-编辑页面"><span class="nav-text">步骤 4 : 编辑页面</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、完整项目下载2"><span class="nav-text">5、完整项目下载2</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v59"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v59"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-分类的管理"><span class="nav-text">步骤 3 : 分类的管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-产品的管理"><span class="nav-text">步骤 4 : 产品的管理</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#伍、SPRING-HIBERNATE"><span class="nav-text">伍、SPRING+HIBERNATE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程-v3"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、整合步骤"><span class="nav-text">1、整合步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-pojo"><span class="nav-text">步骤 1 : pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-hbm"><span class="nav-text">步骤 2 : hbm</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-DAO"><span class="nav-text">步骤 3 : DAO</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-applicationContext-xml-v2"><span class="nav-text">步骤 4 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试查询"><span class="nav-text">步骤 5 : 测试查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试增-删-改"><span class="nav-text">步骤 6 : 测试增 删 改</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、分页"><span class="nav-text">2、分页</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-使用DetachedCriteria进行分页查询"><span class="nav-text">步骤 1 : 使用DetachedCriteria进行分页查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、查询总数"><span class="nav-text">3、查询总数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-查询总数"><span class="nav-text">步骤 1 : 查询总数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、条件查询"><span class="nav-text">4、条件查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-模糊查询"><span class="nav-text">步骤 1 : 模糊查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、使用C3P0连接池"><span class="nav-text">5、使用C3P0连接池</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-applicationContext-xml"><span class="nav-text">步骤 1 : applicationContext.xml</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、连接ORACLE"><span class="nav-text">6、连接ORACLE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-hbm"><span class="nav-text">步骤 1 : hbm</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-applicationContext-xml"><span class="nav-text">步骤 2 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-sql-语句"><span class="nav-text">步骤 3 : sql 语句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-TestSpring"><span class="nav-text">步骤 4 : TestSpring</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#陆、SPRING-STRUTS"><span class="nav-text">陆、SPRING+STRUTS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程-v4"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、整合步骤-v2"><span class="nav-text">1、整合步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v60"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v60"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-struts-xml-v2"><span class="nav-text">步骤 3 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-applicationContext-xml-v3"><span class="nav-text">步骤 4 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-配置web-xml"><span class="nav-text">步骤 5 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-struts2-spring-plugin-2-2-3-1-jar"><span class="nav-text">步骤 6 : struts2-spring-plugin-2.2.3.1.jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v8"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#柒、SSH"><span class="nav-text">柒、SSH</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程-v5"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、整合步骤-v3"><span class="nav-text">1、整合步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-创建数据库"><span class="nav-text">步骤 1 : 创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-创建表"><span class="nav-text">步骤 2 : 创建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-准备数据"><span class="nav-text">步骤 3 : 准备数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-先运行，再学习"><span class="nav-text">步骤 4 : 先运行，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-新建项目"><span class="nav-text">步骤 5 : 新建项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-导入jar"><span class="nav-text">步骤 6 : 导入jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-pojo-v2"><span class="nav-text">步骤 7 : pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-hbm"><span class="nav-text">步骤 8 : hbm</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-DAO"><span class="nav-text">步骤 9 : DAO</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-Service"><span class="nav-text">步骤 10 : Service</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-ProductAction"><span class="nav-text">步骤 11 : ProductAction</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-struts-xml"><span class="nav-text">步骤 12 : struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-applicationContext-xml"><span class="nav-text">步骤 13 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-配置web-xml"><span class="nav-text">步骤 14 : 配置web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-15-list-jsp"><span class="nav-text">步骤 15 : list.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-16-访问http-127-0-0-1-listProduct"><span class="nav-text">步骤 16 : 访问http:&#x2F;&#x2F;127.0.0.1&#x2F;listProduct</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-17-可运行项目"><span class="nav-text">步骤 17 : 可运行项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-18-思路图"><span class="nav-text">步骤 18 : 思路图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-19-练习"><span class="nav-text">步骤 19 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、IDEA-v2"><span class="nav-text">2、IDEA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、单例"><span class="nav-text">3、单例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v61"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v61"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-单例的Action"><span class="nav-text">步骤 3 : 单例的Action</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-非单例模式"><span class="nav-text">步骤 4 : 非单例模式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、自动生成表结构"><span class="nav-text">4、自动生成表结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-自动生成表结构"><span class="nav-text">步骤 1 : 自动生成表结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-自动生成表结构-失效的处理"><span class="nav-text">步骤 2 : 自动生成表结构 失效的处理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、使用XML方式配置事务管理"><span class="nav-text">5、使用XML方式配置事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-删除Product表所有数据"><span class="nav-text">步骤 1 : 删除Product表所有数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再测试"><span class="nav-text">步骤 2 : 先运行，看到效果，再测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-事务概念"><span class="nav-text">步骤 3 : 事务概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-故意制造异常，观察无事务管理的结果"><span class="nav-text">步骤 4 : 故意制造异常，观察无事务管理的结果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-配置事务管理"><span class="nav-text">步骤 5 : 配置事务管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-观察有事务管理的结果"><span class="nav-text">步骤 6 : 观察有事务管理的结果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-Spring事务类型详解"><span class="nav-text">步骤 7 : Spring事务类型详解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-MYSQL-表的类型必须是INNODB才支持事务"><span class="nav-text">步骤 8 : MYSQL 表的类型必须是INNODB才支持事务</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、使用注解方式配置事务管理"><span class="nav-text">6、使用注解方式配置事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-修改applicationContext-xml"><span class="nav-text">步骤 1 : 修改applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-为ProductServiceImpl-添加注解"><span class="nav-text">步骤 2 : 为ProductServiceImpl 添加注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-测试"><span class="nav-text">步骤 3 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-MYSQL-表的类型必须是INNODB才支持事务"><span class="nav-text">步骤 4 : MYSQL 表的类型必须是INNODB才支持事务</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、整合-注解方式"><span class="nav-text">7、整合-注解方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v62"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v62"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的教程-v2"><span class="nav-text">步骤 3 : 基于前面的教程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-jar-v4"><span class="nav-text">步骤 4 : jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-修改applicationContext-xml"><span class="nav-text">步骤 5 : 修改applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-修改struts-xml"><span class="nav-text">步骤 6 : 修改struts.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-为ProductAction添加注解"><span class="nav-text">步骤 7 : 为ProductAction添加注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-为ProductServiceImpl-添加注解"><span class="nav-text">步骤 8 : 为ProductServiceImpl 添加注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-为ProductDAOImpl-添加注解"><span class="nav-text">步骤 9 : 为ProductDAOImpl 添加注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-为Product添加注解"><span class="nav-text">步骤 10 : 为Product添加注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-重启测试"><span class="nav-text">步骤 11 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、整合-增删改查-CRUD一套"><span class="nav-text">8、整合-增删改查 CRUD一套</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-下载右上角的可运行项目"><span class="nav-text">步骤 1 : 下载右上角的可运行项目</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#捌、SPRING-MVC"><span class="nav-text">捌、SPRING MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程-v6"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、Hello-Spring-MVC"><span class="nav-text">1、Hello Spring MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v63"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v63"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建项目springmvc"><span class="nav-text">步骤 3 : 创建项目springmvc</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-导入jar包-v2"><span class="nav-text">步骤 4 : 导入jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-web-xml"><span class="nav-text">步骤 5 : web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-创建springmvc-servlet-xml"><span class="nav-text">步骤 6 : 创建springmvc-servlet.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-控制类-IndexController"><span class="nav-text">步骤 7 : 控制类 IndexController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-准备index-jsp"><span class="nav-text">步骤 8 : 准备index.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-部署在tomcat中，重启测试"><span class="nav-text">步骤 9 : 部署在tomcat中，重启测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-原理图-v2"><span class="nav-text">步骤 10 : 原理图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-完整的项目下载"><span class="nav-text">步骤 11 : 完整的项目下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-练习"><span class="nav-text">步骤 12 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、视图定位"><span class="nav-text">2、视图定位</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v64"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v64"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v24"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改springmvc-servlet-xml"><span class="nav-text">步骤 4 : 修改springmvc-servlet.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-修改IndexController"><span class="nav-text">步骤 5 : 修改IndexController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-移动index-jsp"><span class="nav-text">步骤 6 : 移动index.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v9"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、注解方式进行配置页面跳转"><span class="nav-text">3、注解方式进行配置页面跳转</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v65"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v65"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v25"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改IndexController"><span class="nav-text">步骤 4 : 修改IndexController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-修改springmvc-servlet-xml"><span class="nav-text">步骤 5 : 修改springmvc-servlet.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v6"><span class="nav-text">步骤 6 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-练习"><span class="nav-text">步骤 7 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、接受表单数据"><span class="nav-text">4、接受表单数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v66"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v66"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v26"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-pojo"><span class="nav-text">步骤 4 : pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-addProduct-jsp"><span class="nav-text">步骤 5 : addProduct.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-ProductController"><span class="nav-text">步骤 6 : ProductController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-showProduct-jsp"><span class="nav-text">步骤 7 : showProduct.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试-v3"><span class="nav-text">步骤 8 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-练习-v3"><span class="nav-text">步骤 9 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、客户端跳转-v2"><span class="nav-text">5、客户端跳转</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v67"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v67"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v27"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改IndexController-v2"><span class="nav-text">步骤 4 : 修改IndexController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试-v5"><span class="nav-text">步骤 5 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6"><span class="nav-text">步骤 6 :</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、如何使用SESSION"><span class="nav-text">6、如何使用SESSION</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v68"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v68"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v28"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改IndexController-v3"><span class="nav-text">步骤 4 : 修改IndexController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-check-jsp"><span class="nav-text">步骤 5 : check.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v7"><span class="nav-text">步骤 6 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-练习-v2"><span class="nav-text">步骤 7 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、中文问题"><span class="nav-text">7、中文问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v69"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v69"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v29"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-Filter"><span class="nav-text">步骤 4 : Filter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-addProduct-jsp-v2"><span class="nav-text">步骤 5 : addProduct.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v8"><span class="nav-text">步骤 6 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、上传文件"><span class="nav-text">8、上传文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v70"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v70"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-效果-v30"><span class="nav-text">步骤 3 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-配置web-xml允许访问-jpg"><span class="nav-text">步骤 4 : 配置web.xml允许访问*.jpg</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-配置springmvc-servlet-xml"><span class="nav-text">步骤 5 : 配置springmvc-servlet.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-upload-jsp-上传页面"><span class="nav-text">步骤 6 : upload.jsp 上传页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-准备UploadedImageFile"><span class="nav-text">步骤 7 : 准备UploadedImageFile</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-UploadController-上传控制器"><span class="nav-text">步骤 8 : UploadController 上传控制器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-showUploadedFile-jsp-显示图片的页面"><span class="nav-text">步骤 9 : showUploadedFile.jsp 显示图片的页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-测试"><span class="nav-text">步骤 10 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-练习-v3"><span class="nav-text">步骤 11 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、拦截器"><span class="nav-text">9、拦截器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v71"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v71"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的知识点"><span class="nav-text">步骤 3 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-效果"><span class="nav-text">步骤 4 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-拦截器类：IndexInterceptor"><span class="nav-text">步骤 5 : 拦截器类：IndexInterceptor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-配置拦截器"><span class="nav-text">步骤 6 : 配置拦截器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-修改-index-jsp"><span class="nav-text">步骤 7 : 修改 index.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试-v4"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#玖、MYBATIS"><span class="nav-text">玖、MYBATIS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、基础-v3"><span class="nav-text">一、基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、入门教程"><span class="nav-text">1、入门教程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-学习之前先看效果-v2"><span class="nav-text">步骤 1 : 学习之前先看效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-创建数据库-v2"><span class="nav-text">步骤 2 : 创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建表-v2"><span class="nav-text">步骤 3 : 创建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-导入数据"><span class="nav-text">步骤 4 : 导入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-先运行，看到效果，再学习"><span class="nav-text">步骤 5 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-模仿和排错"><span class="nav-text">步骤 6 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-创建项目"><span class="nav-text">步骤 7 : 创建项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-导入jar包"><span class="nav-text">步骤 8 : 导入jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-创建实体类"><span class="nav-text">步骤 9 : 创建实体类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-配置文件mybatis-config-xml"><span class="nav-text">步骤 10 : 配置文件mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-配置文件Category-xml"><span class="nav-text">步骤 11 : 配置文件Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-测试类TestMybatis"><span class="nav-text">步骤 12 : 测试类TestMybatis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-基本原理图"><span class="nav-text">步骤 13 : 基本原理图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-可运行的项目"><span class="nav-text">步骤 14 : 可运行的项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-15-练习"><span class="nav-text">步骤 15 : 练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、CRUD"><span class="nav-text">2、CRUD</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v72"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v72"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-在前一步的基础上进行"><span class="nav-text">步骤 3 : 在前一步的基础上进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-配置文件Category-xml"><span class="nav-text">步骤 4 : 配置文件Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-增加"><span class="nav-text">步骤 5 : 增加</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-删除"><span class="nav-text">步骤 6 : 删除</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-获取"><span class="nav-text">步骤 7 : 获取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-修改"><span class="nav-text">步骤 8 : 修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-查询所有"><span class="nav-text">步骤 9 : 查询所有</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、多条件查询和模糊查询实例"><span class="nav-text">3、多条件查询和模糊查询实例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v73"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v73"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-在前一步的基础上进行-v2"><span class="nav-text">步骤 3 : 在前一步的基础上进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-模糊查询"><span class="nav-text">步骤 4 : 模糊查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-多条件查询"><span class="nav-text">步骤 5 : 多条件查询</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、一对多"><span class="nav-text">4、一对多</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-分类和产品的一对多关系"><span class="nav-text">步骤 1 : 分类和产品的一对多关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-表结构"><span class="nav-text">步骤 2 : 表结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-准备数据-v2"><span class="nav-text">步骤 3 : 准备数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-先运行，看到效果，再学习"><span class="nav-text">步骤 4 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-模仿和排错"><span class="nav-text">步骤 5 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-效果"><span class="nav-text">步骤 6 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-Product实体类"><span class="nav-text">步骤 7 : Product实体类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-修改Category实体类"><span class="nav-text">步骤 8 : 修改Category实体类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-暂时无需-Product-xml"><span class="nav-text">步骤 9 : 暂时无需 Product.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-修改Category-xml"><span class="nav-text">步骤 10 : 修改Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-测试运行TestMybatis"><span class="nav-text">步骤 11 : 测试运行TestMybatis</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、多对一"><span class="nav-text">5、多对一</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v74"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v74"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-多对一关系"><span class="nav-text">步骤 3 : 多对一关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-学习之前先看效果"><span class="nav-text">步骤 4 : 学习之前先看效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-修改Product-java"><span class="nav-text">步骤 5 : 修改Product.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-Product-xml"><span class="nav-text">步骤 6 : Product.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-mybatis-config-xml"><span class="nav-text">步骤 7 : mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-TestMybatis"><span class="nav-text">步骤 8 : TestMybatis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-可运行的项目"><span class="nav-text">步骤 9 : 可运行的项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-练习-修改多对一关系"><span class="nav-text">步骤 10 : 练习-修改多对一关系</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、多对多"><span class="nav-text">6、多对多</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-定义多对多关系"><span class="nav-text">步骤 1 : 定义多对多关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-表结构-v2"><span class="nav-text">步骤 2 : 表结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-导入数据"><span class="nav-text">步骤 3 : 导入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-先运行，看到效果，再学习-v2"><span class="nav-text">步骤 4 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-模仿和排错-v2"><span class="nav-text">步骤 5 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-实体类"><span class="nav-text">步骤 6 : 实体类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-映射文件"><span class="nav-text">步骤 7 : 映射文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-修改mybatis-config-xml"><span class="nav-text">步骤 8 : 修改mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-查询操作"><span class="nav-text">步骤 9 : 查询操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-建立关系"><span class="nav-text">步骤 10 : 建立关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-删除关系"><span class="nav-text">步骤 11 : 删除关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-修改关系"><span class="nav-text">步骤 12 : 修改关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-可运行的项目"><span class="nav-text">步骤 13 : 可运行的项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-练习-删除订单时，删除对应的订单项"><span class="nav-text">步骤 14 : 练习-删除订单时，删除对应的订单项</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、动态SQL"><span class="nav-text">二、动态SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、IF-标签例子"><span class="nav-text">1、IF 标签例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v75"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v75"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的教程上进行"><span class="nav-text">步骤 3 : 基于前面的教程上进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-执行不同的条件限定，需要准备两条sql语句"><span class="nav-text">步骤 4 : 执行不同的条件限定，需要准备两条sql语句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-if标签"><span class="nav-text">步骤 5 : if标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-可运行项目下载"><span class="nav-text">步骤 6 : 可运行项目下载</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、WHERE-SET-TRIM-标签例子"><span class="nav-text">2、WHERE SET TRIM 标签例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v76"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v76"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于上一个知识点进行"><span class="nav-text">步骤 3 : 基于上一个知识点进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-多条件的矛盾"><span class="nav-text">步骤 4 : 多条件的矛盾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-where标签"><span class="nav-text">步骤 5 : where标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-set标签"><span class="nav-text">步骤 6 : set标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-trim标签"><span class="nav-text">步骤 7 : trim标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-可运行项目下载"><span class="nav-text">步骤 8 : 可运行项目下载</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、CHOOSE-WHEN-OTHERWISE-标签例子"><span class="nav-text">3、CHOOSE WHEN OTHERWISE 标签例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v77"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v77"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-if-else"><span class="nav-text">步骤 3 : if else</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、FOREACH-标签例子"><span class="nav-text">4、FOREACH 标签例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v78"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v78"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-foreach标签"><span class="nav-text">步骤 3 : foreach标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5、BIND-标签例子"><span class="nav-text">5、BIND 标签例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v79"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v79"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-bind标签"><span class="nav-text">步骤 3 : bind标签</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、注解"><span class="nav-text">三、注解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、通过注解方式实现增删改查-CRUD"><span class="nav-text">1、通过注解方式实现增删改查 CRUD</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v80"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v80"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-把XML方式的CRUD修改为注解方式"><span class="nav-text">步骤 3 : 把XML方式的CRUD修改为注解方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-Mapper接口"><span class="nav-text">步骤 4 : Mapper接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-mybatis-config-xml"><span class="nav-text">步骤 5 : mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试类"><span class="nav-text">步骤 6 : 测试类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、使用注解实现一对多"><span class="nav-text">2、使用注解实现一对多</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v81"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v81"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于XML方式的一对多进行"><span class="nav-text">步骤 3 : 基于XML方式的一对多进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-效果-v2"><span class="nav-text">步骤 4 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-CategoryMapper"><span class="nav-text">步骤 5 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-ProductMapper"><span class="nav-text">步骤 6 : ProductMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-mybatis-config-xml-v2"><span class="nav-text">步骤 7 : mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试-v5"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、多对一"><span class="nav-text">3、多对一</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v82"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v82"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于XML方式的多对一进行"><span class="nav-text">步骤 3 : 基于XML方式的多对一进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-多对一效果"><span class="nav-text">步骤 4 : 多对一效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-CategoryMapper-v2"><span class="nav-text">步骤 5 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-ProductMapper-v2"><span class="nav-text">步骤 6 : ProductMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-mybatis-config-xml-v3"><span class="nav-text">步骤 7 : mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试类"><span class="nav-text">步骤 8 : 测试类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、注解方式的多对多查询"><span class="nav-text">4、注解方式的多对多查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v83"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v83"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于XML方式的多对多进行"><span class="nav-text">步骤 3 : 基于XML方式的多对多进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-效果-v3"><span class="nav-text">步骤 4 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-ProductMapper"><span class="nav-text">步骤 5 : ProductMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-OrderItemMapper"><span class="nav-text">步骤 6 : OrderItemMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-OrderMapper"><span class="nav-text">步骤 7 : OrderMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-修改mybatis-config-xml-v2"><span class="nav-text">步骤 8 : 修改mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-查询测试"><span class="nav-text">步骤 9 : 查询测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、注解方式的动态SQL语句"><span class="nav-text">5、注解方式的动态SQL语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v84"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v84"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于手写SQL语句的注解CRUD"><span class="nav-text">步骤 3 : 基于手写SQL语句的注解CRUD</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-CategoryDynaSqlProvider"><span class="nav-text">步骤 4 : CategoryDynaSqlProvider</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-修改CategoryMapper"><span class="nav-text">步骤 5 : 修改CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-查询测试"><span class="nav-text">步骤 6 : 查询测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-关于SQL类"><span class="nav-text">步骤 7 : 关于SQL类</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、相关概念"><span class="nav-text">四、相关概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、开启LOG4J显示执行的SQL语句"><span class="nav-text">1、开启LOG4J显示执行的SQL语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v85"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v85"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-开启日志"><span class="nav-text">步骤 3 : 开启日志</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-jar-v5"><span class="nav-text">步骤 4 : jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-导入到项目"><span class="nav-text">步骤 5 : 导入到项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-log4j-properties"><span class="nav-text">步骤 6 : log4j.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-运行测试-v2"><span class="nav-text">步骤 7 : 运行测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、事务管理"><span class="nav-text">2、事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v86"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v86"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-JDBC方式"><span class="nav-text">步骤 3 : JDBC方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-测试代码"><span class="nav-text">步骤 4 : 测试代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-MYSQL-表的类型必须是INNODB"><span class="nav-text">步骤 5 : MYSQL 表的类型必须是INNODB</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、延迟加载"><span class="nav-text">3、延迟加载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v87"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v87"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于注解方式的一对多"><span class="nav-text">步骤 3 : 基于注解方式的一对多</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-加上日志"><span class="nav-text">步骤 4 : 加上日志</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-只查询分类，不获取产品"><span class="nav-text">步骤 5 : 只查询分类，不获取产品</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-加上延迟加载的配置"><span class="nav-text">步骤 6 : 加上延迟加载的配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-只查询分类，不获取产品"><span class="nav-text">步骤 7 : 只查询分类，不获取产品</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-只有在查询产品的时候，才会看到SQL语句"><span class="nav-text">步骤 8 : 只有在查询产品的时候，才会看到SQL语句</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、分页"><span class="nav-text">4、分页</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v88"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v88"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-增加100条catgory数据"><span class="nav-text">步骤 3 : 增加100条catgory数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改Category-xml"><span class="nav-text">步骤 4 : 修改Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试-v6"><span class="nav-text">步骤 5 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-注解方式"><span class="nav-text">步骤 6 : 注解方式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、PageHelper"><span class="nav-text">5、PageHelper</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-PageHelper介绍"><span class="nav-text">步骤 1 : PageHelper介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-jar包"><span class="nav-text">步骤 4 : jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-数据设置为100条"><span class="nav-text">步骤 5 : 数据设置为100条</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-配置插件"><span class="nav-text">步骤 6 : 配置插件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-Category-xml"><span class="nav-text">步骤 7 : Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-分页查询"><span class="nav-text">步骤 8 : 分页查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-获取总数"><span class="nav-text">步骤 9 : 获取总数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、一级缓存"><span class="nav-text">6、一级缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v89"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v89"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-在一个Session里查相同id的数据"><span class="nav-text">步骤 3 : 在一个Session里查相同id的数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-在不同Session里查相同id的数据"><span class="nav-text">步骤 4 : 在不同Session里查相同id的数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、二级缓存"><span class="nav-text">7、二级缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v90"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v90"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前一个知识点"><span class="nav-text">步骤 3 : 基于前一个知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-观察无二级缓存"><span class="nav-text">步骤 4 : 观察无二级缓存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-启动二级缓存"><span class="nav-text">步骤 5 : 启动二级缓存</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-在Category-xml中增加-cache"><span class="nav-text">步骤 6 : 在Category.xml中增加 &lt;cache&#x2F;&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-序列化Category"><span class="nav-text">步骤 7 : 序列化Category</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-运行测试"><span class="nav-text">步骤 8 : 运行测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、单纯的MYBATIS整合C3P0数据库连接池"><span class="nav-text">8、单纯的MYBATIS整合C3P0数据库连接池</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v91"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v91"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-下载JAR包"><span class="nav-text">步骤 3 : 下载JAR包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-导入项目"><span class="nav-text">步骤 4 : 导入项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-新建类C3P0DataSourceFactory"><span class="nav-text">步骤 5 : 新建类C3P0DataSourceFactory</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-配置-mybatis-config-xml"><span class="nav-text">步骤 6 : 配置 mybatis-config.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v10"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、查询总数"><span class="nav-text">9、查询总数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v92"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v92"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-新增加方法"><span class="nav-text">步骤 3 : 新增加方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-测试-v2"><span class="nav-text">步骤 4 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、GENERATOR-用法"><span class="nav-text">10、GENERATOR 用法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-简介"><span class="nav-text">步骤 1 : 简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v2"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v2"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-jar"><span class="nav-text">步骤 5 : jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-配置文件"><span class="nav-text">步骤 6 : 配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-TestMybatisGenerator"><span class="nav-text">步骤 7 : TestMybatisGenerator</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-TestMybatis-v2"><span class="nav-text">步骤 8 : TestMybatis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-局限性"><span class="nav-text">步骤 9 : 局限性</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#拾、SPRING-MYBATIS"><span class="nav-text">拾、SPRING+MYBATIS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程-v7"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、整合SPRING与MYBATIS，一步步详解"><span class="nav-text">1、整合SPRING与MYBATIS，一步步详解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于Mybatis的课程"><span class="nav-text">步骤 1 : 基于Mybatis的课程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-pojo"><span class="nav-text">步骤 2 : pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-Mapper"><span class="nav-text">步骤 3 : Mapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-Category-xml"><span class="nav-text">步骤 4 : Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-applicationContext-xml-v2"><span class="nav-text">步骤 5 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试-v9"><span class="nav-text">步骤 6 : 测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-可运行项目"><span class="nav-text">步骤 7 : 可运行项目</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#拾壹、SSM"><span class="nav-text">拾壹、SSM</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、教程-v8"><span class="nav-text">一、教程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、SPRING-SPING-MVC-MYBATIS-三大框架整合详细步骤"><span class="nav-text">1、SPRING+SPING MVC + MYBATIS 三大框架整合详细步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-IDEA"><span class="nav-text">步骤 1 : IDEA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-数据库"><span class="nav-text">步骤 2 : 数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建表-v3"><span class="nav-text">步骤 3 : 创建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-准备数据"><span class="nav-text">步骤 4 : 准备数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-JDK版本"><span class="nav-text">步骤 5 : JDK版本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-先运行，再学习"><span class="nav-text">步骤 6 : 先运行，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-新建项目"><span class="nav-text">步骤 7 : 新建项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-导入jar包-v2"><span class="nav-text">步骤 8 : 导入jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-pojo"><span class="nav-text">步骤 9 : pojo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-CategoryMapper"><span class="nav-text">步骤 10 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-Category-xml"><span class="nav-text">步骤 11 : Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-CategoryService"><span class="nav-text">步骤 12 : CategoryService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-CategoryServiceImpl"><span class="nav-text">步骤 13 : CategoryServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-CategoryController"><span class="nav-text">步骤 14 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-15-web-xml"><span class="nav-text">步骤 15 : web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-16-applicationContext-xml"><span class="nav-text">步骤 16 : applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-17-springMVC-xml"><span class="nav-text">步骤 17 : springMVC.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-18-listCategory-jsp"><span class="nav-text">步骤 18 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-19-部署在tomcat中，重启测试"><span class="nav-text">步骤 19 : 部署在tomcat中，重启测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-20-思路图"><span class="nav-text">步骤 20 : 思路图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-21-删掉，从头开始，这次全部自己做"><span class="nav-text">步骤 21 : 删掉，从头开始，这次全部自己做</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、分页示例"><span class="nav-text">2、分页示例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v93"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v93"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的知识点-v2"><span class="nav-text">步骤 3 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-本知识点效果"><span class="nav-text">步骤 4 : 本知识点效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-分页类：Page"><span class="nav-text">步骤 5 : 分页类：Page</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-Category-xml"><span class="nav-text">步骤 6 : Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-CategoryMapper"><span class="nav-text">步骤 7 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-CategoryService"><span class="nav-text">步骤 8 : CategoryService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-CategoryServiceImpl"><span class="nav-text">步骤 9 : CategoryServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-CategoryController"><span class="nav-text">步骤 10 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-listCategory-jsp"><span class="nav-text">步骤 11 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-增加100个对象，用于测试"><span class="nav-text">步骤 12 : 增加100个对象，用于测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-测试"><span class="nav-text">步骤 13 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、PAGEHELPER"><span class="nav-text">3、PAGEHELPER</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于前面的知识点"><span class="nav-text">步骤 1 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v3"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v3"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-效果-v4"><span class="nav-text">步骤 4 : 效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-jar包"><span class="nav-text">步骤 5 : jar包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-修改applicationContext-xml"><span class="nav-text">步骤 6 : 修改applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-CategoryService"><span class="nav-text">步骤 7 : CategoryService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-CategoryServiceImpl"><span class="nav-text">步骤 8 : CategoryServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-CategoryMapper"><span class="nav-text">步骤 9 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-Category-xml"><span class="nav-text">步骤 10 : Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-CategoryController"><span class="nav-text">步骤 11 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-MybatisTest"><span class="nav-text">步骤 12 : MybatisTest</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-重启tomcat-测试"><span class="nav-text">步骤 13 : 重启tomcat,测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、在SSM中使用C3P0连接池"><span class="nav-text">4、在SSM中使用C3P0连接池</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v94"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v94"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于分页进行"><span class="nav-text">步骤 3 : 基于分页进行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-修改applicationContext-xml"><span class="nav-text">步骤 4 : 修改applicationContext.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-测试-v7"><span class="nav-text">步骤 5 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、做增删改查-CRUD一套"><span class="nav-text">5、做增删改查 CRUD一套</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-测试地址"><span class="nav-text">步骤 1 : 测试地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-练习-基于分类的产品CRUD"><span class="nav-text">步骤 2 : 练习-基于分类的产品CRUD</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、进行注解式和XML配置式事务管理"><span class="nav-text">6、进行注解式和XML配置式事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v95"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v95"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-本知识点效果"><span class="nav-text">步骤 3 : 本知识点效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-MYSQL-表的类型必须是INNODB才支持事务-v2"><span class="nav-text">步骤 4 : MYSQL 表的类型必须是INNODB才支持事务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-导入JAR包"><span class="nav-text">步骤 5 : 导入JAR包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-CategoryService"><span class="nav-text">步骤 6 : CategoryService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-CategoryServiceImpl"><span class="nav-text">步骤 7 : CategoryServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-修改测试类，观察效果"><span class="nav-text">步骤 8 : 修改测试类，观察效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-进行事务配置"><span class="nav-text">步骤 9 : 进行事务配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-使用注解方式"><span class="nav-text">步骤 10 : 使用注解方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-运行测试类，观察效果"><span class="nav-text">步骤 11 : 运行测试类，观察效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-使用XML配置方式"><span class="nav-text">步骤 12 : 使用XML配置方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-运行测试类，观察效果"><span class="nav-text">步骤 13 : 运行测试类，观察效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-为什么不启动Web应用进行测试？"><span class="nav-text">步骤 14 : 为什么不启动Web应用进行测试？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、框架做前后端分离"><span class="nav-text">7、框架做前后端分离</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v96"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v96"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-本知识点效果-v2"><span class="nav-text">步骤 3 : 本知识点效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-jquery-min-js"><span class="nav-text">步骤 4 : jquery.min.js</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-json中文问题"><span class="nav-text">步骤 5 : json中文问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-CategoryController"><span class="nav-text">步骤 6 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-submit-html"><span class="nav-text">步骤 7 : submit.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-getOne-html"><span class="nav-text">步骤 8 : getOne.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-getMany-html"><span class="nav-text">步骤 9 : getMany.html</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、MAVEN-风格"><span class="nav-text">8、MAVEN 风格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、RESTFUL-风格的SSM项目"><span class="nav-text">9、RESTFUL 风格的SSM项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-Restful-风格是什么"><span class="nav-text">步骤 1 : Restful 风格是什么</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v4"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-web-xml"><span class="nav-text">步骤 3 : web.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-listCategory-jsp"><span class="nav-text">步骤 4 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-editCategory-jsp"><span class="nav-text">步骤 5 : editCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-CategoryController-v2"><span class="nav-text">步骤 6 : CategoryController</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#拾贰、SPRINGBOOT"><span class="nav-text">拾贰、SPRINGBOOT</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、基础-v4"><span class="nav-text">一、基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、SPRINGBOOT入门（在ECLIPSE中创建跑得起来的SPRINGBOOT项目，非STS插件方式）"><span class="nav-text">1、SPRINGBOOT入门（在ECLIPSE中创建跑得起来的SPRINGBOOT项目，非STS插件方式）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-关于环境版本"><span class="nav-text">步骤 1 : 关于环境版本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-关于-SpringBoot-版本"><span class="nav-text">步骤 2 : 关于 SpringBoot 版本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-关于IDE"><span class="nav-text">步骤 3 : 关于IDE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-关于STS插件"><span class="nav-text">步骤 4 : 关于STS插件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-先运行，看到效果，再学习-v2"><span class="nav-text">步骤 5 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-模仿和排错-v2"><span class="nav-text">步骤 6 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-关于-Tomcat"><span class="nav-text">步骤 7 : 关于 Tomcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-创建项目"><span class="nav-text">步骤 8 : 创建项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-输入项目参数"><span class="nav-text">步骤 9 : 输入项目参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-pom-xml"><span class="nav-text">步骤 10 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-Application-java"><span class="nav-text">步骤 11 : Application.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-HelloController-java"><span class="nav-text">步骤 12 : HelloController.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-运行并测试"><span class="nav-text">步骤 13 : 运行并测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、在IDEA中创建跑得起来的SPRINGBOOT项目"><span class="nav-text">2、在IDEA中创建跑得起来的SPRINGBOOT项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v97"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v97"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-关于-SpringBoot-版本"><span class="nav-text">步骤 3 : 关于 SpringBoot 版本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-关于-Tomcat"><span class="nav-text">步骤 4 : 关于 Tomcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-关于插件"><span class="nav-text">步骤 5 : 关于插件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-创建项目"><span class="nav-text">步骤 6 : 创建项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-项目参数"><span class="nav-text">步骤 7 : 项目参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-选择Web-模块"><span class="nav-text">步骤 8 : 选择Web 模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-指定项目的路径"><span class="nav-text">步骤 9 : 指定项目的路径</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-SpringbootApplication-java"><span class="nav-text">步骤 10 : SpringbootApplication.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-HelloController-java"><span class="nav-text">步骤 11 : HelloController.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-运行并测试"><span class="nav-text">步骤 12 : 运行并测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、用-JAR的方式运行SPRINGBOOT项目"><span class="nav-text">3、用 JAR的方式运行SPRINGBOOT项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-部署方式"><span class="nav-text">步骤 1 : 部署方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-可运行项目"><span class="nav-text">步骤 2 : 可运行项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-打包成jar"><span class="nav-text">步骤 3 : 打包成jar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-运行该jar"><span class="nav-text">步骤 4 : 运行该jar</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、用WAR的方式部署SPRINGBOOT项目"><span class="nav-text">4、用WAR的方式部署SPRINGBOOT项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-部署方式-v2"><span class="nav-text">步骤 1 : 部署方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-可运行项目-v2"><span class="nav-text">步骤 2 : 可运行项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-Application"><span class="nav-text">步骤 3 : Application</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-pom-xml"><span class="nav-text">步骤 4 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-创建war包"><span class="nav-text">步骤 5 : 创建war包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-重命名-war-包，然后部署"><span class="nav-text">步骤 6 : 重命名 war 包，然后部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-启动并测试"><span class="nav-text">步骤 7 : 启动并测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、如何在SPRINGBOOT中使用JSP"><span class="nav-text">5、如何在SPRINGBOOT中使用JSP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-视图支持"><span class="nav-text">步骤 1 : 视图支持</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v5"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v4"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v2"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-pom-xml"><span class="nav-text">步骤 5 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-application-properties"><span class="nav-text">步骤 6 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-HelloController"><span class="nav-text">步骤 7 : HelloController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-hello-jsp"><span class="nav-text">步骤 8 : hello.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-启动测试"><span class="nav-text">步骤 9 : 启动测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、如何让SPRINGBOOT自动重启"><span class="nav-text">6、如何让SPRINGBOOT自动重启</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-必须重启"><span class="nav-text">步骤 1 : 必须重启</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-pom-xml"><span class="nav-text">步骤 2 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-重启测试"><span class="nav-text">步骤 3 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、SPRINGBOOT-错误异常处理统一办法"><span class="nav-text">7、SPRINGBOOT 错误异常处理统一办法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v98"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v98"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-HelloController"><span class="nav-text">步骤 3 : HelloController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-GlobalExceptionHandler"><span class="nav-text">步骤 4 : GlobalExceptionHandler</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-errorPage-jsp"><span class="nav-text">步骤 5 : errorPage.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-重启测试"><span class="nav-text">步骤 6 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、SPRINGBOOT设置端口和上下文路径"><span class="nav-text">8、SPRINGBOOT设置端口和上下文路径</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-端口和上下文路径"><span class="nav-text">步骤 1 : 端口和上下文路径</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、SPRINGBOOT-如何进行多配置切换"><span class="nav-text">9、SPRINGBOOT 如何进行多配置切换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-切换需求"><span class="nav-text">步骤 1 : 切换需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-多配置文件"><span class="nav-text">步骤 2 : 多配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-部署"><span class="nav-text">步骤 3 : 部署</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、SPRINGBOOT中用YML方式进行配置"><span class="nav-text">10、SPRINGBOOT中用YML方式进行配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-yml-格式"><span class="nav-text">步骤 1 : yml 格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-同样内容，不同写法"><span class="nav-text">步骤 2 : 同样内容，不同写法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-application-yml"><span class="nav-text">步骤 3 : application.yml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-排斥性"><span class="nav-text">步骤 4 : 排斥性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11、通过-ECLIPSE-导入-SPRINGBOOT-项目"><span class="nav-text">11、通过 ECLIPSE 导入 SPRINGBOOT 项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-现成项目"><span class="nav-text">步骤 1 : 现成项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-下载"><span class="nav-text">步骤 2 : 下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-导入"><span class="nav-text">步骤 3 : 导入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-等待"><span class="nav-text">步骤 4 : 等待</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-启动"><span class="nav-text">步骤 5 : 启动</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12、如何通过-IDEA-导入一个-SPRINGBOOT-项目"><span class="nav-text">12、如何通过 IDEA 导入一个 SPRINGBOOT 项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-现成项目-v2"><span class="nav-text">步骤 1 : 现成项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-下载-v2"><span class="nav-text">步骤 2 : 下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-导入-v2"><span class="nav-text">步骤 3 : 导入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-等待-v2"><span class="nav-text">步骤 4 : 等待</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-启动-v2"><span class="nav-text">步骤 5 : 启动</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、持久层支持"><span class="nav-text">二、持久层支持</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、SPRINGBOOT中如何运用JPA-简单例子"><span class="nav-text">1、SPRINGBOOT中如何运用JPA,简单例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-JPA概念"><span class="nav-text">步骤 1 : JPA概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-创建数据库-v3"><span class="nav-text">步骤 2 : 创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建表-v4"><span class="nav-text">步骤 3 : 创建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-准备数据-v2"><span class="nav-text">步骤 4 : 准备数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-先运行，看到效果，再学习-v3"><span class="nav-text">步骤 5 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-模仿和排错-v3"><span class="nav-text">步骤 6 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-基于前面的知识点"><span class="nav-text">步骤 7 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-application-properties"><span class="nav-text">步骤 8 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-pom-xml"><span class="nav-text">步骤 9 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-Category"><span class="nav-text">步骤 10 : Category</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-CategoryDAO"><span class="nav-text">步骤 11 : CategoryDAO</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-CategoryController"><span class="nav-text">步骤 12 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-listCategory-jsp"><span class="nav-text">步骤 13 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-重启测试"><span class="nav-text">步骤 14 : 重启测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-15-更多关于JPA"><span class="nav-text">步骤 15 : 更多关于JPA</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、SPRINGBOOT中如何运用MYBATIS-简单例子"><span class="nav-text">2、SPRINGBOOT中如何运用MYBATIS 简单例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-关于Mybatis"><span class="nav-text">步骤 1 : 关于Mybatis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-创建数据库-v4"><span class="nav-text">步骤 2 : 创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-创建表-v5"><span class="nav-text">步骤 3 : 创建表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-准备数据-v3"><span class="nav-text">步骤 4 : 准备数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-先运行，看到效果，再学习-v4"><span class="nav-text">步骤 5 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-模仿和排错-v4"><span class="nav-text">步骤 6 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-基于前面的知识点-v2"><span class="nav-text">步骤 7 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-application-properties-v2"><span class="nav-text">步骤 8 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-pom-xml-v2"><span class="nav-text">步骤 9 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-Category-v2"><span class="nav-text">步骤 10 : Category</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-CategoryMapper"><span class="nav-text">步骤 11 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-CategoryController-v2"><span class="nav-text">步骤 12 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-listCategory-jsp-v2"><span class="nav-text">步骤 13 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-重启测试-v2"><span class="nav-text">步骤 14 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、MYBATIS-XML方式"><span class="nav-text">3、MYBATIS-XML方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-xml方式"><span class="nav-text">步骤 1 : xml方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v6"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v5"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v3"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-CategoryMapper-v3"><span class="nav-text">步骤 5 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-Category-xml-v2"><span class="nav-text">步骤 6 : Category.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-application-properties"><span class="nav-text">步骤 7 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-重启后测试"><span class="nav-text">步骤 8 : 重启后测试</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、CRUD-分页"><span class="nav-text">三、CRUD+分页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、SPRINGBOOT使用JPA实现完整的增删改查-CRUD和分页"><span class="nav-text">1、SPRINGBOOT使用JPA实现完整的增删改查 CRUD和分页</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-CRUD和分页"><span class="nav-text">步骤 1 : CRUD和分页</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v7"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v6"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v4"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-CategoryController"><span class="nav-text">步骤 5 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-listCategory-jsp"><span class="nav-text">步骤 6 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-editCategory-jsp"><span class="nav-text">步骤 7 : editCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-重启测试"><span class="nav-text">步骤 8 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、SPRINGBOOT使用MYBATIS实现完整的-增删改查-CRUD和分页"><span class="nav-text">2、SPRINGBOOT使用MYBATIS实现完整的 增删改查 CRUD和分页</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-Mybatis-CRUD和分页"><span class="nav-text">步骤 1 : Mybatis CRUD和分页</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v8"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v7"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v5"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-pom-xml-v2"><span class="nav-text">步骤 5 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-PageHelperConfig"><span class="nav-text">步骤 6 : PageHelperConfig</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-CategoryMapper-v2"><span class="nav-text">步骤 7 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-CategoryController"><span class="nav-text">步骤 8 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-listCategory-jsp"><span class="nav-text">步骤 9 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-editCategory-jsp"><span class="nav-text">步骤 10 : editCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-重启测试访问"><span class="nav-text">步骤 11 : 重启测试访问</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、SPRINGBOOT-基于SQLITE-和JPA-方式"><span class="nav-text">3、SPRINGBOOT 基于SQLITE 和JPA 方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-SQLite-介绍"><span class="nav-text">步骤 1 : SQLite 介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v9"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v8"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v6"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-SQLite-方言一堆"><span class="nav-text">步骤 5 : SQLite 方言一堆</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-application-properties-v2"><span class="nav-text">步骤 6 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-pom-xml"><span class="nav-text">步骤 7 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-重启运行"><span class="nav-text">步骤 8 : 重启运行</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、其他"><span class="nav-text">四、其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、单元测试"><span class="nav-text">1、单元测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-单元测试"><span class="nav-text">步骤 1 : 单元测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v10"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v9"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v7"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-pom-xml-v3"><span class="nav-text">步骤 5 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-测试类-v2"><span class="nav-text">步骤 6 : 测试类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-测试-v11"><span class="nav-text">步骤 7 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、SPRING-JPA-如何做条件查询"><span class="nav-text">2、SPRING JPA 如何做条件查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v99"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v99"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的知识点-v3"><span class="nav-text">步骤 3 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-JPA-条件查询方式"><span class="nav-text">步骤 4 : JPA 条件查询方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-实现原理"><span class="nav-text">步骤 5 : 实现原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-条件查询规范"><span class="nav-text">步骤 6 : 条件查询规范</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、SPRINGBOOT-如何上传图片文件"><span class="nav-text">3、SPRINGBOOT 如何上传图片文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v100"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v100"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的知识点-v4"><span class="nav-text">步骤 3 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-uploadPage-jsp"><span class="nav-text">步骤 4 : uploadPage.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-UploadController-java"><span class="nav-text">步骤 5 : UploadController.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-UploadController-java"><span class="nav-text">步骤 6 : UploadController.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-application-properties-v2"><span class="nav-text">步骤 7 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-测试-v6"><span class="nav-text">步骤 8 : 测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、SPRINGBOOT-如何开发-RESTFUL-风格的项目"><span class="nav-text">4、SPRINGBOOT 如何开发 RESTFUL 风格的项目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-Restful-风格是什么-v2"><span class="nav-text">步骤 1 : Restful 风格是什么</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v11"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v10"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v8"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-listCategory-jsp"><span class="nav-text">步骤 5 : listCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-editCategory-jsp"><span class="nav-text">步骤 6 : editCategory.jsp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-CategoryController"><span class="nav-text">步骤 7 : CategoryController</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、SPRINGBOOT-做前后端分离"><span class="nav-text">5、SPRINGBOOT 做前后端分离</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-先运行，看到效果，再学习-v101"><span class="nav-text">步骤 1 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-模仿和排错-v101"><span class="nav-text">步骤 2 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-本知识点效果-v3"><span class="nav-text">步骤 3 : 本知识点效果</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v9"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-Category"><span class="nav-text">步骤 5 : Category</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-CategoryController-v3"><span class="nav-text">步骤 6 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-submit-html-v2"><span class="nav-text">步骤 7 : submit.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-getOne-html-v2"><span class="nav-text">步骤 8 : getOne.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-getMany-html-v2"><span class="nav-text">步骤 9 : getMany.html</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、SPRINGBOOT-JPA-REDIS-整合在一起做一套带分页的-增删改查-CRUD"><span class="nav-text">6、SPRINGBOOT JPA REDIS 整合在一起做一套带分页的 增删改查 CRUD</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-Redis"><span class="nav-text">步骤 1 : Redis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-运行-Redis-服务器"><span class="nav-text">步骤 2 : 运行 Redis 服务器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-基于前面的知识点-v5"><span class="nav-text">步骤 3 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-先运行，看到效果，再学习-v3"><span class="nav-text">步骤 4 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-模仿和排错-v3"><span class="nav-text">步骤 5 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-改动"><span class="nav-text">步骤 6 : 改动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-pom-xml-v2"><span class="nav-text">步骤 7 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-application-properties-v3"><span class="nav-text">步骤 8 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-Application"><span class="nav-text">步骤 9 : Application</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-RedisConfig-java"><span class="nav-text">步骤 10 : RedisConfig.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-Page4Navigator"><span class="nav-text">步骤 11 : Page4Navigator</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-CategoryService-v2"><span class="nav-text">步骤 12 : CategoryService</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-CategoryServiceImpl-v2"><span class="nav-text">步骤 13 : CategoryServiceImpl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-CategoryController-v2"><span class="nav-text">步骤 14 : CategoryController</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、ELASTICSEARCH"><span class="nav-text">7、ELASTICSEARCH</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、THYMELEAF"><span class="nav-text">五、THYMELEAF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、入门-基于-SPRINGBOOT-方式"><span class="nav-text">1、入门 基于 SPRINGBOOT 方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-什么是-thymeleaf"><span class="nav-text">步骤 1 : 什么是 thymeleaf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v12"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v11"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-基于前面的知识点-v10"><span class="nav-text">步骤 4 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-pom-xml-v4"><span class="nav-text">步骤 5 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-增加个控制器"><span class="nav-text">步骤 6 : 增加个控制器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-hello-html"><span class="nav-text">步骤 7 : hello.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-application-properties-v4"><span class="nav-text">步骤 8 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-重启测试"><span class="nav-text">步骤 9 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、URL-用法"><span class="nav-text">2、URL 用法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于上一个知识点改进"><span class="nav-text">步骤 1 : 基于上一个知识点改进</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v13"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v12"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-css-文件"><span class="nav-text">步骤 4 : css 文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-js-文件"><span class="nav-text">步骤 5 : js 文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-修改-hello-html"><span class="nav-text">步骤 6 : 修改 hello.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-重启测试"><span class="nav-text">步骤 7 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、THYMELEAF-中各种表达式YONG’F"><span class="nav-text">3、THYMELEAF 中各种表达式YONG’F</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于上一个知识点改进-v2"><span class="nav-text">步骤 1 : 基于上一个知识点改进</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v14"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v13"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-Product类"><span class="nav-text">步骤 4 : Product类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-TestController"><span class="nav-text">步骤 5 : TestController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-test-html"><span class="nav-text">步骤 6 : test.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-重启测试-v2"><span class="nav-text">步骤 7 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、THYMELEAF-如何通过-FRAGMENT-包含另一个文件举例"><span class="nav-text">4、THYMELEAF 如何通过 FRAGMENT 包含另一个文件举例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于上一个知识点改进-v3"><span class="nav-text">步骤 1 : 基于上一个知识点改进</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v15"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v14"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-include-html"><span class="nav-text">步骤 4 : include.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-test-html"><span class="nav-text">步骤 5 : test.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-重启测试-v2"><span class="nav-text">步骤 6 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5、THYMELEAF-如何用TH-IF做条件判断"><span class="nav-text">5、THYMELEAF 如何用TH:IF做条件判断</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于上一个知识点改进-v4"><span class="nav-text">步骤 1 : 基于上一个知识点改进</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v16"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v15"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-TestController"><span class="nav-text">步骤 4 : TestController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-test-html-v2"><span class="nav-text">步骤 5 : test.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-关于真假判断"><span class="nav-text">步骤 6 : 关于真假判断</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-重启测试-v3"><span class="nav-text">步骤 7 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6、THYMELEAF-如何用TH-EACH-做条件遍历"><span class="nav-text">6、THYMELEAF 如何用TH:EACH 做条件遍历</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于前面的知识点-v2"><span class="nav-text">步骤 1 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v17"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v16"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-TestController-v2"><span class="nav-text">步骤 4 : TestController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-普通遍历"><span class="nav-text">步骤 5 : 普通遍历</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-带状态的遍历"><span class="nav-text">步骤 6 : 带状态的遍历</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-结合-select"><span class="nav-text">步骤 7 : 结合 select</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-结合-单选框"><span class="nav-text">步骤 8 : 结合 单选框</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-完整的-test-html"><span class="nav-text">步骤 9 : 完整的 test.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-重启测试"><span class="nav-text">步骤 10 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7、THYMELEAF-内置工具用法示例和手册"><span class="nav-text">7、THYMELEAF 内置工具用法示例和手册</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于前面的知识点-v3"><span class="nav-text">步骤 1 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v18"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v17"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-TestController-v3"><span class="nav-text">步骤 4 : TestController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-test-html-v3"><span class="nav-text">步骤 5 : test.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-thymeleaf-内置工具"><span class="nav-text">步骤 6 : thymeleaf 内置工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-Execution-Info"><span class="nav-text">步骤 7 : Execution Info</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-Messages"><span class="nav-text">步骤 8 : Messages</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-URIs-URLs"><span class="nav-text">步骤 9 : URIs&#x2F;URLs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-Conversions"><span class="nav-text">步骤 10 : Conversions</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-Dates"><span class="nav-text">步骤 11 : Dates</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-Calendars"><span class="nav-text">步骤 12 : Calendars</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-Numbers"><span class="nav-text">步骤 13 : Numbers</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-Strings"><span class="nav-text">步骤 14 : Strings</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-15-Objects"><span class="nav-text">步骤 15 : Objects</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-16-Booleans"><span class="nav-text">步骤 16 : Booleans</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-17-Arrays"><span class="nav-text">步骤 17 : Arrays</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-18-Lists"><span class="nav-text">步骤 18 : Lists</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-19-Sets"><span class="nav-text">步骤 19 : Sets</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-20-Maps"><span class="nav-text">步骤 20 : Maps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-21-Aggregates"><span class="nav-text">步骤 21 : Aggregates</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-22-IDs"><span class="nav-text">步骤 22 : IDs</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8、SPRINGBOOT-整合-THYMELEAF-做增删改查-CRUD和分页"><span class="nav-text">8、SPRINGBOOT 整合 THYMELEAF 做增删改查 CRUD和分页</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-基于前面的知识点-v4"><span class="nav-text">步骤 1 : 基于前面的知识点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-先运行，看到效果，再学习-v19"><span class="nav-text">步骤 2 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-模仿和排错-v18"><span class="nav-text">步骤 3 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-表结构和数据"><span class="nav-text">步骤 4 : 表结构和数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-application-properties"><span class="nav-text">步骤 5 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-pom-xml"><span class="nav-text">步骤 6 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-Category"><span class="nav-text">步骤 7 : Category</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-CategoryMapper"><span class="nav-text">步骤 8 : CategoryMapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-CategoryController"><span class="nav-text">步骤 9 : CategoryController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-PageHelperConfig"><span class="nav-text">步骤 10 : PageHelperConfig</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-listCategory-html"><span class="nav-text">步骤 11 : listCategory.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-editCategory-html"><span class="nav-text">步骤 12 : editCategory.html</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-重启测试"><span class="nav-text">步骤 13 : 重启测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9、VUE-JS-RESTFUL-PAGEHELPER-THYMELEAF-SPRINGBOOT-前后端分离-增删改查-CRUD-教程"><span class="nav-text">9、VUE.JS + RESTFUL + PAGEHELPER + THYMELEAF + SPRINGBOOT 前后端分离 增删改查 CRUD 教程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-教程说明"><span class="nav-text">步骤 1 : 教程说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-数据库准备"><span class="nav-text">步骤 2 : 数据库准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-准备表"><span class="nav-text">步骤 3 : 准备表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-先运行，看到效果，再学习-v4"><span class="nav-text">步骤 4 : 先运行，看到效果，再学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-模仿和排错-v4"><span class="nav-text">步骤 5 : 模仿和排错</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-新建-springboot-项目"><span class="nav-text">步骤 6 : 新建 springboot 项目</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-7-pom-xml-v3"><span class="nav-text">步骤 7 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-8-application-properties-v5"><span class="nav-text">步骤 8 : application.properties</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-9-Application-java"><span class="nav-text">步骤 9 : Application.java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-10-分页配置"><span class="nav-text">步骤 10 : 分页配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-11-异常处理"><span class="nav-text">步骤 11 : 异常处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-12-实体类"><span class="nav-text">步骤 12 : 实体类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-13-Mapper"><span class="nav-text">步骤 13 : Mapper</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-14-Hero-xml"><span class="nav-text">步骤 14 : Hero.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-15-Service-接口"><span class="nav-text">步骤 15 : Service 接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-16-Service-实现类"><span class="nav-text">步骤 16 : Service 实现类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-17-Controller-类"><span class="nav-text">步骤 17 : Controller 类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-18-js-文件"><span class="nav-text">步骤 18 : js 文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-19-模板文件"><span class="nav-text">步骤 19 : 模板文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-20-启动测试"><span class="nav-text">步骤 20 : 启动测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10、在-IDEA2017-里-SPRINGBOOT-THYMELEAF-修改-HTML-之后不能立即看到效果的解决办法"><span class="nav-text">10、在 IDEA2017 里 SPRINGBOOT THYMELEAF 修改 HTML 之后不能立即看到效果的解决办法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-1-idea-热更新"><span class="nav-text">步骤 1 : idea 热更新</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-2-pom-xml-v2"><span class="nav-text">步骤 2 : pom.xml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-3-idea-设置"><span class="nav-text">步骤 3 : idea 设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-4-1-项目自动编译"><span class="nav-text">步骤 4 : 1. 项目自动编译</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-5-2-automake-选项开启-A"><span class="nav-text">步骤 5 : 2. automake 选项开启-A</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#步骤-6-2-automake-选项开启-B"><span class="nav-text">步骤 6 : 2. automake 选项开启-B</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script
  async
  src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"
></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">潇 卟 甸</span>

  
</div>

<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>

-->



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
     我的第 <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> 位朋友，
    </span>
  

  
    <span class="site-pv">
     历经 <span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次回眸才与你相遇
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: 'w1mVK8MFY7n2fWIKlq2t9EJn-gzGzoHsz',
        appKey: 'NMGzUaGqmpzSiSItkHBQGUaA',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("w1mVK8MFY7n2fWIKlq2t9EJn-gzGzoHsz", "NMGzUaGqmpzSiSItkHBQGUaA");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  


  

 <script src="/js/src/activate-power-mode.js"></script>
 <script>
   POWERMODE.colorful = true;
   POWERMODE.shake = false;
   document.body.addEventListener('input', POWERMODE);
 </script>




<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.min.js"></script>
<script>
  function timer() {
    var ages = moment.preciseDiff(moment(),moment(20200610,"YYYYMMDD"));
    ages = ages.replace(/years?/, "年");
    ages = ages.replace(/months?/, "月");
    ages = ages.replace(/days?/, "天");
    ages = ages.replace(/hours?/, "小时");
    ages = ages.replace(/minutes?/, "分");
    ages = ages.replace(/seconds?/, "秒");
    ages = ages.replace(/\d+/g, '<span style="color:#1890ff">$&</span>');
    div.innerHTML = `我已在此等候你 ${ages}`;
  }
  var div = document.createElement("div");
  //插入到copyright之后
  var copyright = document.querySelector(".copyright");
  document.querySelector(".footer-inner").insertBefore(div, copyright.nextSibling);
  timer();
  setInterval("timer()",1000)
</script>




<script>
  var OriginTitile = document.title;
  var titleTime;
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      document.title = "(つェ⊂)我藏好了哦~" + OriginTitile;
      clearTimeout(titleTime);
    } else {
      document.title = "(*´∇｀*) 被你发现啦~" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
      }, 2000);
    }
  });
</script>


  
</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>
